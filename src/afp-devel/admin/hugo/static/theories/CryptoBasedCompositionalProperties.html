<div id="ListExtras">
<div class="head">
<h1>Theory ListExtras</h1>
</div>
<pre class="source"><span class="comment1">(*&lt;*)</span>
<span class="comment1">(*
   Title:  Theory ListExtras.thy
   Author: Maria Spichkova &lt;maria.spichkova at rmit.edu.au&gt;, 2014
*)</span>
<span class="comment1">(*&gt;*)</span>
<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Auxiliary Theory ListExtras.thy›</span></span>

<span class="keyword1"><span class="command">theory</span></span> ListExtras 
<span class="keyword2"><span class="keyword">imports</span></span> <a href="../../HOL/HOL/Main.html">Main</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">disjoint</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> list <span class="main">⇒</span> <span class="tfree">'a</span> list <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
 <span class="quoted"><span class="quoted">"<span class="free">disjoint</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">≡</span>  <span class="main">(</span>set <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span>set <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>

<span class="keyword1"><span class="command">primrec</span></span>
  <span class="entity">mem</span> <span class="main">::</span>  <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> list <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1">mem</span>"</span> 65<span class="main">)</span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1"><span class="free">mem</span></span> <span class="main">[]</span> <span class="main">=</span> False"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1"><span class="free">mem</span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">#</span> <span class="free"><span class="bound"><span class="entity">l</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1"><span class="free">mem</span></span> <span class="free"><span class="bound"><span class="entity">l</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">memS</span> <span class="main">::</span>  <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> list <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
 <span class="quoted"><span class="quoted">"<span class="free">memS</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">l</span></span></span>  <span class="main">≡</span>  <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∈</span> <span class="main">(</span>set <span class="free"><span class="bound"><span class="entity">l</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="ListExtras-mem_memS_eq"><span class="command">lemma</span></span> mem_memS_eq<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">mem</span> <span class="free">l</span> <span class="main">≡</span> memS <span class="free">x</span> <span class="free">l</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">l</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> Nil
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> memS_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">la</span> <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Cons <span class="skolem">a</span> <span class="skolem">la</span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> Cons <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> memS_def<span class="main">)</span>
 <span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="ListExtras-mem_set_1"><span class="command">lemma</span></span> mem_set_1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">mem</span> <span class="free">l</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> set <span class="free">l</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> memS_def mem_memS_eq<span class="main">)</span>

<span class="keyword1" id="ListExtras-mem_set_2"><span class="command">lemma</span></span> mem_set_2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> set <span class="free">l</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">mem</span> <span class="free">l</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> memS_def mem_memS_eq<span class="main">)</span>

<span class="keyword1" id="ListExtras-set_inter_mem"><span class="command">lemma</span></span> set_inter_mem<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">mem</span> <span class="free">l1</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">mem</span> <span class="free">l2</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"set <span class="free">l1</span> <span class="main">∩</span> set <span class="free">l2</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> IntI empty_iff mem_set_1<span class="main">)</span>

<span class="keyword1" id="ListExtras-mem_notdisjoint"><span class="command">lemma</span></span> mem_notdisjoint<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">mem</span> <span class="free">l1</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">mem</span> <span class="free">l2</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> disjoint <span class="free">l1</span> <span class="free">l2</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> disjoint_def set_inter_mem<span class="main">)</span>

<span class="keyword1" id="ListExtras-mem_notdisjoint2"><span class="command">lemma</span></span> mem_notdisjoint2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> h1<span class="main">:</span><span class="quoted"><span class="quoted">"disjoint <span class="main">(</span><span class="free">schedule</span> <span class="free">A</span><span class="main">)</span> <span class="main">(</span><span class="free">schedule</span> <span class="free">B</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> h2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">mem</span> <span class="free">schedule</span> <span class="free">A</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">x</span> <span class="keyword1">mem</span> <span class="free">schedule</span> <span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">" <span class="free">x</span> <span class="keyword1">mem</span> <span class="free">schedule</span> <span class="free">B</span>"</span></span>
     <span class="keyword1"><span class="command">from</span></span> h2 <span class="keyword2"><span class="keyword">and</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>  disjoint <span class="main">(</span><span class="free">schedule</span> <span class="free">A</span><span class="main">)</span> <span class="main">(</span><span class="free">schedule</span> <span class="free">B</span><span class="main">)</span>"</span></span> 
       <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mem_notdisjoint<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> h1 <span class="keyword2"><span class="keyword">and</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
   <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">x</span> <span class="keyword1">mem</span> <span class="free">schedule</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="ListExtras-Add_Less"><span class="command">lemma</span></span> Add_Less<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">b</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">(</span>Suc <span class="free">a</span> <span class="main">-</span> <span class="free">b</span> <span class="main">&lt;</span> Suc <span class="free">a</span><span class="main">)</span> <span class="main">=</span> True"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="ListExtras-list_length_hint1"><span class="command">lemma</span></span> list_length_hint1<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">l</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> length <span class="free">l</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="ListExtras-list_length_hint1a"><span class="command">lemma</span></span> list_length_hint1a<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">l</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> length <span class="free">l</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="ListExtras-list_length_hint2"><span class="command">lemma</span></span> list_length_hint2<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"length <span class="free">x</span>  <span class="main">=</span> Suc <span class="main">0</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">[</span>hd <span class="free">x</span><span class="main">]</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms  
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Zero_neq_Suc list.sel<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> length_Suc_conv neq_Nil_conv<span class="main">)</span>

<span class="keyword1" id="ListExtras-list_length_hint2a"><span class="command">lemma</span></span> list_length_hint2a<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"length <span class="free">l</span> <span class="main">=</span> Suc <span class="main">0</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"tl <span class="free">l</span> <span class="main">=</span> <span class="main">[]</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> list_length_hint2 list.sel<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span> 

<span class="keyword1" id="ListExtras-list_length_hint3"><span class="command">lemma</span></span> list_length_hint3<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"length <span class="free">l</span> <span class="main">=</span> Suc <span class="main">0</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">l</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Zero_neq_Suc list.size<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1" id="ListExtras-list_length_hint4"><span class="command">lemma</span></span> list_length_hint4<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"length <span class="free">x</span> <span class="main">≤</span> Suc <span class="main">0</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"length <span class="free">x</span> <span class="main">=</span> Suc <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> le_0_eq le_Suc_eq length_greater_0_conv less_numeral_extra<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1" id="ListExtras-length_nonempty"><span class="command">lemma</span></span> length_nonempty<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"Suc <span class="main">0</span> <span class="main">≤</span> length <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> length_greater_0_conv less_eq_Suc_le<span class="main">)</span> 

<span class="keyword1" id="ListExtras-last_nth_length"><span class="command">lemma</span></span> last_nth_length<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">!</span> <span class="main">(</span><span class="main">(</span>length <span class="free">x</span><span class="main">)</span> <span class="main">-</span> Suc <span class="main">0</span><span class="main">)</span> <span class="main">=</span> last <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> One_nat_def last_conv_nth<span class="main">)</span>

<span class="keyword1" id="ListExtras-list_nth_append0"><span class="command">lemma</span></span> list_nth_append0<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">&lt;</span> length <span class="free">x</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">!</span> <span class="free">i</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">@</span> <span class="free">z</span><span class="main">)</span> <span class="main">!</span> <span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> nth_append<span class="main">)</span> 

<span class="keyword1" id="ListExtras-list_nth_append1"><span class="command">lemma</span></span> list_nth_append1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">&lt;</span> length <span class="free">x</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span> <span class="main">#</span> <span class="free">x</span><span class="main">)</span> <span class="main">!</span> <span class="free">i</span> <span class="main">=</span> <span class="main">(</span><span class="free">b</span> <span class="main">#</span> <span class="free">x</span> <span class="main">@</span> <span class="free">y</span><span class="main">)</span> <span class="main">!</span> <span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">&lt;</span> length <span class="main">(</span><span class="free">b</span> <span class="main">#</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> sg2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span> <span class="main">#</span> <span class="free">x</span><span class="main">)</span> <span class="main">!</span> <span class="free">i</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">b</span> <span class="main">#</span> <span class="free">x</span><span class="main">)</span> <span class="main">@</span> <span class="free">y</span><span class="main">)</span> <span class="main">!</span> <span class="free">i</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> list_nth_append0<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="ListExtras-list_nth_append2"><span class="command">lemma</span></span> list_nth_append2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span> <span class="main">#</span> <span class="free">x</span><span class="main">)</span> <span class="main">!</span> <span class="free">i</span> <span class="main">=</span> <span class="main">(</span><span class="free">b</span> <span class="main">#</span> <span class="free">x</span> <span class="main">@</span> <span class="free">a</span> <span class="main">#</span> <span class="free">y</span><span class="main">)</span> <span class="main">!</span> <span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Cons_eq_appendI length_Suc_conv list_nth_append0<span class="main">)</span>

<span class="keyword1" id="ListExtras-list_nth_append3"><span class="command">lemma</span></span> list_nth_append3<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> h1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">i</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">x</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">-</span> Suc <span class="main">(</span>length <span class="free">x</span><span class="main">)</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="main">#</span> <span class="free">y</span><span class="main">)</span> <span class="main">!</span> <span class="main">(</span><span class="free">i</span> <span class="main">-</span> Suc <span class="main">(</span>length <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">b</span> <span class="main">#</span> <span class="free">x</span> <span class="main">@</span> <span class="free">a</span> <span class="main">#</span> <span class="free">y</span><span class="main">)</span> <span class="main">!</span> <span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">i</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">=</span><span class="main">0</span>"</span></span> 
  <span class="keyword1"><span class="command">with</span></span> h1  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nth_append<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">ii</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">=</span> Suc <span class="skolem">ii</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> h1  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nth_append<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="ListExtras-list_nth_append4"><span class="command">lemma</span></span> list_nth_append4<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">x</span> <span class="main">+</span> length <span class="free">y</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">i</span> <span class="main">-</span> Suc <span class="main">(</span>length <span class="free">x</span><span class="main">)</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">y</span><span class="main">)</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms  <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>

<span class="keyword1" id="ListExtras-list_nth_append5"><span class="command">lemma</span></span> list_nth_append5<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">-</span> length <span class="free">x</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">y</span><span class="main">)</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">i</span> <span class="main">-</span> Suc <span class="main">(</span>length <span class="free">x</span><span class="main">)</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>  <span class="free">i</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">x</span> <span class="main">+</span> length <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms  <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>

<span class="keyword1" id="ListExtras-list_nth_append6"><span class="command">lemma</span></span> list_nth_append6<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">i</span> <span class="main">-</span> length <span class="free">x</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">y</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">i</span> <span class="main">-</span> Suc <span class="main">(</span>length <span class="free">x</span><span class="main">)</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">i</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">x</span> <span class="main">+</span> length <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>

<span class="keyword1" id="ListExtras-list_nth_append6a"><span class="command">lemma</span></span> list_nth_append6a<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">x</span> <span class="main">+</span> length <span class="free">y</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">i</span> <span class="main">-</span> length <span class="free">x</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span> 

<span class="keyword1" id="ListExtras-list_nth_append7"><span class="command">lemma</span></span> list_nth_append7<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">-</span> length <span class="free">x</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">y</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">-</span> Suc <span class="main">(</span>length <span class="free">x</span><span class="main">)</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">&lt;</span> Suc <span class="main">(</span>Suc <span class="main">(</span>length <span class="free">x</span> <span class="main">+</span> length <span class="free">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms  <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>

<span class="keyword1" id="ListExtras-list_nth_append8"><span class="command">lemma</span></span> list_nth_append8<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">i</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">x</span> <span class="main">+</span> length <span class="free">y</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">&lt;</span> Suc <span class="main">(</span>Suc <span class="main">(</span>length <span class="free">x</span> <span class="main">+</span> length <span class="free">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>     <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">=</span> Suc <span class="main">(</span>length <span class="free">x</span> <span class="main">+</span> length <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms  <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>

<span class="keyword1" id="ListExtras-list_nth_append9"><span class="command">lemma</span></span> list_nth_append9<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">-</span> Suc <span class="main">(</span>length <span class="free">x</span><span class="main">)</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">&lt;</span> Suc <span class="main">(</span>Suc <span class="main">(</span>length <span class="free">x</span> <span class="main">+</span> length <span class="free">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
  
<span class="keyword1" id="ListExtras-list_nth_append10"><span class="command">lemma</span></span> list_nth_append10<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">i</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">x</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">i</span> <span class="main">-</span> Suc <span class="main">(</span>length <span class="free">x</span><span class="main">)</span> <span class="main">&lt;</span> Suc <span class="main">(</span>length <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">i</span> <span class="main">&lt;</span> Suc <span class="main">(</span>Suc <span class="main">(</span>length <span class="free">x</span> <span class="main">+</span> length <span class="free">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="Secrecy_types">
<div class="head">
<h1>Theory Secrecy_types</h1>
</div>
<pre class="source"><span class="comment1">(*
   Title: Theory  Secrecy_types.thy
   Author:    Maria Spichkova &lt;maria.spichkova at rmit.edu.au&gt;, 2014
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Auxiliary data types›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Secrecy_types
<span class="keyword2"><span class="keyword">imports</span></span> <a href="../../HOL/HOL/Main.html">Main</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="comment1">― ‹We assume disjoint sets: Data of data values,›</span>
<span class="comment1">― ‹Secrets of unguessable values, Keys - set of cryptographic  keys.›</span>  
<span class="comment1">― ‹Based on these sets, we specify the sets EncType of encryptors that may be›</span>
<span class="comment1">― ‹used for encryption or decryption, and Expression of expression items.›</span>
<span class="comment1">― ‹The specification (component) identifiers should be listed in the set specID,›</span>
<span class="comment1">― ‹the channel indentifiers should be listed in the set chanID.›</span> 

<span class="keyword1"><span class="command">datatype</span></span> Keys <span class="main">=</span> CKey <span class="main">|</span> CKeyP <span class="main">|</span> SKey <span class="main">|</span> SKeyP <span class="main">|</span> genKey 
<span class="keyword1"><span class="command">datatype</span></span> Secrets <span class="main">=</span> secretD <span class="main">|</span> N <span class="main">|</span> NA
<span class="keyword1"><span class="command">type_synonym</span></span> Var  <span class="main">=</span> <span class="quoted"><span class="quoted">"nat"</span></span>
<span class="keyword1"><span class="command">type_synonym</span></span> Data <span class="main">=</span> <span class="quoted"><span class="quoted">"nat"</span></span>
<span class="keyword1"><span class="command">datatype</span></span> KS          <span class="main">=</span> kKS <span class="quoted">Keys</span> <span class="main">|</span> sKS <span class="quoted">Secrets</span>
<span class="keyword1"><span class="command">datatype</span></span> EncType  <span class="main">=</span> kEnc <span class="quoted">Keys</span> <span class="main">|</span> vEnc <span class="quoted">Var</span>
<span class="keyword1"><span class="command">datatype</span></span> specID <span class="main">=</span> sComp1 <span class="main">|</span> sComp2 <span class="main">|</span> sComp3 <span class="main">|</span> sComp4
<span class="keyword1"><span class="command">datatype</span></span> Expression <span class="main">=</span> kE <span class="quoted">Keys</span> <span class="main">|</span> sE <span class="quoted">Secrets</span> <span class="main">|</span> dE <span class="quoted">Data</span> <span class="main">|</span> idE <span class="quoted">specID</span> 
<span class="keyword1"><span class="command">datatype</span></span> chanID <span class="main">=</span> ch1 <span class="main">|</span> ch2   <span class="main">|</span> ch3  <span class="main">|</span> ch4

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">Expression2KSL</span><span class="main">::</span> <span class="quoted"><span class="quoted">"Expression list <span class="main">⇒</span> KS list"</span></span> 
<span class="keyword2"><span class="keyword">where</span></span>
   <span class="quoted"><span class="quoted">"<span class="free">Expression2KSL</span> <span class="main">[]</span> <span class="main">=</span> <span class="main">[]</span>"</span></span> <span class="main">|</span>
   <span class="quoted"><span class="quoted">"<span class="free">Expression2KSL</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">#</span><span class="free"><span class="bound"><span class="entity">xs</span></span></span><span class="main">)</span> <span class="main">=</span> 
     <span class="main">(</span><span class="main">(</span><span class="keyword1">case</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">of</span> <span class="main">(</span>kE <span class="bound">m</span><span class="main">)</span> <span class="main">⇒</span> <span class="main">[</span>kKS <span class="bound">m</span><span class="main">]</span> 
                  <span class="main">|</span> <span class="main">(</span>sE <span class="bound">m</span><span class="main">)</span> <span class="main">⇒</span> <span class="main">[</span>sKS <span class="bound">m</span><span class="main">]</span> 
                  <span class="main">|</span> <span class="main">(</span>dE <span class="bound">m</span><span class="main">)</span> <span class="main">⇒</span> <span class="main">[]</span> 
                  <span class="main">|</span> <span class="main">(</span>idE <span class="bound">m</span><span class="main">)</span> <span class="main">⇒</span> <span class="main">[]</span><span class="main">)</span> <span class="main">@</span> <span class="free">Expression2KSL</span> <span class="free"><span class="bound"><span class="entity">xs</span></span></span><span class="main">)</span> "</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">KS2Expression</span><span class="main">::</span> <span class="quoted"><span class="quoted">"KS <span class="main">⇒</span> Expression"</span></span> 
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">KS2Expression</span> <span class="main">(</span>kKS <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>kE <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span>"</span></span>  <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">KS2Expression</span> <span class="main">(</span>sKS <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>sE <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="inout">
<div class="head">
<h1>Theory inout</h1>
</div>
<pre class="source"><span class="comment1">(*
   Title: Theory  inout.thy
   Author:    Maria Spichkova &lt;maria.spichkova at rmit.edu.au&gt;, 2014
*)</span>
 
<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Correctness of the relations between sets of Input/Output channels›</span></span>
 
<span class="keyword1"><span class="command">theory</span></span>  inout 
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Secrecy_types.html">Secrecy_types</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">consts</span></span> 
  subcomponents <span class="main">::</span>  <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> specID set"</span></span>

<span class="comment1">― ‹Mappings, defining sets of input, local, and output channels›</span>
<span class="comment1">― ‹of a component›</span>
<span class="keyword1"><span class="command">consts</span></span>
  ins <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> chanID set"</span></span>
  loc <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> chanID set"</span></span>
  out <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> chanID set"</span></span>

<span class="comment1">― ‹Predicate insuring the correct mapping from the component identifier›</span>
<span class="comment1">― ‹to the set of input channels of a component›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">inStream</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> chanID set <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">inStream</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span>  <span class="main">≡</span> <span class="main">(</span>ins <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>

<span class="comment1">― ‹Predicate insuring the correct mapping from the component identifier›</span>
<span class="comment1">― ‹to the set of local channels of a component›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">locStream</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> chanID set <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">locStream</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">≡</span> <span class="main">(</span>loc <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>

<span class="comment1">― ‹Predicate insuring the correct mapping from the component identifier›</span>
<span class="comment1">― ‹to the set of output channels of a component›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">outStream</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> chanID set <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">outStream</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">≡</span> <span class="main">(</span>out <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>

<span class="comment1">― ‹Predicate insuring the correct relations between›</span>
<span class="comment1">― ‹to the set of input, output and local channels of a component›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">correctInOutLoc</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">correctInOutLoc</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> 
   <span class="main">(</span>ins <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span>out <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span> 
    <span class="main">∧</span> <span class="main">(</span>ins <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span>loc <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span> 
    <span class="main">∧</span> <span class="main">(</span>loc <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span>out <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span> "</span></span> 

<span class="comment1">― ‹Predicate insuring the correct relations between›</span>
<span class="comment1">― ‹sets of input channels within a composed component›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">correctCompositionIn</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">correctCompositionIn</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> 
  <span class="main">(</span>ins <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">⋃</span> <span class="main">(</span>ins <span class="main">`</span> <span class="main">(</span>subcomponents <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span>loc <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span>
  <span class="main">∧</span> <span class="main">(</span>ins <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span><span class="main">⋃</span> <span class="main">(</span>out <span class="main">`</span> <span class="main">(</span>subcomponents <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 

<span class="comment1">― ‹Predicate insuring the correct relations between›</span>
<span class="comment1">― ‹sets of output channels within a composed component›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">correctCompositionOut</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">correctCompositionOut</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> 
  <span class="main">(</span>out <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">⋃</span> <span class="main">(</span>out <span class="main">`</span> <span class="main">(</span>subcomponents <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">-</span> <span class="main">(</span>loc <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span>
  <span class="main">∧</span> <span class="main">(</span>out <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span><span class="main">⋃</span> <span class="main">(</span>ins <span class="main">`</span> <span class="main">(</span>subcomponents <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span> "</span></span> 

<span class="comment1">― ‹Predicate insuring the correct relations between›</span>
<span class="comment1">― ‹sets of local channels within a composed component›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">correctCompositionLoc</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">correctCompositionLoc</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> 
   <span class="main">(</span>loc <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">⋃</span> <span class="main">(</span>ins <span class="main">`</span> <span class="main">(</span>subcomponents <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span>
           <span class="main">∩</span> <span class="main">⋃</span> <span class="main">(</span>out <span class="main">`</span> <span class="main">(</span>subcomponents <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span> 

<span class="comment1">― ‹If a component is an elementary one (has no subcomponents)›</span>
<span class="comment1">― ‹its set of local channels should be empty›</span>
<span class="keyword1" id="inout-subcomponents_loc"><span class="command">lemma</span></span> subcomponents_loc<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">x</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">x</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"loc <span class="free">x</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionLoc_def<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="Secrecy">
<div class="head">
<h1>Theory Secrecy</h1>
</div>
<pre class="source"><span class="comment1">(*
   Title: Theory  Secrecy.thy
   Author:    Maria Spichkova &lt;maria.spichkova at rmit.edu.au&gt;, 2014
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Secrecy: Definitions and properties›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Secrecy
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Secrecy_types.html">Secrecy_types</a> <a href="inout.html">inout</a> <a href="ListExtras.html">ListExtras</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="comment1">― ‹Encryption, decryption, signature creation and signature verification functions›</span>
<span class="comment1">― ‹For these functions we define only their signatures and general axioms,›</span>
<span class="comment1">― ‹because in order to reason effectively, we view them as abstract functions and›</span>
<span class="comment1">― ‹abstract from their implementation details›</span> 
<span class="keyword1"><span class="command">consts</span></span> 
  Enc  <span class="main">::</span> <span class="quoted"><span class="quoted">"Keys <span class="main">⇒</span> Expression list <span class="main">⇒</span> Expression list"</span></span>
  Decr <span class="main">::</span> <span class="quoted"><span class="quoted">"Keys <span class="main">⇒</span> Expression list <span class="main">⇒</span> Expression list"</span></span>
  Sign <span class="main">::</span> <span class="quoted"><span class="quoted">"Keys <span class="main">⇒</span> Expression list <span class="main">⇒</span> Expression list"</span></span>
  Ext   <span class="main">::</span> <span class="quoted"><span class="quoted">"Keys <span class="main">⇒</span> Expression list <span class="main">⇒</span> Expression list"</span></span>

<span class="comment1">― ‹Axioms on relations between encription and decription keys›</span>
<span class="keyword1"><span class="command">axiomatization</span></span>
   <span class="free">EncrDecrKeys</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"Keys  <span class="main">⇒</span> Keys <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
ExtSign<span class="main">:</span> 
 <span class="quoted"><span class="quoted">"<span class="free">EncrDecrKeys</span> <span class="free">K1</span> <span class="free">K2</span> <span class="main">⟶</span> <span class="main">(</span>Ext <span class="free">K1</span> <span class="main">(</span>Sign <span class="free">K2</span> <span class="free">E</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">E</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span>
DecrEnc<span class="main">:</span>
 <span class="quoted"><span class="quoted">"<span class="free">EncrDecrKeys</span> <span class="free">K1</span> <span class="free">K2</span> <span class="main">⟶</span> <span class="main">(</span>Decr <span class="free">K2</span> <span class="main">(</span>Enc <span class="free">K1</span> <span class="free">E</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">E</span>"</span></span>

<span class="comment1">― ‹Set of private keys of a component›</span>
<span class="keyword1"><span class="command">consts</span></span>
 specKeys <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> Keys set"</span></span>
<span class="comment1">― ‹Set of unguessable values used by a component›</span>
<span class="keyword1"><span class="command">consts</span></span> 
 specSecrets <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> Secrets set"</span></span>

<span class="comment1">― ‹Join set of private keys and unguessable values used by a component›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">specKeysSecrets</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> KS set"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
 <span class="quoted"><span class="quoted">"<span class="free">specKeysSecrets</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">≡</span>
  <span class="main">{</span><span class="bound">y</span> <span class="main">.</span>  <span class="main">∃</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">(</span>kKS <span class="bound">x</span><span class="main">)</span>  <span class="main">∧</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>specKeys <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">}</span> <span class="main">∪</span>
  <span class="main">{</span><span class="bound">z</span> <span class="main">.</span>  <span class="main">∃</span> <span class="bound">s</span><span class="main">.</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">(</span>sKS <span class="bound">s</span><span class="main">)</span>  <span class="main">∧</span> <span class="main">(</span><span class="bound">s</span> <span class="main">∈</span> <span class="main">(</span>specSecrets <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">}</span>"</span></span>

<span class="comment1">― ‹Predicate defining that a list of expression items does not contain›</span>
<span class="comment1">― ‹any private key  or unguessable value used by a component›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">notSpecKeysSecretsExpr</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span>  Expression list <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
     <span class="quoted"><span class="quoted">"<span class="free">notSpecKeysSecretsExpr</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">≡</span>
     <span class="main">(</span><span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span>kE <span class="bound">x</span><span class="main">)</span> <span class="keyword1">mem</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">⟶</span> <span class="main">(</span>kKS <span class="bound">x</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span> <span class="main">∧</span>
     <span class="main">(</span><span class="main">∀</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span>sE <span class="bound">y</span><span class="main">)</span> <span class="keyword1">mem</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">⟶</span> <span class="main">(</span>sKS <span class="bound">y</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span>"</span></span>

<span class="comment1">― ‹If a component is a composite one, the set of its private keys›</span> 
<span class="comment1">― ‹is a union of the subcomponents' sets of the private keys›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">correctCompositionKeys</span> <span class="main">::</span>  <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">correctCompositionKeys</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span>
    subcomponents <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟶</span> 
    specKeys <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span>  <span class="main">⋃</span> <span class="main">(</span>specKeys <span class="main">`</span> <span class="main">(</span>subcomponents <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span> 

<span class="comment1">― ‹If a component is a composite one, the set of its unguessable values›</span> 
<span class="comment1">― ‹is a union of the subcomponents' sets of the unguessable values›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">correctCompositionSecrets</span> <span class="main">::</span>  <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">correctCompositionSecrets</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span>
    subcomponents <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟶</span> 
    specSecrets <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span>  <span class="main">⋃</span> <span class="main">(</span>specSecrets <span class="main">`</span> <span class="main">(</span>subcomponents <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span> 

<span class="comment1">― ‹If a component is a composite one, the set of its private keys and›</span> 
<span class="comment1">― ‹unguessable values is a union of the corresponding sets of its subcomponents›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">correctCompositionKS</span> <span class="main">::</span>  <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">correctCompositionKS</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span>
    subcomponents <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟶</span> 
    specKeysSecrets <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span>  <span class="main">⋃</span> <span class="main">(</span>specKeysSecrets <span class="main">`</span> <span class="main">(</span>subcomponents <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span> 

<span class="comment1">― ‹Predicate defining set of correctness properties of the component's›</span>
<span class="comment1">― ‹interface  and relations on its private keys and unguessable values›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">correctComponentSecrecy</span>  <span class="main">::</span>  <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">correctComponentSecrecy</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> 
    correctCompositionKS <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> 
    correctCompositionSecrets <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> 
    correctCompositionKeys <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> 
    correctCompositionLoc <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span>
    correctCompositionIn <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span>
    correctCompositionOut <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> 
    correctInOutLoc <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="comment1">― ‹Predicate exprChannel I E defines whether the expression item E can be sent via the channel I›</span>    
<span class="keyword1"><span class="command">consts</span></span>
 exprChannel <span class="main">::</span> <span class="quoted"><span class="quoted">"chanID <span class="main">⇒</span> Expression <span class="main">⇒</span> bool"</span></span>

<span class="comment1">― ‹Predicate eoutM sP M E defines whether the component sP may eventually›</span>
<span class="comment1">― ‹output an expression E if there exists a time interval t of›</span> 
<span class="comment1">― ‹an output channel which contains this expression E›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">eout</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID  <span class="main">⇒</span> Expression <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
 <span class="quoted"><span class="quoted">"<span class="free">eout</span> <span class="free"><span class="bound"><span class="entity">sP</span></span></span> <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="main">≡</span> 
  <span class="main">∃</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">::</span> chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>out <span class="free"><span class="bound"><span class="entity">sP</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>exprChannel <span class="bound">ch</span> <span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="comment1">― ‹Predicate eout sP E defines whether the component sP may eventually›</span>
<span class="comment1">― ‹output an expression E via subset of channels M,›</span>
<span class="comment1">― ‹which is a subset of output channels of sP,›</span>
<span class="comment1">― ‹and if there exists a time interval t of›</span> 
<span class="comment1">― ‹an output channel which contains this expression E›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">eoutM</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID  <span class="main">⇒</span> chanID set <span class="main">⇒</span> Expression <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
 <span class="quoted"><span class="quoted">"<span class="free">eoutM</span> <span class="free"><span class="bound"><span class="entity">sP</span></span></span> <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="main">≡</span> 
  <span class="main">∃</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">::</span> chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>out <span class="free"><span class="bound"><span class="entity">sP</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">M</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>exprChannel <span class="bound">ch</span> <span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="comment1">― ‹Predicate ineM sP M E defines whether a component sP may eventually›</span>
<span class="comment1">― ‹get an expression E  if there exists a time interval t of›</span> 
<span class="comment1">― ‹an input stream  which contains this expression E›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">ine</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID  <span class="main">⇒</span> Expression <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
 <span class="quoted"><span class="quoted">"<span class="free">ine</span> <span class="free"><span class="bound"><span class="entity">sP</span></span></span> <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="main">≡</span> 
  <span class="main">∃</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">::</span> chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>ins <span class="free"><span class="bound"><span class="entity">sP</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>exprChannel <span class="bound">ch</span> <span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="comment1">― ‹Predicate ine sP E defines whether a component sP may eventually›</span>
<span class="comment1">― ‹get an expression E via subset of channels M,›</span>
<span class="comment1">― ‹which is a subset of input channels of sP,›</span>
<span class="comment1">― ‹and if there exists a time interval t of›</span> 
<span class="comment1">― ‹an input stream  which contains this expression E›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">ineM</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID  <span class="main">⇒</span> chanID set <span class="main">⇒</span> Expression <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
 <span class="quoted"><span class="quoted">"<span class="free">ineM</span> <span class="free"><span class="bound"><span class="entity">sP</span></span></span> <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="main">≡</span> 
  <span class="main">∃</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">::</span> chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>ins <span class="free"><span class="bound"><span class="entity">sP</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">M</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>exprChannel <span class="bound">ch</span> <span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="comment1">― ‹This predicate defines whether an input channel ch of a component sP›</span>
<span class="comment1">― ‹is the only one input channel of this component›</span>
<span class="comment1">― ‹via which it may eventually output an expression E›</span>
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">out_exprChannelSingle</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID  <span class="main">⇒</span> chanID <span class="main">⇒</span> Expression <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
 <span class="quoted"><span class="quoted">"<span class="free">out_exprChannelSingle</span> <span class="free"><span class="bound"><span class="entity">sP</span></span></span> <span class="free"><span class="bound"><span class="entity">ch</span></span></span> <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="main">≡</span> 
  <span class="main">(</span><span class="free"><span class="bound"><span class="entity">ch</span></span></span> <span class="main">∈</span> <span class="main">(</span>out <span class="free"><span class="bound"><span class="entity">sP</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span>  
  <span class="main">(</span>exprChannel <span class="free"><span class="bound"><span class="entity">ch</span></span></span> <span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main">)</span>  <span class="main">∧</span>
  <span class="main">(</span><span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span> chanID<span class="main">)</span> <span class="main">(</span><span class="bound">t</span> <span class="main">::</span> nat<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>out <span class="free"><span class="bound"><span class="entity">sP</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">x</span> <span class="main">≠</span> <span class="free"><span class="bound"><span class="entity">ch</span></span></span><span class="main">)</span> <span class="main">⟶</span> <span class="main">¬</span> exprChannel <span class="bound">x</span> <span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="comment1">― ‹This predicate  yields true if only the channels from the set chSet,›</span>
<span class="comment1">― ‹which is a subset of input channels of the  component sP,›</span>
<span class="comment1">― ‹may eventually output an expression E›</span>
<span class="keyword1"><span class="command">definition</span></span>
 <span class="entity">out_exprChannelSet</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID  <span class="main">⇒</span> chanID set <span class="main">⇒</span> Expression <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
 <span class="quoted"><span class="quoted">"<span class="free">out_exprChannelSet</span> <span class="free"><span class="bound"><span class="entity">sP</span></span></span> <span class="free"><span class="bound"><span class="entity">chSet</span></span></span> <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="main">≡</span> 
   <span class="main">(</span><span class="main">(</span><span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span>chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">chSet</span></span></span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>out <span class="free"><span class="bound"><span class="entity">sP</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>exprChannel <span class="bound">x</span> <span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
   <span class="main">∧</span>
   <span class="main">(</span><span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span> chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∉</span> <span class="free"><span class="bound"><span class="entity">chSet</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>out <span class="free"><span class="bound"><span class="entity">sP</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">¬</span> exprChannel <span class="bound">x</span> <span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="comment1">― ‹This redicate defines whether›</span>
<span class="comment1">― ‹an input channel ch of a component sP is the only one input channel›</span>
<span class="comment1">― ‹of this component via which it may eventually get an expression E›</span>
<span class="keyword1"><span class="command">definition</span></span>
 <span class="entity">ine_exprChannelSingle</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID  <span class="main">⇒</span> chanID <span class="main">⇒</span> Expression <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
 <span class="quoted"><span class="quoted">"<span class="free">ine_exprChannelSingle</span> <span class="free"><span class="bound"><span class="entity">sP</span></span></span> <span class="free"><span class="bound"><span class="entity">ch</span></span></span> <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="main">≡</span> 
  <span class="main">(</span><span class="free"><span class="bound"><span class="entity">ch</span></span></span> <span class="main">∈</span> <span class="main">(</span>ins <span class="free"><span class="bound"><span class="entity">sP</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span>
  <span class="main">(</span>exprChannel <span class="free"><span class="bound"><span class="entity">ch</span></span></span> <span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main">)</span>  <span class="main">∧</span>
  <span class="main">(</span><span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span> chanID<span class="main">)</span> <span class="main">(</span><span class="bound">t</span> <span class="main">::</span> nat<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>ins <span class="free"><span class="bound"><span class="entity">sP</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">x</span> <span class="main">≠</span> <span class="free"><span class="bound"><span class="entity">ch</span></span></span><span class="main">)</span> <span class="main">⟶</span> <span class="main">¬</span> exprChannel <span class="bound">x</span> <span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="comment1">― ‹This predicate yields true if the component sP may eventually›</span>
<span class="comment1">― ‹get an expression E only via the channels from the set chSet,›</span>
<span class="comment1">― ‹which is a subset of input channels of sP›</span>
<span class="keyword1"><span class="command">definition</span></span>
 <span class="entity">ine_exprChannelSet</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID  <span class="main">⇒</span> chanID set <span class="main">⇒</span> Expression <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
 <span class="quoted"><span class="quoted">"<span class="free">ine_exprChannelSet</span> <span class="free"><span class="bound"><span class="entity">sP</span></span></span> <span class="free"><span class="bound"><span class="entity">chSet</span></span></span> <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="main">≡</span> 
   <span class="main">(</span><span class="main">(</span><span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span>chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">chSet</span></span></span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>ins <span class="free"><span class="bound"><span class="entity">sP</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>exprChannel <span class="bound">x</span> <span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
   <span class="main">∧</span>
   <span class="main">(</span><span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span> chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∉</span> <span class="free"><span class="bound"><span class="entity">chSet</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>ins <span class="free"><span class="bound"><span class="entity">sP</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">¬</span> exprChannel <span class="bound">x</span> <span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="comment1">― ‹If a list of expression items does not contain any private key›</span>
<span class="comment1">― ‹or unguessable value of a component P, then the first element›</span> 
<span class="comment1">― ‹of the list is neither a private key nor unguessable value of P›</span>
<span class="keyword1" id="Secrecy-notSpecKeysSecretsExpr_L1"><span class="command">lemma</span></span> notSpecKeysSecretsExpr_L1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"notSpecKeysSecretsExpr <span class="free">P</span> <span class="main">(</span><span class="free">a</span> <span class="main">#</span> <span class="free">l</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"notSpecKeysSecretsExpr <span class="free">P</span> <span class="main">[</span><span class="free">a</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> notSpecKeysSecretsExpr_def<span class="main">)</span>

<span class="comment1">― ‹If a list of expression items does not contain any private key›</span>
<span class="comment1">― ‹or unguessable value of a component P, then this list without its first›</span> 
<span class="comment1">― ‹element does not contain them too›</span>
<span class="keyword1" id="Secrecy-notSpecKeysSecretsExpr_L2"><span class="command">lemma</span></span> notSpecKeysSecretsExpr_L2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"notSpecKeysSecretsExpr <span class="free">P</span> <span class="main">(</span><span class="free">a</span> <span class="main">#</span> <span class="free">l</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"notSpecKeysSecretsExpr <span class="free">P</span> <span class="free">l</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> notSpecKeysSecretsExpr_def<span class="main">)</span>

<span class="comment1">― ‹If a channel belongs to the set of input channels of a component P›</span>
<span class="comment1">― ‹and does not belong to the set of local channels of the compositon of P and Q›</span> 
<span class="comment1">― ‹then it belongs to the set of input channels of this composition›</span>
<span class="keyword1" id="Secrecy-correctCompositionIn_L1"><span class="command">lemma</span></span> correctCompositionIn_L1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∉</span> loc <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">P</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">PQ</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionIn_def<span class="main">)</span>

<span class="comment1">― ‹If a channel belongs to the set of input channels of the compositon of P and Q›</span>
<span class="comment1">― ‹then it belongs to the set of input channels either of P or of Q›</span>
<span class="keyword1" id="Secrecy-correctCompositionIn_L2"><span class="command">lemma</span></span> correctCompositionIn_L2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">PQ</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">ch</span> <span class="main">∈</span> ins <span class="free">P</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="free">ch</span> <span class="main">∈</span> ins <span class="free">Q</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionIn_def<span class="main">)</span>

<span class="keyword1" id="Secrecy-ineM_L1"><span class="command">lemma</span></span> ineM_L1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> <span class="free">M</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"exprChannel <span class="free">ch</span> <span class="free">E</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"ineM <span class="free">P</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ineM_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1" id="Secrecy-ineM_ine"><span class="command">lemma</span></span> ineM_ine<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ineM <span class="free">P</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"ine <span class="free">P</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ineM_def ine_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1" id="Secrecy-not_ine_ineM"><span class="command">lemma</span></span> not_ine_ineM<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="free">E</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> ineM <span class="free">P</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ineM_def ine_def<span class="main">)</span>

<span class="keyword1" id="Secrecy-eoutM_eout"><span class="command">lemma</span></span> eoutM_eout<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eoutM <span class="free">P</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"eout <span class="free">P</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eoutM_def eout_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1" id="Secrecy-not_eout_eoutM"><span class="command">lemma</span></span> not_eout_eoutM<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> eout <span class="free">P</span> <span class="free">E</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> eoutM <span class="free">P</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eoutM_def eout_def<span class="main">)</span>

<span class="keyword1" id="Secrecy-correctCompositionKeys_subcomp1"><span class="command">lemma</span></span> correctCompositionKeys_subcomp1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"correctCompositionKeys <span class="free">C</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> subcomponents <span class="free">C</span>"</span></span> 
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">xb</span> <span class="main">∈</span> specKeys <span class="free">C</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">x</span> <span class="main">∈</span> subcomponents <span class="free">C</span><span class="main">.</span> <span class="main">(</span><span class="free">xb</span> <span class="main">∈</span> specKeys <span class="bound">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKeys_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="Secrecy-correctCompositionSecrets_subcomp1"><span class="command">lemma</span></span> correctCompositionSecrets_subcomp1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"correctCompositionSecrets <span class="free">C</span>"</span></span> 
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> subcomponents <span class="free">C</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">∈</span> specSecrets <span class="free">C</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">x</span> <span class="main">∈</span> subcomponents <span class="free">C</span><span class="main">.</span> <span class="main">(</span><span class="free">s</span> <span class="main">∈</span> specSecrets <span class="bound">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionSecrets_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="Secrecy-correctCompositionKeys_subcomp2"><span class="command">lemma</span></span> correctCompositionKeys_subcomp2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"correctCompositionKeys <span class="free">C</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">xb</span> <span class="main">∈</span> subcomponents <span class="free">C</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">xc</span> <span class="main">∈</span> specKeys <span class="free">xb</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">xc</span> <span class="main">∈</span> specKeys <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKeys_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="Secrecy-correctCompositionSecrets_subcomp2"><span class="command">lemma</span></span> correctCompositionSecrets_subcomp2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"correctCompositionSecrets <span class="free">C</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">xb</span> <span class="main">∈</span> subcomponents <span class="free">C</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">xc</span> <span class="main">∈</span> specSecrets <span class="free">xb</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>     <span class="quoted"><span class="quoted">"<span class="free">xc</span> <span class="main">∈</span> specSecrets <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionSecrets_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="Secrecy-correctCompKS_Keys"><span class="command">lemma</span></span> correctCompKS_Keys<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">C</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"correctCompositionKeys <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">C</span> <span class="main">=</span> <span class="main">{}</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">C</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKeys_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">C</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKS_def 
                correctCompositionKeys_def
                specKeysSecrets_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Secrecy-correctCompKS_Secrets"><span class="command">lemma</span></span> correctCompKS_Secrets<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">C</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"correctCompositionSecrets <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">C</span> <span class="main">=</span> <span class="main">{}</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">C</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionSecrets_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">C</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKS_def 
                correctCompositionSecrets_def
                specKeysSecrets_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Secrecy-correctCompKS_KeysSecrets"><span class="command">lemma</span></span> correctCompKS_KeysSecrets<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"correctCompositionKeys <span class="free">C</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionSecrets <span class="free">C</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">C</span> <span class="main">=</span> <span class="main">{}</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">C</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKS_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">C</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKS_def 
                correctCompositionKeys_def 
                correctCompositionSecrets_def
                specKeysSecrets_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> 

<span class="keyword1" id="Secrecy-correctCompositionKS_subcomp1"><span class="command">lemma</span></span> correctCompositionKS_subcomp1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">C</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> h1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> subcomponents <span class="free">C</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">xa</span> <span class="main">∈</span> specKeys <span class="free">C</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">y</span> <span class="main">∈</span> subcomponents <span class="free">C</span><span class="main">.</span> <span class="main">(</span><span class="free">xa</span> <span class="main">∈</span> specKeys <span class="bound">y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">C</span> <span class="main">=</span> <span class="main">{}</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">C</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> h1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">C</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKS_def specKeysSecrets_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Secrecy-correctCompositionKS_subcomp2"><span class="command">lemma</span></span> correctCompositionKS_subcomp2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">C</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> h1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> subcomponents <span class="free">C</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">xa</span> <span class="main">∈</span> specSecrets <span class="free">C</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">y</span> <span class="main">∈</span> subcomponents <span class="free">C</span><span class="main">.</span> <span class="free">xa</span> <span class="main">∈</span> specSecrets <span class="bound">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">C</span> <span class="main">=</span> <span class="main">{}</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">C</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> h1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">C</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKS_def specKeysSecrets_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Secrecy-correctCompositionKS_subcomp3"><span class="command">lemma</span></span> correctCompositionKS_subcomp3<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">C</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> subcomponents <span class="free">C</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">xa</span> <span class="main">∈</span> specKeys <span class="free">x</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">xa</span> <span class="main">∈</span> specKeys <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKS_def specKeysSecrets_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="Secrecy-correctCompositionKS_subcomp4"><span class="command">lemma</span></span> correctCompositionKS_subcomp4<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">C</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> subcomponents <span class="free">C</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">xa</span> <span class="main">∈</span> specSecrets <span class="free">x</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>     <span class="quoted"><span class="quoted">"<span class="free">xa</span> <span class="main">∈</span> specSecrets <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKS_def specKeysSecrets_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="Secrecy-correctCompositionKS_PQ"><span class="command">lemma</span></span> correctCompositionKS_PQ<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span> <span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">∈</span> specKeysSecrets <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">∈</span> specKeysSecrets <span class="free">P</span> <span class="main">∨</span> <span class="free">ks</span> <span class="main">∈</span> specKeysSecrets <span class="free">Q</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKS_def<span class="main">)</span>

<span class="keyword1" id="Secrecy-correctCompositionKS_neg1"><span class="command">lemma</span></span> correctCompositionKS_neg1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span> <span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">∉</span> specKeysSecrets <span class="free">PQ</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKS_def<span class="main">)</span>

<span class="keyword1" id="Secrecy-correctCompositionKS_negP"><span class="command">lemma</span></span> correctCompositionKS_negP<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span> <span class="free">Q</span><span class="main">}</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span> 
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">∉</span> specKeysSecrets <span class="free">PQ</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>     <span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKS_def<span class="main">)</span>

<span class="keyword1" id="Secrecy-correctCompositionKS_negQ"><span class="command">lemma</span></span> correctCompositionKS_negQ<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span> <span class="free">Q</span><span class="main">}</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span> 
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">∉</span> specKeysSecrets <span class="free">PQ</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>     <span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKS_def<span class="main">)</span>

<span class="keyword1" id="Secrecy-out_exprChannelSingle_Set"><span class="command">lemma</span></span> out_exprChannelSingle_Set<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"out_exprChannelSingle <span class="free">P</span> <span class="free">ch</span> <span class="free">E</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"out_exprChannelSet <span class="free">P</span> <span class="main">{</span><span class="free">ch</span><span class="main">}</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> out_exprChannelSingle_def out_exprChannelSet_def<span class="main">)</span>

<span class="keyword1" id="Secrecy-out_exprChannelSet_Single"><span class="command">lemma</span></span> out_exprChannelSet_Single<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"out_exprChannelSet <span class="free">P</span> <span class="main">{</span><span class="free">ch</span><span class="main">}</span> <span class="free">E</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"out_exprChannelSingle <span class="free">P</span> <span class="free">ch</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> out_exprChannelSingle_def out_exprChannelSet_def<span class="main">)</span>

<span class="keyword1" id="Secrecy-ine_exprChannelSingle_Set"><span class="command">lemma</span></span> ine_exprChannelSingle_Set<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ine_exprChannelSingle <span class="free">P</span> <span class="free">ch</span> <span class="free">E</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ine_exprChannelSet <span class="free">P</span> <span class="main">{</span><span class="free">ch</span><span class="main">}</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ine_exprChannelSingle_def ine_exprChannelSet_def<span class="main">)</span>

<span class="keyword1" id="Secrecy-ine_exprChannelSet_Single"><span class="command">lemma</span></span> ine_exprChannelSet_Single<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ine_exprChannelSet <span class="free">P</span> <span class="main">{</span><span class="free">ch</span><span class="main">}</span> <span class="free">E</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"ine_exprChannelSingle <span class="free">P</span> <span class="free">ch</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ine_exprChannelSingle_def ine_exprChannelSet_def<span class="main">)</span>

<span class="keyword1" id="Secrecy-ine_ins_neg1"><span class="command">lemma</span></span> ine_ins_neg1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="free">m</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"exprChannel <span class="free">x</span> <span class="free">m</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∉</span> ins <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ine_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem1a<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ine <span class="free">PQ</span> <span class="free">E</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ine <span class="free">P</span> <span class="free">E</span>  <span class="main">∨</span> ine <span class="free">Q</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ine_def correctCompositionIn_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem1b<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ineM <span class="free">PQ</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"ineM <span class="free">P</span> <span class="free">M</span> <span class="free">E</span> <span class="main">∨</span> ineM <span class="free">Q</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ineM_def correctCompositionIn_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem2a<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eout <span class="free">PQ</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionOut <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"eout <span class="free">P</span> <span class="free">E</span> <span class="main">∨</span> eout <span class="free">Q</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eout_def correctCompositionOut_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem2b<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eoutM <span class="free">PQ</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionOut <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"eoutM <span class="free">P</span> <span class="free">M</span> <span class="free">E</span> <span class="main">∨</span> eoutM <span class="free">Q</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eoutM_def correctCompositionOut_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="Secrecy-correctCompositionIn_prop1"><span class="command">lemma</span></span> correctCompositionIn_prop1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="main">(</span>ins <span class="free">PQ</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">∈</span> <span class="main">(</span>ins <span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="free">x</span> <span class="main">∈</span> <span class="main">(</span>ins <span class="free">Q</span><span class="main">)</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionIn_def<span class="main">)</span>

<span class="keyword1" id="Secrecy-correctCompositionOut_prop1"><span class="command">lemma</span></span> correctCompositionOut_prop1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionOut <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="main">(</span>out <span class="free">PQ</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">∈</span> <span class="main">(</span>out <span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="free">x</span> <span class="main">∈</span> <span class="main">(</span>out <span class="free">Q</span><span class="main">)</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionOut_def<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem3a<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>ine <span class="free">P</span> <span class="free">E</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>ine <span class="free">Q</span> <span class="free">E</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>ine <span class="free">PQ</span> <span class="free">E</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ine_def correctCompositionIn_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> TBlemma3b<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> h1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>ineM <span class="free">P</span> <span class="free">M</span> <span class="free">E</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> h2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>ineM <span class="free">Q</span> <span class="free">M</span> <span class="free">E</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> subPQ<span class="main">:</span><span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> cCompI<span class="main">:</span><span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> chM<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> <span class="free">M</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> chPQ<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> eCh<span class="main">:</span><span class="quoted"><span class="quoted">"exprChannel <span class="free">ch</span> <span class="free">E</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">P</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> a1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> a1 <span class="keyword2"><span class="keyword">and</span></span> chM <span class="keyword2"><span class="keyword">and</span></span> eCh <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ineM <span class="free">P</span> <span class="free">M</span> <span class="free">E</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ineM_L1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> h1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> a2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∉</span> ins <span class="free">P</span>"</span></span> 
  <span class="keyword1"><span class="command">from</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompI <span class="keyword2"><span class="keyword">and</span></span> chPQ <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">ch</span> <span class="main">∈</span> ins <span class="free">P</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="free">ch</span> <span class="main">∈</span> ins <span class="free">Q</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionIn_L2<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">Q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> chM <span class="keyword2"><span class="keyword">and</span></span> eCh <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ineM <span class="free">Q</span> <span class="free">M</span> <span class="free">E</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ineM_L1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> h2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem3b<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>ineM <span class="free">P</span> <span class="free">M</span> <span class="free">E</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>ineM <span class="free">Q</span> <span class="free">M</span> <span class="free">E</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>ineM <span class="free">PQ</span> <span class="free">M</span> <span class="free">E</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> TBtheorem1b<span class="main">)</span>    

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem4a_empty<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ine <span class="free">P</span> <span class="free">E</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span>ine <span class="free">Q</span> <span class="free">E</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"loc <span class="free">PQ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"ine <span class="free">PQ</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ine_def correctCompositionIn_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem4a_P<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ine <span class="free">P</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">ch</span><span class="main">.</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>ins <span class="free">P</span><span class="main">)</span> <span class="main">∧</span> exprChannel <span class="bound">ch</span> <span class="free">E</span> <span class="main">∧</span> <span class="bound">ch</span> <span class="main">∉</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"ine <span class="free">PQ</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ine_def correctCompositionIn_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span> 

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem4b_P<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ineM <span class="free">P</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">ch</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>ins <span class="free">Q</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>exprChannel <span class="bound">ch</span> <span class="free">E</span><span class="main">)</span> <span class="main">∧</span> 
                        <span class="main">(</span><span class="bound">ch</span> <span class="main">∉</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="free">M</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"ineM <span class="free">PQ</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ineM_def correctCompositionIn_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span> 

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem4a_PQ<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ine <span class="free">P</span> <span class="free">E</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span>ine <span class="free">Q</span> <span class="free">E</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">ch</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>ins <span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>ins <span class="free">Q</span><span class="main">)</span> <span class="main">)</span><span class="main">)</span> <span class="main">∧</span> 
                         <span class="main">(</span>exprChannel <span class="bound">ch</span> <span class="free">E</span><span class="main">)</span> <span class="main">∧</span>  <span class="main">(</span><span class="bound">ch</span> <span class="main">∉</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"ine <span class="free">PQ</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ine_def correctCompositionIn_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span> 

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem4b_PQ<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ineM <span class="free">P</span> <span class="free">M</span> <span class="free">E</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span>ineM <span class="free">Q</span> <span class="free">M</span> <span class="free">E</span><span class="main">)</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">ch</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>ins <span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>ins <span class="free">Q</span><span class="main">)</span> <span class="main">)</span><span class="main">)</span> <span class="main">∧</span> 
                         <span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="free">M</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>exprChannel <span class="bound">ch</span> <span class="free">E</span><span class="main">)</span> <span class="main">∧</span>  <span class="main">(</span><span class="bound">ch</span> <span class="main">∉</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>     <span class="quoted"><span class="quoted">"ineM <span class="free">PQ</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ineM_def correctCompositionIn_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span> 

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem4a_notP1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ine <span class="free">P</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">Q</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">ch</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span>ine_exprChannelSingle <span class="free">P</span> <span class="bound">ch</span> <span class="free">E</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">PQ</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ine_def correctCompositionIn_def 
                     ine_exprChannelSingle_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span> 

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem4b_notP1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ineM <span class="free">P</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ineM <span class="free">Q</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>  
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">ch</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span>ine_exprChannelSingle <span class="free">P</span> <span class="bound">ch</span> <span class="free">E</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="free">M</span><span class="main">)</span> 
                     <span class="main">∧</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> ineM <span class="free">PQ</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ineM_def correctCompositionIn_def 
                     ine_exprChannelSingle_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span> 

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem4a_notP2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">Q</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ine_exprChannelSet <span class="free">P</span> <span class="free">ChSet</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span>chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">ChSet</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">PQ</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ine_def correctCompositionIn_def 
                     ine_exprChannelSet_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span> 

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem4b_notP2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ineM <span class="free">Q</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ine_exprChannelSet <span class="free">P</span> <span class="free">ChSet</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span>chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">ChSet</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> ineM <span class="free">PQ</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ineM_def correctCompositionIn_def 
                     ine_exprChannelSet_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span> 

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem4a_notPQ<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ine_exprChannelSet <span class="free">P</span> <span class="free">ChSetP</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ine_exprChannelSet <span class="free">Q</span> <span class="free">ChSetQ</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span>chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">ChSetP</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span>chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">ChSetQ</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">PQ</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ine_def correctCompositionIn_def 
                     ine_exprChannelSet_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="Secrecy-ineM_Un1"><span class="command">lemma</span></span> ineM_Un1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ineM <span class="free">P</span> <span class="free">A</span> <span class="free">E</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"ineM <span class="free">P</span> <span class="main">(</span><span class="free">A</span> <span class="keyword1">Un</span> <span class="free">B</span><span class="main">)</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ineM_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem4b_notPQ<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ine_exprChannelSet <span class="free">P</span> <span class="free">ChSetP</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ine_exprChannelSet <span class="free">Q</span> <span class="free">ChSetQ</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span>chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">ChSetP</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span>chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">ChSetQ</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">" <span class="main">¬</span> ineM <span class="free">PQ</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ineM_def correctCompositionIn_def 
                     ine_exprChannelSet_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span> 

<span class="keyword1" id="Secrecy-ine_nonempty_exprChannelSet"><span class="command">lemma</span></span> ine_nonempty_exprChannelSet<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ine_exprChannelSet <span class="free">P</span> <span class="free">ChSet</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ChSet</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"ine <span class="free">P</span> <span class="free">E</span> "</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ine_def ine_exprChannelSet_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="Secrecy-ine_empty_exprChannelSet"><span class="command">lemma</span></span> ine_empty_exprChannelSet<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ine_exprChannelSet <span class="free">P</span> <span class="free">ChSet</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ChSet</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ine_def ine_exprChannelSet_def<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem5a_empty<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>eout <span class="free">P</span> <span class="free">E</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span>eout <span class="free">Q</span> <span class="free">E</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionOut <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"loc <span class="free">PQ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"eout <span class="free">PQ</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eout_def correctCompositionOut_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem45a_P<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eout <span class="free">P</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionOut <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">ch</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>out <span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>exprChannel <span class="bound">ch</span> <span class="free">E</span><span class="main">)</span> <span class="main">∧</span> 
                        <span class="main">(</span><span class="bound">ch</span> <span class="main">∉</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"eout <span class="free">PQ</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eout_def correctCompositionOut_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> TBtheore54b_P<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eoutM <span class="free">P</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionOut <span class="free">PQ</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">ch</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>out <span class="free">Q</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>exprChannel <span class="bound">ch</span> <span class="free">E</span><span class="main">)</span> <span class="main">∧</span> 
                        <span class="main">(</span><span class="bound">ch</span> <span class="main">∉</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="free">M</span><span class="main">)</span> <span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"eoutM <span class="free">PQ</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eoutM_def correctCompositionOut_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem5a_PQ<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>eout <span class="free">P</span> <span class="free">E</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span>eout <span class="free">Q</span> <span class="free">E</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionOut <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">ch</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>out <span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>out <span class="free">Q</span><span class="main">)</span> <span class="main">)</span><span class="main">)</span> <span class="main">∧</span> 
                        <span class="main">(</span>exprChannel <span class="bound">ch</span> <span class="free">E</span><span class="main">)</span> <span class="main">∧</span>  <span class="main">(</span><span class="bound">ch</span> <span class="main">∉</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"eout <span class="free">PQ</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eout_def correctCompositionOut_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem5b_PQ<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>eoutM <span class="free">P</span> <span class="free">M</span> <span class="free">E</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span>eoutM <span class="free">Q</span> <span class="free">M</span> <span class="free">E</span><span class="main">)</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionOut <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">ch</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>out <span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>out <span class="free">Q</span><span class="main">)</span> <span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="free">M</span><span class="main">)</span> 
                      <span class="main">∧</span> <span class="main">(</span>exprChannel <span class="bound">ch</span> <span class="free">E</span><span class="main">)</span> <span class="main">∧</span>  <span class="main">(</span><span class="bound">ch</span> <span class="main">∉</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"eoutM <span class="free">PQ</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eoutM_def correctCompositionOut_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span> 

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem5a_notP1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eout <span class="free">P</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> eout <span class="free">Q</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionOut <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">ch</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span>out_exprChannelSingle <span class="free">P</span> <span class="bound">ch</span> <span class="free">E</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> eout <span class="free">PQ</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eout_def correctCompositionOut_def 
                      out_exprChannelSingle_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span> 

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem5b_notP1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eoutM <span class="free">P</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> eoutM <span class="free">Q</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionOut <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">ch</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span>out_exprChannelSingle <span class="free">P</span> <span class="bound">ch</span> <span class="free">E</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="free">M</span><span class="main">)</span> 
                   <span class="main">∧</span> <span class="main">(</span><span class="bound">ch</span> <span class="main">∈</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> eoutM <span class="free">PQ</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eoutM_def correctCompositionOut_def 
                     out_exprChannelSingle_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span> 

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem5a_notP2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> eout <span class="free">Q</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionOut <span class="free">PQ</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"out_exprChannelSet <span class="free">P</span> <span class="free">ChSet</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span>chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">ChSet</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> eout <span class="free">PQ</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eout_def correctCompositionOut_def 
                     out_exprChannelSet_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem5b_notP2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> eoutM <span class="free">Q</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionOut <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"out_exprChannelSet <span class="free">P</span> <span class="free">ChSet</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span>chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">ChSet</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> eoutM <span class="free">PQ</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eoutM_def correctCompositionOut_def 
                     out_exprChannelSet_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem5a_notPQ<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionOut <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"out_exprChannelSet <span class="free">P</span> <span class="free">ChSetP</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"out_exprChannelSet <span class="free">Q</span> <span class="free">ChSetQ</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span>chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">ChSetP</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span>chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">ChSetQ</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> eout <span class="free">PQ</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eout_def correctCompositionOut_def 
                     out_exprChannelSet_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span> 

<span class="keyword1"><span class="command">theorem</span></span> TBtheorem5b_notPQ<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionOut <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"out_exprChannelSet <span class="free">P</span> <span class="free">ChSetP</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"out_exprChannelSet <span class="free">Q</span> <span class="free">ChSetQ</span> <span class="free">E</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">=</span> <span class="free">ChSetP</span> <span class="main">∪</span> <span class="free">ChSetQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span>chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">ChSetP</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span>chanID<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">ChSetQ</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>loc <span class="free">PQ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> eoutM <span class="free">PQ</span> <span class="free">M</span> <span class="free">E</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eoutM_def correctCompositionOut_def 
                     out_exprChannelSet_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span> 

<span class="keyword2"><span class="keyword">end</span></span> 
</pre>
</div><div id="CompLocalSecrets">
<div class="head">
<h1>Theory CompLocalSecrets</h1>
</div>
<pre class="source"><span class="comment1">(*
   Title:  Theory  CompLocalSecrets.thy
   Author: Maria Spichkova &lt;maria.spichkova at rmit.edu.au&gt;, 2014
*)</span>
<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Local Secrets of a component›</span></span>

<span class="keyword1"><span class="command">theory</span></span> CompLocalSecrets
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Secrecy.html">Secrecy</a> 
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="comment1">― ‹Set of local secrets: the set of secrets which does not belong to›</span>
<span class="comment1">― ‹the set of private keys and unguessable values, but are transmitted›</span>
<span class="comment1">― ‹via local channels or belongs to the local secrets of its subcomponents›</span>
<span class="keyword1"><span class="command">axiomatization</span></span>
  <span class="free">LocalSecrets</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID  <span class="main">⇒</span> KS set"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
LocalSecretsDef<span class="main">:</span>
 <span class="quoted"><span class="quoted">"<span class="free">LocalSecrets</span> <span class="free">A</span> <span class="main">=</span>
  <span class="main">{</span><span class="main">(</span><span class="bound">m</span> <span class="main">::</span> KS<span class="main">)</span><span class="main">.</span> <span class="bound">m</span> <span class="main">∉</span> specKeysSecrets <span class="free">A</span>  <span class="main">∧</span> 
              <span class="main">(</span><span class="main">(</span><span class="main">∃</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> loc <span class="free">A</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">m</span> <span class="main">=</span> <span class="main">(</span>kKS <span class="bound">y</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>exprChannel <span class="bound">x</span> <span class="main">(</span>kE <span class="bound">y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> 
              <span class="main">|</span><span class="main">(</span><span class="main">∃</span> <span class="bound">x</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> loc <span class="free">A</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">m</span> <span class="main">=</span> <span class="main">(</span>sKS <span class="bound">z</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>exprChannel <span class="bound">x</span> <span class="main">(</span>sE <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">)</span><span class="main">)</span> <span class="main">)</span><span class="main">}</span> 
   <span class="main">∪</span>  <span class="main">(</span><span class="main">⋃</span> <span class="main">(</span><span class="free">LocalSecrets</span> <span class="main">`</span> <span class="main">(</span>subcomponents <span class="free">A</span><span class="main">)</span> <span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="CompLocalSecrets-LocalSecretsComposition1"><span class="command">lemma</span></span> LocalSecretsComposition1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">ls</span> <span class="main">∈</span> LocalSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span> <span class="free">Q</span><span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">ls</span> <span class="main">∈</span> LocalSecrets <span class="free">PQ</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">no_asm</span><span class="main"><span class="main">)</span></span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> LocalSecretsDef<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="CompLocalSecrets-LocalSecretsComposition_exprChannel_k"><span class="command">lemma</span></span>  LocalSecretsComposition_exprChannel_k<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"exprChannel <span class="free">x</span> <span class="main">(</span>kE <span class="free">Keys</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>kE <span class="free">Keys</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>kE <span class="free">Keys</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">x</span> <span class="main">∉</span> ins <span class="free">P</span> <span class="main">∧</span> <span class="free">x</span> <span class="main">∉</span> ins <span class="free">Q</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ine_def<span class="main">)</span>

<span class="keyword1" id="CompLocalSecrets-LocalSecretsComposition_exprChannel_s"><span class="command">lemma</span></span>  LocalSecretsComposition_exprChannel_s<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"exprChannel <span class="free">x</span> <span class="main">(</span>sE <span class="free">Secrets</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>sE <span class="free">Secrets</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>sE <span class="free">Secrets</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">x</span> <span class="main">∉</span> ins <span class="free">P</span> <span class="main">∧</span> <span class="free">x</span> <span class="main">∉</span> ins <span class="free">Q</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ine_ins_neg1<span class="main">)</span>

<span class="keyword1" id="CompLocalSecrets-LocalSecretsComposition_neg1_k"><span class="command">lemma</span></span> LocalSecretsComposition_neg1_k<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span> <span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>kE <span class="free">Keys</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>kE <span class="free">Keys</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">Keys</span> <span class="main">∉</span> LocalSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">Keys</span> <span class="main">∉</span> LocalSecrets <span class="free">Q</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"kKS <span class="free">Keys</span> <span class="main">∉</span> LocalSecrets <span class="free">PQ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">no_asm</span><span class="main"><span class="main">)</span></span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> LocalSecretsDef<span class="main"><span class="keyword3">,</span></span> 
           <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionLoc_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarify</span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> LocalSecretsComposition_exprChannel_k<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CompLocalSecrets-LocalSecretsComposition_neg_k"><span class="command">lemma</span></span> LocalSecretsComposition_neg_k<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>kE <span class="free">m</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>kE <span class="free">m</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span> <span class="main">∉</span> <span class="main">(</span><span class="main">(</span>LocalSecrets <span class="free">P</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span>LocalSecrets <span class="free">Q</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span> <span class="main">∉</span> <span class="main">(</span>LocalSecrets <span class="free">PQ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">no_asm</span><span class="main"><span class="main">)</span></span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> LocalSecretsDef<span class="main"><span class="keyword3">,</span></span> 
           <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionLoc_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarify</span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> LocalSecretsComposition_exprChannel_k<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>  

<span class="keyword1" id="CompLocalSecrets-LocalSecretsComposition_neg_s"><span class="command">lemma</span></span> LocalSecretsComposition_neg_s<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> subPQ<span class="main">:</span><span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> cCompLoc<span class="main">:</span><span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> cCompKS<span class="main">:</span><span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> notKSP<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> notKSQ<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>sE <span class="free">m</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>sE <span class="free">m</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> notLocSeqPQ<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span> <span class="main">∉</span> <span class="main">(</span><span class="main">(</span>LocalSecrets <span class="free">P</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span>LocalSecrets <span class="free">Q</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span> <span class="main">∉</span> <span class="main">(</span>LocalSecrets <span class="free">PQ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompKS <span class="keyword2"><span class="keyword">and</span></span> notKSP <span class="keyword2"><span class="keyword">and</span></span> notKSQ
  <span class="keyword1"><span class="command">have</span></span> sg1<span class="main">:</span><span class="quoted"><span class="quoted">"sKS <span class="free">m</span> <span class="main">∉</span> specKeysSecrets <span class="free">PQ</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKS_neg1<span class="main">)</span> 
  <span class="keyword1"><span class="command">from</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompLoc <span class="keyword2"><span class="keyword">and</span></span> notLocSeqPQ <span class="keyword1"><span class="command">have</span></span> sg2<span class="main">:</span>
   <span class="quoted"><span class="quoted">"sKS <span class="free">m</span> <span class="main">∉</span>  <span class="main">⋃</span> <span class="main">(</span>LocalSecrets <span class="main">`</span> subcomponents <span class="free">PQ</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> sg1 <span class="keyword2"><span class="keyword">and</span></span> sg2 <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">no_asm</span><span class="main"><span class="main">)</span></span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> LocalSecretsDef<span class="main"><span class="keyword3">,</span></span> 
           <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionLoc_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarify</span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> LocalSecretsComposition_exprChannel_s<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>  

<span class="keyword1" id="CompLocalSecrets-LocalSecretsComposition_neg"><span class="command">lemma</span></span> LocalSecretsComposition_neg<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">PQ</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> h1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">m</span><span class="main">.</span> <span class="free">ks</span> <span class="main">=</span> kKS <span class="bound">m</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>kE <span class="bound">m</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>kE <span class="bound">m</span><span class="main">)</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> h2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">m</span><span class="main">.</span> <span class="free">ks</span> <span class="main">=</span> sKS <span class="bound">m</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>sE <span class="bound">m</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>sE <span class="bound">m</span><span class="main">)</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">∉</span> <span class="main">(</span><span class="main">(</span>LocalSecrets <span class="free">P</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span>LocalSecrets <span class="free">Q</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">∉</span> <span class="main">(</span>LocalSecrets <span class="free">PQ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">ks</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span>
  <span class="keyword3"><span class="command">assume</span></span> a1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">=</span> kKS <span class="skolem">m</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> h1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>kE <span class="skolem">m</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>kE <span class="skolem">m</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LocalSecretsComposition_neg_k<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span>
  <span class="keyword3"><span class="command">assume</span></span> a2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">=</span> sKS <span class="skolem">m</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> h2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>sE <span class="skolem">m</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>sE <span class="skolem">m</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LocalSecretsComposition_neg_s<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CompLocalSecrets-LocalSecretsComposition_neg1_s"><span class="command">lemma</span></span> LocalSecretsComposition_neg1_s<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span> <span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>sE <span class="free">s</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>sE <span class="free">s</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">s</span> <span class="main">∉</span> LocalSecrets <span class="free">P</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">s</span> <span class="main">∉</span> LocalSecrets <span class="free">Q</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"sKS <span class="free">s</span> <span class="main">∉</span> LocalSecrets <span class="free">PQ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> 
   <span class="quoted"><span class="quoted">"sKS <span class="free">s</span> <span class="main">∉</span>  <span class="main">⋃</span> <span class="main">(</span>LocalSecrets <span class="main">`</span> subcomponents <span class="free">PQ</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span>  assms <span class="keyword2"><span class="keyword">and</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">no_asm</span><span class="main"><span class="main">)</span></span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> LocalSecretsDef<span class="main"><span class="keyword3">,</span></span> 
              <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionLoc_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarify</span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> LocalSecretsComposition_exprChannel_s<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>  

<span class="keyword1" id="CompLocalSecrets-LocalSecretsComposition_neg1"><span class="command">lemma</span></span> LocalSecretsComposition_neg1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span> <span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> h1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">m</span><span class="main">.</span> <span class="free">ks</span> <span class="main">=</span> kKS <span class="bound">m</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>kE <span class="bound">m</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>kE <span class="bound">m</span><span class="main">)</span><span class="main">)</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> h2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">m</span><span class="main">.</span> <span class="free">ks</span> <span class="main">=</span> sKS <span class="bound">m</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>sE <span class="bound">m</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>sE <span class="bound">m</span><span class="main">)</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">∉</span> LocalSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">∉</span> LocalSecrets <span class="free">Q</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">∉</span> LocalSecrets <span class="free">PQ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">ks</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span>
  <span class="keyword3"><span class="command">assume</span></span> a1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">=</span> kKS <span class="skolem">m</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> h1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>kE <span class="skolem">m</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>kE <span class="skolem">m</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LocalSecretsComposition_neg1_k<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span>
  <span class="keyword3"><span class="command">assume</span></span> a2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">ks</span> <span class="main">=</span> sKS <span class="skolem">m</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> h2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>sE <span class="skolem">m</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>sE <span class="skolem">m</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LocalSecretsComposition_neg1_s<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CompLocalSecrets-LocalSecretsComposition_ine1_k"><span class="command">lemma</span></span> LocalSecretsComposition_ine1_k<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">k</span> <span class="main">∈</span> LocalSecrets <span class="free">PQ</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span> <span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">PQ</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>kE <span class="free">k</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">k</span> <span class="main">∉</span> LocalSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">k</span> <span class="main">∉</span> LocalSecrets <span class="free">Q</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"ine <span class="free">P</span> <span class="main">(</span>kE <span class="free">k</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> LocalSecretsComposition_neg1_k<span class="main">)</span>

<span class="keyword1" id="CompLocalSecrets-LocalSecretsComposition_ine1_s"><span class="command">lemma</span></span> LocalSecretsComposition_ine1_s<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">s</span> <span class="main">∈</span> LocalSecrets <span class="free">PQ</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span> <span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">PQ</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>sE <span class="free">s</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">s</span> <span class="main">∉</span> LocalSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">s</span> <span class="main">∉</span> LocalSecrets <span class="free">Q</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"ine <span class="free">P</span> <span class="main">(</span>sE <span class="free">s</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> LocalSecretsComposition_neg1_s<span class="main">)</span>

<span class="keyword1" id="CompLocalSecrets-LocalSecretsComposition_ine2_k"><span class="command">lemma</span></span> LocalSecretsComposition_ine2_k<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">k</span> <span class="main">∈</span> LocalSecrets <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span> <span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>kE <span class="free">k</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">k</span> <span class="main">∉</span> LocalSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">k</span> <span class="main">∉</span> LocalSecrets <span class="free">Q</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"ine <span class="free">Q</span> <span class="main">(</span>kE <span class="free">k</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> assms  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> LocalSecretsComposition_ine1_k<span class="main">)</span>

<span class="keyword1" id="CompLocalSecrets-LocalSecretsComposition_ine2_s"><span class="command">lemma</span></span> LocalSecretsComposition_ine2_s<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">s</span> <span class="main">∈</span> LocalSecrets <span class="free">PQ</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span> <span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>sE <span class="free">s</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">s</span> <span class="main">∉</span> LocalSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">s</span> <span class="main">∉</span> LocalSecrets <span class="free">Q</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"ine <span class="free">Q</span> <span class="main">(</span>sE <span class="free">s</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> LocalSecretsComposition_ine1_s<span class="main">)</span>

<span class="keyword1" id="CompLocalSecrets-LocalSecretsComposition_neg_loc_k"><span class="command">lemma</span></span> LocalSecretsComposition_neg_loc_k<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">key</span> <span class="main">∉</span> LocalSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"exprChannel <span class="free">ch</span> <span class="main">(</span>kE <span class="free">key</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">key</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∉</span> loc <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> LocalSecretsDef<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="CompLocalSecrets-LocalSecretsComposition_neg_loc_s"><span class="command">lemma</span></span> LocalSecretsComposition_neg_loc_s<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">secret</span> <span class="main">∉</span> LocalSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"exprChannel <span class="free">ch</span> <span class="main">(</span>sE <span class="free">secret</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">secret</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∉</span> loc <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> LocalSecretsDef<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="CompLocalSecrets-correctCompositionKS_exprChannel_k_P"><span class="command">lemma</span></span> correctCompositionKS_exprChannel_k_P<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">key</span> <span class="main">∉</span> LocalSecrets <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"exprChannel <span class="free">ch</span> <span class="main">(</span>kE <span class="free">key</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">key</span> <span class="main">∉</span> specKeysSecrets <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">PQ</span> <span class="main">∧</span> exprChannel <span class="free">ch</span> <span class="main">(</span>kE <span class="free">key</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> LocalSecretsComposition_neg_loc_k correctCompositionIn_L1<span class="main">)</span>

<span class="keyword1" id="CompLocalSecrets-correctCompositionKS_exprChannel_k_Pex"><span class="command">lemma</span></span> correctCompositionKS_exprChannel_k_Pex<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">key</span> <span class="main">∉</span> LocalSecrets <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"exprChannel <span class="free">ch</span> <span class="main">(</span>kE <span class="free">key</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">key</span> <span class="main">∉</span> specKeysSecrets <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">ch</span><span class="main">.</span> <span class="bound">ch</span> <span class="main">∈</span> ins <span class="free">PQ</span> <span class="main">∧</span> exprChannel <span class="bound">ch</span> <span class="main">(</span>kE <span class="free">key</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> correctCompositionKS_exprChannel_k_P<span class="main">)</span>

<span class="keyword1" id="CompLocalSecrets-correctCompositionKS_exprChannel_k_Q"><span class="command">lemma</span></span> correctCompositionKS_exprChannel_k_Q<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">key</span> <span class="main">∉</span> LocalSecrets <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">Q</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> h1<span class="main">:</span><span class="quoted"><span class="quoted">"exprChannel <span class="free">ch</span> <span class="main">(</span>kE <span class="free">key</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">key</span> <span class="main">∉</span> specKeysSecrets <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">PQ</span> <span class="main">∧</span> exprChannel <span class="free">ch</span> <span class="main">(</span>kE <span class="free">key</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∉</span> loc <span class="free">PQ</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LocalSecretsComposition_neg_loc_k<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">PQ</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionIn_def<span class="main">)</span> 
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> h1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CompLocalSecrets-correctCompositionKS_exprChannel_k_Qex"><span class="command">lemma</span></span> correctCompositionKS_exprChannel_k_Qex<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span> 
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">key</span> <span class="main">∉</span> LocalSecrets <span class="free">PQ</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">Q</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"exprChannel <span class="free">ch</span> <span class="main">(</span>kE <span class="free">key</span><span class="main">)</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">key</span> <span class="main">∉</span> specKeysSecrets <span class="free">PQ</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">ch</span><span class="main">.</span> <span class="bound">ch</span> <span class="main">∈</span> ins <span class="free">PQ</span> <span class="main">∧</span> exprChannel <span class="bound">ch</span> <span class="main">(</span>kE <span class="free">key</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> correctCompositionKS_exprChannel_k_Q<span class="main">)</span>

<span class="keyword1" id="CompLocalSecrets-correctCompositionKS_exprChannel_s_P"><span class="command">lemma</span></span> correctCompositionKS_exprChannel_s_P<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">secret</span> <span class="main">∉</span> LocalSecrets <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"exprChannel <span class="free">ch</span> <span class="main">(</span>sE <span class="free">secret</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">secret</span> <span class="main">∉</span> specKeysSecrets <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">PQ</span> <span class="main">∧</span> exprChannel <span class="free">ch</span> <span class="main">(</span>sE <span class="free">secret</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> LocalSecretsComposition_neg_loc_s correctCompositionIn_L1<span class="main">)</span>

<span class="keyword1" id="CompLocalSecrets-correctCompositionKS_exprChannel_s_Pex"><span class="command">lemma</span></span> correctCompositionKS_exprChannel_s_Pex<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">secret</span> <span class="main">∉</span> LocalSecrets <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"exprChannel <span class="free">ch</span> <span class="main">(</span>sE <span class="free">secret</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">secret</span> <span class="main">∉</span> specKeysSecrets <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">ch</span><span class="main">.</span> <span class="bound">ch</span> <span class="main">∈</span> ins <span class="free">PQ</span> <span class="main">∧</span> exprChannel <span class="bound">ch</span> <span class="main">(</span>sE <span class="free">secret</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms  
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> correctCompositionKS_exprChannel_s_P<span class="main">)</span>

<span class="keyword1" id="CompLocalSecrets-correctCompositionKS_exprChannel_s_Q"><span class="command">lemma</span></span> correctCompositionKS_exprChannel_s_Q<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">secret</span> <span class="main">∉</span> LocalSecrets <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">Q</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> h1<span class="main">:</span><span class="quoted"><span class="quoted">"exprChannel <span class="free">ch</span> <span class="main">(</span>sE <span class="free">secret</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">secret</span> <span class="main">∉</span> specKeysSecrets <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">PQ</span> <span class="main">∧</span> exprChannel <span class="free">ch</span> <span class="main">(</span>sE <span class="free">secret</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∉</span> loc <span class="free">PQ</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LocalSecretsComposition_neg_loc_s<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">PQ</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionIn_def<span class="main">)</span> 
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> h1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CompLocalSecrets-correctCompositionKS_exprChannel_s_Qex"><span class="command">lemma</span></span> correctCompositionKS_exprChannel_s_Qex<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">secret</span> <span class="main">∉</span> LocalSecrets <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">∈</span> ins <span class="free">Q</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"exprChannel <span class="free">ch</span> <span class="main">(</span>sE <span class="free">secret</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">secret</span> <span class="main">∉</span> specKeysSecrets <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">ch</span><span class="main">.</span> <span class="bound">ch</span> <span class="main">∈</span> ins <span class="free">PQ</span> <span class="main">∧</span> exprChannel <span class="bound">ch</span> <span class="main">(</span>sE <span class="free">secret</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> correctCompositionKS_exprChannel_s_Q<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="KnowledgeKeysSecrets">
<div class="head">
<h1>Theory KnowledgeKeysSecrets</h1>
</div>
<pre class="source"><span class="comment1">(*
   Title:  Theory AdvKnowledge.thy
   Author: Maria Spichkova &lt;maria.spichkova at rmit.edu.au&gt;, 2014
*)</span>
<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Knowledge of Keys and Secrets›</span></span>

<span class="keyword1"><span class="command">theory</span></span> KnowledgeKeysSecrets
<span class="keyword2"><span class="keyword">imports</span></span> <a href="CompLocalSecrets.html">CompLocalSecrets</a> 
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text_raw</span></span> <span class="quoted"><span class="plain_text">‹
~\\
An component $A$ knows a secret $m$ (or some secret expression $m$)  that does not belong to its local sectrets , if
\begin{itemize}
  \item %
  $A$  may eventually get the secret $m$,
  \item 
  $m$ belongs to the set $LS_A$ of its local secrets, 
  \item %
  $A$ knows some list of expressions $m_2$ which is an concatenations of $m$ and some list of expressions $m_1$,
  \item %
  $m$ is a concatenation of some lists of secrets $m_1$ and $m_2$, and $A$ knows both these secrets,
  \item %
  $A$ knows some secret key $k^{-1}$ and the result of the encryption of the $m$ with the corresponding public key,
  \item %
  $A$ knows some public key $k$ and the result of the signature creation of the $m$ with the corresponding private key,%
  \item %
  $m$ is an encryption of some secret $m_1$ with a public key $k$, and $A$ knows both $m_1$ and $k$,
  \item %
  $m$ is the result of the signature creation of the $m_1$ with the key $k$, and $A$ knows both $m_1$ and $k$.
  %($m = Sign(k, m_1)  \wedge \knows{A}{m_1} \wedge \knows{A}{k}$).
\end{itemize}
›</span></span>

<span class="keyword1"><span class="command">primrec</span></span>
  <span class="entity">know</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> KS <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> 
 <span class="quoted"><span class="quoted">"<span class="free">know</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">(</span>kKS <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span> <span class="main">=</span> 
  <span class="main">(</span><span class="main">(</span>ine <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">(</span>kE <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span>kKS <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="main">(</span>LocalSecrets <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">|</span> 
 <span class="quoted"><span class="quoted">"<span class="free">know</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">(</span>sKS <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span> <span class="main">=</span> 
  <span class="main">(</span><span class="main">(</span>ine <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">(</span>sE <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">(</span>sKS <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="main">(</span>LocalSecrets <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">axiomatization</span></span>
  <span class="free">knows</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> Expression list <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
knows_emptyexpression<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">knows</span> <span class="free">C</span> <span class="main">[]</span> <span class="main">=</span> True"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
know1k<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="free">knows</span> <span class="free">C</span> <span class="main">[</span>KS2Expression <span class="main">(</span>kKS <span class="free">m1</span><span class="main">)</span><span class="main">]</span> <span class="main">=</span> know <span class="free">C</span> <span class="main">(</span>kKS <span class="free">m1</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
know1s<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">knows</span> <span class="free">C</span> <span class="main">[</span>KS2Expression <span class="main">(</span>sKS <span class="free">m2</span><span class="main">)</span><span class="main">]</span> <span class="main">=</span> know <span class="free">C</span> <span class="main">(</span>sKS <span class="free">m2</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
knows2a<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="free">knows</span> <span class="free">A</span> <span class="main">(</span><span class="free">e1</span> <span class="main">@</span> <span class="free">e</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">knows</span> <span class="free">A</span> <span class="free">e</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
knows2b<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="free">knows</span> <span class="free">A</span> <span class="main">(</span><span class="free">e</span> <span class="main">@</span> <span class="free">e1</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">knows</span> <span class="free">A</span> <span class="free">e</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
knows3<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">knows</span> <span class="free">A</span> <span class="free">e1</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="free">knows</span> <span class="free">A</span> <span class="free">e2</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">knows</span> <span class="free">A</span> <span class="main">(</span><span class="free">e1</span> <span class="main">@</span> <span class="free">e2</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
knows4<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">IncrDecrKeys</span> <span class="free">k1</span> <span class="free">k2</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>know <span class="free">A</span> <span class="main">(</span>kKS <span class="free">k2</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="free">knows</span> <span class="free">A</span> <span class="main">(</span>Enc <span class="free">k1</span> <span class="free">e</span><span class="main">)</span><span class="main">)</span>
   <span class="main">⟶</span> <span class="free">knows</span> <span class="free">A</span> <span class="free">e</span>"</span></span> 
<span class="keyword2"><span class="keyword">and</span></span>
knows5<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">IncrDecrKeys</span> <span class="free">k1</span> <span class="free">k2</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>know <span class="free">A</span> <span class="main">(</span>kKS <span class="free">k1</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="free">knows</span> <span class="free">A</span> <span class="main">(</span>Sign <span class="free">k2</span> <span class="free">e</span><span class="main">)</span><span class="main">)</span>
   <span class="main">⟶</span> <span class="free">knows</span> <span class="free">A</span> <span class="free">e</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
knows6<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span>know <span class="free">A</span> <span class="main">(</span>kKS <span class="free">k</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="free">knows</span> <span class="free">A</span> <span class="free">e1</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">knows</span> <span class="free">A</span> <span class="main">(</span>Enc <span class="free">k</span> <span class="free">e1</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">and</span></span>
knows7<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span>know <span class="free">A</span> <span class="main">(</span>kKS <span class="free">k</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="free">knows</span> <span class="free">A</span> <span class="free">e1</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">knows</span> <span class="free">A</span> <span class="main">(</span>Sign <span class="free">k</span> <span class="free">e1</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">primrec</span></span>  <span class="entity">eoutKnowCorrect</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> KS <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
eout_know_k<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="free">eoutKnowCorrect</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">(</span>kKS <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span> <span class="main">=</span> 
  <span class="main">(</span><span class="main">(</span>eout  <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">(</span>kE <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">m</span></span></span> <span class="main">∈</span> <span class="main">(</span>specKeys <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span>know <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">(</span>kKS <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">)</span>"</span></span>  <span class="main">|</span>
eout_know_s<span class="main">:</span> 
   <span class="quoted"><span class="quoted">"<span class="free">eoutKnowCorrect</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">(</span>sKS <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span> <span class="main">=</span> 
  <span class="main">(</span><span class="main">(</span>eout  <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">(</span>sE <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">⟷</span>  <span class="main">(</span><span class="free"><span class="bound"><span class="entity">m</span></span></span> <span class="main">∈</span> <span class="main">(</span>specSecrets <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span>know <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">(</span>sKS <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">eoutKnowsECorrect</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"specID <span class="main">⇒</span> Expression <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">eoutKnowsECorrect</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">≡</span>
   <span class="main">(</span><span class="main">(</span>eout  <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span> <span class="main">⟷</span>
   <span class="main">(</span><span class="main">(</span><span class="main">∃</span> <span class="bound">k</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">=</span> <span class="main">(</span>kE <span class="bound">k</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">k</span> <span class="main">∈</span> specKeys <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> 
    <span class="main">(</span><span class="main">∃</span> <span class="bound">s</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">=</span> <span class="main">(</span>sE <span class="bound">s</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">s</span> <span class="main">∈</span> specSecrets <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span>
    <span class="main">(</span>knows <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">[</span><span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">]</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="KnowledgeKeysSecrets-eoutKnowCorrect_L1k"><span class="command">lemma</span></span> eoutKnowCorrect_L1k<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eoutKnowCorrect <span class="free">C</span> <span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span>"</span></span>  
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eout  <span class="free">C</span> <span class="main">(</span>kE <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="main">(</span>specKeys <span class="free">C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span>know <span class="free">C</span> <span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eout_know_k<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-eoutKnowCorrect_L1s"><span class="command">lemma</span></span> eoutKnowCorrect_L1s<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eoutKnowCorrect <span class="free">C</span> <span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eout  <span class="free">C</span> <span class="main">(</span>sE <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="main">(</span>specSecrets <span class="free">C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span>know <span class="free">C</span> <span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eout_know_s<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-eoutKnowsECorrect_L1"><span class="command">lemma</span></span> eoutKnowsECorrect_L1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eoutKnowsECorrect <span class="free">C</span> <span class="free">e</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eout  <span class="free">C</span> <span class="free">e</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span> <span class="bound">k</span><span class="main">.</span> <span class="free">e</span> <span class="main">=</span> <span class="main">(</span>kE <span class="bound">k</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">k</span> <span class="main">∈</span> specKeys <span class="free">C</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> 
            <span class="main">(</span><span class="main">∃</span> <span class="bound">s</span><span class="main">.</span> <span class="free">e</span> <span class="main">=</span> <span class="main">(</span>sE <span class="bound">s</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">s</span> <span class="main">∈</span> specSecrets <span class="free">C</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span>
            <span class="main">(</span>knows <span class="free">C</span> <span class="main">[</span><span class="free">e</span><span class="main">]</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eoutKnowsECorrect_def<span class="main">)</span>
 
<span class="keyword1" id="KnowledgeKeysSecrets-know2knows_k"><span class="command">lemma</span></span> know2knows_k<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"know <span class="free">A</span> <span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"knows <span class="free">A</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> KS2Expression.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> know1k<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows2know_k"><span class="command">lemma</span></span> knows2know_k<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">A</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"know <span class="free">A</span> <span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> KS2Expression.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> know1k<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-know2knowsPQ_k"><span class="command">lemma</span></span> know2knowsPQ_k<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"know <span class="free">P</span> <span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span> <span class="main">∨</span> know <span class="free">Q</span> <span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span> <span class="main">∨</span> knows <span class="free">Q</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> know2knows_k<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows2knowPQ_k"><span class="command">lemma</span></span> knows2knowPQ_k<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span> <span class="main">∨</span> knows <span class="free">Q</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>     <span class="quoted"><span class="quoted">"know <span class="free">P</span> <span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span> <span class="main">∨</span> know <span class="free">Q</span> <span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> knows2know_k<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows1k"><span class="command">lemma</span></span> knows1k<span class="main">:</span> 
 <span class="quoted"><span class="quoted">"know <span class="free">A</span> <span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span> <span class="main">=</span> knows <span class="free">A</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> know2knows_k knows2know_k<span class="main">)</span> 

<span class="keyword1" id="KnowledgeKeysSecrets-know2knows_neg_k"><span class="command">lemma</span></span> know2knows_neg_k<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span>  <span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">A</span> <span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>     <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">A</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> knows1k<span class="main">)</span> 

<span class="keyword1" id="KnowledgeKeysSecrets-knows2know_neg_k"><span class="command">lemma</span></span> knows2know_neg_k<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">A</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">A</span> <span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> know2knowsPQ_k<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-know2knows_s"><span class="command">lemma</span></span> know2knows_s<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"know <span class="free">A</span> <span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"knows <span class="free">A</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> KS2Expression.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> know1s<span class="main">)</span> 

<span class="keyword1" id="KnowledgeKeysSecrets-knows2know_s"><span class="command">lemma</span></span> knows2know_s<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">A</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"know <span class="free">A</span> <span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> KS2Expression.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> know1s<span class="main">)</span> 

<span class="keyword1" id="KnowledgeKeysSecrets-know2knowsPQ_s"><span class="command">lemma</span></span> know2knowsPQ_s<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"know <span class="free">P</span> <span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span> <span class="main">∨</span> know <span class="free">Q</span> <span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span> <span class="main">∨</span> knows <span class="free">Q</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> know2knows_s<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows2knowPQ_s"><span class="command">lemma</span></span> knows2knowPQ_s<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span> <span class="main">∨</span> knows <span class="free">Q</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"know <span class="free">P</span> <span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span> <span class="main">∨</span> know <span class="free">Q</span> <span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> knows2know_s<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows1s"><span class="command">lemma</span></span> knows1s<span class="main">:</span>
  <span class="quoted"><span class="quoted">"know <span class="free">A</span> <span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span> <span class="main">=</span> knows <span class="free">A</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> know2knows_s knows2know_s<span class="main">)</span> 

<span class="keyword1" id="KnowledgeKeysSecrets-know2knows_neg_s"><span class="command">lemma</span></span> know2knows_neg_s<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">A</span> <span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">A</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> knows2know_s<span class="main">)</span> 

<span class="keyword1" id="KnowledgeKeysSecrets-knows2know_neg_s"><span class="command">lemma</span></span> knows2know_neg_s<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">A</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">A</span> <span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span>  know2knows_s<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows2"><span class="command">lemma</span></span> knows2<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">e2</span> <span class="main">=</span> <span class="free">e1</span> <span class="main">@</span> <span class="free">e</span> <span class="main">∨</span> <span class="free">e2</span> <span class="main">=</span> <span class="free">e</span> <span class="main">@</span> <span class="free">e1</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">A</span> <span class="free">e2</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"knows <span class="free">A</span> <span class="free">e</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> knows2a knows2b<span class="main">)</span>
 
<span class="keyword1" id="KnowledgeKeysSecrets-correctCompositionInLoc_exprChannel"><span class="command">lemma</span></span> correctCompositionInLoc_exprChannel<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span> <span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">:</span> ins <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"exprChannel <span class="free">ch</span> <span class="free">m</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> ins <span class="free">PQ</span> <span class="main">⟶</span> <span class="main">¬</span> exprChannel <span class="bound">x</span> <span class="free">m</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">ch</span> <span class="main">:</span> loc <span class="free">PQ</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionIn_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-eout_know_nonKS_k"><span class="command">lemma</span></span> eout_know_nonKS_k<span class="main">:</span> 
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∉</span> specKeys <span class="free">A</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eout <span class="free">A</span> <span class="main">(</span>kE <span class="free">m</span><span class="main">)</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eoutKnowCorrect <span class="free">A</span> <span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>     <span class="quoted"><span class="quoted">"know <span class="free">A</span> <span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eoutKnowCorrect_L1k<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-eout_know_nonKS_s"><span class="command">lemma</span></span>  eout_know_nonKS_s<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∉</span> specSecrets <span class="free">A</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eout <span class="free">A</span> <span class="main">(</span>sE <span class="free">m</span><span class="main">)</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eoutKnowCorrect <span class="free">A</span> <span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"know <span class="free">A</span> <span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eoutKnowCorrect_L1s<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-not_know_k_not_ine"><span class="command">lemma</span></span> not_know_k_not_ine<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">A</span> <span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">A</span> <span class="main">(</span>kE <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="KnowledgeKeysSecrets-not_know_s_not_ine"><span class="command">lemma</span></span> not_know_s_not_ine<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">A</span> <span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">A</span> <span class="main">(</span>sE <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="KnowledgeKeysSecrets-not_know_k_not_eout"><span class="command">lemma</span></span> not_know_k_not_eout<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∉</span> specKeys <span class="free">A</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">A</span> <span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span>"</span></span> 
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eoutKnowCorrect <span class="free">A</span> <span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>     <span class="quoted"><span class="quoted">"<span class="main">¬</span> eout <span class="free">A</span> <span class="main">(</span>kE <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eout_know_k<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-not_know_s_not_eout"><span class="command">lemma</span></span> not_know_s_not_eout<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∉</span> specSecrets <span class="free">A</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">A</span> <span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eoutKnowCorrect <span class="free">A</span> <span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>     <span class="quoted"><span class="quoted">"<span class="main">¬</span> eout <span class="free">A</span> <span class="main">(</span>sE <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eout_know_nonKS_s<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-adv_not_know1"><span class="command">lemma</span></span> adv_not_know1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"out <span class="free">P</span> <span class="main">⊆</span> ins <span class="free">A</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">A</span> <span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> eout <span class="free">P</span> <span class="main">(</span>kE <span class="free">m</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> eout_def ine_ins_neg1 not_know_k_not_ine rev_subsetD<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-adv_not_know2"><span class="command">lemma</span></span>  adv_not_know2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"out <span class="free">P</span> <span class="main">⊆</span> ins <span class="free">A</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">A</span> <span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> eout <span class="free">P</span> <span class="main">(</span>sE <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> eout_def ine_ins_neg1 not_know_s_not_ine rev_subsetD<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-LocalSecrets_L1"><span class="command">lemma</span></span> LocalSecrets_L1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>kKS<span class="main">)</span> <span class="free">key</span> <span class="main">∈</span> LocalSecrets <span class="free">P</span>"</span></span>  
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>kKS <span class="free">key</span><span class="main">)</span> <span class="main">∉</span> <span class="main">⋃</span><span class="main">(</span>LocalSecrets <span class="main">`</span> subcomponents <span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"kKS <span class="free">key</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> LocalSecretsDef<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-LocalSecrets_L2"><span class="command">lemma</span></span> LocalSecrets_L2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">key</span> <span class="main">∈</span> LocalSecrets <span class="free">P</span>"</span></span>  
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">key</span> <span class="main">∈</span> specKeysSecrets <span class="free">P</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"kKS <span class="free">key</span> <span class="main">∈</span> <span class="main">⋃</span><span class="main">(</span>LocalSecrets <span class="main">`</span> subcomponents <span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> LocalSecretsDef<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-know_composition1"><span class="command">lemma</span></span> know_composition1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> notKSP<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> notKSQ<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"know <span class="free">P</span> <span class="free">m</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> subPQ<span class="main">:</span><span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> cCompI<span class="main">:</span><span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> cCompKS<span class="main">:</span><span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"know <span class="free">PQ</span> <span class="free">m</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">m</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">key</span>
  <span class="keyword3"><span class="command">assume</span></span> a1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span> kKS <span class="skolem">key</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span>  <span class="quoted"><span class="quoted">"ine <span class="free">P</span> <span class="main">(</span>kE <span class="skolem">key</span><span class="main">)</span>"</span></span><span class="main">)</span> 
     <span class="keyword3"><span class="command">assume</span></span> a11<span class="main">:</span><span class="quoted"><span class="quoted">"ine <span class="free">P</span> <span class="main">(</span>kE <span class="skolem">key</span><span class="main">)</span>"</span></span> 
     <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> a11ext<span class="main">:</span><span class="quoted"><span class="quoted">"ine <span class="free">P</span> <span class="main">(</span>kE <span class="skolem">key</span><span class="main">)</span> <span class="main">|</span> ine <span class="free">Q</span> <span class="main">(</span>kE <span class="skolem">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">from</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompKS <span class="keyword2"><span class="keyword">and</span></span> notKSP <span class="keyword2"><span class="keyword">and</span></span> notKSQ 
       <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∉</span> specKeysSecrets <span class="free">PQ</span>"</span></span> 
       <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> correctCompositionKS_neg1<span class="main">)</span> 
     <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword1"><span class="command">have</span></span> sg1<span class="main">:</span><span class="quoted"><span class="quoted">"kKS <span class="skolem">key</span> <span class="main">∉</span> specKeysSecrets <span class="free">PQ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">from</span></span> a1 <span class="keyword2"><span class="keyword">and</span></span> a11ext <span class="keyword2"><span class="keyword">and</span></span> cCompKS  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
     <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"loc <span class="free">PQ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span><span class="main">)</span>
       <span class="keyword3"><span class="command">assume</span></span> a11locE<span class="main">:</span><span class="quoted"><span class="quoted">"loc <span class="free">PQ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
       <span class="keyword1"><span class="command">from</span></span> a11ext <span class="keyword2"><span class="keyword">and</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompI <span class="keyword2"><span class="keyword">and</span></span> a11locE <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ine <span class="free">PQ</span> <span class="main">(</span>kE <span class="skolem">key</span><span class="main">)</span>"</span></span> 
         <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> TBtheorem4a_empty<span class="main">)</span> 
       <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">next</span></span> 
       <span class="keyword3"><span class="command">assume</span></span> a11locNE<span class="main">:</span><span class="quoted"><span class="quoted">"loc <span class="free">PQ</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
       <span class="keyword1"><span class="command">from</span></span> a1 <span class="keyword2"><span class="keyword">and</span></span> a11 <span class="keyword2"><span class="keyword">and</span></span> sg1 <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
         <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ine_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
         <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKS_exprChannel_k_Pex<span class="main">)</span> 
     <span class="keyword1"><span class="command">qed</span></span>
   <span class="keyword1"><span class="command">next</span></span>
     <span class="keyword3"><span class="command">assume</span></span> a12<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>kE <span class="skolem">key</span><span class="main">)</span>"</span></span>
     <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
       <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  LocalSecretsComposition1<span class="main">)</span>
   <span class="keyword1"><span class="command">qed</span></span>
 <span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">secret</span>
  <span class="keyword3"><span class="command">assume</span></span> a2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span> sKS <span class="skolem">secret</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span>  <span class="quoted"><span class="quoted">"ine <span class="free">P</span> <span class="main">(</span>sE <span class="skolem">secret</span><span class="main">)</span>"</span></span><span class="main">)</span> 
     <span class="keyword3"><span class="command">assume</span></span> a21<span class="main">:</span><span class="quoted"><span class="quoted">"ine <span class="free">P</span> <span class="main">(</span>sE <span class="skolem">secret</span><span class="main">)</span>"</span></span> 
     <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> a21ext<span class="main">:</span><span class="quoted"><span class="quoted">"ine <span class="free">P</span> <span class="main">(</span>sE <span class="skolem">secret</span><span class="main">)</span> <span class="main">|</span> ine <span class="free">Q</span> <span class="main">(</span>sE <span class="skolem">secret</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">from</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompKS <span class="keyword2"><span class="keyword">and</span></span> notKSP <span class="keyword2"><span class="keyword">and</span></span> notKSQ <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∉</span> specKeysSecrets <span class="free">PQ</span>"</span></span> 
       <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> correctCompositionKS_neg1<span class="main">)</span> 
     <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword1"><span class="command">have</span></span> sg2<span class="main">:</span><span class="quoted"><span class="quoted">"sKS <span class="skolem">secret</span> <span class="main">∉</span> specKeysSecrets <span class="free">PQ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">from</span></span> a2 <span class="keyword2"><span class="keyword">and</span></span> a21ext <span class="keyword2"><span class="keyword">and</span></span> cCompKS  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
     <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"loc <span class="free">PQ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span><span class="main">)</span>
       <span class="keyword3"><span class="command">assume</span></span> a21locE<span class="main">:</span><span class="quoted"><span class="quoted">"loc <span class="free">PQ</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
       <span class="keyword1"><span class="command">from</span></span> a21ext <span class="keyword2"><span class="keyword">and</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompI <span class="keyword2"><span class="keyword">and</span></span> a21locE <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ine <span class="free">PQ</span> <span class="main">(</span>sE <span class="skolem">secret</span><span class="main">)</span>"</span></span> 
         <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> TBtheorem4a_empty<span class="main">)</span> 
       <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">next</span></span> 
       <span class="keyword3"><span class="command">assume</span></span> a21locNE<span class="main">:</span><span class="quoted"><span class="quoted">"loc <span class="free">PQ</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
       <span class="keyword1"><span class="command">from</span></span> a2 <span class="keyword2"><span class="keyword">and</span></span> a21 <span class="keyword2"><span class="keyword">and</span></span> sg2 <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
         <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ine_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
         <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> correctCompositionKS_exprChannel_s_Pex<span class="main">)</span> 
     <span class="keyword1"><span class="command">qed</span></span>
   <span class="keyword1"><span class="command">next</span></span>
     <span class="keyword3"><span class="command">assume</span></span> a12<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>sE <span class="skolem">secret</span><span class="main">)</span>"</span></span>
     <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword2"><span class="keyword">and</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> LocalSecretsComposition1 know.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
   <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="KnowledgeKeysSecrets-know_composition2"><span class="command">lemma</span></span> know_composition2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"know <span class="free">Q</span> <span class="free">m</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"know <span class="free">PQ</span> <span class="free">m</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> insert_commute know_composition1<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-know_composition"><span class="command">lemma</span></span> know_composition<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"know <span class="free">P</span> <span class="free">m</span> <span class="main">∨</span> know <span class="free">Q</span> <span class="free">m</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span> 
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"know <span class="free">PQ</span> <span class="free">m</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> know_composition1 know_composition2<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> know_composition_neg_ine_k<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">P</span> <span class="main">(</span>kKS <span class="free">key</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">Q</span> <span class="main">(</span>kKS <span class="free">key</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>ine <span class="free">PQ</span> <span class="main">(</span>kE <span class="free">key</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> TBtheorem3a not_know_k_not_ine<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> know_composition_neg_ine_s<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">P</span> <span class="main">(</span>sKS <span class="free">secret</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">Q</span> <span class="main">(</span>sKS <span class="free">secret</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>ine <span class="free">PQ</span> <span class="main">(</span>sE <span class="free">secret</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> TBtheorem3a not_know_s_not_ine<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-know_composition_neg1"><span class="command">lemma</span></span> know_composition_neg1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> notknowP<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">P</span> <span class="free">m</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> notknowQ<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">Q</span> <span class="free">m</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> subPQ<span class="main">:</span><span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> cCompLoc<span class="main">:</span><span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> cCompI<span class="main">:</span><span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">PQ</span> <span class="free">m</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">m</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">key</span>
  <span class="keyword3"><span class="command">assume</span></span> a1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span> kKS <span class="skolem">key</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> notknowP <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword1"><span class="command">have</span></span> sg1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">P</span> <span class="main">(</span>kKS <span class="skolem">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> sg1a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>kE <span class="skolem">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> sg1 <span class="keyword1"><span class="command">have</span></span> sg1b<span class="main">:</span><span class="quoted"><span class="quoted">"kKS <span class="skolem">key</span> <span class="main">∉</span> LocalSecrets <span class="free">P</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> notknowQ <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword1"><span class="command">have</span></span> sg2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">Q</span> <span class="main">(</span>kKS <span class="skolem">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span>  <span class="keyword1"><span class="command">have</span></span> sg2a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>kE <span class="skolem">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> sg2 <span class="keyword1"><span class="command">have</span></span> sg2b<span class="main">:</span><span class="quoted"><span class="quoted">"kKS <span class="skolem">key</span> <span class="main">∉</span> LocalSecrets <span class="free">Q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> sg1 <span class="keyword2"><span class="keyword">and</span></span> sg2 <span class="keyword2"><span class="keyword">and</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompI <span class="keyword1"><span class="command">have</span></span> sg3<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">PQ</span> <span class="main">(</span>kE <span class="skolem">key</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> know_composition_neg_ine_k<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompLoc <span class="keyword2"><span class="keyword">and</span></span> sg1a <span class="keyword2"><span class="keyword">and</span></span> sg2a <span class="keyword2"><span class="keyword">and</span></span> sg1b <span class="keyword2"><span class="keyword">and</span></span> sg2b <span class="keyword1"><span class="command">have</span></span> sg4<span class="main">:</span>
  <span class="quoted"><span class="quoted">"kKS <span class="skolem">key</span> <span class="main">∉</span> LocalSecrets <span class="free">PQ</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> LocalSecretsComposition_neg1_k<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> sg3 <span class="keyword2"><span class="keyword">and</span></span> sg4 <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span> 
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">secret</span>
  <span class="keyword3"><span class="command">assume</span></span> a2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span> sKS <span class="skolem">secret</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> notknowP <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword1"><span class="command">have</span></span> sg1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">P</span> <span class="main">(</span>sKS <span class="skolem">secret</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> sg1a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">P</span> <span class="main">(</span>sE <span class="skolem">secret</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> sg1 <span class="keyword1"><span class="command">have</span></span> sg1b<span class="main">:</span><span class="quoted"><span class="quoted">"sKS <span class="skolem">secret</span> <span class="main">∉</span> LocalSecrets <span class="free">P</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> notknowQ <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword1"><span class="command">have</span></span> sg2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">Q</span> <span class="main">(</span>sKS <span class="skolem">secret</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> sg2a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>sE <span class="skolem">secret</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> sg2 <span class="keyword1"><span class="command">have</span></span> sg2b<span class="main">:</span><span class="quoted"><span class="quoted">"sKS <span class="skolem">secret</span> <span class="main">∉</span> LocalSecrets <span class="free">Q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> sg1 <span class="keyword2"><span class="keyword">and</span></span> sg2 <span class="keyword2"><span class="keyword">and</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompI <span class="keyword1"><span class="command">have</span></span> sg3<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">PQ</span> <span class="main">(</span>sE <span class="skolem">secret</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> know_composition_neg_ine_s<span class="main">)</span> 
  <span class="keyword1"><span class="command">from</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompLoc <span class="keyword2"><span class="keyword">and</span></span> sg1a <span class="keyword2"><span class="keyword">and</span></span> sg2a <span class="keyword2"><span class="keyword">and</span></span> sg1b <span class="keyword2"><span class="keyword">and</span></span> sg2b <span class="keyword1"><span class="command">have</span></span> sg4<span class="main">:</span>
  <span class="quoted"><span class="quoted">"sKS <span class="skolem">secret</span> <span class="main">∉</span> LocalSecrets <span class="free">PQ</span>"</span></span>  
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> LocalSecretsComposition_neg1_s<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> sg3 <span class="keyword2"><span class="keyword">and</span></span> sg4 <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="KnowledgeKeysSecrets-know_decomposition"><span class="command">lemma</span></span> know_decomposition<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> knowPQ<span class="main">:</span><span class="quoted"><span class="quoted">"know <span class="free">PQ</span> <span class="free">m</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> subPQ<span class="main">:</span><span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> cCompI<span class="main">:</span><span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> cCompLoc<span class="main">:</span><span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"know <span class="free">P</span> <span class="free">m</span> <span class="main">∨</span> know <span class="free">Q</span> <span class="free">m</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">m</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">key</span>
  <span class="keyword3"><span class="command">assume</span></span> a1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span> kKS <span class="skolem">key</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"ine <span class="free">PQ</span> <span class="main">(</span>kE <span class="skolem">key</span><span class="main">)</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> a11<span class="main">:</span><span class="quoted"><span class="quoted">"ine <span class="free">PQ</span> <span class="main">(</span>kE <span class="skolem">key</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompI <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword1"><span class="command">have</span></span> 
     <span class="quoted"><span class="quoted">"ine <span class="free">P</span> <span class="main">(</span>kE <span class="skolem">key</span><span class="main">)</span>  <span class="main">∨</span> ine <span class="free">Q</span> <span class="main">(</span>kE <span class="skolem">key</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> TBtheorem1a<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> a12<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">PQ</span> <span class="main">(</span>kE <span class="skolem">key</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> knowPQ <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword1"><span class="command">have</span></span> sg2<span class="main">:</span><span class="quoted"><span class="quoted">"kKS <span class="skolem">key</span> <span class="main">∈</span> LocalSecrets <span class="free">PQ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"know <span class="free">Q</span> <span class="free">m</span>"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"know <span class="free">Q</span> <span class="free">m</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span> 
      <span class="keyword3"><span class="command">assume</span></span> not_knowQm<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">Q</span> <span class="free">m</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> not_knowQm <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword1"><span class="command">have</span></span> sg3a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>kE <span class="skolem">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> not_knowQm <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword1"><span class="command">have</span></span> sg3b<span class="main">:</span><span class="quoted"><span class="quoted">"kKS <span class="skolem">key</span> <span class="main">∉</span> LocalSecrets <span class="free">Q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"kKS <span class="skolem">key</span> <span class="main">∈</span> LocalSecrets <span class="free">P</span>"</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"kKS <span class="skolem">key</span> <span class="main">∈</span> LocalSecrets <span class="free">P</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"kKS <span class="skolem">key</span> <span class="main">∉</span> LocalSecrets <span class="free">P</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> sg2 <span class="keyword2"><span class="keyword">and</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompLoc <span class="keyword2"><span class="keyword">and</span></span> sg3a <span class="keyword2"><span class="keyword">and</span></span> this <span class="keyword2"><span class="keyword">and</span></span> sg3b <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ine <span class="free">P</span> <span class="main">(</span>kE <span class="skolem">key</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LocalSecretsComposition_ine1_k<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">secret</span>
  <span class="keyword3"><span class="command">assume</span></span> a2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span> sKS <span class="skolem">secret</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"ine <span class="free">PQ</span> <span class="main">(</span>sE <span class="skolem">secret</span><span class="main">)</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> a21<span class="main">:</span><span class="quoted"><span class="quoted">"ine <span class="free">PQ</span> <span class="main">(</span>sE <span class="skolem">secret</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompI <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword1"><span class="command">have</span></span>
     <span class="quoted"><span class="quoted">"ine <span class="free">P</span> <span class="main">(</span>sE <span class="skolem">secret</span><span class="main">)</span>  <span class="main">∨</span> ine <span class="free">Q</span> <span class="main">(</span>sE <span class="skolem">secret</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> TBtheorem1a<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> a22<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">PQ</span> <span class="main">(</span>sE <span class="skolem">secret</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> knowPQ <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword1"><span class="command">have</span></span> sg5<span class="main">:</span>
     <span class="quoted"><span class="quoted">"sKS <span class="skolem">secret</span> <span class="main">∈</span> LocalSecrets <span class="free">PQ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"know <span class="free">Q</span> <span class="free">m</span>"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"know <span class="free">Q</span> <span class="free">m</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span> 
      <span class="keyword3"><span class="command">assume</span></span> not_knowQm<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> know <span class="free">Q</span> <span class="free">m</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> not_knowQm <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword1"><span class="command">have</span></span> sg6a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">Q</span> <span class="main">(</span>sE <span class="skolem">secret</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> not_knowQm <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword1"><span class="command">have</span></span> sg6b<span class="main">:</span><span class="quoted"><span class="quoted">"sKS <span class="skolem">secret</span> <span class="main">∉</span> LocalSecrets <span class="free">Q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"sKS <span class="skolem">secret</span> <span class="main">∈</span> LocalSecrets <span class="free">P</span>"</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"sKS <span class="skolem">secret</span> <span class="main">∈</span> LocalSecrets <span class="free">P</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"sKS <span class="skolem">secret</span> <span class="main">∉</span> LocalSecrets <span class="free">P</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> sg5 <span class="keyword2"><span class="keyword">and</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompLoc <span class="keyword2"><span class="keyword">and</span></span> sg6a <span class="keyword2"><span class="keyword">and</span></span> this <span class="keyword2"><span class="keyword">and</span></span> sg6b <span class="keyword1"><span class="command">have</span></span> 
         <span class="quoted"><span class="quoted">"ine <span class="free">P</span> <span class="main">(</span>sE <span class="skolem">secret</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LocalSecretsComposition_ine1_s<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="KnowledgeKeysSecrets-eout_knows_nonKS_k"><span class="command">lemma</span></span> eout_knows_nonKS_k<span class="main">:</span>
 <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∉</span> <span class="main">(</span>specKeys <span class="free">A</span><span class="main">)</span>"</span></span>
         <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eout <span class="free">A</span> <span class="main">(</span>kE <span class="free">m</span><span class="main">)</span>"</span></span>
         <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eoutKnowsECorrect <span class="free">A</span> <span class="main">(</span>kE <span class="free">m</span><span class="main">)</span>"</span></span>
   <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">A</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Expression.distinct<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> Expression.inject<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> eoutKnowsECorrect_L1<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-eout_knows_nonKS_s"><span class="command">lemma</span></span> eout_knows_nonKS_s<span class="main">:</span>
 <span class="keyword2"><span class="keyword">assumes</span></span> h1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∉</span> specSecrets <span class="free">A</span>"</span></span>
         <span class="keyword2"><span class="keyword">and</span></span> h2<span class="main">:</span><span class="quoted"><span class="quoted">"eout <span class="free">A</span> <span class="main">(</span>sE <span class="free">m</span><span class="main">)</span>"</span></span>
         <span class="keyword2"><span class="keyword">and</span></span> h3<span class="main">:</span><span class="quoted"><span class="quoted">"eoutKnowsECorrect <span class="free">A</span> <span class="main">(</span>sE <span class="free">m</span><span class="main">)</span>"</span></span>
   <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">A</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Expression.distinct<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> Expression.inject<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> eoutKnowsECorrect_def<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-not_knows_k_not_ine"><span class="command">lemma</span></span> not_knows_k_not_ine<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">A</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">A</span> <span class="main">(</span>kE <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> knows2know_neg_k not_know_k_not_ine<span class="main">)</span> 

<span class="keyword1" id="KnowledgeKeysSecrets-not_knows_s_not_ine"><span class="command">lemma</span></span> not_knows_s_not_ine<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">A</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> ine <span class="free">A</span> <span class="main">(</span>sE <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> knows2know_neg_s not_know_s_not_ine<span class="main">)</span> 

<span class="keyword1" id="KnowledgeKeysSecrets-not_knows_k_not_eout"><span class="command">lemma</span></span> not_knows_k_not_eout<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∉</span> specKeys <span class="free">A</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">A</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eoutKnowsECorrect <span class="free">A</span> <span class="main">(</span>kE <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> eout <span class="free">A</span> <span class="main">(</span>kE <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eout_knows_nonKS_k<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-not_knows_s_not_eout"><span class="command">lemma</span></span> not_knows_s_not_eout<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∉</span> specSecrets <span class="free">A</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">A</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"eoutKnowsECorrect <span class="free">A</span> <span class="main">(</span>sE <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> eout <span class="free">A</span> <span class="main">(</span>sE <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eout_knows_nonKS_s<span class="main">)</span> 

<span class="keyword1" id="KnowledgeKeysSecrets-adv_not_knows1"><span class="command">lemma</span></span>  adv_not_knows1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"out <span class="free">P</span> <span class="main">⊆</span> ins <span class="free">A</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">A</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> eout <span class="free">P</span> <span class="main">(</span>kE <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> adv_not_know1 knows2know_neg_k<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-adv_not_knows2"><span class="command">lemma</span></span> adv_not_knows2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"out <span class="free">P</span>  <span class="main">⊆</span> ins <span class="free">A</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">A</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> eout <span class="free">P</span> <span class="main">(</span>sE <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> adv_not_know2 knows2know_neg_s<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows_decomposition_1_k"><span class="command">lemma</span></span> knows_decomposition_1_k<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">a</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">a</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span> <span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">PQ</span> <span class="main">[</span>kE <span class="free">a</span><span class="main">]</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">[</span>kE <span class="free">a</span><span class="main">]</span> <span class="main">∨</span> knows <span class="free">Q</span> <span class="main">[</span>kE <span class="free">a</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> know_decomposition knows1k<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows_decomposition_1_s"><span class="command">lemma</span></span> knows_decomposition_1_s<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">a</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">a</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span> <span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">PQ</span> <span class="main">[</span>sE <span class="free">a</span><span class="main">]</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">[</span>sE <span class="free">a</span><span class="main">]</span> <span class="main">∨</span> knows <span class="free">Q</span> <span class="main">[</span>sE <span class="free">a</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> know_decomposition knows1s<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows_decomposition_1"><span class="command">lemma</span></span> knows_decomposition_1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span> <span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">PQ</span> <span class="main">[</span><span class="free">a</span><span class="main">]</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="free">a</span> <span class="main">=</span> kE <span class="bound">z</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="free">a</span> <span class="main">=</span> sE <span class="bound">z</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">z</span><span class="main">.</span> <span class="free">a</span> <span class="main">=</span> kE <span class="bound">z</span> <span class="main">⟶</span> 
         kKS <span class="bound">z</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span> <span class="main">∧</span> kKS <span class="bound">z</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> h7<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">z</span><span class="main">.</span> <span class="free">a</span> <span class="main">=</span> sE <span class="bound">z</span> <span class="main">⟶</span> 
         sKS <span class="bound">z</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span> <span class="main">∧</span> sKS <span class="bound">z</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">[</span><span class="free">a</span><span class="main">]</span> <span class="main">∨</span> knows <span class="free">Q</span> <span class="main">[</span><span class="free">a</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> knows_decomposition_1_k knows_decomposition_1_s<span class="main">)</span> 

<span class="keyword1" id="KnowledgeKeysSecrets-knows_composition1_k"><span class="command">lemma</span></span> knows_composition1_k<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">PQ</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> know_composition knows1k<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows_composition1_s"><span class="command">lemma</span></span> knows_composition1_s<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">PQ</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> know_composition knows1s<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows_composition2_k"><span class="command">lemma</span></span> knows_composition2_k<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>kKS <span class="free">m</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">Q</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">PQ</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> know2knowsPQ_k know_composition knows2know_k<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows_composition2_s"><span class="command">lemma</span></span> knows_composition2_s<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>sKS <span class="free">m</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">Q</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">PQ</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> know2knowsPQ_s know_composition knows2know_s<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows_composition_neg1_k"><span class="command">lemma</span></span> knows_composition_neg1_k<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">m</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"kKS <span class="free">m</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">P</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">Q</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">PQ</span> <span class="main">[</span>kE <span class="free">m</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> know_decomposition knows1k<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows_composition_neg1_s"><span class="command">lemma</span></span> knows_composition_neg1_s<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">m</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"sKS <span class="free">m</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">P</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">Q</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionLoc <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">PQ</span> <span class="main">[</span>sE <span class="free">m</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> knows_decomposition_1_s<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows_concat_1"><span class="command">lemma</span></span> knows_concat_1<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">(</span><span class="free">a</span> <span class="main">#</span> <span class="free">e</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">[</span><span class="free">a</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> append_Cons append_Nil knows2<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows_concat_2"><span class="command">lemma</span></span> knows_concat_2<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">(</span><span class="free">a</span> <span class="main">#</span> <span class="free">e</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="free">e</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> append_Cons append_Nil knows2a<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows_concat_3"><span class="command">lemma</span></span> knows_concat_3<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">[</span><span class="free">a</span><span class="main">]</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="free">e</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">(</span><span class="free">a</span> <span class="main">#</span> <span class="free">e</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> append_Cons append_Nil knows3<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-not_knows_conc_knows_elem_not_knows_tail"><span class="command">lemma</span></span> not_knows_conc_knows_elem_not_knows_tail<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">P</span> <span class="main">(</span><span class="free">a</span> <span class="main">#</span> <span class="free">e</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">[</span><span class="free">a</span><span class="main">]</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">P</span> <span class="free">e</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> knows_concat_3<span class="main">)</span>
    
<span class="keyword1" id="KnowledgeKeysSecrets-not_knows_conc_not_knows_elem_tail"><span class="command">lemma</span></span> not_knows_conc_not_knows_elem_tail<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">P</span> <span class="main">(</span><span class="free">a</span><span class="main">#</span><span class="free">e</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">P</span> <span class="main">[</span><span class="free">a</span><span class="main">]</span> <span class="main">∨</span> <span class="main">¬</span> knows <span class="free">P</span> <span class="free">e</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> append_Cons append_Nil knows3<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-not_knows_elem_not_knows_conc"><span class="command">lemma</span></span> not_knows_elem_not_knows_conc<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">P</span> <span class="main">[</span><span class="free">a</span><span class="main">]</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">P</span> <span class="main">(</span><span class="free">a</span> <span class="main">#</span> <span class="free">e</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> knows_concat_1<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-not_knows_tail_not_knows_conc"><span class="command">lemma</span></span> not_knows_tail_not_knows_conc<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">P</span> <span class="free">e</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="main">¬</span> knows <span class="free">P</span> <span class="main">(</span><span class="free">a</span> <span class="main">#</span> <span class="free">e</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> knows_concat_2<span class="main">)</span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows_composition3"><span class="command">lemma</span></span> knows_composition3<span class="main">:</span>
 <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">e</span><span class="main">::</span><span class="quoted"><span class="quoted">"Expression list"</span></span>
 <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="free">e</span>"</span></span>
     <span class="keyword2"><span class="keyword">and</span></span> subPQ<span class="main">:</span><span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
     <span class="keyword2"><span class="keyword">and</span></span> cCompI<span class="main">:</span><span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
     <span class="keyword2"><span class="keyword">and</span></span> cCompKS<span class="main">:</span><span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
     <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="main">(</span><span class="bound">m</span><span class="main">::</span>Expression<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">m</span> <span class="keyword1">mem</span> <span class="free">e</span><span class="main">)</span> <span class="main">⟶</span> 
            <span class="main">(</span><span class="main">(</span><span class="main">∃</span> <span class="bound">z1</span><span class="main">.</span> <span class="bound">m</span> <span class="main">=</span> <span class="main">(</span>kE <span class="bound">z1</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">z2</span><span class="main">.</span> <span class="bound">m</span> <span class="main">=</span> <span class="main">(</span>sE <span class="bound">z2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
     <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"notSpecKeysSecretsExpr <span class="free">P</span> <span class="free">e</span>"</span></span>
     <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"notSpecKeysSecretsExpr <span class="free">Q</span> <span class="free">e</span>"</span></span> 
 <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">PQ</span> <span class="free">e</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">e</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> Nil 
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> knows_emptyexpression<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">l</span> 
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Cons <span class="skolem">a</span> <span class="skolem">l</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> Cons <span class="keyword1"><span class="command">have</span></span> sg1<span class="main">:</span><span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">[</span><span class="skolem">a</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> knows_concat_1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> Cons <span class="keyword1"><span class="command">have</span></span> sg2<span class="main">:</span><span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="skolem">l</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> knows_concat_2<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> sg1 <span class="keyword1"><span class="command">have</span></span> sg3<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="keyword1">mem</span> <span class="main">(</span><span class="skolem">a</span> <span class="main">#</span> <span class="skolem">l</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> Cons <span class="keyword2"><span class="keyword">and</span></span> sg2 <span class="keyword1"><span class="command">have</span></span> sg2a<span class="main">:</span><span class="quoted"><span class="quoted">"knows <span class="free">PQ</span> <span class="skolem">l</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> notSpecKeysSecretsExpr_L2<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> Cons <span class="keyword2"><span class="keyword">and</span></span> sg1 <span class="keyword2"><span class="keyword">and</span></span> sg2 <span class="keyword2"><span class="keyword">and</span></span> sg3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">z1</span><span class="main">.</span> <span class="skolem">a</span> <span class="main">=</span> kE <span class="bound">z1</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">z1</span><span class="main">.</span> <span class="skolem">a</span> <span class="main">=</span> <span class="main">(</span>kE <span class="bound">z1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> a1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="main">(</span>kE <span class="skolem">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> a1 <span class="keyword2"><span class="keyword">and</span></span> Cons <span class="keyword1"><span class="command">have</span></span> sg4<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>kKS <span class="skolem">z</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> notSpecKeysSecretsExpr_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> a1 <span class="keyword2"><span class="keyword">and</span></span> Cons <span class="keyword1"><span class="command">have</span></span> sg5<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>kKS <span class="skolem">z</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> notSpecKeysSecretsExpr_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> sg1 <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword1"><span class="command">have</span></span> sg6<span class="main">:</span><span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">[</span>kE <span class="skolem">z</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> sg4 <span class="keyword2"><span class="keyword">and</span></span> sg5 <span class="keyword2"><span class="keyword">and</span></span> sg6 <span class="keyword2"><span class="keyword">and</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompI <span class="keyword2"><span class="keyword">and</span></span> cCompKS  
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">PQ</span> <span class="main">[</span>kE <span class="skolem">z</span><span class="main">]</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> knows_composition1_k<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> sg2a <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> knows_concat_3<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span> 
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound">z1</span><span class="main">.</span> <span class="skolem">a</span> <span class="main">=</span> kE <span class="bound">z1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> Cons <span class="keyword2"><span class="keyword">and</span></span> sg3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">z2</span><span class="main">.</span> <span class="skolem">a</span> <span class="main">=</span> <span class="main">(</span>sE <span class="bound">z2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> a2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="main">(</span>sE <span class="skolem">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> a2 <span class="keyword2"><span class="keyword">and</span></span> Cons <span class="keyword1"><span class="command">have</span></span> sg8<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>sKS <span class="skolem">z</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> notSpecKeysSecretsExpr_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> a2 <span class="keyword2"><span class="keyword">and</span></span> Cons <span class="keyword1"><span class="command">have</span></span> sg9<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>sKS <span class="skolem">z</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> notSpecKeysSecretsExpr_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> sg1 <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword1"><span class="command">have</span></span> sg10<span class="main">:</span><span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="main">[</span>sE <span class="skolem">z</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
    <span class="keyword1"><span class="command">from</span></span> sg8 <span class="keyword2"><span class="keyword">and</span></span> sg9 <span class="keyword2"><span class="keyword">and</span></span> sg10 <span class="keyword2"><span class="keyword">and</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompI <span class="keyword2"><span class="keyword">and</span></span> cCompKS  
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">PQ</span> <span class="main">[</span>sE <span class="skolem">z</span><span class="main">]</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> knows_composition1_s<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> sg2a <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> knows_concat_3<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span> 
<span class="keyword1"><span class="command">qed</span></span> 
 
<span class="keyword1" id="KnowledgeKeysSecrets-knows_composition4"><span class="command">lemma</span></span> knows_composition4<span class="main">:</span>
 <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">Q</span> <span class="free">e</span>"</span></span>
     <span class="keyword2"><span class="keyword">and</span></span> subPQ<span class="main">:</span><span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span> 
     <span class="keyword2"><span class="keyword">and</span></span> cCompI<span class="main">:</span><span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
     <span class="keyword2"><span class="keyword">and</span></span> cCompKS<span class="main">:</span><span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
     <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="keyword1">mem</span> <span class="free">e</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">m</span> <span class="main">=</span> kE <span class="bound">z</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">m</span> <span class="main">=</span> sE <span class="bound">z</span><span class="main">)</span><span class="main">)</span>"</span></span>
     <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"notSpecKeysSecretsExpr <span class="free">P</span> <span class="free">e</span>"</span></span>
     <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"notSpecKeysSecretsExpr <span class="free">Q</span> <span class="free">e</span>"</span></span> 
 <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">PQ</span> <span class="free">e</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">e</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> Nil 
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> knows_emptyexpression<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">l</span> 
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Cons <span class="skolem">a</span> <span class="skolem">l</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> Cons <span class="keyword1"><span class="command">have</span></span> sg1<span class="main">:</span><span class="quoted"><span class="quoted">"knows <span class="free">Q</span> <span class="main">[</span><span class="skolem">a</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> knows_concat_1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> Cons <span class="keyword1"><span class="command">have</span></span> sg2<span class="main">:</span><span class="quoted"><span class="quoted">"knows <span class="free">Q</span> <span class="skolem">l</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> knows_concat_2<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> sg1 <span class="keyword1"><span class="command">have</span></span> sg3<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="keyword1">mem</span> <span class="main">(</span><span class="skolem">a</span> <span class="main">#</span> <span class="skolem">l</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> Cons <span class="keyword2"><span class="keyword">and</span></span> sg2 <span class="keyword1"><span class="command">have</span></span> sg2a<span class="main">:</span><span class="quoted"><span class="quoted">"knows <span class="free">PQ</span> <span class="skolem">l</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> notSpecKeysSecretsExpr_L2<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> Cons <span class="keyword2"><span class="keyword">and</span></span> sg1 <span class="keyword2"><span class="keyword">and</span></span> sg2 <span class="keyword2"><span class="keyword">and</span></span> sg3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">z1</span><span class="main">.</span> <span class="skolem">a</span> <span class="main">=</span> kE <span class="bound">z1</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">z1</span><span class="main">.</span> <span class="skolem">a</span> <span class="main">=</span> <span class="main">(</span>kE <span class="bound">z1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> a1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="main">(</span>kE <span class="skolem">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> a1 <span class="keyword2"><span class="keyword">and</span></span> Cons <span class="keyword1"><span class="command">have</span></span> sg4<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>kKS <span class="skolem">z</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> notSpecKeysSecretsExpr_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> a1 <span class="keyword2"><span class="keyword">and</span></span> Cons <span class="keyword1"><span class="command">have</span></span> sg5<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>kKS <span class="skolem">z</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> notSpecKeysSecretsExpr_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> sg1 <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword1"><span class="command">have</span></span> sg6<span class="main">:</span><span class="quoted"><span class="quoted">"knows <span class="free">Q</span> <span class="main">[</span>kE <span class="skolem">z</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> sg4 <span class="keyword2"><span class="keyword">and</span></span> sg5 <span class="keyword2"><span class="keyword">and</span></span> sg6 <span class="keyword2"><span class="keyword">and</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompI <span class="keyword2"><span class="keyword">and</span></span> cCompKS 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">PQ</span> <span class="main">[</span>kE <span class="skolem">z</span><span class="main">]</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> knows_composition2_k<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> sg2a <span class="keyword2"><span class="keyword">and</span></span> a1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> knows_concat_3<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span> 
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span><span class="bound">z1</span><span class="main">.</span> <span class="skolem">a</span> <span class="main">=</span> kE <span class="bound">z1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> Cons <span class="keyword2"><span class="keyword">and</span></span> sg3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">z2</span><span class="main">.</span> <span class="skolem">a</span> <span class="main">=</span> <span class="main">(</span>sE <span class="bound">z2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> a2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="main">(</span>sE <span class="skolem">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> a2 <span class="keyword2"><span class="keyword">and</span></span> Cons <span class="keyword1"><span class="command">have</span></span> sg8<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>sKS <span class="skolem">z</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">P</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> notSpecKeysSecretsExpr_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> a2 <span class="keyword2"><span class="keyword">and</span></span> Cons <span class="keyword1"><span class="command">have</span></span> sg9<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>sKS <span class="skolem">z</span><span class="main">)</span> <span class="main">∉</span> specKeysSecrets <span class="free">Q</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> notSpecKeysSecretsExpr_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> sg1 <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword1"><span class="command">have</span></span> sg10<span class="main">:</span><span class="quoted"><span class="quoted">"knows <span class="free">Q</span> <span class="main">[</span>sE <span class="skolem">z</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
    <span class="keyword1"><span class="command">from</span></span> sg8 <span class="keyword2"><span class="keyword">and</span></span> sg9 <span class="keyword2"><span class="keyword">and</span></span> sg10 <span class="keyword2"><span class="keyword">and</span></span> subPQ <span class="keyword2"><span class="keyword">and</span></span> cCompI <span class="keyword2"><span class="keyword">and</span></span> cCompKS  
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">PQ</span> <span class="main">[</span>sE <span class="skolem">z</span><span class="main">]</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> knows_composition2_s<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> sg2a <span class="keyword2"><span class="keyword">and</span></span> a2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> knows_concat_3<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="KnowledgeKeysSecrets-knows_composition5"><span class="command">lemma</span></span> knows_composition5<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">P</span> <span class="free">e</span> <span class="main">∨</span> knows <span class="free">Q</span> <span class="free">e</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subcomponents <span class="free">PQ</span> <span class="main">=</span> <span class="main">{</span><span class="free">P</span><span class="main">,</span><span class="free">Q</span><span class="main">}</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionIn <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"correctCompositionKS <span class="free">PQ</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="keyword1">mem</span> <span class="free">e</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">m</span> <span class="main">=</span> kE <span class="bound">z</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">m</span> <span class="main">=</span> sE <span class="bound">z</span><span class="main">)</span><span class="main">)</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"notSpecKeysSecretsExpr <span class="free">P</span> <span class="free">e</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"notSpecKeysSecretsExpr <span class="free">Q</span> <span class="free">e</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"knows <span class="free">PQ</span> <span class="free">e</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> knows_composition3 knows_composition4<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span> 
</pre>
</div>
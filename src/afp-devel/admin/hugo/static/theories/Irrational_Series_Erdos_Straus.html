<div id="Irrational_Series_Erdos_Straus">
<div class="head">
<h1>Theory Irrational_Series_Erdos_Straus</h1>
</div>
<pre class="source"><span class="comment1">(* Title:      Irrational_Series_Erdos_Straus.thy
   Author:     Angeliki Koutsoukou-Argyraki and Wenda Li, University of Cambridge, UK.

We formalise certain irrationality criteria for infinite series by P. Erdos and E.G. Straus.
In particular, we formalise Theorem 2.1, Corollary 2.10 and Theorem 3.1 in [1]. The latter is an 
application of Theorem 2.1 involving the prime numbers.

References:
[1]  P. Erdos and E.G. Straus, On the irrationality of certain series, Pacific Journal of 
Mathematics, Vol. 55, No 1, 1974  https://projecteuclid.org/euclid.pjm/1102911140
*)</span>

<span class="keyword1"><span class="command">theory</span></span> <span class="quoted">"Irrational_Series_Erdos_Straus"</span> <span class="keyword2"><span class="keyword">imports</span></span>
  <a href="../Prime_Number_Theorem/Prime_Number_Theorem.html">Prime_Number_Theorem.Prime_Number_Theorem</a>
  <a href="../Prime_Distribution_Elementary/PNT_Consequences.html">Prime_Distribution_Elementary.PNT_Consequences</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Miscellaneous›</span></span>

<span class="keyword1" id="Irrational_Series_Erdos_Straus-suminf_comparison"><span class="command">lemma</span></span> suminf_comparison<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"summable <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> gf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> norm <span class="main">(</span><span class="free">g</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≤</span> <span class="free">f</span> <span class="bound">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"suminf <span class="free">g</span> <span class="main">≤</span> suminf <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> suminf_le<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="skolem">n</span> <span class="main">≤</span> <span class="free">f</span> <span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">using</span></span> gf<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"summable <span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms summable_comparison_test' <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"summable <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Irrational_Series_Erdos_Straus-tendsto_of_int_diff_0"><span class="command">lemma</span></span> tendsto_of_int_diff_0<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span> <span class="main">-</span> of_int<span class="main">(</span><span class="free">g</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="main">0</span><span class="main">::</span>real<span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">f</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">0</span> <span class="main">≤</span> <span class="free">g</span> <span class="bound">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">¦</span><span class="free">f</span> <span class="bound">n</span> <span class="main">-</span> of_int<span class="main">(</span><span class="free">g</span> <span class="bound">n</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span><span class="main">[</span><span class="operator">unfolded</span> tendsto_iff<span class="main">,</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="operator">linarith</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Irrational_Series_Erdos_Straus-eventually_mono_sequentially"><span class="command">lemma</span></span> eventually_mono_sequentially<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"eventually <span class="free">P</span> sequentially"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="free">P</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="free">k</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">Q</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="free">k</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eventually <span class="free">Q</span> sequentially"</span></span>
  <span class="keyword1"><span class="command">using</span></span> sequentially_offset<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="free">k</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> eventually_sequentially_seg<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">,</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="free">k</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> eventually_mono<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>

<span class="keyword1" id="Irrational_Series_Erdos_Straus-frequently_eventually_at_top"><span class="command">lemma</span></span> frequently_eventually_at_top<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">P</span> <span class="free">Q</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>linorder <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"frequently <span class="free">P</span> at_top"</span></span> <span class="quoted"><span class="quoted">"eventually <span class="free">Q</span> at_top"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"frequently <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">P</span> <span class="bound">x</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">y</span></span><span class="main">≥</span><span class="bound">x</span><span class="main">.</span> <span class="free">Q</span> <span class="bound">y</span><span class="main">)</span> <span class="main">)</span> at_top"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms
  <span class="keyword1"><span class="command">unfolding</span></span> frequently_def eventually_at_top_linorder 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> hide_lams<span class="main"><span class="main">)</span></span> le_cases order_trans<span class="main">)</span>

<span class="keyword1" id="Irrational_Series_Erdos_Straus-eventually_at_top_mono"><span class="command">lemma</span></span> eventually_at_top_mono<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">P</span> <span class="free">Q</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>linorder <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> event_P<span class="main">:</span><span class="quoted"><span class="quoted">"eventually <span class="free">P</span> at_top"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> PQ_imp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">≥</span><span class="free">z</span> <span class="main">⟹</span> <span class="main">∀</span><span class="bound"><span class="bound">y</span></span><span class="main">≥</span><span class="bound">x</span><span class="main">.</span> <span class="free">P</span> <span class="bound">y</span> <span class="main">⟹</span> <span class="free">Q</span> <span class="bound">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eventually <span class="free">Q</span> at_top"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="skolem">N</span><span class="main">.</span> <span class="free">P</span> <span class="bound">n</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> event_P eventually_at_top_linorder<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">when</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≥</span> max <span class="skolem">N</span> <span class="free">z</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">using</span></span> PQ_imp that <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> eventually_at_top_linorder
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Irrational_Series_Erdos_Straus-frequently_at_top_elim"><span class="command">lemma</span></span> frequently_at_top_elim<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">P</span> <span class="free">Q</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>linorder <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span><span class="bound">x</span> <span class="keyword1">in</span> at_top<span class="main">.</span> <span class="free">P</span> <span class="bound">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">i</span><span class="main">.</span> <span class="free">P</span> <span class="bound">i</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound"><span class="bound">j</span></span><span class="main">&gt;</span><span class="bound">i</span><span class="main">.</span> <span class="free">Q</span> <span class="bound">j</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span><span class="bound">x</span> <span class="keyword1">in</span> at_top<span class="main">.</span> <span class="free">Q</span> <span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> frequently_def eventually_at_top_linorder 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> leD le_cases less_le_trans<span class="main">)</span>

<span class="keyword1" id="Irrational_Series_Erdos_Straus-less_Liminf_iff"><span class="command">lemma</span></span> less_Liminf_iff<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">X</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">⇒</span> <span class="main">_</span> <span class="main">::</span> complete_linorder"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Liminf <span class="free">F</span> <span class="free">X</span> <span class="main">&lt;</span> <span class="free">C</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">y</span></span><span class="main">&lt;</span><span class="free">C</span><span class="main">.</span> frequently <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">y</span> <span class="main">≥</span> <span class="free">X</span> <span class="bound">x</span><span class="main">)</span> <span class="free">F</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> not_less not_frequently not_le le_Liminf_iff <span class="quasi_keyword">simp</span> <span class="quasi_keyword">flip</span><span class="main"><span class="main">:</span></span> Not_eq_iff<span class="main">)</span>

<span class="keyword1" id="Irrational_Series_Erdos_Straus-sequentially_even_odd_imp"><span class="command">lemma</span></span> sequentially_even_odd_imp<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">N</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">P</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="bound">N</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">N</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">P</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="bound">N</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">P</span> <span class="bound">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N</span></span> <span class="keyword2"><span class="keyword">where</span></span> N_P<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">x</span></span><span class="main">≥</span><span class="skolem">N</span><span class="main">.</span>  <span class="free">P</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∧</span> <span class="free">P</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> eventually_conj<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> 
    <span class="keyword1"><span class="command">unfolding</span></span> eventually_at_top_linorder <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">when</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">≥</span> <span class="numeral">2</span><span class="main">*</span><span class="skolem">N</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">n'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span><span class="main">=</span> <span class="skolem">n</span> <span class="keyword1">div</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span> <span class="main">≥</span> <span class="skolem">N</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> that <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">n'</span><span class="main">)</span> <span class="main">∧</span> <span class="free">P</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">n'</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> N_P <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> n'_def
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"even <span class="skolem">n</span>"</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> eventually_at_top_linorder <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Theorem 2.1 and Corollary 2.10›</span></span>

<span class="keyword1"><span class="command">context</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">a</span> <span class="free">b</span> <span class="main">::</span><span class="quoted"><span class="quoted">"nat<span class="main">⇒</span>int "</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> a_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">&gt;</span><span class="main">0</span> "</span></span> <span class="keyword2"><span class="keyword">and</span></span> a_large<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> ab_tendsto<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">¦</span><span class="free">b</span> <span class="bound">n</span><span class="main">¦</span> <span class="main">/</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword2"><span class="keyword">private</span></span> <span class="keyword1" id="Irrational_Series_Erdos_Straus-aux_series_summable"><span class="command">lemma</span></span> aux_series_summable<span class="main">:</span> <span class="quoted"><span class="quoted">"summable <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">e</span><span class="main">.</span> <span class="bound">e</span><span class="main">&gt;</span><span class="main">0</span> <span class="main">⟹</span> <span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">¦</span><span class="free">b</span> <span class="bound">x</span><span class="main">¦</span> <span class="main">/</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="bound">x</span><span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">x</span><span class="main">)</span> <span class="main">&lt;</span> <span class="bound">e</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ab_tendsto<span class="main">[</span><span class="operator">unfolded</span> tendsto_iff<span class="main">]</span> 
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> abs_mult <span class="quasi_keyword">flip</span><span class="main"><span class="main">:</span></span> of_int_abs<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> <span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> abs_of_pos<span class="main"><span class="keyword3">,</span></span><span class="operator">use</span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span> <span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> <span class="operator">auto</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>              
  <span class="keyword1"><span class="command">from</span></span> this<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="main">1</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">¦</span>real_of_int<span class="main">(</span><span class="free">b</span> <span class="bound">x</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="bound">x</span><span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span> <span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="bound">n</span><span class="main">.</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> a_pos <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>linordered_semidom_class.prod_pos<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">¦</span><span class="free">b</span> <span class="bound">n</span><span class="main">¦</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">k</span><span class="main">)</span> 
                        <span class="main">&lt;</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">k</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> eventually_mono<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="free">b</span> <span class="skolem">n</span><span class="main">¦</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="skolem">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">k</span><span class="main">)</span> <span class="main">=</span> norm <span class="main">(</span><span class="free">b</span> <span class="skolem">n</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="skolem">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span> 
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="bound">n</span><span class="main">.</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span><span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> norm <span class="main">(</span><span class="free">b</span> <span class="bound">n</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span> 
                        <span class="main">&lt;</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">k</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">algebra</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"summable <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">s</span></span> <span class="keyword2"><span class="keyword">where</span></span> a_gt_1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="skolem">s</span><span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">&gt;</span><span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> a_large<span class="main">[</span><span class="operator">unfolded</span> eventually_at_top_linorder<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">cc</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">cc</span><span class="main">=</span> <span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">&lt;</span><span class="skolem">s</span><span class="main">.</span> <span class="free">a</span> <span class="bound">k</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">cc</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> cc_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> a_pos prod_pos<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">s</span><span class="main">.</span> <span class="free">a</span> <span class="bound">k</span><span class="main">)</span> <span class="main">≥</span> <span class="skolem">cc</span> <span class="main">*</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"prod <span class="free">a</span> <span class="main">{</span><span class="skolem">s</span><span class="main">..&lt;</span>Suc <span class="main">(</span><span class="skolem">s</span> <span class="main">+</span> <span class="skolem">n</span><span class="main">)</span><span class="main">}</span> <span class="main">≥</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">n</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">case</span></span> 0
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> a_gt_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">(</span><span class="skolem">s</span> <span class="main">+</span> Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">≥</span> <span class="numeral">2</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> a_gt_1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> le_add1<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> 
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> prod.atLeastLessThan_Suc<span class="main"><span class="keyword3">,</span></span><span class="operator">simp</span><span class="main">)</span>
          <span class="keyword1"><span class="command">using</span></span> mult_mono'<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="numeral">2</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">(</span>Suc <span class="main">(</span><span class="skolem">s</span> <span class="main">+</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">" <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">n</span>"</span></span> <span class="quoted"><span class="quoted">"prod <span class="free">a</span> <span class="main">{</span><span class="skolem">s</span><span class="main">..&lt;</span>Suc <span class="main">(</span><span class="skolem">s</span> <span class="main">+</span> <span class="skolem">n</span><span class="main">)</span><span class="main">}</span>"</span></span><span class="main">]</span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult.commute<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"prod <span class="free">a</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">s</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">s</span><span class="main">}</span> <span class="main">*</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">s</span><span class="main">..&lt;</span>Suc <span class="main">(</span><span class="skolem">s</span> <span class="main">+</span> <span class="skolem">n</span><span class="main">)</span><span class="main">}</span> "</span></span>
        <span class="keyword1"><span class="command">using</span></span> prod.atLeastLessThan_concat<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="main">0</span></span> <span class="quoted"><span class="skolem">s</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span><span class="main">+</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="quoted"><span class="free">a</span></span><span class="main">]</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> add.commute lessThan_atLeast0 prod.atLeastLessThan_concat prod.head_if<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">cc</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> cc_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> atLeast0AtMost<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">s</span><span class="main">.</span> <span class="free">a</span> <span class="bound">k</span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="skolem">cc</span> <span class="main">*</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">n</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">assume</span></span> asm<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">cc</span> <span class="main">*</span> <span class="numeral">2</span> <span class="main">^</span> <span class="bound">n</span> <span class="main">≤</span> prod <span class="free">a</span> <span class="main">{..</span><span class="bound">n</span> <span class="main">+</span> <span class="skolem">s</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"real_of_int <span class="main">(</span><span class="skolem">cc</span> <span class="main">*</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">≤</span> prod <span class="free">a</span> <span class="main">{..</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">s</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> of_int_le_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"prod <span class="free">a</span> <span class="main">{..</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">s</span><span class="main">}</span> <span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">cc</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> a_pos prod_pos<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">cc</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span>of_int_prod<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"summable <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="skolem">cc</span> <span class="main">*</span> <span class="numeral">2</span><span class="main">^</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"summable <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="numeral">2</span><span class="main">::</span>int<span class="main">)</span><span class="main">^</span><span class="bound">n</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> summable_geometric<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="numeral">2</span><span class="main">::</span>int<span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>power_one_over<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> summable_mult<span class="main">[</span><span class="operator">OF</span> this<span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="skolem">cc</span>"</span></span><span class="main">]</span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"summable <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="bound">n</span><span class="main">+</span><span class="skolem">s</span><span class="main">.</span> <span class="free">a</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> summable_comparison_test'<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> N<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="main">0</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">unfold</span> real_norm_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">subst</span> abs_of_pos<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="bound">n</span><span class="main">.</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span>›</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"summable <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> summable_iff_shift<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> k<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="skolem">s</span></span><span class="main"><span class="main">,</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"summable <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="bound">n</span><span class="main">+</span><span class="numeral">2</span><span class="main">.</span> <span class="free">a</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">assume</span></span> asm<span class="main">:</span><span class="quoted"><span class="quoted">"summable <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">1</span> <span class="main">/</span> real_of_int <span class="main">(</span>prod <span class="free">a</span> <span class="main">{..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">/</span> real_of_int <span class="main">(</span>prod <span class="free">a</span> <span class="main">{..</span><span class="skolem">n</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="skolem">n</span><span class="main">+</span><span class="numeral">2</span><span class="main">.</span> <span class="free">a</span> <span class="bound">k</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span> 
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">≠</span><span class="main">0</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> a_pos <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> less_irrefl<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> atLeast0_atMost_Suc atMost_atLeast0<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> asm <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"summable <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">k</span><span class="main">≤</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> summable_iff_shift<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">,</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="numeral">2</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> summable_comparison_test_ev<span class="main"><span class="main">[</span></span><span class="operator">rotated</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eventually_mono<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">private</span></span> <span class="keyword1"><span class="command">fun</span></span> <span class="entity">get_c</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> int<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> int<span class="main">)</span> <span class="main">⇒</span> int <span class="main">⇒</span> nat <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> int<span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">get_c</span> <span class="free"><span class="bound"><span class="entity">a'</span></span></span> <span class="free"><span class="bound"><span class="entity">b'</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="free"><span class="bound"><span class="entity">N</span></span></span> <span class="main">0</span> <span class="main">=</span> round <span class="main">(</span><span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">b'</span></span></span> <span class="free"><span class="bound"><span class="entity">N</span></span></span> <span class="main">/</span> <span class="free"><span class="bound"><span class="entity">a'</span></span></span> <span class="free"><span class="bound"><span class="entity">N</span></span></span><span class="main">)</span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">get_c</span> <span class="free"><span class="bound"><span class="entity">a'</span></span></span> <span class="free"><span class="bound"><span class="entity">b'</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="free"><span class="bound"><span class="entity">N</span></span></span> <span class="main">(</span>Suc <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free">get_c</span> <span class="free"><span class="bound"><span class="entity">a'</span></span></span> <span class="free"><span class="bound"><span class="entity">b'</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="free"><span class="bound"><span class="entity">N</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">a'</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">+</span><span class="free"><span class="bound"><span class="entity">N</span></span></span><span class="main">)</span> <span class="main">-</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">b'</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">+</span><span class="free"><span class="bound"><span class="entity">N</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Irrational_Series_Erdos_Straus-ab_rationality_imp"><span class="command">lemma</span></span> ab_rationality_imp<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> ab_rational<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">b</span> <span class="bound">n</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">i</span> <span class="main">≤</span> <span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">i</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="main">ℚ</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="main">(</span><span class="bound"><span class="bound">B</span></span><span class="main">::</span>int<span class="main">)</span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">c</span><span class="main">::</span>nat<span class="main">⇒</span> int<span class="main">.</span>
            <span class="main">(</span><span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="bound">B</span><span class="main">*</span><span class="free">b</span> <span class="bound">n</span> <span class="main">=</span> <span class="bound">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="bound">c</span><span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¦</span><span class="bound">c</span><span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">¦</span><span class="main">&lt;</span><span class="free">a</span> <span class="bound">n</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span>
            <span class="main">∧</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="bound">c</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="skolem">n</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span> <span class="keyword1"><span class="command">using</span></span> a_pos <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> less_numeral_extra<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span><span class="main">::</span><span class="quoted">int</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">B</span></span><span class="main">::</span><span class="quoted">int</span> <span class="keyword2"><span class="keyword">where</span></span> 
    AB_eq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> real_of_int <span class="main">(</span><span class="free">b</span> <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> real_of_int <span class="main">(</span>prod <span class="free">a</span> <span class="main">{..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">A</span> <span class="main">/</span> <span class="skolem">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">q</span></span><span class="main">::</span><span class="quoted">rat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> real_of_int <span class="main">(</span><span class="free">b</span> <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> real_of_int <span class="main">(</span>prod <span class="free">a</span> <span class="main">{..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> real_of_rat <span class="skolem">q</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ab_rational <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Rats_cases<span class="main">)</span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span><span class="main">::</span><span class="quoted">int</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">B</span></span><span class="main">::</span><span class="quoted">int</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">=</span> Rat.Fract <span class="skolem">A</span> <span class="skolem">B</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"coprime <span class="skolem">A</span> <span class="skolem">B</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Rat_cases<span class="main">)</span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> that<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="skolem">A</span></span> <span class="quoted"><span class="skolem">B</span></span><span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>of_rat_rat<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>  
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">≡</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">/</span> real_of_int <span class="main">(</span>prod <span class="free">a</span> <span class="main">{..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">R</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span> <span class="main">≡</span> <span class="main">(</span><span class="main">λ</span><span class="bound">N</span><span class="main">.</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">B</span><span class="main">*</span><span class="free">b</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="bound">N</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{</span><span class="bound">N</span><span class="main">..</span><span class="bound">n</span><span class="main">+</span><span class="bound">N</span><span class="main">+</span><span class="main">1</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> all_e_ubound<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">e</span></span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">M</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="main">¦</span><span class="skolem">B</span><span class="main">*</span><span class="free">b</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="bound">M</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{</span><span class="bound">M</span><span class="main">..</span><span class="bound">n</span><span class="main">+</span><span class="bound">M</span><span class="main">+</span><span class="main">1</span><span class="main">}</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="bound">e</span><span class="main">/</span><span class="numeral">4</span> <span class="main">*</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">^</span><span class="bound">n</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">safe</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">e</span><span class="main">::</span><span class="quoted">real</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">e</span><span class="main">&gt;</span><span class="main">0</span>"</span></span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N</span></span> <span class="keyword2"><span class="keyword">where</span></span> N_a2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n</span></span> <span class="main">≥</span> <span class="skolem">N</span><span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">≥</span> <span class="numeral">2</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> N_ba<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n</span></span> <span class="main">≥</span> <span class="skolem">N</span><span class="main">.</span> <span class="main">¦</span><span class="free">b</span> <span class="bound">n</span><span class="main">¦</span> <span class="main">/</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span>  <span class="main">&lt;</span> <span class="skolem">e</span><span class="main">/</span><span class="main">(</span><span class="numeral">4</span><span class="main">*</span><span class="skolem">B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">¦</span><span class="free">b</span> <span class="bound">n</span><span class="main">¦</span> <span class="main">/</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="bound">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">e</span><span class="main">/</span><span class="main">(</span><span class="numeral">4</span><span class="main">*</span><span class="skolem">B</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> order_topology_class.order_tendstoD<span class="main">[</span><span class="operator">OF</span> ab_tendsto<span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="skolem"><span class="skolem">e</span></span><span class="main"><span class="main">/</span></span><span class="main"><span class="main">(</span></span><span class="numeral"><span class="numeral">4</span></span><span class="main"><span class="main">*</span></span><span class="skolem"><span class="skolem">B</span></span><span class="main"><span class="main">)</span></span>"</span></span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span><span class="main">&gt;</span><span class="main">0</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">≥</span> <span class="numeral">2</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> a_large <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> eventually_mono<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">¦</span><span class="free">b</span> <span class="bound">n</span><span class="main">¦</span> <span class="main">/</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="bound">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">e</span><span class="main">/</span><span class="main">(</span><span class="numeral">4</span><span class="main">*</span><span class="skolem">B</span><span class="main">)</span> <span class="main">∧</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">≥</span> <span class="numeral">2</span>"</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> eventually_at_top_linorder <span class="keyword1"><span class="command">using</span></span> that
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> geq_N_bound<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="skolem">B</span><span class="main">*</span><span class="free">b</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">M</span><span class="main">..</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">+</span><span class="main">1</span><span class="main">}</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">e</span><span class="main">/</span><span class="numeral">4</span> <span class="main">*</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">^</span><span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">when</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span><span class="main">≥</span><span class="skolem">N</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span> <span class="skolem">M</span>   
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">D</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">=</span> <span class="skolem">B</span><span class="main">*</span><span class="free">b</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">/</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="skolem">B</span><span class="main">*</span><span class="free">b</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">M</span><span class="main">..</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">+</span><span class="main">1</span><span class="main">}</span><span class="main">¦</span> <span class="main">=</span> <span class="main">¦</span><span class="skolem">D</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">M</span><span class="main">..&lt;</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">}</span><span class="main">¦</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">M</span><span class="main">..</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">+</span><span class="main">1</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">M</span><span class="main">..&lt;</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">,</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">+</span><span class="main">1</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"prod <span class="free">a</span> <span class="main">{</span><span class="skolem">M</span><span class="main">..</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">+</span><span class="main">1</span><span class="main">}</span> <span class="main">=</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">*</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">M</span><span class="main">..&lt;</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> D_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">&lt;</span>  <span class="main">¦</span><span class="skolem">e</span><span class="main">/</span><span class="numeral">4</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span>prod <span class="free">a</span> <span class="main">{</span><span class="skolem">M</span><span class="main">..&lt;</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">}</span><span class="main">)</span><span class="main">¦</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="skolem">D</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">e</span><span class="main">/</span><span class="numeral">4</span>"</span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span> D_def <span class="keyword1"><span class="command">using</span></span> N_ba<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">+</span><span class="main">1</span>"</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">M</span> <span class="main">≥</span> <span class="skolem">N</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> a_pos
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span> abs_mult abs_of_pos<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> mult_strict_right_mono<span class="main">[</span><span class="operator">OF</span> this<span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span>prod <span class="free">a</span> <span class="main">{</span><span class="skolem">M</span><span class="main">..&lt;</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">}</span>"</span></span><span class="main">]</span> a_pos <span class="quoted"><span class="quoted">‹<span class="skolem">e</span><span class="main">&gt;</span><span class="main">0</span>›</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>abs_prod abs_mult prod_pos<span class="main">)</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> abs_of_pos<span class="main"><span class="keyword3">,</span></span><span class="operator">auto</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">e</span><span class="main">/</span><span class="numeral">4</span> <span class="main">*</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">^</span><span class="skolem">n</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"prod <span class="free">a</span> <span class="main">{</span><span class="skolem">M</span><span class="main">..&lt;</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">}</span> <span class="main">≥</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">n</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">case</span></span> 0
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> 
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">M</span><span class="main">≥</span><span class="skolem">N</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> N_a2 mult.commute mult_mono' prod.atLeastLessThan_Suc<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"real_of_int <span class="main">(</span>prod <span class="free">a</span> <span class="main">{</span><span class="skolem">M</span><span class="main">..&lt;</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">}</span><span class="main">)</span> <span class="main">≥</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">n</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> numeral_power_le_of_int_cancel_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">M</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="main">¦</span>real_of_int <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="bound">M</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> 
                <span class="main">/</span> real_of_int <span class="main">(</span>prod <span class="free">a</span> <span class="main">{</span><span class="bound">M</span><span class="main">..</span><span class="bound">n</span> <span class="main">+</span> <span class="bound">M</span> <span class="main">+</span> <span class="main">1</span><span class="main">}</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">e</span> <span class="main">/</span> <span class="numeral">4</span> <span class="main">*</span> <span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">^</span> <span class="bound">n</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> eventually_sequentiallyI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="skolem">N</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> geq_N_bound <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> R_tendsto_0<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">R</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> tendstoI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">e</span><span class="main">::</span><span class="quoted">real</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">e</span><span class="main">&gt;</span><span class="main">0</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> dist <span class="main">(</span><span class="skolem">R</span> <span class="bound">x</span><span class="main">)</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">e</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> all_e_ubound<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span><span class="main">&gt;</span><span class="main">0</span>›</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">eventually_elim</span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>elim <span class="skolem">M</span><span class="main">)</span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">B</span><span class="main">*</span><span class="free">b</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">M</span><span class="main">..</span><span class="bound">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">+</span><span class="main">1</span><span class="main">}</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> g_lt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="skolem">g</span> <span class="skolem">n</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">e</span><span class="main">/</span><span class="numeral">4</span> <span class="main">*</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">^</span><span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
        <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">unfolding</span></span> g_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> §<span class="main">:</span> <span class="quoted"><span class="quoted">"summable <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="skolem">e</span><span class="main">/</span><span class="numeral">4</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span><span class="main">^</span><span class="bound">n</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> g_abs_summable<span class="main">:</span><span class="quoted"><span class="quoted">"summable <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">¦</span><span class="skolem">g</span> <span class="bound">n</span><span class="main">¦</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> summable_comparison_test'<span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> abs_idempotent g_lt less_eq_real_def power_one_over real_norm_def times_divide_eq_right<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">g</span> <span class="bound">n</span><span class="main">¦</span> <span class="main">≤</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="main">¦</span><span class="skolem">g</span> <span class="bound">n</span><span class="main">¦</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> summable_rabs<span class="main"><span class="main">[</span></span><span class="operator">OF</span> g_abs_summable<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span><span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">e</span><span class="main">/</span><span class="numeral">4</span> <span class="main">*</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">^</span><span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> suminf_comparison<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"summable <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">e</span><span class="main">/</span><span class="numeral">4</span> <span class="main">*</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">^</span><span class="bound">n</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> § <span class="keyword1"><span class="command">unfolding</span></span> power_divide <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> norm <span class="main">¦</span><span class="skolem">g</span> <span class="bound">n</span><span class="main">¦</span> <span class="main">≤</span> <span class="skolem">e</span> <span class="main">/</span> <span class="numeral">4</span> <span class="main">*</span> <span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">^</span> <span class="bound">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> g_lt less_eq_real_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">e</span><span class="main">/</span><span class="numeral">4</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span><span class="main">^</span><span class="bound">n</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> suminf_mult<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
         <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span> power_divide<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">e</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>suminf_geometric<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">g</span> <span class="bound">n</span><span class="main">¦</span> <span class="main">≤</span> <span class="skolem">e</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"dist <span class="main">(</span><span class="skolem">R</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">e</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> R_def g_def <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N</span></span> <span class="keyword2"><span class="keyword">where</span></span> R_N_bound<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">M</span></span> <span class="main">≥</span> <span class="skolem">N</span><span class="main">.</span> <span class="main">¦</span><span class="skolem">R</span> <span class="bound">M</span><span class="main">¦</span> <span class="main">≤</span>  <span class="main">1</span> <span class="main">/</span> <span class="numeral">4</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> N_geometric<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">M</span></span><span class="main">≥</span><span class="skolem">N</span><span class="main">.</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="main">¦</span>real_of_int <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="bound">M</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span>prod <span class="free">a</span> <span class="main">{</span><span class="bound">M</span><span class="main">..</span><span class="bound">n</span> <span class="main">+</span> <span class="bound">M</span> <span class="main">+</span> <span class="main">1</span><span class="main">}</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">^</span> <span class="bound">n</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N1</span></span> <span class="keyword2"><span class="keyword">where</span></span> N1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">M</span></span> <span class="main">≥</span> <span class="skolem">N1</span><span class="main">.</span> <span class="main">¦</span><span class="skolem">R</span> <span class="bound">M</span><span class="main">¦</span> <span class="main">≤</span>  <span class="main">1</span> <span class="main">/</span> <span class="numeral">4</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> metric_LIMSEQ_D<span class="main">[</span><span class="operator">OF</span> R_tendsto_0<span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="numeral">4</span>"</span></span><span class="main">]</span> all_e_ubound<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="numeral">4</span></span><span class="main">,</span><span class="operator">unfolded</span> eventually_sequentially<span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>less_eq_real_def<span class="main">)</span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N2</span></span> <span class="keyword2"><span class="keyword">where</span></span> N2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">M</span></span><span class="main">≥</span><span class="skolem">N2</span><span class="main">.</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="main">¦</span>real_of_int <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="bound">M</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> 
                          <span class="main">/</span> <span class="main">(</span>prod <span class="free">a</span> <span class="main">{</span><span class="bound">M</span><span class="main">..</span><span class="bound">n</span> <span class="main">+</span> <span class="bound">M</span> <span class="main">+</span> <span class="main">1</span><span class="main">}</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">^</span> <span class="bound">n</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> all_e_ubound<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="numeral">4</span></span><span class="main">,</span><span class="operator">unfolded</span> eventually_sequentially<span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>less_eq_real_def<span class="main">)</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">N</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">N</span><span class="main">=</span>max <span class="skolem">N1</span> <span class="skolem">N2</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> that<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">N</span></span><span class="main">]</span> N1 N2 <span class="keyword1"><span class="command">unfolding</span></span> N_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> <span class="skolem">B</span> <span class="main">*</span> prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">*</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">&lt;</span><span class="skolem">N</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"summable <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">using</span></span> aux_series_summable <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">*</span> prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">=</span> <span class="skolem">C</span> <span class="main">+</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">N</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">N</span>  <span class="main">+</span> <span class="skolem">R</span> <span class="skolem">N</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">*</span> prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">=</span> <span class="skolem">B</span> <span class="main">*</span> prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">*</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> AB_eq f_def <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">B</span> <span class="main">*</span> prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">&lt;</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">f</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> suminf_split_initial_segment<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹summable <span class="skolem">f</span>›</span></span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="skolem">N</span><span class="main">+</span><span class="main">1</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">B</span> <span class="main">*</span> prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">&lt;</span><span class="skolem">N</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">+</span> <span class="skolem">f</span> <span class="skolem">N</span> <span class="main">+</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">f</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> sum.atLeast0_lessThan_Suc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">C</span> <span class="main">+</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">N</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">N</span> <span class="main">+</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">B</span><span class="main">*</span><span class="free">b</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..</span><span class="bound">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">*</span> <span class="skolem">f</span> <span class="skolem">N</span> <span class="main">=</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">N</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">N</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{..</span><span class="skolem">N</span><span class="main">}</span> <span class="main">=</span>  <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">N</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ivl_disj_un_singleton<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">*</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">f</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">B</span><span class="main">*</span><span class="free">b</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..</span><span class="bound">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">}</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"summable <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">f</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="skolem">N</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹summable <span class="skolem">f</span>›</span></span> summable_iff_shift<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">f</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">N</span><span class="main">+</span><span class="main">1</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">*</span> <span class="skolem">f</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">N</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="free">b</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">N</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">N</span> <span class="main">+</span> <span class="main">1</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{..</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">N</span> <span class="main">+</span> <span class="main">1</span><span class="main">}</span> <span class="main">=</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">N</span> <span class="main">+</span> <span class="main">1</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
            <span class="keyword1"><span class="command">unfolding</span></span> f_def
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> prod.union_disjoint<span class="main">)</span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> suminf_mult<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult.commute mult.left_commute<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> C_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">C</span> <span class="main">+</span><span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">N</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">N</span>  <span class="main">+</span> <span class="skolem">R</span> <span class="skolem">N</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> R_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> R_bound<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="skolem">R</span> <span class="skolem">M</span><span class="main">¦</span> <span class="main">≤</span> <span class="main">1</span> <span class="main">/</span> <span class="numeral">4</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> R_Suc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">R</span> <span class="main">(</span>Suc <span class="skolem">M</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span> <span class="skolem">M</span> <span class="main">*</span> <span class="skolem">R</span> <span class="skolem">M</span> <span class="main">-</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="main">(</span>Suc <span class="skolem">M</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="main">(</span>Suc <span class="skolem">M</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">when</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span> <span class="main">≥</span> <span class="skolem">N</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">M</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">B</span><span class="main">*</span><span class="free">b</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">M</span><span class="main">..</span><span class="bound">n</span><span class="main">+</span><span class="skolem">M</span><span class="main">+</span><span class="main">1</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> g_abs_summable<span class="main">:</span><span class="quoted"><span class="quoted">"summable <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">¦</span><span class="skolem">g</span> <span class="bound">n</span><span class="main">¦</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"summable <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">::</span>real<span class="main">)</span> <span class="main">^</span> <span class="bound">n</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="skolem">g</span> <span class="skolem">n</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">^</span><span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
        <span class="keyword1"><span class="command">using</span></span> N_geometric<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">OF</span> that<span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> g_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> summable_comparison_test'<span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> less_eq_real_def power_one_over<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="skolem">R</span> <span class="skolem">M</span><span class="main">¦</span> <span class="main">≤</span> <span class="main">1</span> <span class="main">/</span> <span class="numeral">4</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> R_N_bound<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">OF</span> that<span class="main">]</span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span> <span class="skolem">M</span> <span class="main">=</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">g</span> <span class="bound">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> R_def g_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">g</span> <span class="main">0</span> <span class="main">+</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">g</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> suminf_split_head<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> summable_rabs_cancel<span class="main">[</span><span class="operator">OF</span> g_abs_summable<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">g</span> <span class="main">0</span> <span class="main">+</span> <span class="main">1</span><span class="main">/</span><span class="free">a</span> <span class="skolem">M</span> <span class="main">*</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="skolem">M</span> <span class="main">*</span> <span class="skolem">g</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> suminf_mult<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_abs_summable summable_Suc_iff summable_rabs_cancel<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">g</span> <span class="main">0</span> <span class="main">+</span> <span class="main">1</span><span class="main">/</span><span class="free">a</span> <span class="skolem">M</span> <span class="main">*</span> <span class="skolem">R</span> <span class="main">(</span>Suc <span class="skolem">M</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="skolem">M</span> <span class="main">*</span> <span class="skolem">g</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">M</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{</span>Suc <span class="skolem">M</span><span class="main">..</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">M</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">M</span><span class="main">..</span>Suc <span class="main">(</span>Suc <span class="main">(</span><span class="skolem">M</span> <span class="main">+</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">M</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span>Suc <span class="skolem">M</span><span class="main">..</span>Suc <span class="main">(</span>Suc <span class="main">(</span><span class="skolem">M</span> <span class="main">+</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span> g_def <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="skolem">M</span> <span class="main">*</span> <span class="skolem">g</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">R</span> <span class="main">(</span>Suc <span class="skolem">M</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> R_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span> <span class="skolem">M</span> <span class="main">=</span> <span class="skolem">g</span> <span class="main">0</span> <span class="main">+</span> <span class="main">1</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">M</span> <span class="main">*</span> <span class="skolem">R</span> <span class="main">(</span>Suc <span class="skolem">M</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span> <span class="main">(</span>Suc <span class="skolem">M</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span> <span class="skolem">M</span> <span class="main">*</span> <span class="skolem">R</span> <span class="skolem">M</span> <span class="main">-</span> <span class="skolem">g</span> <span class="main">0</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">M</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">M</span><span class="main">..</span>Suc <span class="skolem">M</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">M</span><span class="main">,</span>Suc <span class="skolem">M</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span> <span class="main">(</span>Suc <span class="skolem">M</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span> <span class="skolem">M</span> <span class="main">*</span> <span class="skolem">R</span> <span class="skolem">M</span> <span class="main">-</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="main">(</span>Suc <span class="skolem">M</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="main">(</span>Suc <span class="skolem">M</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> g_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">if</span> <span class="bound">n</span><span class="main">≥</span><span class="skolem">N</span> <span class="keyword1">then</span> get_c <span class="free">a</span> <span class="free">b</span> <span class="skolem">B</span> <span class="skolem">N</span> <span class="main">(</span><span class="bound">n</span><span class="main">-</span><span class="skolem">N</span><span class="main">)</span> <span class="keyword1">else</span> undefined<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> c_rec<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span>  <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">when</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">≥</span> <span class="skolem">N</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">unfolding</span></span> c_def <span class="keyword1"><span class="command">using</span></span> that <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>Suc_diff_le<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> c_R<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">=</span> <span class="skolem">R</span> <span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">when</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">≥</span> <span class="skolem">N</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">using</span></span> that
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>nat_induct_at_least<span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> base
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">N</span> <span class="main">¦</span> <span class="main">≤</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">N</span> <span class="main">=</span> round <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">N</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">N</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> c_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">N</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">N</span> <span class="main">-</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">N</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">N</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">N</span></span><span class="main">]</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>c_rec<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="skolem">N</span></span><span class="main"><span class="main">,</span></span><span class="operator">simplified</span><span class="main"><span class="main">]</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> of_int_round_abs_le <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>        
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="skolem">R</span> <span class="skolem">N</span><span class="main">¦</span> <span class="main">≤</span> <span class="main">1</span> <span class="main">/</span> <span class="numeral">4</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> R_bound<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">N</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">N</span> <span class="main">-</span> <span class="skolem">R</span> <span class="skolem">N</span> <span class="main">¦</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">N</span> <span class="main">-</span> <span class="skolem">R</span> <span class="skolem">N</span> <span class="main">∈</span> <span class="main">ℤ</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">N</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">N</span> <span class="main">-</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">N</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">N</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">N</span></span><span class="main">]</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>c_rec<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="skolem">N</span></span><span class="main"><span class="main">,</span></span><span class="operator">simplified</span><span class="main"><span class="main">]</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">" <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">N</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">N</span> <span class="main">+</span> <span class="skolem">R</span> <span class="skolem">N</span> <span class="main">∈</span> <span class="main">ℤ</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> <span class="skolem">B</span> <span class="main">*</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">&lt;</span><span class="skolem">N</span><span class="main">.</span> prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">*</span> <span class="main">(</span><span class="free">b</span> <span class="bound">n</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">unfolding</span></span> C_def f_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>sum_distrib_left <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">B</span> <span class="main">*</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">&lt;</span><span class="skolem">N</span><span class="main">.</span> prod <span class="free">a</span> <span class="main">{</span><span class="bound">n</span><span class="main">&lt;..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">*</span> <span class="free">b</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">n</span><span class="main">&lt;..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{..</span><span class="skolem">n</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">&lt;</span><span class="skolem">N</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ivl_disj_un_one<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> sup_commute that<span class="main">)</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> 
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> prod.union_disjoint<span class="main">)</span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> real_of_int <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">&lt;</span><span class="skolem">N</span><span class="main">.</span> prod <span class="free">a</span> <span class="main">{</span><span class="bound">n</span><span class="main">&lt;..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">*</span> <span class="free">b</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="main">ℤ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Ints_of_int <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">*</span> prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">=</span> <span class="skolem">C</span> <span class="main">+</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">N</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">N</span>  <span class="main">+</span> <span class="skolem">R</span> <span class="skolem">N</span>›</span></span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Ints_diff Ints_of_int add.assoc add_diff_cancel_left'<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> diff_diff_add<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">N</span> <span class="main">-</span> <span class="skolem">R</span> <span class="skolem">N</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Ints_cases less_irrefl of_int_0 of_int_lessD<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> c_rec<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">n</span>"</span></span><span class="main"><span class="main">,</span></span><span class="operator">simplified</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">N</span> <span class="main">≤</span> <span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">*</span> <span class="skolem">R</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>"</span></span>  
      <span class="keyword1"><span class="command">using</span></span> Suc <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">R</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> R_Suc<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">N</span> <span class="main">≤</span> <span class="skolem">n</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">finally</span></span>  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> ca_tendsto_zero<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> R_tendsto_0 
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> filterlim_mono_eventually<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> c_R <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>eventually_sequentiallyI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="skolem">N</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> ca_bound<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span> <span class="keyword2"><span class="keyword">when</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">≥</span> <span class="skolem">N</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">¦</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">n</span>  <span class="main">=</span> <span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">n</span><span class="main">¦</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">¦</span><span class="skolem">R</span> <span class="skolem">n</span><span class="main">¦</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> c_R<span class="main">[</span><span class="operator">OF</span> that<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> R_bound<span class="main">[</span><span class="operator">OF</span> that<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">¦</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(* (* the following part corresponds to (2.7) (2.8) in the original paper, but turns out to be
        not necessary. *)
  have c_round:"c n = round (B * b n / a n)" when "n ≥ N" for n
  proof (cases "n=N")
    case True
    then show ?thesis unfolding c_def by simp
  next
    case False
    with ‹n≥N› obtain n' where n_Suc:"n=Suc n'" and "n' ≥ N" 
      by (metis le_eq_less_or_eq lessE less_imp_le_nat)
    have "B * b n / a n = c n - R n"
    proof -
      have "R n = c n - B * b n / a n"
        using c_R[OF ‹n'≥N›,symmetric,folded n_Suc] R_Suc[OF ‹n'≥N›,folded n_Suc]
        by (auto simp:field_simps)
      then show ?thesis by (auto simp:field_simps)
    qed
    then have "¦B * b n / a n - c n¦ = ¦R n¦" by auto
    then have "¦B * b n / a n - c n¦ &lt; 1/2" using R_bound[OF ‹n ≥ N›] by auto
    from round_unique'[OF this] show ?thesis by auto
  qed
  *)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">B</span></span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∃</span><span class="bound">c</span><span class="main">.</span> <span class="main">(</span><span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="bound">B</span> <span class="main">*</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">=</span> <span class="bound">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="bound">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> 
            <span class="main">∧</span> real_of_int <span class="main">¦</span><span class="bound">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="bound">c</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> eventually_at_top_linorder
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="skolem">B</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span><span class="operator">use</span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> <span class="operator">simp</span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span><span class="quoted"><span class="skolem">c</span></span><span class="main"><span class="main">]</span></span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="skolem">N</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> c_rec ca_bound ca_tendsto_zero 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">private</span></span> <span class="keyword1" id="Irrational_Series_Erdos_Straus-imp_ab_rational"><span class="command">lemma</span></span> imp_ab_rational<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="main">(</span><span class="bound"><span class="bound">B</span></span><span class="main">::</span>int<span class="main">)</span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">c</span><span class="main">::</span>nat<span class="main">⇒</span> int<span class="main">.</span>
              <span class="main">(</span><span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="bound">B</span><span class="main">*</span><span class="free">b</span> <span class="bound">n</span> <span class="main">=</span> <span class="bound">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="bound">c</span><span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¦</span><span class="bound">c</span><span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">¦</span><span class="main">&lt;</span><span class="free">a</span> <span class="bound">n</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">b</span> <span class="bound">n</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">i</span> <span class="main">≤</span> <span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">i</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="main">ℚ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span><span class="main">::</span><span class="quoted">int</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">c</span></span><span class="main">::</span><span class="quoted"><span class="quoted">"nat<span class="main">⇒</span>int"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">N</span></span><span class="main">::</span><span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  
    large_n<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="skolem">N</span><span class="main">.</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">=</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">∧</span> real_of_int <span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">/</span> <span class="numeral">2</span>
                      <span class="main">∧</span> <span class="free">a</span> <span class="bound">n</span><span class="main">≥</span><span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> event1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">=</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> 
              <span class="main">∧</span> real_of_int <span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> eventually_conj<span class="main">[</span><span class="operator">OF</span> event1 a_large<span class="main">,</span><span class="operator">unfolded</span> eventually_at_top_linorder<span class="main">]</span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="skolem">N</span><span class="main">.</span> <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">=</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> 
                        <span class="main">∧</span> real_of_int <span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">∧</span> <span class="numeral">2</span> <span class="main">≤</span> <span class="free">a</span> <span class="bound">n</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> that<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">B</span></span> <span class="quoted"><span class="skolem">N</span></span> <span class="quoted"><span class="skolem">c</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span><span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real_of_int <span class="main">(</span><span class="free">b</span> <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> real_of_int <span class="main">(</span>prod <span class="free">a</span> <span class="main">{..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">S</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">S</span> <span class="main">=</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"summable <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> aux_series_summable<span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span><span class="main">=</span><span class="skolem">B</span><span class="main">*</span>prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">*</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">&lt;</span><span class="skolem">N</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">*</span>prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">*</span> <span class="skolem">S</span> <span class="main">=</span> <span class="skolem">C</span> <span class="main">+</span> real_of_int <span class="main">(</span><span class="skolem">c</span> <span class="skolem">N</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">h1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h1</span> <span class="main">≡</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..</span><span class="bound">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">h2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h2</span> <span class="main">≡</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..</span><span class="bound">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> f_h12<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span><span class="main">*</span><span class="skolem">f</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">h1</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g1</span> <span class="main">≡</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g2</span> <span class="main">≡</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{..</span><span class="bound">n</span> <span class="main">+</span> <span class="skolem">N</span><span class="main">}</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span><span class="main">*</span><span class="skolem">f</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">g1</span> <span class="skolem">n</span> <span class="main">*</span> <span class="skolem">g2</span> <span class="skolem">n</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> f_def g1_def g2_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g1</span> <span class="skolem">n</span> <span class="main">=</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> large_n<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> g1_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g2</span> <span class="skolem">n</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span>prod <span class="free">a</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">}</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"prod <span class="free">a</span> <span class="main">(</span><span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">N</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">*</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">N</span><span class="main">}</span>"</span></span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> prod.union_disjoint<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">N</span><span class="main">..</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">}</span>"</span></span> <span class="quoted"><span class="free">a</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"prod <span class="free">a</span> <span class="main">(</span><span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">N</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> prod <span class="free">a</span> <span class="main">{..</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">}</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ivl_disj_un_one<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span> g2_def
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">using</span></span> a_pos <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> less_irrefl<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">*</span>prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span><span class="main">*</span><span class="skolem">f</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">h1</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="skolem">n</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> h1_def h2_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span> diff_divide_distrib<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">*</span>prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">*</span> <span class="skolem">S</span> <span class="main">=</span> <span class="skolem">B</span><span class="main">*</span>prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">&lt;</span><span class="skolem">N</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">f</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> suminf_split_initial_segment<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹summable <span class="skolem">f</span>›</span></span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">N</span></span><span class="main">]</span> 
      <span class="keyword1"><span class="command">unfolding</span></span> S_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">C</span> <span class="main">+</span> <span class="skolem">B</span><span class="main">*</span>prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span><span class="main">*</span><span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">f</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> C_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">C</span> <span class="main">+</span> <span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">h1</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> suminf_mult<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹summable <span class="skolem">f</span>›</span></span> f_h12 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">C</span> <span class="main">+</span> <span class="skolem">h1</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">∑</span><span class="bound">i</span><span class="main">≤</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">h1</span> <span class="bound">i</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="bound">i</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="main">∑</span><span class="bound">i</span><span class="main">.</span> <span class="skolem">h1</span> <span class="bound">i</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="bound">i</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> summable_LIMSEQ'<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">i</span><span class="main">.</span> <span class="skolem">h1</span> <span class="bound">i</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="bound">i</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">i</span><span class="main">.</span>  real_of_int <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">f</span> <span class="main">(</span><span class="bound">i</span> <span class="main">+</span> <span class="skolem">N</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> f_h12 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"summable <span class="main">(</span><span class="main">λ</span><span class="bound">i</span><span class="main">.</span> <span class="skolem">h1</span> <span class="bound">i</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="bound">i</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹summable <span class="skolem">f</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> summable_mult<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∑</span><span class="bound">i</span><span class="main">≤</span><span class="skolem">n</span><span class="main">.</span> <span class="skolem">h1</span> <span class="bound">i</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="bound">i</span><span class="main">)</span>  <span class="main">=</span> <span class="skolem">h1</span> <span class="main">0</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">case</span></span> 0
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∑</span><span class="bound">i</span><span class="main">≤</span>Suc <span class="skolem">n</span><span class="main">.</span> <span class="skolem">h1</span> <span class="bound">i</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="bound">i</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∑</span><span class="bound">i</span><span class="main">≤</span><span class="skolem">n</span><span class="main">.</span> <span class="skolem">h1</span> <span class="bound">i</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="bound">i</span><span class="main">)</span> <span class="main">+</span> <span class="skolem">h1</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span>  <span class="skolem">h1</span> <span class="main">0</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="skolem">n</span> <span class="main">+</span> <span class="skolem">h1</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Suc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">h1</span> <span class="main">0</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h2</span> <span class="skolem">n</span> <span class="main">=</span> <span class="skolem">h1</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">unfolding</span></span> h2_def h1_def 
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>prod.nat_ivl_Suc'<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> a_pos <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> less_numeral_extra<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">h1</span> <span class="main">0</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="main">∑</span><span class="bound">i</span><span class="main">.</span> <span class="skolem">h1</span> <span class="bound">i</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="bound">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h2</span> <span class="main">⇢</span> <span class="main">(</span><span class="skolem">h1</span> <span class="main">0</span> <span class="main">-</span>  <span class="main">(</span><span class="main">∑</span><span class="bound">i</span><span class="main">.</span> <span class="skolem">h1</span> <span class="bound">i</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="bound">i</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> metric_tendsto_imp_tendsto<span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>eventuallyI <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>dist_real_def<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h2</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> h2_n<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="skolem">h2</span> <span class="skolem">n</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span><span class="main">^</span><span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span> 
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="skolem">h2</span> <span class="skolem">n</span><span class="main">¦</span> <span class="main">=</span> <span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">N</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">¦</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">N</span><span class="main">}</span>"</span></span>
            <span class="keyword1"><span class="command">unfolding</span></span> h2_def abs_divide
            <span class="keyword1"><span class="command">using</span></span> a_pos <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> abs_of_pos prod_pos<span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="skolem">N</span><span class="main">+</span><span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">/</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">N</span><span class="main">}</span>"</span></span>
            <span class="keyword1"><span class="command">unfolding</span></span> h2_def
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> divide_strict_right_mono<span class="main">)</span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> large_n<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="skolem">N</span><span class="main">+</span><span class="skolem">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> a_pos <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> prod_pos<span class="main">)</span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span>prod <span class="free">a</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..&lt;</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">N</span><span class="main">}</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> ivl_disj_un<span class="main"><span class="main">(</span></span>6<span class="main"><span class="main">)</span></span><span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="skolem">N</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span>"</span></span><span class="main"><span class="main">,</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="skolem">N</span><span class="main">+</span><span class="skolem">n</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span><span class="main">^</span><span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span>
            <span class="keyword3"><span class="command">case</span></span> 0
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>
            <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">P</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">=</span><span class="main">1</span> <span class="main">/</span> real_of_int <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..&lt;</span><span class="skolem">n</span> <span class="main">+</span> <span class="skolem">N</span><span class="main">}</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">/</span> real_of_int <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> prod <span class="free">a</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..&lt;</span>Suc <span class="skolem">n</span> <span class="main">+</span> <span class="skolem">N</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">P</span> <span class="main">/</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">unfolding</span></span> P_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> prod.atLeastLessThan_Suc<span class="main">)</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span>  <span class="main">(</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">^</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span><span class="main">)</span> "</span></span>
              <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> divide_right_mono<span class="main">)</span>
              <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> P_def <span class="keyword1"><span class="command">using</span></span> Suc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> a_pos less_imp_le<span class="main">)</span>
              <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">^</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span> "</span></span>
              <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> divide_left_mono<span class="main">)</span>
              <span class="keyword1"><span class="command">using</span></span> large_n<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">+</span><span class="skolem">N</span>"</span></span><span class="main">,</span><span class="operator">simplified</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">^</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span><span class="main">^</span><span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="main">0</span><span class="main">::</span>real<span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> tendsto_mult_right_zero<span class="main">[</span><span class="operator">OF</span> LIMSEQ_abs_realpow_zero2<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span><span class="main"><span class="main">,</span></span><span class="operator">simplified</span><span class="main"><span class="main">]</span></span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span><span class="main">]</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> Lim_null_comparison<span class="main"><span class="main">[</span></span><span class="operator">rotated</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">using</span></span> h2_n less_eq_real_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>eventuallyI<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∑</span><span class="bound">i</span><span class="main">.</span> <span class="skolem">h1</span> <span class="bound">i</span> <span class="main">-</span> <span class="skolem">h2</span> <span class="bound">i</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">h1</span> <span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> LIMSEQ_unique <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">C</span> <span class="main">+</span> <span class="skolem">c</span> <span class="skolem">N</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> h1_def <span class="keyword1"><span class="command">using</span></span> a_pos 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> less_irrefl<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span> 
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">S</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">C</span> <span class="main">+</span> real_of_int <span class="main">(</span><span class="skolem">c</span> <span class="skolem">N</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span><span class="main">*</span>prod <span class="free">a</span> <span class="main">{..&lt;</span><span class="skolem">N</span><span class="main">}</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">B</span>›</span></span> a_pos less_irrefl mult.commute mult_pos_pos 
        nonzero_mult_div_cancel_right of_int_eq_0_iff prod_pos<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">∈</span> <span class="main">ℚ</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> C_def f_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> Rats_divide Rats_add Rats_mult Rats_of_int Rats_sum<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">S</span> <span class="main">∈</span> <span class="main">ℚ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> theorem_2_1_Erdos_Straus <span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">b</span> <span class="bound">n</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">i</span> <span class="main">≤</span> <span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">i</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="main">ℚ</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span> <span class="main">(</span><span class="bound"><span class="bound">B</span></span><span class="main">::</span>int<span class="main">)</span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">c</span><span class="main">::</span>nat<span class="main">⇒</span> int<span class="main">.</span>
            <span class="main">(</span><span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="bound">B</span><span class="main">*</span><span class="free">b</span> <span class="bound">n</span> <span class="main">=</span> <span class="bound">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="bound">c</span><span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¦</span><span class="bound">c</span><span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">¦</span><span class="main">&lt;</span><span class="free">a</span> <span class="bound">n</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ab_rationality_imp imp_ab_rational <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The following is a Corollary to Theorem 2.1.  ›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> corollary_2_10_Erdos_Straus<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> ab_event<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">∧</span> <span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≥</span> <span class="free">a</span> <span class="bound">n</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> ba_lim_leq<span class="main">:</span><span class="quoted"><span class="quoted">"lim <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">)</span><span class="main">/</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> ba_lim_exist<span class="main">:</span><span class="quoted"><span class="quoted">"convergent <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">)</span><span class="main">/</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"liminf <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">/</span> <span class="free">b</span> <span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> "</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">b</span> <span class="bound">n</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">i</span> <span class="main">≤</span> <span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">i</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∉</span> <span class="main">ℚ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">b</span> <span class="bound">n</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">i</span> <span class="main">≤</span> <span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">i</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="main">ℚ</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> abc_event<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">=</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> 
          <span class="main">∧</span> <span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ca_vanish<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ab_rationality_imp <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">have</span></span> bac_close<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">+</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> abc_event <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>eventually_mono<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">+</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">=</span> <span class="main">0</span> "</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">eventually_elim</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="bound">n</span>  <span class="main">+</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">eventually_elim</span>
      <span class="keyword1"><span class="command">using</span></span> a_pos <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> less_irrefl<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="bound">n</span>  <span class="main">+</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eventually_mono tendsto_iff<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> tendsto_diff<span class="main">[</span><span class="operator">OF</span> this ca_vanish<span class="main">]</span>  
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">have</span></span> c_pos<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> bac_close <span class="keyword1"><span class="command">have</span></span> *<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> tendsto_of_int_diff_0<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> ab_event a_large <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">eventually_elim</span><span class="main">)</span> 
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">0</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span> <span class="main">≥</span> <span class="main">0</span> <span class="main">∧</span> <span class="skolem">c</span> <span class="bound">n</span><span class="main">≥</span><span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> * eventually_sequentially_Suc<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span><span class="main">≥</span><span class="main">0</span>"</span></span><span class="main">]</span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> eventually_at_top_linorder le_Suc_eq<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∧</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> eventually_elim2 frequently_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">∧</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">=</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> ab_event abc_event <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∧</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span> <span class="main">≥</span> <span class="main">0</span> <span class="main">∧</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">0</span> 
                          <span class="main">∧</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">=</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> frequently_eventually_frequently <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">from</span></span> frequently_ex<span class="main">[</span><span class="operator">OF</span> this<span class="main">]</span> 
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="skolem">n</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> 
        <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">n</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">n</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">b</span> <span class="skolem">n</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> mult_pos_pos not_le <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">have</span></span> bc_epsilon<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">b</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">&gt;</span>  <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="bound">n</span>"</span></span> <span class="keyword2"><span class="keyword">when</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε</span><span class="main">&lt;</span><span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">ε</span><span class="main">::</span><span class="quoted">real</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">x</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">x</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">ε</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ca_vanish<span class="main">[</span><span class="operator">unfolded</span> tendsto_iff<span class="main">,</span><span class="operator">rule_format</span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="skolem">ε</span><span class="main">/</span><span class="numeral">2</span>"</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">then</span></span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="numeral">2</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">ε</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> eventually_sequentially_Suc<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> abc_event
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> eventually_sequentially_Suc<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>eventually_mono<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">∧</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">∧</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="numeral">2</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> c_pos <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> eventually_sequentially_Suc<span class="main">)</span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">then</span></span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> c_pos <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> eventually_sequentially_Suc<span class="main">)</span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> c_pos <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> ab_event abc_event 
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">eventually_elim</span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>elim <span class="skolem">n</span><span class="main">)</span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span></span> <span class="skolem"><span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">=</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">=</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="numeral">2</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">&lt;</span> <span class="skolem">ε</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">&lt;</span> <span class="skolem">ε</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a_pos elim <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ε<span class="hidden">⇩</span><sub>0</sub>_def ε<span class="hidden">⇩</span><sub>1</sub>_def<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">ε</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="main">*</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> mult_pos_pos<span class="main">)</span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">&lt;</span> <span class="skolem">ε</span><span class="main">/</span><span class="numeral">2</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> elim <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> mult_pos_pos<span class="main"><span class="main">[</span></span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">using</span></span> elim<span class="main">(</span>4<span class="main">)</span> that<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">ε</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="main">*</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">+</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">&lt;</span> <span class="skolem">ε</span> <span class="main">/</span> <span class="numeral">2</span>›</span></span> elim<span class="main">(</span>4<span class="main">)</span> that<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> elim<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span> <span class="main">-</span>  <span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span> <span class="main">-</span>  <span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span> <span class="main">-</span>  <span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="main">(</span><span class="skolem">ε</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="main">*</span> real_of_int <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> real_of_int <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span>›</span></span> 
              divide_pos_pos elim<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> mult_le_0_iff of_int_less_1_iff that<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> a_pos elim<span class="main">(</span>5<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_cancel_left1 mult_le_cancel_iff2<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">n</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> ε<span class="hidden">⇩</span><sub>0</sub>_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">n</span> <span class="main">=</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span> ε<span class="hidden">⇩</span><sub>1</sub>_def 
          <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">+</span><span class="main">1</span>"</span></span><span class="main">]</span> 
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span>›</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult.commute<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">b</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">b</span> <span class="skolem">n</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">have</span></span> eq_2_11<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">b</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">/</span> <span class="skolem">B</span>"</span></span> 
    <span class="keyword2"><span class="keyword">when</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε</span><span class="main">&lt;</span><span class="main">1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">c</span> <span class="bound">n</span><span class="main">)</span>"</span></span>  <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">ε</span><span class="main">::</span><span class="quoted">real</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">x</span><span class="main">)</span> "</span></span> <span class="keyword1"><span class="command">using</span></span> that<span class="main">(</span>3<span class="main">)</span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>not_eventually frequently_elim1<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">x</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">x</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">ε</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ca_vanish<span class="main">[</span><span class="operator">unfolded</span> tendsto_iff<span class="main">,</span><span class="operator">rule_format</span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="skolem">ε</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">∧</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> c_pos <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> eventually_sequentially_Suc<span class="main">)</span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> c_pos <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>  <span class="keyword1"><span class="command">using</span></span> ab_event abc_event bc_epsilon<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε</span><span class="main">&lt;</span><span class="main">1</span>›</span></span><span class="main">]</span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> frequently_rev_mp<span class="main"><span class="keyword3">,</span></span><span class="operator">eventually_elim</span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>elim <span class="skolem">n</span><span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">ε</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">ε</span> <span class="main">*</span> <span class="skolem">c</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> elim<span class="main">(</span>7<span class="main">)</span> that<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">ε</span> <span class="main">*</span> <span class="skolem">c</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">ε</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">]</span> elim <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="skolem">n</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">/</span> <span class="skolem">B</span> <span class="main">&lt;</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">B</span>"</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> mult_less_iff1<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">,</span></span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span><span class="main">-</span><span class="skolem">ε</span><span class="main">)</span><span class="main">/</span><span class="skolem">B</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε</span><span class="main">&lt;</span><span class="main">1</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> power2_eq_square mult_less_iff1<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="skolem">n</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">/</span> <span class="skolem">B</span> <span class="main">&lt;</span> <span class="free">b</span> <span class="skolem">n</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">B</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">b</span> <span class="skolem">n</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">B</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">b</span> <span class="skolem">n</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">b</span> <span class="skolem">n</span> <span class="main">/</span> <span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">n</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="main">(</span><span class="main">1</span><span class="main">-</span><span class="skolem">ε</span><span class="main">)</span><span class="main">/</span><span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">n</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">-</span><span class="skolem">ε</span><span class="main">)</span><span class="main">/</span><span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">n</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span><span class="skolem">ε</span><span class="main">)</span><span class="main">/</span><span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> <span class="free">b</span> <span class="skolem">n</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">cp</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">cp</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span><span class="main">+</span><span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≥</span> <span class="skolem">cp</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> cp_def <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="skolem">n</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">fold</span> cp_def<span class="main">)</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">&lt;</span> <span class="free">b</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">c</span> <span class="bound">n</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">c</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> eq_2_11<span class="main">[</span><span class="operator">OF</span> _ _ this<span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="numeral">2</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">b</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">/</span><span class="numeral">4</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">/</span> <span class="skolem">B</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span> power2_eq_square<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> *<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">(</span><span class="free">b</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="free">b</span> <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> <span class="numeral">4</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> frequently_elim1<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword2"><span class="keyword">for</span></span> n
        <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">b</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="free">b</span> <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">⇢</span> lim <span class="skolem">f</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> convergent_LIMSEQ_iff ba_lim_exist <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this<span class="main">[</span><span class="operator">unfolded</span> tendsto_iff<span class="main">,</span><span class="operator">rule_format</span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span><span class="main">*</span><span class="numeral">4</span><span class="main">)</span>"</span></span><span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">¦</span><span class="skolem">f</span> <span class="bound">x</span> <span class="main">-</span> lim <span class="skolem">f</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> <span class="numeral">4</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>dist_real_def<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">f</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> <span class="numeral">4</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> * <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">f</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> <span class="numeral">4</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¦</span><span class="skolem">f</span> <span class="bound">n</span> <span class="main">-</span> lim <span class="skolem">f</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> <span class="numeral">4</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>frequently_eventually_frequently<span class="main"><span class="main">[</span></span><span class="operator">rotated</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> frequently_ex<span class="main">[</span><span class="operator">OF</span> this<span class="main">]</span> 
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">n</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> <span class="numeral">4</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="skolem">f</span> <span class="skolem">n</span> <span class="main">-</span> lim <span class="skolem">f</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> <span class="numeral">4</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lim <span class="skolem">f</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ba_lim_leq <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N</span></span> <span class="keyword2"><span class="keyword">where</span></span> N_dec<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="skolem">N</span><span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">c</span> <span class="bound">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> eventually_at_top_linorder<span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">max_c</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">max_c</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">MAX</span> <span class="bound">n</span> <span class="main">∈</span> <span class="main">{..</span><span class="skolem">N</span><span class="main">}</span><span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> max_c<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">≤</span> <span class="skolem">max_c</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">≤</span><span class="skolem">N</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> max_c_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">≥</span><span class="skolem">N</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span><span class="main">≤</span><span class="skolem">c</span> <span class="skolem">N</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span>nat_induct_at_least<span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> base
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">c</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> N_dec <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">≤</span> <span class="skolem">c</span> <span class="skolem">N</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">N</span> <span class="main">≤</span> <span class="skolem">max_c</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> max_c_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">max_c</span> <span class="main">&gt;</span> <span class="main">0</span> "</span></span> 
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="skolem">N</span><span class="main">.</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="bound">n</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> c_pos<span class="main">[</span><span class="operator">unfolded</span> eventually_at_top_linorder<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">N</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> max_c<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">N</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> ba_limsup_bound<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="skolem">B</span><span class="main">*</span><span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> limsup <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">b</span> <span class="bound">n</span><span class="main">/</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span>"</span></span> 
    <span class="quoted"><span class="quoted">"limsup <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">b</span> <span class="bound">n</span><span class="main">/</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">max_c</span> <span class="main">/</span> <span class="skolem">B</span> <span class="main">+</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">b</span> <span class="bound">n</span><span class="main">/</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> tendsto_mult_right_zero<span class="main">[</span><span class="operator">OF</span> bac_close<span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="skolem">B</span>"</span></span><span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">/</span> <span class="skolem">B</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> this<span class="main">[</span><span class="operator">unfolded</span> tendsto_iff<span class="main">,</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">¦</span><span class="skolem">f</span> <span class="bound">x</span> <span class="main">-</span> <span class="skolem">c</span> <span class="bound">x</span> <span class="main">/</span> <span class="skolem">B</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> *<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="skolem">B</span><span class="main">*</span><span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> ereal <span class="main">(</span><span class="skolem">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">∧</span> ereal <span class="main">(</span><span class="skolem">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">max_c</span> <span class="main">/</span> <span class="skolem">B</span> <span class="main">+</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> c_pos
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">eventually_elim</span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>elim <span class="skolem">n</span><span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">/</span> <span class="skolem">B</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">/</span> <span class="skolem">B</span> <span class="main">+</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">max_c</span> <span class="main">/</span> <span class="skolem">B</span> <span class="main">+</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> max_c<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> *<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">max_c</span> <span class="main">/</span> <span class="skolem">B</span> <span class="main">+</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>

      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="skolem">B</span><span class="main">*</span><span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span><span class="skolem">B</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">c</span> <span class="skolem">n</span><span class="main">/</span><span class="skolem">B</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="skolem">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main"><span class="keyword3">,</span></span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">&lt;</span> <span class="skolem">f</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="skolem">B</span><span class="main">*</span><span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">f</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">with</span></span> * <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"limsup <span class="skolem">f</span> <span class="main">≤</span> <span class="skolem">max_c</span> <span class="main">/</span> <span class="skolem">B</span> <span class="main">+</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Limsup_bounded<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> * <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>eventually_mono<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="skolem">B</span><span class="main">*</span><span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> liminf <span class="skolem">f</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Liminf_bounded<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> * <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>eventually_mono<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"liminf <span class="skolem">f</span> <span class="main">≤</span> limsup <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Liminf_le_Limsup<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="skolem">B</span><span class="main">*</span><span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> limsup <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> inverse <span class="main">(</span>ereal <span class="main">(</span><span class="skolem">max_c</span> <span class="main">/</span> <span class="skolem">B</span> <span class="main">+</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">max_c</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pos_add_strict<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> inverse <span class="main">(</span>limsup <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">b</span> <span class="bound">n</span><span class="main">/</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ereal_inverse_antimono<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ ba_limsup_bound<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="skolem">B</span><span class="main">*</span><span class="main">(</span><span class="skolem">B</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> limsup <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">b</span> <span class="bound">n</span><span class="main">/</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ba_limsup_bound<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">≤</span>limsup <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">b</span> <span class="bound">n</span><span class="main">/</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> zero_ereal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span> 
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> liminf <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> inverse <span class="main">(</span>ereal <span class="main">(</span> <span class="free">b</span> <span class="bound">n</span><span class="main">/</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Liminf_inverse_ereal<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> a_pos ab_event <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>eventually_mono <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> liminf <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span> <span class="free">a</span> <span class="bound">n</span><span class="main">/</span><span class="free">b</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Liminf_eq<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> a_pos ab_event 
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>eventually_mono<span class="main">)</span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> less_int_code<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"liminf <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span> <span class="free">a</span> <span class="bound">n</span><span class="main">/</span><span class="free">b</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹liminf <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">/</span> <span class="free">b</span> <span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">‹Some auxiliary results on the prime numbers. ›</span></span>

<span class="keyword1" id="Irrational_Series_Erdos_Straus-nth_prime_nonzero"><span class="command">lemma</span></span> nth_prime_nonzero<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"nth_prime <span class="free">n</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> prime_gt_0_nat prime_nth_prime<span class="main">)</span>

<span class="keyword1" id="Irrational_Series_Erdos_Straus-nth_prime_gt_zero"><span class="command">lemma</span></span> nth_prime_gt_zero<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"nth_prime <span class="free">n</span> <span class="main">&gt;</span><span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> prime_gt_0_nat prime_nth_prime<span class="main">)</span>

<span class="keyword1" id="Irrational_Series_Erdos_Straus-ratio_of_consecutive_primes"><span class="command">lemma</span></span> ratio_of_consecutive_primes<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> nth_prime <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">/</span>nth_prime <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span><span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span><span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> real <span class="main">(</span>nth_prime <span class="main">(</span>Suc <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span>real <span class="main">(</span>nth_prime <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span>real <span class="bound">x</span> <span class="main">*</span> ln <span class="main">(</span>real <span class="bound">x</span><span class="main">)</span><span class="main">)</span> 
                              <span class="main">/</span> <span class="main">(</span>real <span class="main">(</span>Suc <span class="bound">x</span><span class="main">)</span> <span class="main">*</span> ln <span class="main">(</span>real <span class="main">(</span>Suc <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> p_n<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> real <span class="main">(</span>nth_prime <span class="bound">x</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span>real <span class="bound">x</span> <span class="main">*</span> ln <span class="main">(</span>real <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> nth_prime_asymptotics<span class="main">[</span><span class="operator">unfolded</span> asymp_equiv_def<span class="main">,</span><span class="operator">simplified</span><span class="main">]</span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> p_sn<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real <span class="main">(</span>nth_prime <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span> 
                        <span class="main">/</span> <span class="main">(</span>real <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span> <span class="main">*</span> ln <span class="main">(</span>real <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> nth_prime_asymptotics<span class="main">[</span><span class="operator">unfolded</span> asymp_equiv_def<span class="main">,</span><span class="operator">simplified</span>
        <span class="main">,</span><span class="operator">THEN</span> LIMSEQ_Suc<span class="main">]</span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">x</span> <span class="main">*</span> <span class="skolem">g</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> tendsto_divide<span class="main">[</span><span class="operator">OF</span> p_sn p_n<span class="main">]</span> 
    <span class="keyword1"><span class="command">unfolding</span></span> f_def g_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> g_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">real_asymp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="keyword1">if</span> <span class="skolem">g</span> <span class="bound">x</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span> <span class="main">0</span> <span class="keyword1">else</span> <span class="skolem">f</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">drule_tac</span> tendsto_divide<span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ <span class="quoted"><span class="quoted">‹<span class="skolem">g</span> <span class="main">⇢</span> <span class="main">1</span>›</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> filterlim_mono_eventually<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">(</span><span class="keyword1">if</span> <span class="skolem">g</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="numeral">3</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span> <span class="main">0</span> 
                <span class="keyword1">else</span> <span class="skolem">f</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="numeral">3</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">f</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="numeral">3</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> g_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">(</span><span class="keyword1">if</span> <span class="skolem">g</span> <span class="bound">x</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span> <span class="main">0</span> <span class="keyword1">else</span> <span class="skolem">f</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">f</span> <span class="bound">x</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> eventually_sequentially_seg<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Irrational_Series_Erdos_Straus-nth_prime_double_sqrt_less"><span class="command">lemma</span></span> nth_prime_double_sqrt_less<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">ε</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">(</span>nth_prime <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="bound">n</span><span class="main">)</span> <span class="main">-</span> nth_prime <span class="bound">n</span><span class="main">)</span> 
            <span class="main">/</span> sqrt <span class="main">(</span>nth_prime <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="bound">n</span> <span class="keyword1">powr</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">+</span><span class="free">ε</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">pp</span></span> <span class="skolem"><span class="skolem">ll</span></span> <span class="keyword2"><span class="keyword">where</span></span> 
    <span class="quoted"><span class="quoted">"<span class="skolem">pp</span><span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span>nth_prime <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="bound">n</span><span class="main">)</span> <span class="main">-</span> nth_prime <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> sqrt <span class="main">(</span>nth_prime <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="quoted"><span class="quoted">"<span class="skolem">ll</span><span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">x</span> <span class="main">*</span> ln <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> pp_pos<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">pp</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">unfolding</span></span> pp_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> nth_prime <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∼[</span>sequentially<span class="main">]</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">x</span><span class="main">)</span> <span class="main">*</span> ln <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> nth_prime_asymptotics<span class="main">[</span><span class="operator">THEN</span> asymp_equiv_compose
        <span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">(*)</span> <span class="numeral">2</span>"</span></span> <span class="quoted">sequentially</span><span class="main">,</span><span class="operator">unfolded</span> comp_def<span class="main">]</span>
    <span class="keyword1"><span class="command">using</span></span> mult_nat_left_at_top pos2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">∼[</span>sequentially<span class="main">]</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="numeral">2</span> <span class="main">*</span><span class="bound">x</span> <span class="main">*</span> ln <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">real_asymp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> nth_prime <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∼[</span>sequentially<span class="main">]</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="numeral">2</span> <span class="main">*</span><span class="bound">x</span> <span class="main">*</span> ln <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">from</span></span> this<span class="main">[</span><span class="operator">unfolded</span> asymp_equiv_def<span class="main">,</span> <span class="operator">THEN</span> tendsto_mult_left<span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="numeral">2</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> nth_prime <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">x</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="bound">x</span> <span class="main">*</span> ln <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> asymp_equiv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> *<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> nth_prime <span class="bound">x</span> <span class="main">/</span> <span class="main">(</span><span class="bound">x</span> <span class="main">*</span> ln <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> nth_prime_asymptotics <span class="keyword1"><span class="command">unfolding</span></span> asymp_equiv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span>    
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span>nth_prime <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">x</span><span class="main">)</span> <span class="main">-</span> nth_prime <span class="bound">x</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">ll</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> ll_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">drule</span> <span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> tendsto_diff<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> of_nat_diff<span class="main"><span class="keyword3">,</span></span><span class="operator">simp</span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> diff_divide_distrib<span class="main"><span class="keyword3">,</span></span><span class="operator">simp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> sqrt <span class="main">(</span>nth_prime <span class="bound">x</span><span class="main">)</span> <span class="main">/</span> sqrt <span class="main">(</span><span class="skolem">ll</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> ll_def
    <span class="keyword1"><span class="command">using</span></span> tendsto_real_sqrt<span class="main">[</span><span class="operator">OF</span> *<span class="main">]</span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> real_sqrt_divide<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="skolem">pp</span> <span class="bound">x</span> <span class="main">*</span> <span class="main">(</span>sqrt <span class="main">(</span><span class="skolem">ll</span> <span class="bound">x</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">ll</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">drule</span> <span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> tendsto_divide<span class="main"><span class="keyword3">,</span></span><span class="operator">simp</span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span> of_nat_diff pp_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> sqrt <span class="main">(</span><span class="skolem">ll</span> <span class="bound">x</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">ll</span> <span class="bound">x</span> <span class="main">=</span> <span class="main">1</span><span class="main">/</span>sqrt <span class="main">(</span><span class="skolem">ll</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> eventually_sequentially_Suc<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>eventuallyI <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>ll_def <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="skolem">pp</span> <span class="bound">x</span> <span class="main">/</span> sqrt <span class="main">(</span><span class="skolem">ll</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> filterlim_mono_eventually<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>eventually_mono<span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> mult.right_neutral times_divide_eq_right<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> sqrt <span class="main">(</span><span class="skolem">ll</span> <span class="bound">x</span><span class="main">)</span> <span class="main">/</span> <span class="bound">x</span> <span class="keyword1">powr</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">+</span><span class="free">ε</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> ll_def <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">ε</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">real_asymp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="skolem">pp</span> <span class="bound">x</span> <span class="main">/</span> <span class="bound">x</span> <span class="keyword1">powr</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">+</span><span class="free">ε</span><span class="main">)</span> <span class="main">*</span> 
                      <span class="main">(</span>sqrt <span class="main">(</span><span class="skolem">ll</span> <span class="bound">x</span><span class="main">)</span> <span class="main">/</span> sqrt <span class="main">(</span><span class="skolem">ll</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">drule</span> <span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> tendsto_mult<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>filterlim_mono_eventually<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> sqrt <span class="main">(</span><span class="skolem">ll</span> <span class="bound">x</span><span class="main">)</span> <span class="main">/</span> sqrt <span class="main">(</span><span class="skolem">ll</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> eventually_sequentially_Suc<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>eventuallyI <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>ll_def <span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="skolem">pp</span> <span class="bound">x</span> <span class="main">/</span> <span class="bound">x</span> <span class="keyword1">powr</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">+</span><span class="free">ε</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> filterlim_mono_eventually<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>eventually_mono<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> tendstoD<span class="main">[</span><span class="operator">OF</span> this<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="main">1</span></span><span class="main">,</span><span class="operator">simplified</span><span class="main">]</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">pp</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="bound">x</span> <span class="keyword1">powr</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">+</span> <span class="free">ε</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> eventually_mono_sequentially<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="main">1</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> pp_pos <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Theorem 3.1›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Theorem 3.1 is an application of Theorem 2.1 with the sequences considered involving 
the prime numbers.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> theorem_3_10_Erdos_Straus<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">a</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> int"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> a_pos<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"mono <span class="free">a</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> nth_1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> nth_prime <span class="bound">n</span> <span class="main">/</span> <span class="main">(</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> nth_2<span class="main">:</span><span class="quoted"><span class="quoted">"liminf <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">/</span> nth_prime <span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span>nth_prime <span class="bound">n</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">i</span> <span class="main">≤</span> <span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">i</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∉</span> <span class="main">ℚ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> asm<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span>nth_prime <span class="bound">n</span> <span class="main">/</span> <span class="main">(</span><span class="main">∏</span><span class="bound">i</span> <span class="main">≤</span> <span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">i</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="main">ℚ</span>"</span></span>

  <span class="keyword1"><span class="command">have</span></span> a2_omega<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">ω(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">*</span> ln <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real <span class="main">(</span>nth_prime <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">o(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real_of_int <span class="main">(</span><span class="main">(</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> smalloI_tendsto<span class="main"><span class="main">[</span></span><span class="operator">OF</span> nth_1<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> a_pos <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> less_int_code<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> 
          not_eventuallyD of_int_0_eq_iff zero_eq_power2<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> real <span class="main">(</span>nth_prime <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">Ω(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> real <span class="bound">x</span> <span class="main">*</span> ln <span class="main">(</span>real <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> nth_prime_bigtheta
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
      <span class="keyword1"><span class="command">using</span></span> landau_omega.small_big_trans smallo_imp_smallomega <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">have</span></span> a_gt_1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="bound">n</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">¦</span><span class="bound">x</span> <span class="main">*</span> ln <span class="bound">x</span><span class="main">¦</span> <span class="main">≤</span> <span class="main">(</span><span class="free">a</span> <span class="bound">x</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> a2_omega<span class="main">[</span><span class="operator">unfolded</span> smallomega_def<span class="main">,</span><span class="operator">simplified</span><span class="main">,</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="main">1</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">¦</span><span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="numeral">3</span><span class="main">)</span> <span class="main">*</span> ln <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="numeral">3</span><span class="main">)</span><span class="main">¦</span> <span class="main">≤</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="numeral">3</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span>"</span></span> 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> eventually_sequentially_seg<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">,</span></span> <span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="numeral">3</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">(</span> <span class="bound">n</span><span class="main">+</span><span class="numeral">3</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> eventually_mono<span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span>real <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> <span class="numeral">3</span><span class="main">)</span> <span class="main">*</span> ln <span class="main">(</span>real <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> <span class="numeral">3</span><span class="main">)</span><span class="main">)</span><span class="main">¦</span> <span class="main">≤</span> real_of_int <span class="main">(</span><span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> <span class="numeral">3</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span>real <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> <span class="numeral">3</span><span class="main">)</span> <span class="main">*</span> ln <span class="main">(</span>real <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> <span class="numeral">3</span><span class="main">)</span><span class="main">)</span><span class="main">¦</span> <span class="main">&gt;</span> <span class="numeral">3</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ln <span class="main">(</span>real <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> <span class="numeral">3</span><span class="main">)</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">using</span></span> ln3_gt_1 ln_gt_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"real<span class="main">(</span><span class="skolem">x</span><span class="main">+</span><span class="numeral">3</span><span class="main">)</span> <span class="main">≥</span> <span class="numeral">3</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">+</span><span class="numeral">3</span><span class="main">)</span><span class="main">*</span>ln <span class="main">(</span>real <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> <span class="numeral">3</span><span class="main">)</span><span class="main">)</span> <span class="main">&gt;</span> <span class="numeral">3</span><span class="main">*</span><span class="main">1</span> "</span></span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> mult_le_less_imp_less<span class="main">)</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"real_of_int <span class="main">(</span><span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> <span class="numeral">3</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span><span class="main">)</span> <span class="main">&gt;</span> <span class="numeral">3</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> <span class="numeral">3</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> Suc3_eq_add_3 a_pos add.commute of_int_1 one_power2<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> eventually_sequentially_seg<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">,</span></span> <span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="numeral">3</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span><span class="main">::</span><span class="quoted">int</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> 
    <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> Bc_large<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="bound">n</span> 
                <span class="main">=</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span>  <span class="free">a</span> <span class="bound">n</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> ca_vanish<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">note</span></span> a_gt_1
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real_of_int <span class="main">¦</span>int <span class="main">(</span>nth_prime <span class="bound">n</span><span class="main">)</span><span class="main">¦</span> 
                    <span class="main">/</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="bound">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span><span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> nth_prime <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">a</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="numeral">2</span><span class="main">*</span>nth_prime <span class="bound">n</span> <span class="main">/</span> <span class="main">(</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> norm <span class="main">(</span><span class="skolem">f</span> <span class="bound">x</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">g</span> <span class="bound">x</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> nth_prime <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">*</span>nth_prime <span class="bound">n</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> ratio_of_consecutive_primes<span class="main">[</span><span class="operator">unfolded</span> tendsto_iff
              <span class="main">,</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="main">1</span></span><span class="main">,</span><span class="operator">simplified</span><span class="main">]</span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> eventually_mono<span class="main">)</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span> dist_norm<span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>
                           <span class="main">≥</span> <span class="main">(</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span>"</span></span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> eventuallyI<span class="main">)</span>
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹mono <span class="free">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>power2_eq_square a_pos incseq_SucD<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> f_def g_def
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">eventually_elim</span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> norm_divide<span class="main">)</span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> linordered_field_class.frac_le<span class="main">)</span>
          <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span> <span class="operator">THEN</span> order.strict_implies_not_eq <span class="main">]</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">⇢</span> <span class="main">0</span> "</span></span> 
        <span class="keyword1"><span class="command">using</span></span> nth_1<span class="main">[</span><span class="operator">THEN</span> tendsto_mult_right_zero<span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="numeral">2</span></span><span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> g_def 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> Lim_null_comparison<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">f</span></span> <span class="quoted"><span class="skolem">g</span></span> <span class="quoted">sequentially</span><span class="main">]</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> f_def
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule_tac</span> LIMSEQ_imp_Suc<span class="main">)</span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∑</span><span class="bound">n</span><span class="main">.</span> real_of_int <span class="main">(</span>int <span class="main">(</span>nth_prime <span class="bound">n</span><span class="main">)</span><span class="main">)</span> 
                    <span class="main">/</span> real_of_int <span class="main">(</span>prod <span class="free">a</span> <span class="main">{..</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="main">ℚ</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> asm <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">B</span></span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∃</span><span class="bound">c</span><span class="main">.</span> <span class="main">(</span><span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span>
              <span class="bound">B</span> <span class="main">*</span> int <span class="main">(</span>nth_prime <span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="bound">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="bound">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">∧</span>
              real_of_int <span class="main">¦</span><span class="bound">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">∧</span>
          <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real_of_int <span class="main">(</span><span class="bound">c</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ab_rationality_imp<span class="main">[</span><span class="operator">OF</span> a_pos<span class="main">,</span><span class="operator">of</span> <span class="quoted">nth_prime</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="skolem">thesis</span></span> 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">clarify</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> c<span class="main"><span class="main">=</span></span><span class="quoted"><span class="improper">c</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> B<span class="main"><span class="main">=</span></span><span class="quoted"><span class="improper">B</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> that<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">have</span></span> bac_close<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="bound">n</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">+</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Bc_large <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>eventually_mono<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">+</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">=</span> <span class="main">0</span> "</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="bound">n</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="bound">n</span>  <span class="main">+</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">eventually_elim</span>
      <span class="keyword1"><span class="command">using</span></span> a_pos <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> less_irrefl<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="bound">n</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="bound">n</span>  <span class="main">+</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eventually_mono tendsto_iff<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> tendsto_diff<span class="main">[</span><span class="operator">OF</span> this ca_vanish<span class="main">]</span>  
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">have</span></span> c_pos<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> bac_close <span class="keyword1"><span class="command">have</span></span> *<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> tendsto_of_int_diff_0<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> a_gt_1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">eventually_elim</span><span class="main">)</span> 
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">0</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span> <span class="main">≥</span> <span class="main">0</span> <span class="main">∧</span> <span class="skolem">c</span> <span class="bound">n</span><span class="main">≥</span><span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> * eventually_sequentially_Suc<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span><span class="main">≥</span><span class="main">0</span>"</span></span><span class="main">]</span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> eventually_at_top_linorder le_Suc_eq<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∧</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> eventually_elim2 frequently_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> nth_prime <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">0</span> 
                        <span class="main">∧</span> <span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="bound">n</span> <span class="main">=</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> Bc_large <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∧</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span> <span class="main">≥</span> <span class="main">0</span> 
          <span class="main">∧</span> <span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="bound">n</span> <span class="main">=</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> frequently_eventually_frequently <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">from</span></span> frequently_ex<span class="main">[</span><span class="operator">OF</span> this<span class="main">]</span> 
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
        <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="skolem">n</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="skolem">n</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_le_0_iff<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">have</span></span> B_nth_prime<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> nth_prime <span class="bound">n</span> <span class="main">&gt;</span> <span class="skolem">B</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">B</span><span class="main">+</span><span class="main">1</span> <span class="main">≤</span> nth_prime <span class="bound">x</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> nth_prime_at_top<span class="main">[</span><span class="operator">unfolded</span> filterlim_at_top_ge<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> c<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted">"nat <span class="skolem">B</span><span class="main">+</span><span class="main">1</span>"</span></span><span class="main"><span class="main">]</span></span>
          <span class="main">,</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"nat <span class="skolem">B</span> <span class="main">+</span> <span class="main">1</span>"</span></span><span class="main">,</span><span class="operator">simplified</span><span class="main">]</span> 

      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> eventually_mono<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> eventually_mono<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">have</span></span> bc_epsilon<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> nth_prime <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> 
            <span class="main">/</span> nth_prime <span class="bound">n</span> <span class="main">&gt;</span>  <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="bound">n</span>"</span></span> <span class="keyword2"><span class="keyword">when</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε</span><span class="main">&lt;</span><span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">ε</span><span class="main">::</span><span class="quoted">real</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">x</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">x</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">ε</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ca_vanish<span class="main">[</span><span class="operator">unfolded</span> tendsto_iff<span class="main">,</span><span class="operator">rule_format</span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="skolem">ε</span><span class="main">/</span><span class="numeral">2</span>"</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">then</span></span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="numeral">2</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">ε</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> eventually_sequentially_Suc<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Bc_large
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> eventually_sequentially_Suc<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>eventually_mono<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">∧</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">∧</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="numeral">2</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> c_pos <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> eventually_sequentially_Suc<span class="main">)</span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">then</span></span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> c_pos <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> eventually_sequentially_Suc<span class="main">)</span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> c_pos <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Bc_large
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">eventually_elim</span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>elim <span class="skolem">n</span><span class="main">)</span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span></span> <span class="skolem"><span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">=</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">=</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="numeral">2</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">&lt;</span> <span class="skolem">ε</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">&lt;</span> <span class="skolem">ε</span><span class="main">/</span><span class="numeral">2</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> a_pos elim <span class="quoted"><span class="quoted">‹mono <span class="free">a</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ε<span class="hidden">⇩</span><sub>0</sub>_def ε<span class="hidden">⇩</span><sub>1</sub>_def abs_of_pos<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">ε</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="main">*</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">&lt;</span> <span class="skolem">ε</span><span class="main">/</span><span class="numeral">2</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> elim <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> elim<span class="main">(</span>4<span class="main">)</span> that<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">ε</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="main">*</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">+</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">&lt;</span> <span class="skolem">ε</span> <span class="main">/</span> <span class="numeral">2</span>›</span></span> elim<span class="main">(</span>4<span class="main">)</span> that<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> elim<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span> <span class="main">-</span>  <span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span> <span class="main">-</span>  <span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span> <span class="main">-</span>  <span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="main">(</span><span class="skolem">ε</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="main">*</span> real_of_int <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> real_of_int <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span>›</span></span> 
              divide_pos_pos elim<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> mult_le_0_iff of_int_less_1_iff that<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> a_pos <span class="quoted"><span class="quoted">‹mono <span class="free">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mono_def<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_cancel_left1 mult_le_cancel_iff2<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="skolem">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="skolem">n</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> ε<span class="hidden">⇩</span><sub>0</sub>_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="skolem">n</span> <span class="main">=</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>0</sub></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">ε<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span> ε<span class="hidden">⇩</span><sub>1</sub>_def 
          <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">+</span><span class="main">1</span>"</span></span><span class="main">]</span> 
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span>›</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult.commute<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> nth_prime <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> nth_prime <span class="skolem">n</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>


  <span class="keyword1"><span class="command">have</span></span> c_ubound<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">" <span class="main">¬</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ub</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">≤</span> <span class="skolem">ub</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ub</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> dual_order.trans int_one_le_iff_zero_less le_cases not_le<span class="main">)</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">pa</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">pa</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> nth_prime <span class="bound">n</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> pa_pos<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">pa</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> pa_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> a_pos<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"liminf <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">1</span> <span class="main">/</span> <span class="skolem">pa</span> <span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> nth_2 <span class="keyword1"><span class="command">unfolding</span></span> pa_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound"><span class="bound">y</span></span><span class="main">&lt;</span>ereal <span class="main">(</span>real_of_int <span class="skolem">B</span> <span class="main">/</span> real_of_int <span class="main">(</span><span class="skolem">ub</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">.</span> 
      <span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> ereal <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="skolem">pa</span> <span class="bound">x</span><span class="main">)</span> <span class="main">≤</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> less_Liminf_iff<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">B</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">ub</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">1</span> <span class="main">/</span> <span class="skolem">pa</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">B</span><span class="main">/</span><span class="main">(</span><span class="skolem">ub</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> frequently_mono le_less_trans less_ereal.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">B</span><span class="main">*</span><span class="skolem">pa</span> <span class="bound">x</span> <span class="main">&gt;</span> <span class="main">(</span><span class="skolem">ub</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">elim</span> frequently_elim1<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">ub</span>›</span></span> mult.left_neutral of_int_0_less_iff pa_pos pos_divide_less_eq 
          pos_less_divide_eq times_divide_eq_left zless_add1_eq<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">x</span> <span class="main">≤</span> <span class="skolem">ub</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">≤</span> <span class="skolem">ub</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">B</span><span class="main">*</span><span class="skolem">pa</span> <span class="bound">x</span> <span class="main">-</span> <span class="skolem">c</span> <span class="bound">x</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">elim</span> frequently_rev_mp eventually_mono<span class="main">)</span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">B</span> <span class="main">*</span> <span class="skolem">pa</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span><span class="main">0</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> pa_def <span class="keyword1"><span class="command">using</span></span> bac_close <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> tendstoD<span class="main">[</span><span class="operator">OF</span> this<span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="main">1</span></span><span class="main">]</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span>  <span class="main">¦</span><span class="skolem">B</span> <span class="main">*</span> <span class="skolem">pa</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="bound">n</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">B</span><span class="main">*</span><span class="skolem">pa</span> <span class="bound">x</span> <span class="main">-</span> <span class="skolem">c</span> <span class="bound">x</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">∧</span> <span class="main">¦</span><span class="skolem">B</span> <span class="main">*</span> <span class="skolem">pa</span> <span class="bound">x</span> <span class="main">-</span> <span class="skolem">c</span> <span class="bound">x</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> frequently_eventually_frequently <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> frequently_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">have</span></span> eq_2_11<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">&gt;</span><span class="skolem">c</span> <span class="bound">n</span> <span class="main">⟶</span> 
                  nth_prime <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> nth_prime <span class="bound">n</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">/</span> <span class="skolem">B</span>"</span></span> 
    <span class="keyword2"><span class="keyword">when</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ε</span><span class="main">&lt;</span><span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">ε</span><span class="main">::</span><span class="quoted">real</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">x</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">x</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">ε</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ca_vanish<span class="main">[</span><span class="operator">unfolded</span> tendsto_iff<span class="main">,</span><span class="operator">rule_format</span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="skolem">ε</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">∧</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> c_pos <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> eventually_sequentially_Suc<span class="main">)</span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> c_pos <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>  <span class="keyword1"><span class="command">using</span></span> Bc_large bc_epsilon<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε</span><span class="main">&lt;</span><span class="main">1</span>›</span></span><span class="main">]</span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">eventually_elim</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule_tac</span> impI<span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>elim <span class="skolem">n</span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">ε</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">using</span></span> elim<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">ε</span> <span class="main">*</span> <span class="skolem">c</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> elim<span class="main">(</span>2<span class="main">)</span> that<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">ε</span> <span class="main">*</span> <span class="skolem">c</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">ε</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">]</span> elim <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="skolem">n</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">/</span> <span class="skolem">B</span> <span class="main">&lt;</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">B</span>"</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> mult_less_iff1<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">,</span></span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span><span class="main">-</span><span class="skolem">ε</span><span class="main">)</span><span class="main">/</span><span class="skolem">B</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ε</span><span class="main">&lt;</span><span class="main">1</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> power2_eq_square mult_less_iff1<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nth_prime <span class="skolem">n</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">/</span> <span class="skolem">B</span> <span class="main">&lt;</span> nth_prime <span class="skolem">n</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">B</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> nth_prime <span class="skolem">n</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">B</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> nth_prime <span class="skolem">n</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>nth_prime <span class="skolem">n</span> <span class="main">/</span> <span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> nth_prime <span class="skolem">n</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="main">(</span><span class="main">1</span><span class="main">-</span><span class="skolem">ε</span><span class="main">)</span><span class="main">/</span><span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> nth_prime <span class="skolem">n</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">-</span><span class="skolem">ε</span><span class="main">)</span><span class="main">/</span><span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> nth_prime <span class="skolem">n</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span><span class="skolem">ε</span><span class="main">)</span><span class="main">/</span><span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> nth_prime <span class="skolem">n</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">cp</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">cp</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span><span class="main">+</span><span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≥</span> <span class="skolem">cp</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> cp_def <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"nth_prime <span class="skolem">n</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">fold</span> cp_def<span class="main">)</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">&lt;</span> nth_prime <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"real <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">ε</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span> <span class="main">*</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span><span class="main">)</span> 
          <span class="main">/</span> real_of_int <span class="skolem">B</span> <span class="main">&lt;</span> real <span class="main">(</span>nth_prime <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">have</span></span> c_neq_large<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≠</span> <span class="skolem">c</span> <span class="bound">n</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">≠</span> <span class="skolem">c</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> that<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="bound">n</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> frequently_def <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> int <span class="main">(</span>nth_prime <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="bound">x</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">x</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> 
        <span class="main">∧</span> <span class="main">¦</span>real_of_int <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="bound">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="bound">x</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">∧</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="bound">x</span> <span class="main">∧</span> <span class="skolem">B</span> <span class="main">&lt;</span> int <span class="main">(</span>nth_prime <span class="bound">x</span><span class="main">)</span>
        <span class="main">∧</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">&gt;</span><span class="skolem">c</span> <span class="bound">x</span> <span class="main">⟶</span> nth_prime <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> nth_prime <span class="bound">x</span> <span class="main">+</span>  <span class="free">a</span> <span class="bound">x</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span> <span class="skolem">B</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Bc_large c_pos B_nth_prime eq_2_11<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">-</span><span class="main">1</span><span class="main">/</span> sqrt <span class="numeral">2</span>"</span></span><span class="main">,</span><span class="operator">simplified</span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">m</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> nth_prime <span class="main">(</span><span class="bound">m</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">B</span><span class="main">)</span><span class="main">)</span><span class="main">*</span>nth_prime <span class="bound">m</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> frequently_eventually_at_top<span class="main"><span class="main">[</span></span><span class="operator">OF</span> that<span class="main"><span class="main">,</span></span> <span class="operator">THEN</span> frequently_at_top_elim<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">∧</span>
           <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">y</span></span><span class="main">≥</span><span class="skolem">n</span><span class="main">.</span> <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> int <span class="main">(</span>nth_prime <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="bound">y</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">y</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">y</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">∧</span>
                    <span class="main">¦</span>real_of_int <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="bound">y</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="bound">y</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">∧</span>
                   <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="bound">y</span> <span class="main">∧</span> <span class="skolem">B</span> <span class="main">&lt;</span> int <span class="main">(</span>nth_prime <span class="bound">y</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="skolem">c</span> <span class="bound">y</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">y</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">⟶</span>
                   real <span class="main">(</span>nth_prime <span class="bound">y</span><span class="main">)</span> <span class="main">+</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="bound">y</span><span class="main">)</span> <span class="main">/</span> real_of_int <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">B</span><span class="main">)</span>
                   <span class="main">&lt;</span> real <span class="main">(</span>nth_prime <span class="main">(</span><span class="bound">y</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span>"</span></span> 
        <span class="keyword2"><span class="keyword">and</span></span> Bc_eq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">y</span></span><span class="main">≥</span><span class="skolem">n</span><span class="main">.</span> <span class="skolem">B</span> <span class="main">*</span> int <span class="main">(</span>nth_prime <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="bound">y</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">y</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">y</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">∧</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="bound">y</span> 
                            <span class="main">∧</span> <span class="main">¦</span>real_of_int <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="bound">y</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="bound">y</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span> 
                            <span class="main">∧</span> <span class="skolem">B</span> <span class="main">&lt;</span> int <span class="main">(</span>nth_prime <span class="bound">y</span><span class="main">)</span>
                            <span class="main">∧</span> <span class="main">(</span><span class="skolem">c</span> <span class="bound">y</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">y</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">⟶</span>
                   real <span class="main">(</span>nth_prime <span class="bound">y</span><span class="main">)</span> <span class="main">+</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="bound">y</span><span class="main">)</span> <span class="main">/</span> real_of_int <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">B</span><span class="main">)</span>
                   <span class="main">&lt;</span> real <span class="main">(</span>nth_prime <span class="main">(</span><span class="bound">y</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">&lt;</span><span class="skolem">m</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">m</span> <span class="main">≤</span> <span class="skolem">c</span> <span class="skolem">n</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span><span class="main">&lt;</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">m</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">N</span><span class="main">.</span> <span class="bound">N</span> <span class="main">&gt;</span> <span class="skolem">n</span> <span class="main">∧</span> <span class="skolem">c</span> <span class="bound">N</span> <span class="main">&gt;</span> <span class="skolem">c</span> <span class="skolem">n</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> c_ubound<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="keyword1">MAX</span> <span class="bound">x</span><span class="main">∈</span><span class="main">{..</span><span class="skolem">n</span><span class="main">}</span><span class="main">.</span> <span class="skolem">c</span> <span class="bound">x</span>"</span></span><span class="main">]</span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Max_ge atMost_iff dual_order.trans finite_atMost finite_imageI image_eqI 
              linorder_not_le order_refl<span class="main">)</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">N</span><span class="main">&gt;</span><span class="skolem">n</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">N</span><span class="main">&gt;</span><span class="skolem">c</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">=</span><span class="main">{</span><span class="bound">m</span><span class="main">.</span> <span class="skolem">n</span><span class="main">&lt;</span><span class="bound">m</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">m</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">≤</span><span class="skolem">N</span> <span class="main">∧</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">m</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> <span class="skolem">c</span> <span class="skolem">n</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">=</span> Min <span class="skolem">A</span>"</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> A_def
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> A_def add_leE finite_nat_set_iff_bounded_le mem_Collect_eq<span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">N</span><span class="main">-</span><span class="main">1</span><span class="main">∈</span><span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> A_def 
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="skolem">N</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">N</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> Suc_diff_Suc Suc_eq_plus1 Suc_leI Suc_pred  add.commute 
              add_diff_inverse_nat add_leD1 diff_is_0_eq' mem_Collect_eq nat_add_left_cancel_less
              zero_less_one<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main">∈</span><span class="skolem">A</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> Min_in <span class="keyword1"><span class="command">unfolding</span></span> m_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">&lt;</span><span class="skolem">m</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span><span class="main">&lt;</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">m</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main">&gt;</span><span class="main">0</span>"</span></span>
          <span class="keyword1"><span class="command">unfolding</span></span> m_def A_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">m</span> <span class="main">≤</span> <span class="skolem">c</span> <span class="skolem">n</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">" <span class="main">¬</span> <span class="skolem">c</span> <span class="skolem">m</span> <span class="main">≤</span> <span class="skolem">c</span> <span class="skolem">n</span>"</span></span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main">-</span><span class="main">1</span><span class="main">∈</span><span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">∈</span><span class="skolem">A</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span>›</span></span>
            <span class="keyword1"><span class="command">unfolding</span></span> A_def 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">smt</span> One_nat_def Suc_eq_plus1 Suc_lessI less_diff_conv<span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span>  Min_le<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">A</span>›</span></span> this<span class="main">,</span><span class="operator">folded</span> m_def<span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> that<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">m</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">B</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> nth_prime <span class="skolem">m</span> <span class="main">&lt;</span> nth_prime <span class="skolem">m</span> <span class="main">+</span> <span class="free">a</span> <span class="skolem">m</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">B</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nth_prime <span class="skolem">m</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="skolem">m</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> int <span class="main">(</span>nth_prime <span class="skolem">m</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="skolem">m</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> Bc_eq<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">m</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="skolem">m</span> <span class="main">≤</span> <span class="skolem">c</span> <span class="skolem">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">m</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="skolem">m</span> <span class="main">≤</span> <span class="skolem">c</span> <span class="skolem">n</span>›</span></span> a_pos mult_right_mono<span class="main">)</span>
          <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> int <span class="main">(</span>nth_prime <span class="skolem">m</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span><span class="main">≤</span><span class="skolem">B</span>"</span></span> 
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">" <span class="skolem">B</span> <span class="main">*</span> int <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">&lt;</span> int <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span>"</span></span>
              <span class="keyword2"><span class="keyword">and</span></span> c_a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¦</span>real_of_int <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> Bc_eq<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
            <span class="keyword1"><span class="command">from</span></span> this<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">" <span class="skolem">c</span> <span class="skolem">n</span> <span class="keyword1">dvd</span> <span class="main">(</span><span class="skolem">B</span> <span class="main">*</span> int <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"coprime <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">(</span>int <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&lt;</span> int <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span>"</span></span> 
              <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
                <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&lt;</span> int <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> asm<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">≥</span> int <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="skolem">n</span> <span class="main">&gt;</span> <span class="numeral">2</span> <span class="main">*</span> nth_prime <span class="skolem">n</span>"</span></span>
                  <span class="keyword1"><span class="command">using</span></span> c_a <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span><span class="main">1</span> <span class="main">≥</span> <span class="numeral">2</span> <span class="main">*</span> nth_prime <span class="skolem">n</span>"</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
                <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&gt;</span> <span class="numeral">2</span> <span class="main">*</span> <span class="skolem">B</span>"</span></span>
                  <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">&lt;</span> int <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">from</span></span> mult_le_less_imp_less<span class="main">[</span><span class="operator">OF</span> asm this<span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"int <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">B</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">*</span> int <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>›</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">B</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">&lt;</span> int <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span>›</span></span> combine_common_factor 
                      mult.commute mult_pos_pos<span class="main">)</span>
              <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> nth_prime <span class="skolem">n</span> <span class="keyword1">dvd</span> <span class="skolem">c</span> <span class="skolem">n</span>"</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Bc_eq zdvd_not_zless<span class="main">)</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"coprime <span class="main">(</span>int <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span><span class="main">)</span>"</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>prime_imp_coprime_int<span class="main">)</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> coprime_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span> <span class="keyword1">dvd</span> <span class="skolem">B</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> coprime_dvd_mult_left_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">B</span>›</span></span> zdvd_imp_le <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&gt;</span> <span class="main">0</span> "</span></span> <span class="keyword1"><span class="command">using</span></span> Bc_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> a_pos mult_mono<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">&lt;</span> nth_prime <span class="main">(</span><span class="skolem">m</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> Bc_eq<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="skolem">m</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">&lt;</span><span class="skolem">m</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="skolem">m</span> <span class="main">≤</span> <span class="skolem">c</span> <span class="skolem">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">m</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">j</span></span><span class="main">&gt;</span><span class="skolem">n</span><span class="main">.</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">1</span> <span class="main">/</span> real_of_int <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">B</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> real <span class="main">(</span>nth_prime <span class="bound">j</span><span class="main">)</span>
                       <span class="main">&lt;</span> real <span class="main">(</span>nth_prime <span class="main">(</span><span class="bound">j</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">&gt;</span><span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">m</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> nth_prime <span class="main">(</span><span class="bound">m</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">/</span>nth_prime <span class="bound">m</span> <span class="main">&gt;</span> <span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">B</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>frequently_elim1 <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">m</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> nth_prime <span class="main">(</span><span class="bound">m</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">/</span>nth_prime <span class="bound">m</span> <span class="main">&lt;</span> <span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">B</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ratio_of_consecutive_primes<span class="main">[</span><span class="operator">unfolded</span> tendsto_iff<span class="main">,</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">B</span><span class="main">)</span>"</span></span><span class="main">]</span>
        <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> dist_real_def
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>eventually_mono <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eventually_mono frequently_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">have</span></span> c_gt_half<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">N</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> card <span class="main">{</span><span class="bound"><span class="bound">n</span></span><span class="main">∈</span><span class="main">{</span><span class="bound">N</span><span class="main">..&lt;</span><span class="numeral">2</span><span class="main">*</span><span class="bound">N</span><span class="main">}</span><span class="main">.</span>  <span class="skolem">c</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">}</span> <span class="main">&gt;</span> <span class="bound">N</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span><span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span>nth_prime <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="bound">n</span><span class="main">)</span> <span class="main">-</span> nth_prime <span class="bound">n</span><span class="main">)</span> 
                              <span class="main">/</span>  sqrt <span class="main">(</span>nth_prime <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">h</span> <span class="bound">n</span> <span class="main">&lt;</span> <span class="bound">n</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">h</span> <span class="bound">n</span> <span class="main">&lt;</span> <span class="bound">n</span> <span class="keyword1">powr</span> <span class="main">(</span><span class="numeral">5</span><span class="main">/</span><span class="numeral">6</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> nth_prime_double_sqrt_less<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="numeral">3</span>"</span></span><span class="main">]</span>
        <span class="keyword1"><span class="command">unfolding</span></span> h_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="bound">n</span> <span class="keyword1">powr</span> <span class="main">(</span><span class="numeral">5</span><span class="main">/</span><span class="numeral">6</span><span class="main">)</span> <span class="main">&lt;</span> <span class="main">(</span><span class="bound">n</span> <span class="main">/</span><span class="numeral">2</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">real_asymp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> sqrt <span class="main">(</span>nth_prime <span class="bound">n</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">B</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> nth_1<span class="main">[</span><span class="operator">THEN</span> tendsto_real_sqrt<span class="main">,</span><span class="operator">unfolded</span> tendsto_iff
          <span class="main">,</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">B</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> a_pos
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>real_sqrt_divide abs_of_pos<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≠</span> <span class="skolem">c</span> <span class="bound">x</span>
        <span class="main">∧</span> sqrt <span class="main">(</span>nth_prime <span class="bound">x</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">B</span><span class="main">)</span>
        <span class="main">∧</span>  <span class="skolem">h</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="bound">x</span> <span class="main">/</span> <span class="numeral">2</span>
        <span class="main">∧</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">&gt;</span><span class="skolem">c</span> <span class="bound">x</span> <span class="main">⟶</span> nth_prime <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> nth_prime <span class="bound">x</span> <span class="main">+</span>  <span class="free">a</span> <span class="bound">x</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span> <span class="skolem">B</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> c_neq_large B_nth_prime eq_2_11<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">-</span><span class="main">1</span><span class="main">/</span> sqrt <span class="numeral">2</span>"</span></span><span class="main">,</span><span class="operator">simplified</span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> eventually_at_top_mono<span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">N</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">N</span><span class="main">≥</span><span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> N_asm<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">y</span></span><span class="main">≥</span><span class="skolem">N</span><span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">y</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">≠</span> <span class="skolem">c</span> <span class="bound">y</span> <span class="main">∧</span>
               sqrt <span class="main">(</span>real <span class="main">(</span>nth_prime <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="bound">y</span><span class="main">)</span>
               <span class="main">&lt;</span> <span class="main">1</span> <span class="main">/</span> real_of_int <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">B</span><span class="main">)</span> <span class="main">∧</span>  <span class="skolem">h</span> <span class="bound">y</span> <span class="main">&lt;</span> <span class="bound">y</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">∧</span>
               <span class="main">(</span><span class="skolem">c</span> <span class="bound">y</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">y</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">⟶</span>
                real <span class="main">(</span>nth_prime <span class="bound">y</span><span class="main">)</span> <span class="main">+</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="bound">y</span><span class="main">)</span> <span class="main">/</span> real_of_int <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">B</span><span class="main">)</span>
                <span class="main">&lt;</span> real <span class="main">(</span>nth_prime <span class="main">(</span><span class="bound">y</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">S</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">S</span><span class="main">=</span><span class="main">{</span><span class="bound"><span class="bound">n</span></span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..&lt;</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">N</span><span class="main">}</span><span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">}</span>"</span></span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span>nth_prime <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> nth_prime <span class="bound">n</span><span class="main">)</span> 
                              <span class="main">/</span>  sqrt <span class="main">(</span>nth_prime <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span><span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> nth_prime <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> nth_prime <span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> g_gt_1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="skolem">n</span><span class="main">&gt;</span><span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">when</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">≥</span><span class="skolem">N</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nth_prime <span class="skolem">n</span> <span class="main">+</span> sqrt <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span> <span class="main">&lt;</span> nth_prime <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nth_prime <span class="skolem">n</span> <span class="main">+</span> sqrt <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span> <span class="main">&lt;</span> nth_prime <span class="skolem">n</span> <span class="main">+</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">B</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> N_asm<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">≥</span><span class="skolem">N</span>›</span></span><span class="main">]</span> a_pos
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">&lt;</span> nth_prime <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> N_asm<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">≥</span><span class="skolem">N</span>›</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> g_def 
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">have</span></span> g_geq_0<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="skolem">n</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span> 
        <span class="keyword1"><span class="command">unfolding</span></span> g_def  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">S</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="skolem">S</span><span class="main">.</span> <span class="bound">x</span><span class="main">≥</span><span class="skolem">N</span> <span class="main">∧</span> <span class="skolem">c</span> <span class="bound">x</span><span class="main">&lt;</span><span class="skolem">c</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> S_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">S</span> <span class="main">≤</span> sum <span class="skolem">g</span> <span class="skolem">S</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">S</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">case</span></span> empty
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>insert <span class="skolem">x</span> <span class="skolem">F</span><span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="skolem">x</span><span class="main">&gt;</span><span class="main">1</span>"</span></span> 
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">x</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">≥</span><span class="skolem">N</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> insert<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> g_gt_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> sum <span class="skolem">g</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..&lt;</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">N</span><span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> sum_mono2<span class="main">)</span>
        <span class="keyword1"><span class="command">unfolding</span></span> S_def <span class="keyword1"><span class="command">using</span></span> g_geq_0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> sum <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">n</span><span class="main">/</span>sqrt <span class="main">(</span>nth_prime <span class="skolem">N</span><span class="main">)</span><span class="main">)</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..&lt;</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">N</span><span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> f_def g_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>sum_mono divide_left_mono<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="skolem">f</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..&lt;</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">N</span><span class="main">}</span> <span class="main">/</span> sqrt <span class="main">(</span>nth_prime <span class="skolem">N</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> sum_divide_distrib<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span>nth_prime <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">N</span><span class="main">)</span> <span class="main">-</span> nth_prime <span class="skolem">N</span><span class="main">)</span> <span class="main">/</span> sqrt <span class="main">(</span>nth_prime <span class="skolem">N</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="skolem">f</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..&lt;</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">N</span><span class="main">}</span> <span class="main">=</span> nth_prime <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">N</span><span class="main">)</span> <span class="main">-</span> nth_prime <span class="skolem">N</span>"</span></span>   
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">N</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">case</span></span> 0
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">N</span><span class="main">)</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">N</span><span class="main">=</span><span class="main">0</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="skolem">f</span> <span class="main">{</span>Suc <span class="skolem">N</span><span class="main">..&lt;</span><span class="numeral">2</span> <span class="main">*</span> Suc <span class="skolem">N</span><span class="main">}</span> <span class="main">=</span> sum <span class="skolem">f</span> <span class="main">{</span><span class="main">1</span><span class="main">}</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> that <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> numeral_2_eq_2<span class="main">)</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> nth_prime <span class="numeral">2</span> <span class="main">-</span> nth_prime <span class="main">1</span>"</span></span>
              <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>numeral_2_eq_2<span class="main">)</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> nth_prime <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> Suc <span class="skolem">N</span><span class="main">)</span> <span class="main">-</span> nth_prime <span class="main">(</span>Suc <span class="skolem">N</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> that <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">N</span><span class="main">≠</span><span class="main">0</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="skolem">f</span> <span class="main">{</span>Suc <span class="skolem">N</span><span class="main">..&lt;</span><span class="numeral">2</span> <span class="main">*</span> Suc <span class="skolem">N</span><span class="main">}</span> <span class="main">=</span> sum <span class="skolem">f</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..&lt;</span><span class="numeral">2</span> <span class="main">*</span> Suc <span class="skolem">N</span><span class="main">}</span> <span class="main">-</span> <span class="skolem">f</span> <span class="skolem">N</span>"</span></span>
              <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> sum.atLeast_Suc_lessThan<span class="main">)</span>
              <span class="keyword1"><span class="command">using</span></span> that <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="skolem">f</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..&lt;</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">N</span><span class="main">}</span><span class="main">+</span> <span class="skolem">f</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">N</span><span class="main">)</span> <span class="main">+</span> <span class="skolem">f</span><span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">N</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">f</span> <span class="skolem">N</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> nth_prime <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> Suc <span class="skolem">N</span><span class="main">)</span> <span class="main">-</span> nth_prime <span class="main">(</span>Suc <span class="skolem">N</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> Suc <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">h</span> <span class="skolem">N</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> h_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">&lt;</span> <span class="skolem">N</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> N_asm <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">S</span> <span class="main">&lt;</span> <span class="skolem">N</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>

      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">T</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">T</span><span class="main">=</span><span class="main">{</span><span class="bound"><span class="bound">n</span></span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..&lt;</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">N</span><span class="main">}</span><span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">T</span> <span class="main">∪</span> <span class="skolem">S</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..&lt;</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">N</span><span class="main">}</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">T</span> <span class="main">∩</span> <span class="skolem">S</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">T</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> T_def S_def <span class="keyword1"><span class="command">using</span></span> N_asm <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span><span class="main"><span class="keyword3">+</span></span>

      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">T</span> <span class="main">+</span> card <span class="skolem">S</span> <span class="main">=</span> card <span class="main">{</span><span class="skolem">N</span><span class="main">..&lt;</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">N</span><span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> card_Un_disjoint <span class="quoted"><span class="quoted">‹finite <span class="skolem">S</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">N</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">T</span> <span class="main">+</span> card <span class="skolem">S</span> <span class="main">=</span> <span class="skolem">N</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹card <span class="skolem">S</span> <span class="main">&lt;</span> <span class="skolem">N</span><span class="main">/</span><span class="numeral">2</span>›</span></span> 
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">T</span> <span class="main">&gt;</span> <span class="skolem">N</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Inequality (3.5) in the original paper required a slight modification: ›</span></span>

  <span class="keyword1"><span class="command">have</span></span> a_gt_plus<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">⟶</span><span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">+</span> <span class="main">(</span><span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span><span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">note</span></span> a_gt_1<span class="main">[</span><span class="operator">THEN</span> eventually_all_ge_at_top<span class="main">]</span> c_pos<span class="main">[</span><span class="operator">THEN</span> eventually_all_ge_at_top<span class="main">]</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> 
              <span class="skolem">B</span> <span class="main">*</span> int <span class="main">(</span>nth_prime <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Bc_large 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> eventually_sequentially_Suc<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>eventually_mono<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> 
                        <span class="skolem">B</span> <span class="main">*</span> int <span class="main">(</span>nth_prime <span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span>  <span class="free">a</span> <span class="bound">n</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Bc_large <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span>eventually_mono<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">eventually_elim</span><span class="main">)</span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> 
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">y</span></span><span class="main">≥</span><span class="skolem">n</span><span class="main">.</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="bound">y</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">y</span></span><span class="main">≥</span><span class="skolem">n</span><span class="main">.</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="bound">y</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span>
        Suc_n_eq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> int <span class="main">(</span>nth_prime <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
        <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> int <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">∧</span>
                real_of_int <span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span> 
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="skolem">n</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> n_eq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> int <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
        c_less_a<span class="main">:</span> <span class="quoted"><span class="quoted">"real_of_int <span class="main">¦</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound"><span class="bound">y</span></span><span class="main">≥</span><span class="skolem">n</span><span class="main">.</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="bound">y</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound"><span class="bound">y</span></span><span class="main">≥</span><span class="skolem">n</span><span class="main">.</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="bound">y</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> *<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="skolem">n</span><span class="main">&gt;</span><span class="main">1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> 
        <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="numeral">2</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="main">1</span><span class="main">/</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">/</span><span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> mult_right_mono<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>›</span></span> a_pos divide_nonneg_pos mult_pos_pos of_int_0_le_iff 
              of_int_0_less_iff<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">&lt;</span> <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>  <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> divide_strict_left_mono<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="numeral">2</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">unfolding</span></span> Suc_n_eq<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword1"><span class="command">using</span></span> * <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">&lt;</span> <span class="main">(</span><span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>  <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> frac_less<span class="main">)</span>
        <span class="keyword1"><span class="command">unfolding</span></span> Suc_n_eq<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword1"><span class="command">using</span></span> * <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="skolem">n</span>›</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> nth_prime <span class="skolem">n</span> <span class="main">/</span> nth_prime <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> Suc_n_eq<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> n_eq<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">1</span> <span class="main">/</span> real_of_int <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> 
        <span class="main">/</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="main">1</span> "</span></span> <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="skolem">n</span> <span class="main">+</span> <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span>  <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> * <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> a_gt_1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">+</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Bc_large a_gt_plus c_pos<span class="main">[</span><span class="operator">THEN</span> eventually_all_ge_at_top<span class="main">]</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">eventually_elim</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span>  
      <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">⟶</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">+</span>  <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span>  <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> 
      <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> B_eq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">*</span> int <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">*</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">∧</span>
         <span class="main">¦</span>real_of_int <span class="main">(</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">¦</span> <span class="main">&lt;</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c_pos<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">y</span></span><span class="main">≥</span><span class="skolem">n</span><span class="main">.</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="bound">y</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="skolem">n</span> <span class="main">+</span>  <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span>  <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> B_eq c_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">+</span><span class="main">1</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">≥</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> c_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">+</span><span class="main">1</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The following corresponds to inequality (3.6) in the paper, which had to be
        slightly corrected:  ›</span></span>

  <span class="keyword1"><span class="command">have</span></span> a_gt_sqrt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">a</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&gt;</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">+</span> <span class="main">(</span>sqrt <span class="bound">n</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> a_2N<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">N</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">a</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="bound">N</span><span class="main">)</span> <span class="main">≥</span> <span class="bound">N</span> <span class="main">/</span><span class="numeral">2</span> <span class="main">+</span><span class="main">1</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> c_gt_half a_gt_1<span class="main">[</span><span class="operator">THEN</span> eventually_all_ge_at_top<span class="main">]</span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">eventually_elim</span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>elim <span class="skolem">N</span><span class="main">)</span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">S</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">S</span><span class="main">=</span><span class="main">{</span><span class="bound"><span class="bound">n</span></span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..&lt;</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">N</span><span class="main">}</span><span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="bound">n</span><span class="main">}</span>"</span></span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span> <span class="main">-</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span>"</span></span>

      <span class="keyword1"><span class="command">have</span></span> f_1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="skolem">S</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">x</span><span class="main">≥</span><span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> f_0<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">x</span><span class="main">≥</span><span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">unfolding</span></span> S_def f_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹mono <span class="free">a</span>›</span></span><span class="main">[</span><span class="operator">THEN</span> incseq_SucD<span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">N</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">&lt;</span> card <span class="skolem">S</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">unfolding</span></span> S_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> sum <span class="skolem">f</span> <span class="skolem">S</span>"</span></span> 
        <span class="keyword1"><span class="command">unfolding</span></span> of_int_sum
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> sum_bounded_below<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="main">1</span></span><span class="main"><span class="main">,</span></span><span class="operator">simplified</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">using</span></span> f_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> sum <span class="skolem">f</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..&lt;</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">N</span><span class="main">}</span>"</span></span> 
        <span class="keyword1"><span class="command">unfolding</span></span> of_int_sum
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> sum_mono2<span class="main">)</span>
        <span class="keyword1"><span class="command">unfolding</span></span> S_def <span class="keyword1"><span class="command">using</span></span> f_0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">a</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">N</span><span class="main">)</span> <span class="main">-</span> <span class="free">a</span> <span class="skolem">N</span>"</span></span> 
        <span class="keyword1"><span class="command">unfolding</span></span> of_int_sum f_def of_int_diff
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> sum_Suc_diff'<span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">N</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">N</span><span class="main">)</span> <span class="main">-</span> <span class="free">a</span> <span class="skolem">N</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">N</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">qed</span></span>

    <span class="keyword1"><span class="command">have</span></span> a_n4<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="bound">n</span><span class="main">/</span><span class="numeral">4</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N</span></span> <span class="keyword2"><span class="keyword">where</span></span> a_N<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="skolem">N</span><span class="main">.</span> <span class="free">a</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="bound">n</span><span class="main">)</span> <span class="main">≥</span> <span class="bound">n</span> <span class="main">/</span><span class="numeral">2</span><span class="main">+</span><span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> a_2N <span class="keyword1"><span class="command">unfolding</span></span> eventually_at_top_linorder <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="skolem">n</span><span class="main">&gt;</span><span class="skolem">n</span><span class="main">/</span><span class="numeral">4</span>"</span></span> <span class="keyword2"><span class="keyword">when</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">≥</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">N</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span> 
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">n'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span><span class="main">=</span><span class="skolem">n</span> <span class="keyword1">div</span> <span class="numeral">2</span>"</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span><span class="main">≥</span><span class="skolem">N</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> n'_def <span class="keyword1"><span class="command">using</span></span> that <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">/</span><span class="numeral">4</span> <span class="main">&lt;</span> <span class="skolem">n'</span> <span class="main">/</span><span class="numeral">2</span><span class="main">+</span><span class="main">1</span>"</span></span>
          <span class="keyword1"><span class="command">unfolding</span></span> n'_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">n'</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> a_N <span class="quoted"><span class="quoted">‹<span class="skolem">n'</span><span class="main">≥</span><span class="skolem">N</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span><span class="free">a</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> n'_def
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"even <span class="skolem">n</span>"</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> incseqD<span class="main">)</span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> eventually_at_top_linorder <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>

    <span class="keyword1"><span class="command">have</span></span> c_sqrt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">&lt;</span> sqrt <span class="bound">n</span> <span class="main">/</span> <span class="numeral">4</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="bound">x</span><span class="main">&gt;</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> real <span class="main">(</span>nth_prime <span class="bound">x</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span>real <span class="bound">x</span> <span class="main">*</span> ln <span class="main">(</span>real <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="numeral">2</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> nth_prime_asymptotics<span class="main">[</span><span class="operator">unfolded</span> asymp_equiv_def<span class="main">,</span><span class="operator">THEN</span> order_tendstoD<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="numeral">2</span></span><span class="main">]</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="bound">n</span> <span class="main">&lt;</span> <span class="skolem">B</span><span class="main">*</span><span class="numeral">8</span> <span class="main">*</span>ln <span class="bound">n</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a_n4 Bc_large
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">eventually_elim</span>
        <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>elim <span class="skolem">n</span><span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> this<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="skolem">n</span><span class="main">=</span><span class="main">(</span><span class="skolem">B</span><span class="main">*</span>nth_prime <span class="skolem">n</span><span class="main">+</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">/</span><span class="free">a</span> <span class="skolem">n</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">]</span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">B</span><span class="main">*</span>nth_prime <span class="skolem">n</span><span class="main">)</span><span class="main">/</span><span class="free">a</span> <span class="skolem">n</span><span class="main">+</span><span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">/</span><span class="free">a</span> <span class="skolem">n</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">&lt;</span> <span class="main">(</span><span class="skolem">B</span><span class="main">*</span>nth_prime <span class="skolem">n</span><span class="main">)</span><span class="main">/</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">/</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> elim<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">&lt;</span> <span class="skolem">B</span><span class="main">*</span><span class="numeral">8</span> <span class="main">*</span> ln <span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">*</span>nth_prime <span class="skolem">n</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">*</span><span class="skolem">B</span><span class="main">*</span><span class="skolem">n</span><span class="main">*</span>ln <span class="skolem">n</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹real <span class="main">(</span>nth_prime <span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span>real <span class="skolem">n</span> <span class="main">*</span> ln <span class="main">(</span>real <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="numeral">2</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹ <span class="main">1</span> <span class="main">&lt;</span> <span class="skolem">n</span>›</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"real <span class="skolem">n</span> <span class="main">/</span> <span class="numeral">4</span> <span class="main">&lt;</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">B</span><span class="main">*</span>nth_prime <span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">&lt;</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">B</span><span class="main">*</span><span class="skolem">n</span><span class="main">*</span>ln <span class="skolem">n</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="skolem">n</span><span class="main">/</span><span class="numeral">4</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> frac_less<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">&gt;</span><span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹ <span class="main">1</span> <span class="main">&lt;</span> <span class="skolem">n</span>›</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">B</span><span class="main">*</span><span class="numeral">8</span> <span class="main">*</span> ln <span class="skolem">n</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹ <span class="main">1</span> <span class="main">&lt;</span> <span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">B</span><span class="main">*</span><span class="numeral">8</span> <span class="main">*</span>ln <span class="bound">n</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&lt;</span> sqrt <span class="bound">n</span> <span class="main">/</span> <span class="numeral">4</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">real_asymp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>

    <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span> sqrt <span class="main">(</span><span class="bound">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">4</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="numeral">4</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">(</span><span class="bound">n</span> <span class="main">-</span> <span class="numeral">4</span><span class="main">)</span> <span class="main">/</span> sqrt <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span> <span class="main">&gt;</span> sqrt <span class="bound">n</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> c_pos<span class="main">[</span><span class="operator">THEN</span> eventually_all_ge_at_top<span class="main">]</span>    
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span>  c_sqrt<span class="main">[</span><span class="operator">THEN</span> eventually_all_ge_at_top<span class="main">]</span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="main">(</span><span class="operator">use</span> le_add1 <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> <span class="operator">blast</span><span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">real_asymp</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> a_gt_plus a_n4
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">eventually_elim</span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span> asm<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span> sqrt <span class="main">(</span>real <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">4</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
        a_ineq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="skolem">n</span> <span class="main">⟶</span> <span class="free">a</span> <span class="skolem">n</span> <span class="main">+</span>  <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span>  <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> 
        <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="skolem">n</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">/</span> <span class="numeral">4</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="skolem">n</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">&gt;</span> <span class="numeral">4</span>"</span></span> 
        <span class="keyword2"><span class="keyword">and</span></span> n_neq<span class="main">:</span><span class="quoted"><span class="quoted">" sqrt <span class="main">(</span>real <span class="skolem">n</span><span class="main">)</span> <span class="main">&lt;</span> real <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="numeral">4</span><span class="main">)</span> <span class="main">/</span> sqrt <span class="main">(</span>real <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span>

      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">n</span><span class="main">-</span><span class="numeral">4</span><span class="main">)</span> <span class="main">/</span> sqrt<span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">n</span><span class="main">/</span><span class="numeral">4</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">/</span> <span class="main">(</span>sqrt <span class="main">(</span>real <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">4</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">&gt;</span><span class="numeral">4</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span>  <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> frac_less<span class="main">)</span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">&gt;</span> <span class="numeral">4</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">/</span> <span class="numeral">4</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="skolem">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span> sqrt <span class="main">(</span>real <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">4</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span>  <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="skolem">n</span> <span class="main">+</span> <span class="main">...</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> a_ineq <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="skolem">n</span> <span class="main">+</span> <span class="main">(</span><span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="numeral">4</span><span class="main">)</span> <span class="main">/</span> sqrt <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="numeral">4</span><span class="main">)</span> <span class="main">/</span> sqrt <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&gt;</span> sqrt <span class="skolem">n</span> <span class="main">-</span> <span class="numeral">2</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> n_neq<span class="main">[</span><span class="operator">THEN</span> diff_strict_right_mono<span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="numeral">2</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">&gt;</span><span class="numeral">4</span>›</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span> of_nat_diff<span class="main">)</span> 
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"real_of_int <span class="main">(</span><span class="free">a</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>sqrt <span class="main">(</span>real <span class="skolem">n</span><span class="main">)</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">&lt;</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">argo</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The following corresponds to inequality $ a_{2N} &gt; N^{3/2}/2$ in the paper,
 which had to be slightly corrected: ›</span></span>

  <span class="keyword1"><span class="command">have</span></span> a_2N_sqrt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">N</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">a</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="bound">N</span><span class="main">)</span> <span class="main">&gt;</span>  real <span class="bound">N</span> <span class="main">*</span> <span class="main">(</span>sqrt <span class="main">(</span>real <span class="bound">N</span><span class="main">)</span><span class="main">/</span><span class="numeral">2</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> c_gt_half a_gt_sqrt<span class="main">[</span><span class="operator">THEN</span> eventually_all_ge_at_top<span class="main">]</span> eventually_gt_at_top<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="numeral">4</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">eventually_elim</span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>elim <span class="skolem">N</span><span class="main">)</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">S</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">S</span><span class="main">=</span><span class="main">{</span><span class="bound"><span class="bound">n</span></span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..&lt;</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">N</span><span class="main">}</span><span class="main">.</span> <span class="skolem">c</span> <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="bound">n</span><span class="main">}</span>"</span></span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span> <span class="main">-</span> <span class="free">a</span> <span class="bound">n</span><span class="main">)</span>"</span></span>

    <span class="keyword1"><span class="command">have</span></span> f_N<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="skolem">S</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">x</span><span class="main">≥</span>sqrt <span class="skolem">N</span> <span class="main">-</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> 
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="skolem">S</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="main">(</span>real <span class="skolem">x</span><span class="main">)</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">&lt;</span> <span class="skolem">f</span> <span class="skolem">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">≥</span><span class="skolem">N</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">unfolding</span></span> S_def f_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="skolem">x</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">≥</span> sqrt <span class="skolem">N</span> <span class="main">-</span> <span class="numeral">2</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">≥</span><span class="skolem">N</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"sqrt <span class="main">(</span>real <span class="skolem">N</span><span class="main">)</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">≤</span> real_of_int <span class="main">(</span><span class="skolem">f</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">argo</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> f_0<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">x</span><span class="main">≥</span><span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹mono <span class="free">a</span>›</span></span><span class="main">[</span><span class="operator">THEN</span> incseq_SucD<span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">N</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span>  <span class="main">*</span> <span class="main">(</span>sqrt <span class="skolem">N</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">&lt;</span> card <span class="skolem">S</span> <span class="main">*</span> <span class="main">(</span>sqrt <span class="skolem">N</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> mult_strict_right_mono<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> elim <span class="keyword1"><span class="command">unfolding</span></span> S_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">N</span><span class="main">&gt;</span><span class="numeral">4</span>›</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> diff_gt_0_iff_gt numeral_less_real_of_nat_iff real_sqrt_four real_sqrt_less_iff<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span>  <span class="main">≤</span> sum <span class="skolem">f</span> <span class="skolem">S</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> of_int_sum
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> sum_bounded_below<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> f_N <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> sum <span class="skolem">f</span> <span class="main">{</span><span class="skolem">N</span><span class="main">..&lt;</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">N</span><span class="main">}</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> of_int_sum
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> sum_mono2<span class="main">)</span>
      <span class="keyword1"><span class="command">unfolding</span></span> S_def <span class="keyword1"><span class="command">using</span></span> f_0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">a</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="skolem">N</span><span class="main">)</span> <span class="main">-</span> <span class="free">a</span> <span class="skolem">N</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> of_int_sum f_def of_int_diff
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> sum_Suc_diff'<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"real <span class="skolem">N</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span>sqrt <span class="main">(</span>real <span class="skolem">N</span><span class="main">)</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">&lt;</span> real_of_int <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">N</span><span class="main">)</span> <span class="main">-</span> <span class="free">a</span> <span class="skolem">N</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">.</span></span>              
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"real <span class="skolem">N</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span>sqrt <span class="main">(</span>real <span class="skolem">N</span><span class="main">)</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">N</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> a_pos<span class="main">[</span><span class="operator">rule_format</span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="skolem">N</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The following part is required to derive the final contradiction of the proof.›</span></span>

  <span class="keyword1"><span class="command">have</span></span> a_n_sqrt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="bound">n</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span> <span class="keyword1">powr</span> <span class="main">(</span><span class="numeral">3</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="bound">n</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span><span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> sequentially_even_odd_imp<span class="main">)</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span><span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">N</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span>real <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">N</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="keyword1">powr</span> <span class="main">(</span><span class="numeral">3</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">-</span> real <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">N</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">N</span><span class="main">.</span> real <span class="bound">N</span> <span class="main">*</span> <span class="main">(</span>sqrt <span class="main">(</span>real <span class="bound">N</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">N</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">g</span> <span class="bound">N</span> <span class="main">&gt;</span> <span class="skolem">f</span> <span class="bound">N</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> f_def g_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">real_asymp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">N</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">a</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">N</span><span class="main">)</span> <span class="main">&gt;</span> <span class="skolem">g</span> <span class="bound">N</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> g_def <span class="keyword1"><span class="command">using</span></span> a_2N_sqrt <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">N</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">f</span> <span class="bound">N</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">N</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span><span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">N</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span>real <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">N</span> <span class="main">+</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="keyword1">powr</span> <span class="main">(</span><span class="numeral">3</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> 
                                  <span class="main">-</span> real <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">N</span> <span class="main">+</span> <span class="main">1</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">N</span><span class="main">.</span> real <span class="bound">N</span> <span class="main">*</span> <span class="main">(</span>sqrt <span class="main">(</span>real <span class="bound">N</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">N</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">g</span> <span class="bound">N</span> <span class="main">=</span> <span class="skolem">f</span> <span class="bound">N</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> eventually_gt_at_top<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="main">0</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">eventually_elim</span>
      <span class="keyword1"><span class="command">unfolding</span></span> f_def g_def
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">algebra_simps</span></span> powr_half_sqrt<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> powr_mult_base<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">N</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">a</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">N</span><span class="main">)</span> <span class="main">&gt;</span> <span class="skolem">g</span> <span class="bound">N</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> g_def <span class="keyword1"><span class="command">using</span></span> a_2N_sqrt <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">N</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">a</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">N</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">≥</span> <span class="free">a</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="bound">N</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> eventuallyI<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹mono <span class="free">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> incseqD<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">N</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">f</span> <span class="bound">N</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">a</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">N</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">have</span></span> a_nth_prime_gt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">/</span> nth_prime <span class="bound">n</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span><span class="main">=</span><span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">::</span>nat<span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="bound">n</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span> <span class="keyword1">powr</span> <span class="main">(</span><span class="numeral">3</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="bound">n</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span><span class="numeral">2</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">x</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> real <span class="main">(</span>nth_prime <span class="bound">x</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span>real <span class="bound">x</span> <span class="main">*</span> ln <span class="main">(</span>real <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="numeral">2</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> nth_prime_asymptotics<span class="main">[</span><span class="operator">unfolded</span> asymp_equiv_def<span class="main">,</span><span class="operator">THEN</span> order_tendstoD<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="numeral">2</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> this eventually_gt_at_top<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="main">1</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> real <span class="main">(</span>nth_prime <span class="bound">n</span><span class="main">)</span>   <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">*</span><span class="main">(</span>real <span class="bound">n</span> <span class="main">*</span> ln <span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span><span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> *<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">N</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">f</span> <span class="bound">N</span> <span class="main">&gt;</span><span class="main">0</span> "</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> f_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">real_asymp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">" <span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="skolem">f</span> <span class="bound">n</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="bound">n</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> a_n_sqrt <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">/</span> nth_prime <span class="bound">n</span> <span class="main">&gt;</span> <span class="skolem">f</span> <span class="bound">n</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="main">(</span>real <span class="bound">n</span> <span class="main">*</span> ln <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">eventually_elim</span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>elim <span class="skolem">n</span><span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> frac_less2<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="main">(</span><span class="skolem">f</span> <span class="bound">n</span><span class="main">)</span><span class="main">/</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="main">(</span>real <span class="bound">n</span> <span class="main">*</span> ln <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">real_asymp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">eventually_elim</span> <span class="operator">argo</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">have</span></span> a_nth_prime_lt<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">∃<span class="hidden">⇩</span><sub>F</sub></span> <span class="bound">n</span> <span class="keyword1">in</span> sequentially<span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">/</span> nth_prime <span class="bound">n</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"liminf <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">a</span> <span class="bound">x</span> <span class="main">/</span> nth_prime <span class="bound">x</span><span class="main">)</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> nth_2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this<span class="main">[</span><span class="operator">unfolded</span> less_Liminf_iff<span class="main">]</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>frequently_elim1<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> divide_less_eq_1 ereal_less_eq<span class="main"><span class="main">(</span></span>7<span class="main"><span class="main">)</span></span> leD leI 
          nth_prime_nonzero of_nat_eq_0_iff of_nat_less_0_iff order.trans<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">from</span></span> a_nth_prime_gt a_nth_prime_lt <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eventually_mono frequently_def<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">‹Acknowledgements›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A.K.-A. and W.L. were supported by the ERC Advanced Grant ALEXANDRIA (Project 742178)
 funded by the European Research Council and led by Professor Lawrence Paulson
 at the University of Cambridge, UK.›</span></span>

<span class="keyword2"><span class="keyword">end</span></span></pre>
</div>
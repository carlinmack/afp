<div id="CPair">
<div class="head">
<h1>Theory CPair</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Defintion and basics facts about Cantor pairing function
    Author:      Michael Nedzelsky &lt;MichaelNedzelsky at yandex.ru&gt;, 2008
    Maintainer:  Michael Nedzelsky &lt;MichaelNedzelsky at yandex.ru&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Cantor pairing function›</span></span>

<span class="keyword1"><span class="command">theory</span></span> CPair
<span class="keyword2"><span class="keyword">imports</span></span> <a href="../../HOL/HOL/Main.html">Main</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  We introduce a particular coding <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>c_pair›</span></span></span></span> from ordered pairs
  of natural numbers to natural numbers.  See \cite{Rogers} and the
  Isabelle documentation for more information.
›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Pairing function›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">sf</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  sf_def<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">sf</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">*</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_pair</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_pair</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> sf <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">+</span><span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="main">+</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1" id="CPair-sf_at_0"><span class="command">lemma</span></span> sf_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sf_def<span class="main">)</span>

<span class="keyword1" id="CPair-sf_at_1"><span class="command">lemma</span></span> sf_at_1<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="main">1</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sf_def<span class="main">)</span>

<span class="keyword1" id="CPair-sf_at_Suc"><span class="command">lemma</span></span> sf_at_Suc<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">=</span> sf <span class="free">x</span> <span class="main">+</span> <span class="free">x</span> <span class="main">+</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="numeral">2</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">x</span><span class="main">=</span><span class="bound">y</span> <span class="main">⟹</span> <span class="bound">x</span> <span class="keyword1">div</span> <span class="numeral">2</span> <span class="main">=</span> <span class="bound">y</span> <span class="keyword1">div</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="numeral">2</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> S2_1<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">0</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">&lt;</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S4 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S3 S5 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sf_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-arg_le_sf"><span class="command">lemma</span></span> arg_le_sf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> sf <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">+</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span> <span class="main">≤</span> <span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> div_le_mono<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sf_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-sf_mono"><span class="command">lemma</span></span> sf_mono<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">y</span> <span class="main">⟹</span> sf <span class="free">x</span> <span class="main">≤</span> sf <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">+</span><span class="main">1</span> <span class="main">≤</span> <span class="free">y</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> <span class="free">y</span><span class="main">*</span><span class="main">(</span><span class="free">y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> mult_le_mono<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span> <span class="main">≤</span> <span class="free">y</span><span class="main">*</span><span class="main">(</span><span class="free">y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> div_le_mono<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sf_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-sf_strict_mono"><span class="command">lemma</span></span> sf_strict_mono<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="free">y</span> <span class="main">⟹</span> sf <span class="free">x</span> <span class="main">&lt;</span> sf <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">+</span><span class="main">1</span> <span class="main">≤</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S1 sf_mono <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> sf <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> sf_at_Suc <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="free">x</span> <span class="main">&lt;</span> sf <span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-sf_posI"><span class="command">lemma</span></span> sf_posI<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> sf<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="main">0</span><span class="main">)</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_strict_mono<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-arg_less_sf"><span class="command">lemma</span></span> arg_less_sf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="var">?y</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="var">?y</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_posI<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="var">?y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">=</span> sf<span class="main">(</span><span class="var">?y</span><span class="main">)</span> <span class="main">+</span> <span class="var">?y</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_at_Suc<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> sf<span class="main">(</span><span class="var">?y</span><span class="main">)</span> <span class="main">+</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> S2  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-sf_eq_arg"><span class="command">lemma</span></span> sf_eq_arg<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="free">x</span> <span class="main">=</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">x</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span> <span class="main">(</span><span class="free">x</span> <span class="main">&gt;</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> arg_less_sf<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-sf_le_sfD"><span class="command">lemma</span></span> sf_le_sfD<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="free">x</span> <span class="main">≤</span> sf <span class="free">y</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="free">x</span> <span class="main">≤</span> sf <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> sf <span class="free">y</span> <span class="main">&lt;</span> sf <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_strict_mono<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">∨</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-sf_less_sfD"><span class="command">lemma</span></span> sf_less_sfD<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="free">x</span> <span class="main">&lt;</span> sf <span class="free">y</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="free">x</span> <span class="main">&lt;</span> sf <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> sf <span class="free">y</span> <span class="main">≤</span> sf <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_mono<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">∨</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-sf_inj"><span class="command">lemma</span></span> sf_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="free">x</span> <span class="main">=</span> sf <span class="free">y</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="free">x</span> <span class="main">=</span> sf <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="free">x</span> <span class="main">≤</span> sf <span class="free">y</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_le_sfD<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="free">y</span> <span class="main">≤</span> sf <span class="free">x</span> <span class="main">⟹</span> <span class="free">y</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_le_sfD<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="free">x</span> <span class="main">≤</span> sf <span class="free">y</span> <span class="main">∧</span> sf <span class="free">y</span> <span class="main">≤</span> sf <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 S1 S2 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">y</span> <span class="main">∧</span> <span class="free">y</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S4 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Auxiliary lemmas›</span></span>

<span class="keyword1" id="CPair-sf_aux1"><span class="command">lemma</span></span> sf_aux1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">+</span> <span class="free">y</span> <span class="main">&lt;</span> <span class="free">z</span> <span class="main">⟹</span> sf<span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">)</span> <span class="main">+</span> <span class="free">x</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="free">z</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">+</span><span class="free">y</span> <span class="main">&lt;</span> <span class="free">z</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">+</span><span class="main">1</span> <span class="main">≤</span> <span class="free">z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> sf<span class="main">(</span><span class="free">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_mono<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">=</span> sf<span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">)</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_at_Suc<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 S2 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span> <span class="main">≤</span> sf<span class="main">(</span><span class="free">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S4 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-sf_aux2"><span class="command">lemma</span></span> sf_aux2<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="free">z</span><span class="main">)</span> <span class="main">≤</span> sf<span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">)</span> <span class="main">+</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">z</span> <span class="main">≤</span> <span class="free">x</span><span class="main">+</span><span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="free">z</span><span class="main">)</span> <span class="main">≤</span> sf<span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">)</span> <span class="main">+</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> sf<span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">)</span> <span class="main">+</span><span class="free">x</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="free">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 sf_aux1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">x</span><span class="main">+</span><span class="free">y</span> <span class="main">&lt;</span> <span class="free">z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-sf_aux3"><span class="command">lemma</span></span> sf_aux3<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="free">z</span><span class="main">)</span> <span class="main">+</span> <span class="free">m</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="free">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">m</span> <span class="main">≤</span> <span class="free">z</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="free">z</span><span class="main">)</span> <span class="main">+</span> <span class="free">m</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="free">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="free">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">=</span> sf<span class="main">(</span><span class="free">z</span><span class="main">)</span> <span class="main">+</span> <span class="free">z</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_at_Suc<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="free">z</span><span class="main">)</span> <span class="main">+</span> <span class="free">m</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="free">z</span><span class="main">)</span> <span class="main">+</span> <span class="free">z</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">&lt;</span> <span class="free">z</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-sf_aux4"><span class="command">lemma</span></span> sf_aux4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">s</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">&lt;</span> <span class="free">t</span> <span class="main">⟹</span> <span class="main">(</span>sf <span class="free">s</span><span class="main">)</span> <span class="main">+</span> <span class="free">s</span> <span class="main">&lt;</span> sf <span class="free">t</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">s</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">&lt;</span> <span class="free">t</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">*</span><span class="main">(</span><span class="free">s</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="free">s</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> <span class="free">t</span><span class="main">*</span><span class="main">(</span><span class="free">t</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">s</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">+</span> <span class="main">1</span> <span class="main">≤</span> <span class="free">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">s</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">≤</span> <span class="free">t</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">s</span><span class="main">::</span>nat<span class="main">)</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">s</span><span class="main">+</span><span class="numeral">2</span><span class="main">)</span> <span class="main">≤</span> <span class="free">t</span><span class="main">*</span><span class="main">(</span><span class="free">t</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> mult_le_mono<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">s</span><span class="main">*</span><span class="main">(</span><span class="free">s</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="free">s</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span> <span class="main">≤</span>  <span class="free">t</span><span class="main">*</span><span class="main">(</span><span class="free">t</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> div_le_mono<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">0</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">&lt;</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">s</span><span class="main">*</span><span class="main">(</span><span class="free">s</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="free">s</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span><span class="free">s</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">s</span><span class="main">*</span><span class="main">(</span><span class="free">s</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">s</span><span class="main">*</span><span class="main">(</span><span class="free">s</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="free">s</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> <span class="free">t</span><span class="main">*</span><span class="main">(</span><span class="free">t</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">s</span><span class="main">*</span><span class="main">(</span><span class="free">s</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span> <span class="main">+</span> <span class="free">s</span> <span class="main">&lt;</span> <span class="free">t</span><span class="main">*</span><span class="main">(</span><span class="free">t</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sf_def<span class="main">)</span>  
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Basic properties of c\_pair function›</span></span>

<span class="keyword1" id="CPair-sum_le_c_pair"><span class="command">lemma</span></span> sum_le_c_pair<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">+</span> <span class="free">y</span> <span class="main">≤</span> c_pair <span class="free">x</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">+</span><span class="free">y</span> <span class="main">≤</span> sf<span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> arg_le_sf<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-arg1_le_c_pair"><span class="command">lemma</span></span> arg1_le_c_pair<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> c_pair <span class="free">x</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">+</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">+</span> <span class="free">y</span> <span class="main">≤</span> c_pair <span class="free">x</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sum_le_c_pair<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-arg2_le_c_pair"><span class="command">lemma</span></span> arg2_le_c_pair<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">≤</span> c_pair <span class="free">x</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">y</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">+</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">+</span> <span class="free">y</span> <span class="main">≤</span> c_pair <span class="free">x</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sum_le_c_pair<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_pair_sum_mono"><span class="command">lemma</span></span> c_pair_sum_mono<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x1</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">+</span> <span class="free">y1</span> <span class="main">&lt;</span> <span class="free">x2</span> <span class="main">+</span> <span class="free">y2</span> <span class="main">⟹</span> c_pair <span class="free">x1</span> <span class="free">y1</span> <span class="main">&lt;</span> c_pair <span class="free">x2</span> <span class="free">y2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x1</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">+</span> <span class="free">y1</span> <span class="main">&lt;</span> <span class="free">x2</span> <span class="main">+</span> <span class="free">y2</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"sf <span class="main">(</span><span class="free">x1</span><span class="main">+</span><span class="free">y1</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">x1</span><span class="main">+</span><span class="free">y1</span><span class="main">)</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="free">x2</span><span class="main">+</span><span class="free">y2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_aux4<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"sf <span class="main">(</span><span class="free">x1</span><span class="main">+</span><span class="free">y1</span><span class="main">)</span> <span class="main">+</span> <span class="free">x1</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="free">x2</span><span class="main">+</span><span class="free">y2</span><span class="main">)</span> <span class="main">+</span> <span class="free">x2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_pair_sum_inj"><span class="command">lemma</span></span> c_pair_sum_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> c_pair <span class="free">x2</span> <span class="free">y2</span> <span class="main">⟹</span> <span class="free">x1</span> <span class="main">+</span> <span class="free">y1</span> <span class="main">=</span> <span class="free">x2</span> <span class="main">+</span> <span class="free">y2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> c_pair <span class="free">x2</span> <span class="free">y2</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x1</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">+</span> <span class="free">y1</span> <span class="main">&lt;</span> <span class="free">x2</span> <span class="main">+</span> <span class="free">y2</span> <span class="main">⟹</span> c_pair <span class="free">x1</span> <span class="free">y1</span> <span class="main">≠</span> c_pair <span class="free">x2</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> less_not_refl3<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> c_pair_sum_mono<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">+</span> <span class="free">y2</span> <span class="main">&lt;</span> <span class="free">x1</span> <span class="main">+</span> <span class="free">y1</span> <span class="main">⟹</span> c_pair <span class="free">x1</span> <span class="free">y1</span> <span class="main">≠</span> c_pair <span class="free">x2</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> less_not_refl2<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> c_pair_sum_mono<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x1</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">+</span> <span class="free">y1</span> <span class="main">≠</span> <span class="free">x2</span> <span class="main">+</span> <span class="free">y2</span> <span class="main">⟹</span> c_pair <span class="free">x1</span> <span class="free">y1</span> <span class="main">≠</span> c_pair <span class="free">x2</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">arith</span><span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_pair_inj"><span class="command">lemma</span></span> c_pair_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> c_pair <span class="free">x2</span> <span class="free">y2</span> <span class="main">⟹</span> <span class="free">x1</span> <span class="main">=</span> <span class="free">x2</span> <span class="main">∧</span> <span class="free">y1</span> <span class="main">=</span> <span class="free">y2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> c_pair <span class="free">x2</span> <span class="free">y2</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x1</span> <span class="main">+</span> <span class="free">y1</span> <span class="main">=</span> <span class="free">x2</span> <span class="main">+</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_sum_inj<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="main">(</span><span class="free">x1</span><span class="main">+</span><span class="free">y1</span><span class="main">)</span> <span class="main">+</span> <span class="free">x1</span> <span class="main">=</span> sf <span class="main">(</span><span class="free">x2</span><span class="main">+</span><span class="free">y2</span><span class="main">)</span> <span class="main">+</span> <span class="free">x2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> c_pair_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x1</span> <span class="main">=</span> <span class="free">x2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S3 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y1</span> <span class="main">=</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 S4 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_pair_inj1"><span class="command">lemma</span></span> c_pair_inj1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> c_pair <span class="free">x2</span> <span class="free">y2</span> <span class="main">⟹</span> <span class="free">x1</span> <span class="main">=</span> <span class="free">x2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">frule</span> c_pair_inj<span class="main"><span class="keyword3">,</span></span> <span class="operator">drule</span> conjunct1<span class="main">)</span>

<span class="keyword1" id="CPair-c_pair_inj2"><span class="command">lemma</span></span> c_pair_inj2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> c_pair <span class="free">x2</span> <span class="free">y2</span> <span class="main">⟹</span> <span class="free">y1</span> <span class="main">=</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">frule</span> c_pair_inj<span class="main"><span class="keyword3">,</span></span> <span class="operator">drule</span> conjunct2<span class="main">)</span>

<span class="keyword1" id="CPair-c_pair_strict_mono1"><span class="command">lemma</span></span> c_pair_strict_mono1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x1</span> <span class="main">&lt;</span> <span class="free">x2</span> <span class="main">⟹</span> c_pair <span class="free">x1</span> <span class="free">y</span> <span class="main">&lt;</span> c_pair <span class="free">x2</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x1</span> <span class="main">&lt;</span> <span class="free">x2</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x1</span> <span class="main">+</span> <span class="free">y</span> <span class="main">&lt;</span> <span class="free">x2</span> <span class="main">+</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_sum_mono<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_pair_mono1"><span class="command">lemma</span></span> c_pair_mono1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x1</span> <span class="main">≤</span> <span class="free">x2</span> <span class="main">⟹</span> c_pair <span class="free">x1</span> <span class="free">y</span> <span class="main">≤</span> c_pair <span class="free">x2</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x1</span> <span class="main">≤</span> <span class="free">x2</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x1</span> <span class="main">&lt;</span> <span class="free">x2</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x1</span> <span class="free">y</span> <span class="main">&lt;</span> c_pair <span class="free">x2</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_strict_mono1<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">x1</span> <span class="main">&lt;</span> <span class="free">x2</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x1</span> <span class="main">=</span> <span class="free">x2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_pair_strict_mono2"><span class="command">lemma</span></span> c_pair_strict_mono2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y1</span> <span class="main">&lt;</span> <span class="free">y2</span> <span class="main">⟹</span> c_pair <span class="free">x</span> <span class="free">y1</span> <span class="main">&lt;</span> c_pair <span class="free">x</span> <span class="free">y2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y1</span> <span class="main">&lt;</span> <span class="free">y2</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">+</span> <span class="free">y1</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">+</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_sum_mono<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_pair_mono2"><span class="command">lemma</span></span> c_pair_mono2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y1</span> <span class="main">≤</span> <span class="free">y2</span> <span class="main">⟹</span> c_pair <span class="free">x</span> <span class="free">y1</span> <span class="main">≤</span> c_pair <span class="free">x</span> <span class="free">y2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y1</span> <span class="main">≤</span> <span class="free">y2</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">y1</span> <span class="main">&lt;</span> <span class="free">y2</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y1</span> <span class="main">&lt;</span> c_pair <span class="free">x</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_strict_mono2<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">y1</span> <span class="main">&lt;</span> <span class="free">y2</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">y1</span> <span class="main">=</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Inverse mapping›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>c_fst›</span></span></span></span> and <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>c_snd›</span></span></span></span> are the functions which yield
  the inverse mapping to <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>c_pair›</span></span></span></span>.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_sum</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_sum</span> <span class="free"><span class="bound"><span class="entity">u</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">LEAST</span> <span class="bound">z</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">u</span></span></span> <span class="main">&lt;</span> sf <span class="main">(</span><span class="bound">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_fst</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_fst</span> <span class="free"><span class="bound"><span class="entity">u</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">u</span></span></span> <span class="main">-</span> sf <span class="main">(</span>c_sum <span class="free"><span class="bound"><span class="entity">u</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_snd</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_snd</span> <span class="free"><span class="bound"><span class="entity">u</span></span></span> <span class="main">=</span> c_sum <span class="free"><span class="bound"><span class="entity">u</span></span></span> <span class="main">-</span> c_fst <span class="free"><span class="bound"><span class="entity">u</span></span></span>"</span></span>

<span class="keyword1" id="CPair-arg_less_sf_at_Suc_of_c_sum"><span class="command">lemma</span></span> arg_less_sf_at_Suc_of_c_sum<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&lt;</span> sf <span class="main">(</span><span class="main">(</span>c_sum <span class="free">u</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">+</span><span class="main">1</span> <span class="main">≤</span> sf<span class="main">(</span><span class="free">u</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> arg_le_sf<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="free">u</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> c_sum_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> LeastI<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-arg_less_sf_imp_c_sum_less_arg"><span class="command">lemma</span></span> arg_less_sf_imp_c_sum_less_arg<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">⟹</span> c_sum <span class="free">u</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">x</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">=</span><span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
    <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> Suc <span class="skolem">y</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="skolem">y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Least <span class="main">(</span><span class="main">%</span><span class="bound">z</span><span class="main">.</span> <span class="free">u</span> <span class="main">&lt;</span> sf <span class="main">(</span><span class="bound">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Least_le<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"c_sum <span class="free">u</span> <span class="main">≤</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">fold</span> c_sum_def<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-sf_c_sum_le_arg"><span class="command">lemma</span></span> sf_c_sum_le_arg<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">≥</span> sf <span class="main">(</span>c_sum <span class="free">u</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_sum <span class="free">u</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> arg_less_sf_at_Suc_of_c_sum <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&lt;</span> sf <span class="main">(</span><span class="var">?z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> c_sum <span class="free">u</span> <span class="main">&lt;</span> c_sum <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> arg_less_sf_imp_c_sum_less_arg S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">u</span> <span class="main">&lt;</span> sf <span class="main">(</span>c_sum <span class="free">u</span><span class="main">)</span> "</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_sum_le_arg"><span class="command">lemma</span></span> c_sum_le_arg<span class="main">:</span> <span class="quoted"><span class="quoted">"c_sum <span class="free">u</span> <span class="main">≤</span> <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_sum <span class="free">u</span> <span class="main">≤</span> sf <span class="main">(</span>c_sum <span class="free">u</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> arg_le_sf<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span>c_sum <span class="free">u</span><span class="main">)</span> <span class="main">≤</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_c_sum_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_sum_of_c_pair"><span class="command">lemma</span></span> c_sum_of_c_pair <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"c_sum <span class="main">(</span>c_pair <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span> <span class="main">+</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?u</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_sum <span class="var">?u</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?u</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="var">?z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> arg_less_sf_at_Suc_of_c_sum<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="var">?z</span><span class="main">)</span> <span class="main">≤</span> <span class="var">?u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_c_sum_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">)</span><span class="main">+</span><span class="free">x</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="var">?z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="var">?z</span><span class="main">)</span> <span class="main">≤</span> sf<span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">)</span> <span class="main">+</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">)</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="var">?z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S5 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">+</span><span class="free">y</span> <span class="main">&lt;</span> <span class="var">?z</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_less_sfD<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S6 <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">+</span><span class="free">y</span> <span class="main">≤</span> <span class="var">?z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S4 <span class="keyword1"><span class="command">have</span></span> S8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?z</span> <span class="main">≤</span> <span class="free">x</span><span class="main">+</span><span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_aux2<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S7 S8 <span class="keyword1"><span class="command">have</span></span> S9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?z</span> <span class="main">=</span> <span class="free">x</span><span class="main">+</span><span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S9 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_fst_of_c_pair"><span class="command">lemma</span></span> c_fst_of_c_pair<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_pair <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?u</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_sum <span class="var">?u</span> <span class="main">=</span> <span class="free">x</span> <span class="main">+</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="var">?u</span> <span class="main">=</span> <span class="var">?u</span> <span class="main">-</span> sf<span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_fst_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?u</span> <span class="main">=</span> sf<span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">)</span> <span class="main">+</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_snd_of_c_pair"><span class="command">lemma</span></span> c_snd_of_c_pair<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="main">(</span>c_pair <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?u</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_sum <span class="var">?u</span> <span class="main">=</span> <span class="free">x</span> <span class="main">+</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="var">?u</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_snd_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_pair_at_0"><span class="command">lemma</span></span> c_pair_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="main">0</span> <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sf_def c_pair_def<span class="main">)</span>

<span class="keyword1" id="CPair-c_fst_at_0"><span class="command">lemma</span></span> c_fst_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="main">0</span> <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_at_0<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="main">0</span> <span class="main">=</span> c_fst <span class="main">(</span>c_pair <span class="main">0</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_snd_at_0"><span class="command">lemma</span></span> c_snd_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="main">0</span> <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_at_0<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"c_snd <span class="main">0</span> <span class="main">=</span> c_snd <span class="main">(</span>c_pair <span class="main">0</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-sf_c_sum_plus_c_fst"><span class="command">lemma</span></span> sf_c_sum_plus_c_fst<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span>c_sum <span class="free">u</span><span class="main">)</span> <span class="main">+</span> c_fst <span class="free">u</span> <span class="main">=</span> <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span>c_sum <span class="free">u</span><span class="main">)</span> <span class="main">≤</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_c_sum_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">u</span> <span class="main">=</span> <span class="free">u</span> <span class="main">-</span> sf<span class="main">(</span>c_sum <span class="free">u</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_fst_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_fst_le_c_sum"><span class="command">lemma</span></span> c_fst_le_c_sum<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">u</span> <span class="main">≤</span> c_sum <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span>c_sum <span class="free">u</span><span class="main">)</span> <span class="main">+</span> c_fst <span class="free">u</span> <span class="main">=</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_c_sum_plus_c_fst<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="main">(</span>c_sum <span class="free">u</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> arg_less_sf_at_Suc_of_c_sum<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 sf_aux3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_snd_le_c_sum"><span class="command">lemma</span></span> c_snd_le_c_sum<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">u</span> <span class="main">≤</span> c_sum <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_snd_def<span class="main">)</span>

<span class="keyword1" id="CPair-c_fst_le_arg"><span class="command">lemma</span></span> c_fst_le_arg<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">u</span> <span class="main">≤</span> <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="free">u</span> <span class="main">≤</span> c_sum <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_fst_le_c_sum<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_sum <span class="free">u</span> <span class="main">≤</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_sum_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_snd_le_arg"><span class="command">lemma</span></span> c_snd_le_arg<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">u</span> <span class="main">≤</span> <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_snd <span class="free">u</span> <span class="main">≤</span> c_sum <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_snd_le_c_sum<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_sum <span class="free">u</span> <span class="main">≤</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_sum_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_sum_is_sum"><span class="command">lemma</span></span> c_sum_is_sum<span class="main">:</span> <span class="quoted"><span class="quoted">"c_sum <span class="free">u</span> <span class="main">=</span> c_fst <span class="free">u</span> <span class="main">+</span> c_snd <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_snd_def c_fst_le_c_sum<span class="main">)</span>
 
<span class="keyword1" id="CPair-proj_eq_imp_arg_eq"><span class="command">lemma</span></span> proj_eq_imp_arg_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> c_fst <span class="free">u</span> <span class="main">=</span> c_fst <span class="free">v</span><span class="main">;</span> c_snd <span class="free">u</span> <span class="main">=</span> c_snd <span class="free">v</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">u</span> <span class="main">=</span> <span class="free">v</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">u</span> <span class="main">=</span> c_fst <span class="free">v</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">u</span> <span class="main">=</span> c_snd <span class="free">v</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 c_sum_is_sum <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_sum <span class="free">u</span> <span class="main">=</span> c_sum <span class="free">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span>c_sum <span class="free">u</span><span class="main">)</span> <span class="main">+</span> c_fst <span class="free">u</span> <span class="main">=</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_c_sum_plus_c_fst<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 S1 S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span>c_sum <span class="free">v</span><span class="main">)</span> <span class="main">+</span> c_fst <span class="free">v</span> <span class="main">=</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 sf_c_sum_plus_c_fst <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_pair_of_c_fst_c_snd"><span class="command">lemma</span></span> c_pair_of_c_fst_c_snd<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="main">(</span>c_fst <span class="free">u</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="free">u</span><span class="main">)</span> <span class="main">=</span> <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">u</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">u</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?x</span> <span class="var">?y</span> <span class="main">=</span> sf<span class="main">(</span><span class="var">?x</span> <span class="main">+</span> <span class="var">?y</span><span class="main">)</span> <span class="main">+</span> <span class="var">?x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_sum <span class="free">u</span> <span class="main">=</span> <span class="var">?x</span> <span class="main">+</span> <span class="var">?y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_sum_is_sum<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?x</span> <span class="var">?y</span> <span class="main">=</span> sf<span class="main">(</span>c_sum <span class="free">u</span><span class="main">)</span> <span class="main">+</span> c_fst <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sf_c_sum_plus_c_fst<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_sum_eq_arg"><span class="command">lemma</span></span> c_sum_eq_arg<span class="main">:</span> <span class="quoted"><span class="quoted">"c_sum <span class="free">x</span> <span class="main">=</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_sum <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span>c_sum <span class="free">x</span><span class="main">)</span> <span class="main">+</span> c_fst <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_c_sum_plus_c_fst<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="free">x</span> <span class="main">+</span> c_fst <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> sf <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> arg_le_sf<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 S3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="free">x</span><span class="main">)</span><span class="main">=</span><span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_eq_arg<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_sum_eq_arg_2"><span class="command">lemma</span></span> c_sum_eq_arg_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_sum <span class="free">x</span> <span class="main">=</span> <span class="free">x</span> <span class="main">⟹</span> c_fst <span class="free">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_sum <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span>c_sum <span class="free">x</span><span class="main">)</span> <span class="main">+</span> c_fst <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sf_c_sum_plus_c_fst<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="free">x</span> <span class="main">+</span> c_fst <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> sf <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> arg_le_sf<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_fst_eq_arg"><span class="command">lemma</span></span> c_fst_eq_arg<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">x</span> <span class="main">=</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">x</span> <span class="main">≤</span> c_sum <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_fst_le_c_sum<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_sum <span class="free">x</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_sum_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 S1 S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_sum <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="free">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_sum_eq_arg_2<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_fst_less_arg"><span class="command">lemma</span></span> c_fst_less_arg<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> c_fst <span class="free">x</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="free">x</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> c_fst <span class="free">x</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">x</span> <span class="main">≥</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="free">x</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_fst_le_arg<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_fst_eq_arg<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_snd_eq_arg"><span class="command">lemma</span></span> c_snd_eq_arg<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">x</span> <span class="main">=</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">x</span> <span class="main">≤</span> c_sum <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_snd_le_c_sum<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_sum <span class="free">x</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_sum_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 S1 S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_sum <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>  
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_sum_eq_arg<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="CPair-c_snd_less_arg"><span class="command">lemma</span></span> c_snd_less_arg<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">⟹</span> c_snd <span class="free">x</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"c_snd <span class="free">x</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> c_snd <span class="free">x</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">x</span> <span class="main">≥</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_snd <span class="free">x</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_snd_le_arg<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_snd <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_snd_eq_arg<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="PRecFun">
<div class="head">
<h1>Theory PRecFun</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Primitive recursive function
    Author:      Michael Nedzelsky &lt;MichaelNedzelsky at yandex.ru&gt;, 2008
    Maintainer:  Michael Nedzelsky &lt;MichaelNedzelsky at yandex.ru&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Primitive recursive functions›</span></span>

<span class="keyword1"><span class="command">theory</span></span> PRecFun <span class="keyword2"><span class="keyword">imports</span></span> <a href="CPair.html">CPair</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  This theory contains definition of the primitive recursive functions.
›</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Basic definitions›</span></span>

<span class="keyword1"><span class="command">primrec</span></span>
  <span class="entity">PrimRecOp</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat<span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">PrimRecOp</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">0</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>  <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">PrimRecOp</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">(</span>Suc <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">(</span><span class="free">PrimRecOp</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1"><span class="command">primrec</span></span>
  <span class="entity">PrimRecOp_last</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat<span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">PrimRecOp_last</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">0</span>  <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">PrimRecOp_last</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">(</span>Suc <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span><span class="main">=</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">(</span><span class="free">PrimRecOp_last</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>

<span class="keyword1"><span class="command">primrec</span></span>
  <span class="entity">PrimRecOp1</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">PrimRecOp1</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">0</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">PrimRecOp1</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">(</span>Suc <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">(</span><span class="free">PrimRecOp1</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">inductive_set</span></span> 
  <span class="entity">PrimRec1</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="entity">PrimRec2</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat<span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="entity">PrimRec3</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat<span class="main">)</span> set"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  zero<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec1</span>"</span></span>
  <span class="main">|</span> suc<span class="main">:</span>   <span class="quoted"><span class="quoted">"Suc <span class="main">∈</span> <span class="free">PrimRec1</span>"</span></span>
  <span class="main">|</span> id1_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec1</span>"</span></span>
  <span class="main">|</span> id2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec2</span>"</span></span>
  <span class="main">|</span> id2_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec2</span>"</span></span>
  <span class="main">|</span> id3_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec3</span>"</span></span>
  <span class="main">|</span> id3_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec3</span>"</span></span>
  <span class="main">|</span> id3_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">z</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec3</span>"</span></span>
  <span class="main">|</span> comp1_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec1</span>"</span></span>
  <span class="main">|</span> comp1_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∈</span> <span class="free">PrimRec2</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec2</span>"</span></span>
  <span class="main">|</span> comp1_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∈</span> <span class="free">PrimRec3</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec3</span>"</span></span>
  <span class="main">|</span> comp2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> <span class="free">PrimRec2</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec1</span>"</span></span>
  <span class="main">|</span> comp3_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> <span class="free">PrimRec3</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec1</span>"</span></span>
  <span class="main">|</span> comp2_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> <span class="free">PrimRec2</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∈</span> <span class="free">PrimRec2</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">∈</span> <span class="free">PrimRec2</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec2</span>"</span></span>
  <span class="main">|</span> comp2_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> <span class="free">PrimRec2</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∈</span> <span class="free">PrimRec3</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">∈</span> <span class="free">PrimRec3</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec3</span>"</span></span>
  <span class="main">|</span> comp3_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> <span class="free">PrimRec3</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∈</span> <span class="free">PrimRec2</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">∈</span> <span class="free">PrimRec2</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="main">∈</span> <span class="free">PrimRec2</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec2</span>"</span></span>
  <span class="main">|</span> comp3_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> <span class="free">PrimRec3</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∈</span> <span class="free">PrimRec3</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">∈</span> <span class="free">PrimRec3</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="main">∈</span> <span class="free">PrimRec3</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec3</span>"</span></span>
  <span class="main">|</span> prim_rec<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">∈</span> <span class="free">PrimRec3</span><span class="main">⟧</span> <span class="main">⟹</span> PrimRecOp <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">∈</span> <span class="free">PrimRec2</span>"</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> pr_zero <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.zero
<span class="keyword1"><span class="command">lemmas</span></span> pr_suc <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.suc
<span class="keyword1"><span class="command">lemmas</span></span> pr_id1_1 <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.id1_1
<span class="keyword1"><span class="command">lemmas</span></span> pr_id2_1 <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.id2_1
<span class="keyword1"><span class="command">lemmas</span></span> pr_id2_2 <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.id2_2
<span class="keyword1"><span class="command">lemmas</span></span> pr_id3_1 <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.id3_1
<span class="keyword1"><span class="command">lemmas</span></span> pr_id3_2 <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.id3_2
<span class="keyword1"><span class="command">lemmas</span></span> pr_id3_3 <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.id3_3
<span class="keyword1"><span class="command">lemmas</span></span> pr_comp1_1 <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.comp1_1
<span class="keyword1"><span class="command">lemmas</span></span> pr_comp1_2 <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.comp1_2
<span class="keyword1"><span class="command">lemmas</span></span> pr_comp1_3 <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.comp1_3
<span class="keyword1"><span class="command">lemmas</span></span> pr_comp2_1 <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.comp2_1
<span class="keyword1"><span class="command">lemmas</span></span> pr_comp2_2 <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.comp2_2
<span class="keyword1"><span class="command">lemmas</span></span> pr_comp2_3 <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.comp2_3
<span class="keyword1"><span class="command">lemmas</span></span> pr_comp3_1 <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.comp3_1
<span class="keyword1"><span class="command">lemmas</span></span> pr_comp3_2 <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.comp3_2
<span class="keyword1"><span class="command">lemmas</span></span> pr_comp3_3 <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.comp3_3
<span class="keyword1"><span class="command">lemmas</span></span> pr_rec <span class="main">=</span> PrimRec1_PrimRec2_PrimRec3.prim_rec

<span class="keyword1"><span class="command">ML_file</span></span> <span class="quoted">‹Utils.ML›</span>

<span class="keyword1"><span class="command">named_theorems</span></span> prec

<span class="keyword1"><span class="command">method_setup</span></span> prec0 <span class="main">=</span> <span class="quoted">‹
  <span class="entity">Attrib.thms</span> &gt;&gt; <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">ths</span> <span class="main">=&gt;</span> <span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">ctxt</span> <span class="main">=&gt;</span> <span class="entity">Method.METHOD</span> <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">facts</span> <span class="main">=&gt;</span>
    HEADGOAL <span class="main">(</span><span class="entity">prec0_tac</span> <span class="entity">ctxt</span> <span class="main">(</span><span class="entity">facts</span> @ <span class="entity">Named_Theorems.get</span> <span class="entity">ctxt</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">named_theorems</span> prec<span class="antiquote">}</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
›</span> <span class="quoted">"apply primitive recursive functions"</span>


<span class="keyword1"><span class="command">lemmas</span></span> <span class="main">[</span><span class="operator">prec</span><span class="main">]</span> <span class="main">=</span> pr_zero pr_suc pr_id1_1 pr_id2_1 pr_id2_2 pr_id3_1 pr_id3_2 pr_id3_3

<span class="keyword1" id="PRecFun-pr_swap"><span class="command">lemma</span></span> pr_swap<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec2 <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">f</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec0</span>

<span class="keyword1"><span class="command">theorem</span></span> pr_rec_scheme<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">g</span> <span class="main">∈</span> PrimRec1<span class="main">;</span> <span class="free">h</span> <span class="main">∈</span> PrimRec3<span class="main">;</span> <span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">0</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">g</span> <span class="bound">x</span><span class="main">;</span> <span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">h</span> <span class="bound">y</span> <span class="main">(</span><span class="free">f</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> h_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> PrimRec3"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> f_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">0</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">g</span> <span class="bound">x</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> f_at_Suc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">h</span> <span class="bound">y</span> <span class="main">(</span><span class="free">f</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> f_at_0 f_at_Suc <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">f</span> <span class="bound">y</span> <span class="bound">x</span>  <span class="main">=</span> PrimRecOp <span class="free">g</span> <span class="free">h</span> <span class="bound">y</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct_tac</span> <span class="quoted"><span class="improper"><span class="quoted"><span class="improper">y</span></span></span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> PrimRecOp <span class="free">g</span> <span class="free">h</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ext<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> g_is_pr h_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_rec<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-op_plus_is_pr"><span class="command">lemma</span></span> op_plus_is_pr <span class="main">[</span><span class="operator">prec</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">x</span> <span class="main">+</span> <span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> pr_swap<span class="main">)</span>
 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span><span class="main">+</span><span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"PrimRecOp <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> Suc <span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> pr_rec<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id1_1<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> Suc <span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec0</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span><span class="main">+</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> PrimRecOp <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> Suc <span class="bound">y</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?f</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="var">?f</span> <span class="bound">y</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">y</span> <span class="main">+</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct_tac</span> <span class="quoted"><span class="improper"><span class="quoted"><span class="improper">y</span></span></span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ext<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-op_mult_is_pr"><span class="command">lemma</span></span> op_mult_is_pr <span class="main">[</span><span class="operator">prec</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">x</span><span class="main">*</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> pr_swap<span class="main">)</span>
 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span><span class="main">*</span><span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"PrimRecOp <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">y</span><span class="main">+</span><span class="bound">z</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> pr_rec<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_zero<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">y</span><span class="main">+</span><span class="bound">z</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec0</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span><span class="main">*</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> PrimRecOp <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">y</span><span class="main">+</span><span class="bound">z</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?f</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="var">?f</span> <span class="bound">y</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">y</span> <span class="main">*</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct_tac</span> <span class="quoted"><span class="improper"><span class="quoted"><span class="improper">y</span></span></span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ext<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-const_is_pr"><span class="command">lemma</span></span> const_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="free">n</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_zero<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec0</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-const_is_pr_2"><span class="command">lemma</span></span> const_is_pr_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">n</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> pr_comp1_2 <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?f</span><span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">%</span></span><span class="bound"><span class="bound">x</span></span><span class="main"><span class="main">.</span></span><span class="main"><span class="main">(</span></span><span class="free"><span class="free">n</span></span><span class="main"><span class="main">::</span></span>nat<span class="main"><span class="main">)</span></span>"</span></span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">and</span></span></span></span> <span class="var">?g</span><span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">%</span></span><span class="bound"><span class="bound">x</span></span> <span class="bound"><span class="bound">y</span></span><span class="main"><span class="main">.</span></span> <span class="bound"><span class="bound">x</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free">n</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> const_is_pr<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id2_1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-const_is_pr_3"><span class="command">lemma</span></span> const_is_pr_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span><span class="free">n</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> pr_comp1_3 <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?f</span><span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">%</span></span><span class="bound"><span class="bound">x</span></span><span class="main"><span class="main">.</span></span><span class="main"><span class="main">(</span></span><span class="free"><span class="free">n</span></span><span class="main"><span class="main">::</span></span>nat<span class="main"><span class="main">)</span></span>"</span></span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">and</span></span></span></span> <span class="var">?g</span><span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">%</span></span><span class="bound"><span class="bound">x</span></span> <span class="bound"><span class="bound">y</span></span> <span class="bound"><span class="bound">z</span></span><span class="main"><span class="main">.</span></span> <span class="bound"><span class="bound">x</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free">n</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> const_is_pr<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id3_1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> pr_rec_last<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">g</span> <span class="main">∈</span> PrimRec1<span class="main">;</span> <span class="free">h</span> <span class="main">∈</span> PrimRec3<span class="main">⟧</span> <span class="main">⟹</span> PrimRecOp_last <span class="free">g</span> <span class="free">h</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> PrimRec3"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?h1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="free">h</span> <span class="bound">z</span> <span class="bound">y</span> <span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 pr_id3_3 pr_id3_2 pr_id3_1 <span class="keyword1"><span class="command">have</span></span> h1_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?h1</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_comp3_3<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"PrimRecOp <span class="free">g</span> <span class="var">?h1</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 h1_is_pr <span class="keyword1"><span class="command">have</span></span> f1_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?f1</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_rec<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="var">?f1</span> <span class="bound">y</span> <span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> f1_is_pr <span class="keyword1"><span class="command">have</span></span> f_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_swap<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="var">?f</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> PrimRecOp_last <span class="free">g</span> <span class="free">h</span> <span class="bound">x</span> <span class="bound">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct_tac</span> <span class="quoted"><span class="improper"><span class="quoted"><span class="improper">y</span></span></span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">=</span> PrimRecOp_last <span class="free">g</span> <span class="free">h</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ext<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> f_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> pr_rec1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> PrimRec2 <span class="main">⟹</span> PrimRecOp1 <span class="main">(</span><span class="free">a</span><span class="main">::</span>nat<span class="main">)</span> <span class="free">h</span> <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free">a</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?g</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> const_is_pr<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?h1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="free">h</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> h1_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?h1</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec0</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"PrimRecOp <span class="var">?g</span> <span class="var">?h1</span>"</span></span>  
  <span class="keyword1"><span class="command">from</span></span> g_is_pr h1_is_pr <span class="keyword1"><span class="command">have</span></span> f1_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?f1</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_rec<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="var">?f1</span> <span class="bound">x</span> <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> f1_is_pr pr_id1_1 pr_zero <span class="keyword1"><span class="command">have</span></span> f_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_comp2_1<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">y</span><span class="main">.</span> <span class="var">?f</span> <span class="bound">y</span> <span class="main">=</span> PrimRecOp1 <span class="free">a</span> <span class="free">h</span> <span class="bound">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct_tac</span> <span class="quoted"><span class="improper"><span class="quoted"><span class="improper">y</span></span></span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">=</span> PrimRecOp1 <span class="free">a</span> <span class="free">h</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ext<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> f_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> pr_rec1_scheme<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">h</span> <span class="main">∈</span> PrimRec2<span class="main">;</span> <span class="free">f</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span><span class="main">;</span> <span class="main">∀</span> <span class="bound">y</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">h</span> <span class="bound">y</span> <span class="main">(</span><span class="free">f</span> <span class="bound">y</span><span class="main">)</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> h_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> f_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> f_at_Suc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">y</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">h</span> <span class="bound">y</span> <span class="main">(</span><span class="free">f</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> f_at_0 f_at_Suc <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">y</span><span class="main">.</span> <span class="free">f</span> <span class="bound">y</span>  <span class="main">=</span> PrimRecOp1 <span class="free">a</span> <span class="free">h</span> <span class="bound">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct_tac</span> <span class="quoted"><span class="improper"><span class="quoted"><span class="improper">y</span></span></span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> PrimRecOp1 <span class="free">a</span> <span class="free">h</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ext<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> h_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_rec1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-pred_is_pr"><span class="command">lemma</span></span> pred_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"PrimRecOp1 <span class="main">0</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> pr_rec1<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id2_1<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">=</span> PrimRecOp1 <span class="main">0</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?f</span>"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="var">?f</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">x</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct_tac</span> <span class="quoted"><span class="improper"><span class="quoted"><span class="improper">x</span></span></span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ext<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-op_sub_is_pr"><span class="command">lemma</span></span> op_sub_is_pr <span class="main">[</span><span class="operator">prec</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">x</span><span class="main">-</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> pr_swap<span class="main">)</span>
 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">-</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"PrimRecOp <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span>  <span class="bound">y</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> pr_rec<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id1_1<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">from</span></span> pred_is_pr pr_id3_2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">y</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_comp1_3<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">-</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> PrimRecOp <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span>  <span class="bound">y</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?f</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="var">?f</span> <span class="bound">y</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">x</span> <span class="main">-</span> <span class="bound">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct_tac</span> <span class="quoted"><span class="improper"><span class="quoted"><span class="improper">y</span></span></span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ext<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> <span class="main">[</span><span class="operator">prec</span><span class="main">]</span> <span class="main">=</span>
  const_is_pr <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="main">0</span></span><span class="main">]</span> const_is_pr_2 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="main">0</span></span><span class="main">]</span> const_is_pr_3 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="main">0</span></span><span class="main">]</span>
  const_is_pr <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="main">1</span></span><span class="main">]</span> const_is_pr_2 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="main">1</span></span><span class="main">]</span> const_is_pr_3 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="main">1</span></span><span class="main">]</span>
  const_is_pr <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="numeral">2</span></span><span class="main">]</span> const_is_pr_2 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="numeral">2</span></span><span class="main">]</span> const_is_pr_3 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="numeral">2</span></span><span class="main">]</span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">sgn1</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">sgn1</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">case</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">of</span> <span class="main">0</span> <span class="main">⇒</span> <span class="main">0</span> <span class="main">|</span> Suc <span class="bound">y</span> <span class="main">⇒</span> <span class="main">1</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">sgn2</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">sgn2</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">(</span><span class="keyword1">case</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">of</span> <span class="main">0</span> <span class="main">⇒</span> <span class="main">1</span> <span class="main">|</span> Suc <span class="bound">y</span> <span class="main">⇒</span> <span class="main">0</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">abs_of_diff</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">abs_of_diff</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">-</span> <span class="bound">y</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="bound">y</span> <span class="main">-</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"sgn1 <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sgn1_def<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"sgn1 <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sgn1_def<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"sgn2 <span class="main">0</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sgn2_def<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"sgn2 <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sgn2_def<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> sgn1 <span class="free">x</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sgn1_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">cases</span> <span class="quoted"><span class="free">x</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> sgn2 <span class="free">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sgn2_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">cases</span> <span class="quoted"><span class="free">x</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="PRecFun-sgn1_nz_impl_arg_pos"><span class="command">lemma</span></span> sgn1_nz_impl_arg_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"sgn1 <span class="free">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">x</span></span><span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1" id="PRecFun-sgn1_zero_impl_arg_zero"><span class="command">lemma</span></span> sgn1_zero_impl_arg_zero<span class="main">:</span> <span class="quoted"><span class="quoted">"sgn1 <span class="free">x</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">x</span></span><span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1" id="PRecFun-sgn2_nz_impl_arg_zero"><span class="command">lemma</span></span> sgn2_nz_impl_arg_zero<span class="main">:</span> <span class="quoted"><span class="quoted">"sgn2 <span class="free">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">x</span></span><span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1" id="PRecFun-sgn2_zero_impl_arg_pos"><span class="command">lemma</span></span> sgn2_zero_impl_arg_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"sgn2 <span class="free">x</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">x</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1" id="PRecFun-sgn1_nz_eq_arg_pos"><span class="command">lemma</span></span> sgn1_nz_eq_arg_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>sgn1 <span class="free">x</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">x</span></span><span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1" id="PRecFun-sgn1_zero_eq_arg_zero"><span class="command">lemma</span></span> sgn1_zero_eq_arg_zero<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>sgn1 <span class="free">x</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">x</span></span><span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1" id="PRecFun-sgn2_nz_eq_arg_pos"><span class="command">lemma</span></span> sgn2_nz_eq_arg_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>sgn2 <span class="free">x</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">x</span></span><span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1" id="PRecFun-sgn2_zero_eq_arg_zero"><span class="command">lemma</span></span> sgn2_zero_eq_arg_zero<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>sgn2 <span class="free">x</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">x</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1" id="PRecFun-sgn1_pos_eq_one"><span class="command">lemma</span></span> sgn1_pos_eq_one<span class="main">:</span> <span class="quoted"><span class="quoted">"sgn1 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> sgn1 <span class="free">x</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">x</span></span><span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1" id="PRecFun-sgn2_pos_eq_one"><span class="command">lemma</span></span> sgn2_pos_eq_one<span class="main">:</span> <span class="quoted"><span class="quoted">"sgn2 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> sgn2 <span class="free">x</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">x</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1" id="PRecFun-sgn2_eq_1_sub_arg"><span class="command">lemma</span></span> sgn2_eq_1_sub_arg<span class="main">:</span> <span class="quoted"><span class="quoted">"sgn2 <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">1</span> <span class="main">-</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ext<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"sgn2 <span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">x</span></span><span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-sgn1_eq_1_sub_sgn2"><span class="command">lemma</span></span> sgn1_eq_1_sub_sgn2<span class="main">:</span> <span class="quoted"><span class="quoted">"sgn1  <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">1</span> <span class="main">-</span> <span class="main">(</span>sgn2 <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"sgn1 <span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> sgn2 <span class="skolem">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">-</span> sgn2 <span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sgn2_eq_1_sub_arg<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sgn1_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">cases</span> <span class="quoted"><span class="skolem">x</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-sgn2_is_pr"><span class="command">lemma</span></span> sgn2_is_pr <span class="main">[</span><span class="operator">prec</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"sgn2 <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">1</span> <span class="main">-</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec0</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sgn2_eq_1_sub_arg<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-sgn1_is_pr"><span class="command">lemma</span></span> sgn1_is_pr <span class="main">[</span><span class="operator">prec</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"sgn1 <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> sgn2_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">1</span> <span class="main">-</span> <span class="main">(</span>sgn2 <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec0</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sgn1_eq_1_sub_sgn2<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-abs_of_diff_is_pr"><span class="command">lemma</span></span> abs_of_diff_is_pr <span class="main">[</span><span class="operator">prec</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"abs_of_diff <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> abs_of_diff_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec0</span>

<span class="keyword1" id="PRecFun-abs_of_diff_eq"><span class="command">lemma</span></span> abs_of_diff_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abs_of_diff <span class="free">x</span> <span class="free">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">=</span> <span class="free">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> abs_of_diff_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">arith</span><span class="main">)</span>

<span class="keyword1" id="PRecFun-sf_is_pr"><span class="command">lemma</span></span> sf_is_pr <span class="main">[</span><span class="operator">prec</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"sf <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"PrimRecOp1 <span class="main">0</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">+</span> <span class="bound">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> pr_rec1<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">+</span> <span class="bound">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec0</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> sf <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> PrimRecOp1 <span class="main">0</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">+</span> <span class="bound">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?f</span>"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="var">?f</span> <span class="bound">x</span> <span class="main">=</span> sf <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct_tac</span> <span class="quoted"><span class="improper"><span class="quoted"><span class="improper">x</span></span></span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">0</span> <span class="main">=</span> sf <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sf_at_0<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="skolem">x</span> <span class="main">=</span> sf <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> sf_at_Suc <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">(</span>Suc <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> sf <span class="main">(</span>Suc <span class="skolem">x</span><span class="main">)</span>"</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ext<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-c_pair_is_pr"><span class="command">lemma</span></span> c_pair_is_pr <span class="main">[</span><span class="operator">prec</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> sf <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="bound">y</span><span class="main">)</span> <span class="main">+</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def ext<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> sf_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> sf <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="bound">y</span><span class="main">)</span> <span class="main">+</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec0</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-if_is_pr"><span class="command">lemma</span></span> if_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">p</span> <span class="main">∈</span> PrimRec1<span class="main">;</span> <span class="free">q1</span> <span class="main">∈</span> PrimRec1<span class="main">;</span> <span class="free">q2</span> <span class="main">∈</span> PrimRec1<span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="keyword1">if</span> <span class="main">(</span><span class="free">p</span> <span class="bound">x</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> if_as_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="keyword1">if</span> <span class="main">(</span><span class="free">p</span> <span class="bound">x</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span>sgn2 <span class="main">(</span><span class="free">p</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>sgn1 <span class="main">(</span><span class="free">p</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ext<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">if</span> <span class="main">(</span><span class="free">p</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="skolem">x</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>sgn2 <span class="main">(</span><span class="free">p</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q1</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>sgn1 <span class="main">(</span><span class="free">p</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q2</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?left</span> <span class="main">=</span> <span class="var">?right</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?left</span> <span class="main">=</span> <span class="free">q1</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?right</span> <span class="main">=</span> <span class="free">q1</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="skolem">x</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="skolem">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">q1</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">q2</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span>sgn2 <span class="main">(</span><span class="free">p</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>sgn1 <span class="main">(</span><span class="free">p</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec0</span>
  <span class="keyword1"><span class="command">with</span></span> if_as_pr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-if_eq_is_pr"><span class="command">lemma</span></span> if_eq_is_pr <span class="main">[</span><span class="operator">prec</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">p1</span> <span class="main">∈</span> PrimRec1<span class="main">;</span> <span class="free">p2</span> <span class="main">∈</span> PrimRec1<span class="main">;</span> <span class="free">q1</span> <span class="main">∈</span> PrimRec1<span class="main">;</span> <span class="free">q2</span> <span class="main">∈</span> PrimRec1<span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="keyword1">if</span> <span class="main">(</span><span class="free">p1</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">p2</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="keyword1">if</span> <span class="main">(</span><span class="free">p1</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">p2</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="keyword1">if</span> <span class="main">(</span>abs_of_diff <span class="main">(</span><span class="free">p1</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free">p2</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?L</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> abs_of_diff_eq<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p1</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p2</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword1"><span class="command">with</span></span> abs_of_diff_is_pr <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> abs_of_diff <span class="main">(</span><span class="free">p1</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free">p2</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec0</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">q1</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">q2</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> if_is_pr<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-if_is_pr2"><span class="command">lemma</span></span> if_is_pr2 <span class="main">[</span><span class="operator">prec</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">p</span> <span class="main">∈</span> PrimRec2<span class="main">;</span> <span class="free">q1</span> <span class="main">∈</span> PrimRec2<span class="main">;</span> <span class="free">q2</span> <span class="main">∈</span> PrimRec2<span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="keyword1">if</span> <span class="main">(</span><span class="free">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> if_as_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="keyword1">if</span> <span class="main">(</span><span class="free">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span>sgn2 <span class="main">(</span><span class="free">p</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>sgn1 <span class="main">(</span><span class="free">p</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ext<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ext<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">if</span> <span class="main">(</span><span class="free">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="skolem">x</span> <span class="skolem">y</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="skolem">x</span> <span class="skolem">y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>sgn2 <span class="main">(</span><span class="free">p</span> <span class="skolem">x</span> <span class="skolem">y</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q1</span> <span class="skolem">x</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>sgn1 <span class="main">(</span><span class="free">p</span> <span class="skolem">x</span> <span class="skolem">y</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q2</span> <span class="skolem">x</span> <span class="skolem">y</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?left</span> <span class="main">=</span> <span class="var">?right</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?left</span> <span class="main">=</span> <span class="free">q1</span> <span class="skolem">x</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?right</span> <span class="main">=</span> <span class="free">q1</span> <span class="skolem">x</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">q1</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">q2</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span>sgn2 <span class="main">(</span><span class="free">p</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>sgn1 <span class="main">(</span><span class="free">p</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec0</span>
  <span class="keyword1"><span class="command">with</span></span> if_as_pr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-if_eq_is_pr2"><span class="command">lemma</span></span> if_eq_is_pr2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">p1</span> <span class="main">∈</span> PrimRec2<span class="main">;</span> <span class="free">p2</span> <span class="main">∈</span> PrimRec2<span class="main">;</span> <span class="free">q1</span> <span class="main">∈</span> PrimRec2<span class="main">;</span> <span class="free">q2</span> <span class="main">∈</span> PrimRec2<span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="keyword1">if</span> <span class="main">(</span><span class="free">p1</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="free">p2</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="keyword1">if</span> <span class="main">(</span><span class="free">p1</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="free">p2</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="keyword1">if</span> <span class="main">(</span>abs_of_diff <span class="main">(</span><span class="free">p1</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">(</span><span class="free">p2</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?L</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> abs_of_diff_eq<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p1</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p2</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">with</span></span> abs_of_diff_is_pr <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> abs_of_diff <span class="main">(</span><span class="free">p1</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">(</span><span class="free">p2</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec0</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">q1</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">q2</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> if_is_pr2<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-if_is_pr3"><span class="command">lemma</span></span> if_is_pr3 <span class="main">[</span><span class="operator">prec</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">p</span> <span class="main">∈</span> PrimRec3<span class="main">;</span> <span class="free">q1</span> <span class="main">∈</span> PrimRec3<span class="main">;</span> <span class="free">q2</span> <span class="main">∈</span> PrimRec3<span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="keyword1">if</span> <span class="main">(</span><span class="free">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> if_as_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="keyword1">if</span> <span class="main">(</span><span class="free">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span>sgn2 <span class="main">(</span><span class="free">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>sgn1 <span class="main">(</span><span class="free">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ext<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ext<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ext<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">if</span> <span class="main">(</span><span class="free">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">z</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">z</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>sgn2 <span class="main">(</span><span class="free">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">z</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q1</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">z</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>sgn1 <span class="main">(</span><span class="free">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">z</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q2</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">z</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?left</span> <span class="main">=</span> <span class="var">?right</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">z</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?left</span> <span class="main">=</span> <span class="free">q1</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?right</span> <span class="main">=</span> <span class="free">q1</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">z</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">z</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">q1</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">q2</span> <span class="main">∈</span> PrimRec3"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span>sgn2 <span class="main">(</span><span class="free">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>sgn1 <span class="main">(</span><span class="free">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec0</span>
  <span class="keyword1"><span class="command">with</span></span> if_as_pr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-if_eq_is_pr3"><span class="command">lemma</span></span> if_eq_is_pr3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">p1</span> <span class="main">∈</span> PrimRec3<span class="main">;</span> <span class="free">p2</span> <span class="main">∈</span> PrimRec3<span class="main">;</span> <span class="free">q1</span> <span class="main">∈</span> PrimRec3<span class="main">;</span> <span class="free">q2</span> <span class="main">∈</span> PrimRec3<span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="keyword1">if</span> <span class="main">(</span><span class="free">p1</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span> <span class="main">=</span> <span class="free">p2</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="keyword1">if</span> <span class="main">(</span><span class="free">p1</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span> <span class="main">=</span> <span class="free">p2</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="keyword1">if</span> <span class="main">(</span>abs_of_diff <span class="main">(</span><span class="free">p1</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="main">(</span><span class="free">p2</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">q1</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span><span class="free">q2</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?L</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> abs_of_diff_eq<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p1</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p2</span> <span class="main">∈</span> PrimRec3"</span></span>
  <span class="keyword1"><span class="command">with</span></span> abs_of_diff_is_pr <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> abs_of_diff <span class="main">(</span><span class="free">p1</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="main">(</span><span class="free">p2</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec0</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">q1</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">q2</span> <span class="main">∈</span> PrimRec3"</span></span>
  <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> if_is_pr3<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">ML</span></span> <span class="quoted">‹
<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">get_if_by_index</span> <span class="inner_numeral">1</span> <span class="main">=</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> if_eq_is_pr<span class="antiquote">}</span></span></span>
  <span class="main">|</span> <span class="entity">get_if_by_index</span> <span class="inner_numeral">2</span> <span class="main">=</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> if_eq_is_pr2<span class="antiquote">}</span></span></span>
  <span class="main">|</span> <span class="entity">get_if_by_index</span> <span class="inner_numeral">3</span> <span class="main">=</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> if_eq_is_pr3<span class="antiquote">}</span></span></span>
  <span class="main">|</span> <span class="entity">get_if_by_index</span> <span class="main">_</span> <span class="main">=</span> <span class="keyword3"><span class="keyword">raise</span></span> <span class="entity">BadArgument</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">if_comp_tac</span> <span class="entity">ctxt</span> <span class="main">=</span> SUBGOAL <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="main">(</span><span class="entity">t</span><span class="main">,</span> <span class="entity">i</span><span class="main">)</span> <span class="main">=&gt;</span>
  <span class="keyword2"><span class="keyword">let</span></span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">t</span> <span class="main">=</span> <span class="entity">extract_trueprop_arg</span> <span class="main">(</span>Logic.strip_imp_concl <span class="entity">t</span><span class="main">)</span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="main">(</span><span class="entity">t1</span><span class="main">,</span> <span class="entity">t2</span><span class="main">)</span> <span class="main">=</span> <span class="entity">extract_set_args</span> <span class="entity">t</span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">n2</span> <span class="main">=</span>
      <span class="keyword2"><span class="keyword">let</span></span>
        <span class="keyword1"><span class="keyword">val</span></span> Const<span class="main">(</span><span class="entity">s</span><span class="main">,</span> <span class="main">_</span><span class="main">)</span> <span class="main">=</span> <span class="entity">t2</span>
      <span class="keyword2"><span class="keyword">in</span></span>
        <span class="entity">get_num_by_set</span> <span class="entity">s</span>
      <span class="keyword2"><span class="keyword">end</span></span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="main">(</span><span class="entity">name</span><span class="main">,</span> <span class="main">_</span><span class="main">,</span> <span class="entity">n1</span><span class="main">)</span> <span class="main">=</span> <span class="entity">extract_free_arg</span> <span class="entity">t1</span>
  <span class="keyword2"><span class="keyword">in</span></span>
    <span class="keyword2"><span class="keyword">if</span></span> <span class="entity">name</span> <span class="main">=</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">const_name</span> If<span class="antiquote">}</span></span> <span class="keyword2"><span class="keyword">then</span></span>
      resolve_tac <span class="entity">ctxt</span> <span class="main">[</span><span class="entity">get_if_by_index</span> <span class="entity">n2</span><span class="main">]</span> <span class="entity">i</span>
    <span class="keyword2"><span class="keyword">else</span></span>
      <span class="keyword2"><span class="keyword">let</span></span>
        <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">comp</span> <span class="main">=</span> <span class="entity">get_comp_by_indexes</span> <span class="main">(</span><span class="entity">n1</span><span class="main">,</span> <span class="entity">n2</span><span class="main">)</span>
      <span class="keyword2"><span class="keyword">in</span></span>
        <span class="entity">Rule_Insts.res_inst_tac</span> <span class="entity">ctxt</span>
          <span class="main">[</span><span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="inner_quoted">"f"</span><span class="main">,</span> <span class="inner_numeral">0</span><span class="main">)</span><span class="main">,</span> Position.none<span class="main">)</span><span class="main">,</span> Variable.revert_fixed <span class="entity">ctxt</span> <span class="entity">name</span><span class="main">)</span><span class="main">]</span> <span class="main">[</span><span class="main">]</span> <span class="entity">comp</span> <span class="entity">i</span>
      <span class="keyword2"><span class="keyword">end</span></span>
  <span class="keyword2"><span class="keyword">end</span></span>
  <span class="keyword3"><span class="keyword">handle</span></span> <span class="entity">BadArgument</span> <span class="main">=&gt;</span> no_tac<span class="main">)</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">prec_tac</span> <span class="entity">ctxt</span> <span class="entity">facts</span> <span class="entity">i</span> <span class="main">=</span>
  <span class="entity">Method.insert_tac</span> <span class="entity">ctxt</span> <span class="entity">facts</span> <span class="entity">i</span> THEN
  REPEAT <span class="main">(</span>resolve_tac <span class="entity">ctxt</span> <span class="main">[</span><span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> const_is_pr<span class="antiquote">}</span></span></span><span class="main">,</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> const_is_pr_2<span class="antiquote">}</span></span></span><span class="main">,</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> const_is_pr_3<span class="antiquote">}</span></span></span><span class="main">]</span> <span class="entity">i</span> ORELSE
    assume_tac <span class="entity">ctxt</span> <span class="entity">i</span> ORELSE <span class="entity">if_comp_tac</span> <span class="entity">ctxt</span> <span class="entity">i</span><span class="main">)</span>
›</span>

<span class="keyword1"><span class="command">method_setup</span></span> prec <span class="main">=</span> <span class="quoted">‹
  <span class="entity">Attrib.thms</span> &gt;&gt; <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">ths</span> <span class="main">=&gt;</span> <span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">ctxt</span> <span class="main">=&gt;</span> <span class="entity">Method.METHOD</span> <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">facts</span> <span class="main">=&gt;</span>
    HEADGOAL <span class="main">(</span><span class="entity">prec_tac</span> <span class="entity">ctxt</span> <span class="main">(</span><span class="entity">facts</span> @ <span class="entity">Named_Theorems.get</span> <span class="entity">ctxt</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">named_theorems</span> prec<span class="antiquote">}</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
›</span> <span class="quoted">"apply primitive recursive functions"</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Bounded least operator›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">b_least</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">b_least</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">(</span>Least <span class="main">(</span><span class="main">%</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∨</span> <span class="main">(</span><span class="bound">y</span> <span class="main">&lt;</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="bound">y</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">b_least2</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat<span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">b_least2</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">≡</span> <span class="main">(</span>Least <span class="main">(</span><span class="main">%</span><span class="bound">z</span><span class="main">.</span> <span class="bound">z</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">∨</span> <span class="main">(</span><span class="bound">z</span> <span class="main">&lt;</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="bound">z</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecFun-b_least_aux1"><span class="command">lemma</span></span> b_least_aux1<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least <span class="free">f</span> <span class="free">x</span> <span class="main">=</span> <span class="free">x</span> <span class="main">∨</span> <span class="main">(</span>b_least <span class="free">f</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">∧</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="main">(</span>b_least <span class="free">f</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">%</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">=</span> <span class="free">x</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">y</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">∧</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">(</span>Least <span class="var">?P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> LeastI<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> b_least_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-b_least_le_arg"><span class="command">lemma</span></span> b_least_le_arg<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least <span class="free">f</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"b_least <span class="free">f</span> <span class="free">x</span> <span class="main">=</span> <span class="free">x</span> <span class="main">∨</span> <span class="main">(</span>b_least <span class="free">f</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">∧</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="main">(</span>b_least <span class="free">f</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least_aux1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">arith</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-less_b_least_impl_zero"><span class="command">lemma</span></span> less_b_least_impl_zero<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">&lt;</span> b_least <span class="free">f</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">&lt;</span> b_least <span class="free">f</span> <span class="free">x</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">&lt;</span> <span class="var">?b</span>"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"b_least <span class="free">f</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">" <span class="free">y</span> <span class="main">&lt;</span> <span class="main">(</span>Least <span class="main">(</span><span class="main">%</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">=</span> <span class="free">x</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">y</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">∧</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> b_least_def<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">y</span> <span class="main">=</span> <span class="free">x</span> <span class="main">∨</span> <span class="main">(</span><span class="free">y</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">∧</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> not_less_Least<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-nz_impl_b_least_le"><span class="command">lemma</span></span> nz_impl_b_least_le<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> <span class="main">(</span>b_least <span class="free">f</span> <span class="free">x</span><span class="main">)</span> <span class="main">≤</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> b_least <span class="free">f</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">&lt;</span> b_least <span class="free">f</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> less_b_least_impl_zero<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-b_least_less_impl_nz"><span class="command">lemma</span></span> b_least_less_impl_nz<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least <span class="free">f</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>b_least <span class="free">f</span> <span class="free">x</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least <span class="free">f</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"b_least <span class="free">f</span> <span class="free">x</span> <span class="main">=</span> <span class="free">x</span> <span class="main">∨</span> <span class="main">(</span>b_least <span class="free">f</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">∧</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="main">(</span>b_least <span class="free">f</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least_aux1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-b_least_less_impl_eq"><span class="command">lemma</span></span> b_least_less_impl_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least <span class="free">f</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> <span class="main">(</span>b_least <span class="free">f</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Least <span class="main">(</span><span class="main">%</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least <span class="free">f</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?b</span> <span class="main">&lt;</span> <span class="main">_</span>"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Least <span class="main">(</span><span class="main">%</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="var">?b</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least_less_impl_nz<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?B</span>  <span class="main">≤</span> <span class="var">?b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Least_le<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="var">?B</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> LeastI<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?b</span> <span class="main">≤</span> <span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nz_impl_b_least_le<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 S4 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-less_b_least_impl_zero2"><span class="command">lemma</span></span> less_b_least_impl_zero2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">y</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">;</span> b_least <span class="free">f</span> <span class="free">x</span> <span class="main">=</span> <span class="free">x</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> less_b_least_impl_zero<span class="main">)</span>

<span class="keyword1" id="PRecFun-nz_impl_b_least_less"><span class="command">lemma</span></span> nz_impl_b_least_less<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">y</span><span class="main">&lt;</span><span class="free">x</span><span class="main">;</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span>b_least <span class="free">f</span> <span class="free">x</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"b_least <span class="free">f</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nz_impl_b_least_le<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-b_least_aux2"><span class="command">lemma</span></span> b_least_aux2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">y</span><span class="main">&lt;</span><span class="free">x</span><span class="main">;</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span>b_least <span class="free">f</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Least <span class="main">(</span><span class="main">%</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least <span class="free">f</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nz_impl_b_least_less<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least_less_impl_eq<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-b_least2_aux1"><span class="command">lemma</span></span> b_least2_aux1<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">=</span> <span class="free">y</span> <span class="main">∨</span> <span class="main">(</span>b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">&lt;</span> <span class="free">y</span> <span class="main">∧</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="main">(</span>b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span><span class="main">)</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">%</span><span class="bound">z</span><span class="main">.</span> <span class="bound">z</span> <span class="main">=</span> <span class="free">y</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">z</span> <span class="main">&lt;</span> <span class="free">y</span> <span class="main">∧</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="bound">z</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">(</span>Least <span class="var">?P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> LeastI<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> b_least2_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-b_least2_le_arg"><span class="command">lemma</span></span> b_least2_le_arg<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">≤</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span> <span class="main">=</span> <span class="free">y</span> <span class="main">∨</span> <span class="main">(</span><span class="var">?B</span> <span class="main">&lt;</span> <span class="free">y</span> <span class="main">∧</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="var">?B</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_aux1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">arith</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-less_b_least2_impl_zero"><span class="command">lemma</span></span> less_b_least2_impl_zero<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">&lt;</span> b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">⟹</span> <span class="free">f</span> <span class="free">x</span> <span class="free">z</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">&lt;</span> b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">&lt;</span> <span class="var">?b</span>"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">≤</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">" <span class="free">z</span> <span class="main">&lt;</span> <span class="main">(</span>Least <span class="main">(</span><span class="main">%</span><span class="bound">z</span><span class="main">.</span> <span class="bound">z</span> <span class="main">=</span> <span class="free">y</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">z</span> <span class="main">&lt;</span> <span class="free">y</span> <span class="main">∧</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="bound">z</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> b_least2_def<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">z</span> <span class="main">=</span> <span class="free">y</span> <span class="main">∨</span> <span class="main">(</span><span class="free">z</span> <span class="main">&lt;</span> <span class="free">y</span> <span class="main">∧</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="free">z</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> not_less_Least<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-nz_impl_b_least2_le"><span class="command">lemma</span></span> nz_impl_b_least2_le<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="free">z</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> <span class="main">(</span>b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">≤</span> <span class="free">z</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="free">z</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">&lt;</span> b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">⟹</span> <span class="free">f</span> <span class="free">x</span> <span class="free">z</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> less_b_least2_impl_zero<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-b_least2_less_impl_nz"><span class="command">lemma</span></span> b_least2_less_impl_nz<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">&lt;</span> <span class="free">y</span> <span class="main">⟹</span> <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">=</span> <span class="free">y</span> <span class="main">∨</span> <span class="main">(</span>b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">&lt;</span> <span class="free">y</span> <span class="main">∧</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="main">(</span>b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span><span class="main">)</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_aux1<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-b_least2_less_impl_eq"><span class="command">lemma</span></span> b_least2_less_impl_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">&lt;</span> <span class="free">y</span> <span class="main">⟹</span> <span class="main">(</span>b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Least <span class="main">(</span><span class="main">%</span><span class="bound">z</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="bound">z</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?b</span> <span class="main">&lt;</span> <span class="main">_</span>"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Least <span class="main">(</span><span class="main">%</span><span class="bound">z</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="bound">z</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="var">?b</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_less_impl_nz<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?B</span>  <span class="main">≤</span> <span class="var">?b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Least_le<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="var">?B</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> LeastI<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?b</span> <span class="main">≤</span> <span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nz_impl_b_least2_le<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 S4 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-less_b_least2_impl_zero2"><span class="command">lemma</span></span> less_b_least2_impl_zero2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">z</span><span class="main">&lt;</span><span class="free">y</span><span class="main">;</span> b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">=</span> <span class="free">y</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">f</span> <span class="free">x</span> <span class="free">z</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span>  <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">&lt;</span> b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> less_b_least2_impl_zero<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-nz_b_least2_impl_less"><span class="command">lemma</span></span> nz_b_least2_impl_less<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">z</span><span class="main">&lt;</span><span class="free">y</span><span class="main">;</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="free">z</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span>b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="free">z</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">≤</span> <span class="main">(</span>b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">≤</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">=</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="free">z</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> less_b_least2_impl_zero2<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-b_least2_less_impl_eq2"><span class="command">lemma</span></span> b_least2_less_impl_eq2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">z</span> <span class="main">&lt;</span> <span class="free">y</span><span class="main">;</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="free">z</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span>b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Least <span class="main">(</span><span class="main">%</span><span class="bound">z</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span> <span class="bound">z</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="free">z</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nz_b_least2_impl_less<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_less_impl_eq<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-b_least2_aux2"><span class="command">lemma</span></span> b_least2_aux2<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">&lt;</span> <span class="free">y</span> <span class="main">⟹</span> b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="main">=</span> b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?B</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="var">?B</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_less_impl_nz<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="main">≤</span> <span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nz_impl_b_least2_le<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="main">&lt;</span> Suc <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="main">(</span>b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_less_impl_nz<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S4 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?B</span> <span class="main">≤</span> b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nz_impl_b_least2_le<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 S5 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-b_least2_aux3"><span class="command">lemma</span></span> b_least2_aux3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">=</span> <span class="free">y</span><span class="main">;</span> <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">≠</span> <span class="main">0</span><span class="main">⟧</span> <span class="main">⟹</span> b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">=</span><span class="free">y</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="main">≤</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nz_impl_b_least2_le<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">y</span> <span class="main">⟹</span> False"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?z</span> <span class="main">&lt;</span> <span class="main">_</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A2_1 <span class="keyword1"><span class="command">have</span></span> S2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?z</span> <span class="main">&lt;</span> Suc <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> S2_1 <span class="keyword1"><span class="command">have</span></span> S2_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="var">?z</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_less_impl_nz<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A2_1 S2_2 <span class="keyword1"><span class="command">have</span></span> S2_3<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nz_b_least2_impl_less<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> S2_3 A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-b_least2_mono"><span class="command">lemma</span></span> b_least2_mono<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y1</span> <span class="main">≤</span> <span class="free">y2</span> <span class="main">⟹</span> b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y1</span> <span class="main">≤</span> b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y1</span> <span class="main">≤</span> <span class="free">y2</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?b1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="var"><span class="quoted"><span class="var">?b2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y2</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="var">?b1</span> <span class="main">≤</span> <span class="var">?b2</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?b2</span> <span class="main">&lt;</span> <span class="var">?b1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?b1</span> <span class="main">≤</span> <span class="free">y1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?b2</span> <span class="main">≤</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 S1 S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?b2</span> <span class="main">&lt;</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="var">?b2</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_less_impl_nz<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="var">?b2</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> less_b_least2_impl_zero<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S4 S5 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-b_least2_aux4"><span class="command">lemma</span></span> b_least2_aux4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">=</span> <span class="free">y</span><span class="main">;</span> <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">⟧</span> <span class="main">⟹</span> b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="main">=</span> Suc <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="main">≤</span> Suc <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">≤</span> b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">≤</span> Suc <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">≤</span> b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_mono<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="main">=</span><span class="free">y</span> <span class="main">∨</span> b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="main">=</span> Suc <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">&lt;</span> Suc <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="main">&lt;</span> Suc <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="main">(</span>b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> b_least2_less_impl_nz<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="free">y</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>      
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="main">=</span> Suc <span class="free">y</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-b_least2_at_zero"><span class="command">lemma</span></span> b_least2_at_zero<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="free">x</span> <span class="main">0</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> pr_b_least2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec2 <span class="main">⟹</span> b_least2 <span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">loc_Op1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op1</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="main">(</span><span class="bound">f</span><span class="main">::</span>nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span>sgn1 <span class="main">(</span><span class="bound">z</span> <span class="main">-</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="bound">y</span> <span class="main">+</span> <span class="main">(</span>sgn2 <span class="main">(</span><span class="bound">z</span> <span class="main">-</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">(</span>sgn1 <span class="main">(</span><span class="bound">f</span> <span class="bound">x</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span><span class="main">*</span><span class="bound">z</span> <span class="main">+</span> <span class="main">(</span>sgn2 <span class="main">(</span><span class="bound">f</span> <span class="bound">x</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span><span class="main">*</span><span class="main">(</span>Suc <span class="bound">z</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">loc_Op2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span><span class="main">.</span> PrimRecOp_last <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span> <span class="main">(</span><span class="skolem">loc_Op1</span> <span class="bound">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> loc_op2_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">f</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">loc_Op2</span> <span class="bound">f</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">&lt;</span> <span class="bound">y</span> <span class="main">⟹</span> <span class="skolem">loc_Op2</span> <span class="bound">f</span> <span class="bound">x</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">loc_Op2</span> <span class="bound">f</span> <span class="bound">x</span> <span class="bound">y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?b</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">loc_Op1</span> <span class="skolem">f</span><span class="main">)</span> <span class="skolem">x</span> <span class="var">?b</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_Op2_def<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?b</span> <span class="main">&lt;</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">-</span> <span class="var">?b</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op1</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="var">?b</span> <span class="skolem">y</span> <span class="main">=</span> <span class="var">?b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_Op1_def<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">&lt;</span> <span class="skolem">y</span> <span class="main">⟹</span> <span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> loc_op2_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">f</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">⟦</span><span class="main">¬</span><span class="main">(</span><span class="skolem">loc_Op2</span> <span class="bound">f</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">&lt;</span> <span class="bound">y</span><span class="main">)</span><span class="main">;</span> <span class="bound">f</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">≠</span> <span class="main">0</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="skolem">loc_Op2</span> <span class="bound">f</span> <span class="bound">x</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="bound">y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?b</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="var"><span class="quoted"><span class="var">?h</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op1</span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="var">?h</span> <span class="skolem">x</span> <span class="var">?b</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_Op2_def<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="var">?b</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">-</span> <span class="var">?b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?h</span> <span class="skolem">x</span> <span class="var">?b</span> <span class="skolem">y</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_Op1_def<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> loc_op2_lm_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">f</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">⟦</span><span class="main">¬</span><span class="main">(</span><span class="skolem">loc_Op2</span> <span class="bound">f</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">&lt;</span> <span class="bound">y</span><span class="main">)</span><span class="main">;</span> <span class="bound">f</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="skolem">loc_Op2</span> <span class="bound">f</span> <span class="bound">x</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> Suc <span class="bound">y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?b</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="var"><span class="quoted"><span class="var">?h</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op1</span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="var">?h</span> <span class="skolem">x</span> <span class="var">?b</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_Op2_def<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="var">?b</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">-</span> <span class="var">?b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?h</span> <span class="skolem">x</span> <span class="var">?b</span> <span class="skolem">y</span> <span class="main">=</span> Suc <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_Op1_def<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> Suc <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> Op2_eq_b_least2_at_point<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">f</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">loc_Op2</span> <span class="bound">f</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> b_least2 <span class="bound">f</span> <span class="bound">x</span> <span class="bound">y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="bound">y</span> <span class="main">=</span> b_least2 <span class="skolem">f</span> <span class="skolem">x</span> <span class="bound">y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct_tac</span> <span class="quoted"><span class="improper"><span class="quoted"><span class="improper">y</span></span></span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">0</span> <span class="main">=</span> b_least2 <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_Op2_def b_least2_at_zero<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
    <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">=</span> b_least2 <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> b_least2 <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">&lt;</span> <span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_op2_lm_1<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"b_least2 <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">&lt;</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> b_least2 <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_aux2<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> A1 S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">&lt;</span> <span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> A3'<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"b_least2 <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">≤</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_le_arg<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> A1 A3 this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
        <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_op2_lm_2<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> A3' A4 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_aux3<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> S3 S4 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">≠</span>  <span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> Suc <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_op2_lm_3<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> A3' A5 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> Suc <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_aux4<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> S5 S6 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> Op2_eq_b_least2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="main">=</span> b_least2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Op2_eq_b_least2_at_point ext<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">have</span></span> pr_loc_Op2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op2</span> <span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">loc_Op1</span> <span class="free">f</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_Op1_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">prec</span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> pr_zero S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"PrimRecOp_last <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span> <span class="main">(</span><span class="skolem">loc_Op1</span> <span class="free">f</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_rec_last<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_Op2_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> Op2_eq_b_least2 this <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun-b_least_def1"><span class="command">lemma</span></span> b_least_def1<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least <span class="free">f</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> b_least2 <span class="free">f</span> <span class="bound">x</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> b_least2_def b_least_def ext<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> pr_b_least<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec2 <span class="main">⟹</span> b_least <span class="free">f</span> <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_b_least2<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this pr_id1_1 pr_id1_1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> b_least2 <span class="free">f</span> <span class="bound">x</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_comp2_1<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> b_least_def1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Examples›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> c_sum_as_b_least<span class="main">:</span> <span class="quoted"><span class="quoted">"c_sum <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> b_least2 <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span>sgn1 <span class="main">(</span>sf<span class="main">(</span><span class="bound">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="bound">u</span> <span class="main">(</span>Suc <span class="bound">u</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ext<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_sum <span class="skolem">u</span> <span class="main">=</span> b_least2 <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span>sgn1 <span class="main">(</span>sf<span class="main">(</span><span class="bound">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">u</span> <span class="main">(</span>Suc <span class="skolem">u</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span>sgn1 <span class="main">(</span>sf<span class="main">(</span><span class="bound">y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="bound">x</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="bound">y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ext<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ext<span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>sgn1 <span class="main">(</span>sf<span class="main">(</span><span class="skolem">y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="skolem">y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>sgn1 <span class="main">(</span>sf<span class="main">(</span><span class="skolem">y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>sf<span class="main">(</span><span class="skolem">y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">x</span> <span class="main">&gt;</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sgn1_nz_eq_arg_pos<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>sgn1 <span class="main">(</span>sf<span class="main">(</span><span class="skolem">y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="skolem">y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span> <span class="comment1">(* lm_1 *)</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">u</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span>sgn1 <span class="main">(</span>sf<span class="main">(</span><span class="bound">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="skolem">u</span> <span class="skolem">u</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> S1_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">+</span><span class="main">1</span> <span class="main">≤</span> sf<span class="main">(</span><span class="skolem">u</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> arg_le_sf<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> S1_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">&lt;</span> <span class="skolem">u</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> S1_1 S1_2 <span class="keyword1"><span class="command">have</span></span> S1_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="skolem">u</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> S1_3 <span class="keyword1"><span class="command">have</span></span> S1_4<span class="main">:</span> <span class="quoted"><span class="quoted">"sf<span class="main">(</span><span class="skolem">u</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> S1_4 <span class="keyword1"><span class="command">have</span></span> S1_5<span class="main">:</span> <span class="quoted"><span class="quoted">"sgn1 <span class="main">(</span>sf<span class="main">(</span><span class="skolem">u</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">-</span><span class="skolem">u</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> S1_5 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">&lt;</span> Suc <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> S3 S1 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="var">?f</span> <span class="skolem">u</span> <span class="main">(</span>Suc <span class="skolem">u</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Least <span class="main">(</span><span class="main">%</span><span class="bound">z</span><span class="main">.</span> <span class="main">(</span><span class="var">?f</span> <span class="skolem">u</span> <span class="bound">z</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_less_impl_eq2<span class="main">)</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">u</span> <span class="bound">z</span><span class="main">.</span> <span class="var">?f</span> <span class="bound">u</span> <span class="bound">z</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?Q</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">u</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">u</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="bound">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> lm_1 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">=</span> <span class="var">?Q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> S6 <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">%</span><span class="bound">z</span><span class="main">.</span> <span class="var">?P</span> <span class="skolem">u</span> <span class="bound">z</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">%</span><span class="bound">z</span><span class="main">.</span> <span class="var">?Q</span> <span class="skolem">u</span> <span class="bound">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> fun_cong<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> S7 <span class="keyword1"><span class="command">have</span></span> S8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Least <span class="main">(</span><span class="main">%</span><span class="bound">z</span><span class="main">.</span> <span class="var">?P</span> <span class="skolem">u</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Least <span class="main">(</span><span class="main">%</span><span class="bound">z</span><span class="main">.</span> <span class="var">?Q</span> <span class="skolem">u</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> S4 S8 <span class="keyword1"><span class="command">have</span></span> S9<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="var">?f</span> <span class="skolem">u</span> <span class="main">(</span>Suc <span class="skolem">u</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Least <span class="main">(</span><span class="main">%</span><span class="bound">z</span><span class="main">.</span> <span class="skolem">u</span> <span class="main">&lt;</span> sf<span class="main">(</span><span class="bound">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> trans<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_sum_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> c_sum_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"c_sum <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">u</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span>sgn1 <span class="main">(</span>sf<span class="main">(</span><span class="bound">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">u</span> <span class="bound">z</span><span class="main">.</span> sgn1 <span class="main">(</span><span class="main">(</span>sf<span class="main">(</span><span class="bound">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> b_least2 <span class="var">?f</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> g_def S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_b_least2<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> <span class="skolem">g</span> <span class="bound">u</span> <span class="main">(</span>Suc <span class="bound">u</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">from</span></span> g_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_sum <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> <span class="skolem">g</span> <span class="bound">u</span> <span class="main">(</span>Suc <span class="bound">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_sum_as_b_least ext<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> c_fst_is_pr <span class="main">[</span><span class="operator">prec</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> c_fst <span class="bound">u</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> <span class="main">(</span><span class="bound">u</span> <span class="main">-</span> sf <span class="main">(</span>c_sum <span class="bound">u</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_fst_def ext<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> c_sum_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> <span class="main">(</span><span class="bound">u</span> <span class="main">-</span> sf <span class="main">(</span>c_sum <span class="bound">u</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> c_snd_is_pr <span class="main">[</span><span class="operator">prec</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> <span class="main">(</span>c_sum <span class="bound">u</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span>c_fst <span class="bound">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_snd_def ext<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> c_sum_is_pr c_fst_is_pr <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> <span class="main">(</span>c_sum <span class="bound">u</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span>c_fst <span class="bound">u</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">from</span></span> S1 this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> pr_1_to_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec1 <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span>c_pair <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>

<span class="keyword1"><span class="command">theorem</span></span> pr_2_to_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec2 <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">z</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span>c_fst <span class="bound">z</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">pr_conv_1_to_2</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">f</span> <span class="main">(</span>c_pair <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">pr_conv_1_to_3</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">f</span> <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">pr_conv_2_to_1</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">f</span> <span class="main">(</span>c_fst <span class="bound">x</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">pr_conv_3_to_1</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">f</span> <span class="main">(</span>c_fst <span class="main">(</span>c_fst <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_fst <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">pr_conv_3_to_2</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span><span class="main">.</span> pr_conv_1_to_2 <span class="main">(</span>pr_conv_3_to_1 <span class="bound">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">pr_conv_2_to_3</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span><span class="main">.</span> pr_conv_1_to_3 <span class="main">(</span>pr_conv_2_to_1 <span class="bound">f</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pr_conv_1_to_2 <span class="main">(</span>pr_conv_2_to_1 <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_1_to_2_def pr_conv_2_to_1_def<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pr_conv_2_to_1 <span class="main">(</span>pr_conv_1_to_2 <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_1_to_2_def pr_conv_2_to_1_def<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pr_conv_1_to_3 <span class="main">(</span>pr_conv_3_to_1 <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_1_to_3_def pr_conv_3_to_1_def<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="main">(</span>pr_conv_1_to_3 <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_1_to_3_def pr_conv_3_to_1_def<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pr_conv_3_to_2 <span class="main">(</span>pr_conv_2_to_3 <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_3_to_2_def pr_conv_2_to_3_def<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pr_conv_2_to_3 <span class="main">(</span>pr_conv_3_to_2 <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_3_to_2_def pr_conv_2_to_3_def<span class="main">)</span>

<span class="keyword1" id="PRecFun-pr_conv_1_to_2_lm"><span class="command">lemma</span></span> pr_conv_1_to_2_lm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec1 <span class="main">⟹</span> pr_conv_1_to_2 <span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_1_to_2_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">prec</span><span class="main">)</span>
<span class="keyword1" id="PRecFun-pr_conv_1_to_3_lm"><span class="command">lemma</span></span> pr_conv_1_to_3_lm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec1 <span class="main">⟹</span> pr_conv_1_to_3 <span class="free">f</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_1_to_3_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">prec</span><span class="main">)</span>
<span class="keyword1" id="PRecFun-pr_conv_2_to_1_lm"><span class="command">lemma</span></span> pr_conv_2_to_1_lm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec2 <span class="main">⟹</span> pr_conv_2_to_1 <span class="free">f</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_2_to_1_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">prec</span><span class="main">)</span>
<span class="keyword1" id="PRecFun-pr_conv_3_to_1_lm"><span class="command">lemma</span></span> pr_conv_3_to_1_lm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec3 <span class="main">⟹</span> pr_conv_3_to_1 <span class="free">f</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_3_to_1_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">prec</span><span class="main">)</span>
<span class="keyword1" id="PRecFun-pr_conv_3_to_2_lm"><span class="command">lemma</span></span> pr_conv_3_to_2_lm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec3 <span class="main">⟹</span> pr_conv_3_to_2 <span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec3"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="free">f</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_conv_3_to_1_lm<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_3_to_2_def pr_conv_1_to_2_lm<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1" id="PRecFun-pr_conv_2_to_3_lm"><span class="command">lemma</span></span> pr_conv_2_to_3_lm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec2 <span class="main">⟹</span> pr_conv_2_to_3 <span class="free">f</span> <span class="main">∈</span> PrimRec3"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pr_conv_2_to_1 <span class="free">f</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_conv_2_to_1_lm<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_2_to_3_def pr_conv_1_to_3_lm<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> b_least2_scheme<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">f</span> <span class="main">∈</span> PrimRec2<span class="main">;</span> <span class="free">g</span> <span class="main">∈</span> PrimRec1<span class="main">;</span> <span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="free">h</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">g</span> <span class="bound">x</span><span class="main">;</span> <span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">(</span><span class="free">h</span> <span class="bound">x</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">;</span> <span class="main">∀</span> <span class="bound">z</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="free">h</span> <span class="bound">x</span> <span class="main">⟶</span> <span class="free">f</span> <span class="bound">x</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟧</span> <span class="main">⟹</span>
                            <span class="free">h</span> <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> f_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> h_lt_g<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="free">h</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">g</span> <span class="bound">x</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> f_at_h_nz<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">(</span><span class="free">h</span> <span class="bound">x</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> h_is_min<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">z</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="free">h</span> <span class="bound">x</span> <span class="main">⟶</span> <span class="free">f</span> <span class="bound">x</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> h_def<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> b_least2 <span class="free">f</span> <span class="bound">x</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="skolem">x</span> <span class="main">=</span> b_least2 <span class="free">f</span> <span class="skolem">x</span> <span class="main">(</span><span class="free">g</span> <span class="skolem">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> f_at_h_nz <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="skolem">x</span> <span class="main">(</span><span class="free">g</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">≤</span> <span class="free">h</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nz_impl_b_least2_le<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> h_lt_g <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">g</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="skolem">x</span> <span class="main">(</span><span class="free">g</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">g</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="skolem">x</span> <span class="main">(</span>b_least2 <span class="free">f</span> <span class="skolem">x</span> <span class="main">(</span><span class="free">g</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_less_impl_nz<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="skolem">x</span> <span class="main">≤</span> b_least2 <span class="free">f</span> <span class="skolem">x</span> <span class="main">(</span><span class="free">g</span> <span class="skolem">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">h</span> <span class="skolem">x</span> <span class="main">≤</span> b_least2 <span class="free">f</span> <span class="skolem">x</span> <span class="main">(</span><span class="free">g</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"b_least2 <span class="free">f</span> <span class="skolem">x</span> <span class="main">(</span><span class="free">g</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">h</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> h_is_min <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="skolem">x</span> <span class="main">(</span>b_least2 <span class="free">f</span> <span class="skolem">x</span> <span class="main">(</span><span class="free">g</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">from</span></span> S1 S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f1</span> <span class="main">=</span> b_least2 <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> f_is_pr f1_def <span class="keyword1"><span class="command">have</span></span> f1_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f1</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_b_least2<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> g_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">f1</span> <span class="bound">x</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">with</span></span> h_def f1_def <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> b_least2_scheme2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">f</span> <span class="main">∈</span> PrimRec3<span class="main">;</span> <span class="free">g</span> <span class="main">∈</span> PrimRec2<span class="main">;</span> <span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">h</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">&lt;</span> <span class="free">g</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">;</span> <span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">f</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">(</span><span class="free">h</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">;</span>
                             <span class="main">∀</span> <span class="bound">z</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="free">h</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="free">f</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟧</span> <span class="main">⟹</span>
                             <span class="free">h</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> f_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec3"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> h_lt_g<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">h</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">&lt;</span> <span class="free">g</span> <span class="bound">x</span> <span class="bound">y</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> f_at_h_nz<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">f</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">(</span><span class="free">h</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> h_is_min<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">z</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="free">h</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="free">f</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f1</span> <span class="main">=</span> pr_conv_3_to_2 <span class="free">f</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g1</span> <span class="main">=</span> pr_conv_2_to_1 <span class="free">g</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">h1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h1</span> <span class="main">=</span> pr_conv_2_to_1 <span class="free">h</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> f_is_pr f1_def <span class="keyword1"><span class="command">have</span></span> f1_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f1</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_3_to_2_lm<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> g_is_pr g1_def <span class="keyword1"><span class="command">have</span></span> g1_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g1</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_2_to_1_lm<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> h_lt_g h1_def g1_def <span class="keyword1"><span class="command">have</span></span> h1_lt_g1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">h1</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">g1</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_2_to_1_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> f_at_h_nz f1_def h1_def <span class="keyword1"><span class="command">have</span></span> f1_at_h1_nz<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">f1</span> <span class="bound">x</span> <span class="main">(</span><span class="skolem">h1</span> <span class="bound">x</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_2_to_1_def pr_conv_3_to_2_def pr_conv_3_to_1_def pr_conv_1_to_2_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> h_is_min f1_def h1_def <span class="keyword1"><span class="command">have</span></span> h1_is_min<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">z</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">h1</span> <span class="bound">x</span> <span class="main">⟶</span> <span class="skolem">f1</span> <span class="bound">x</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_2_to_1_def pr_conv_3_to_2_def pr_conv_3_to_1_def pr_conv_1_to_2_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> f1_is_pr g1_is_pr h1_lt_g1 f1_at_h1_nz h1_is_min <span class="keyword1"><span class="command">have</span></span> h1_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h1</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_scheme<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> h1_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">=</span> pr_conv_1_to_2 <span class="skolem">h1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> h1_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_1_to_2_lm<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> div_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="bound">a</span> <span class="keyword1">div</span> <span class="bound">b</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="skolem">z</span> <span class="main">=</span> <span class="main">(</span>sgn1 <span class="skolem">b</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>sgn1 <span class="main">(</span><span class="skolem">b</span><span class="main">*</span><span class="main">(</span><span class="skolem">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">-</span><span class="skolem">a</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>sgn2 <span class="skolem">b</span><span class="main">)</span><span class="main">*</span><span class="main">(</span>sgn2 <span class="skolem">z</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="skolem">z</span>
  <span class="keyword1"><span class="command">have</span></span> f_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">a</span> <span class="keyword1">div</span> <span class="skolem">b</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">::</span> <span class="quoted">nat</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">a</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">::</span> <span class="quoted">nat</span>
  <span class="keyword1"><span class="command">have</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> g_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> h_lt_g<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="skolem">h</span> <span class="bound">a</span> <span class="bound">b</span> <span class="main">&lt;</span> <span class="skolem">g</span> <span class="bound">a</span> <span class="bound">b</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span>
    <span class="keyword1"><span class="command">from</span></span> h_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">≤</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> g_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">&lt;</span> <span class="skolem">g</span> <span class="skolem">a</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">&lt;</span> <span class="skolem">g</span> <span class="skolem">a</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> f_at_h_nz<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">a</span> <span class="bound">b</span> <span class="main">(</span><span class="skolem">h</span> <span class="bound">a</span> <span class="bound">b</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">(</span><span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> h_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> f_def A <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> A f_def <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">(</span><span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span><span class="main">)</span> <span class="main">=</span> sgn1 <span class="main">(</span><span class="skolem">b</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">a</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?thesis</span> <span class="main">=</span> <span class="main">(</span>sgn1<span class="main">(</span><span class="skolem">b</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">a</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">b</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">a</span> <span class="main">&gt;</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sgn1_nz_eq_arg_pos<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">a</span> <span class="main">&lt;</span> <span class="skolem">b</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">a</span> <span class="main">&lt;</span> <span class="skolem">b</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span><span class="main">)</span> <span class="main">+</span> <span class="skolem">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> h_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">a</span> <span class="main">&lt;</span> <span class="skolem">b</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">a</span> <span class="keyword1">div</span> <span class="skolem">b</span><span class="main">)</span> <span class="main">+</span> <span class="skolem">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?thesis</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">a</span> <span class="main">&lt;</span> <span class="skolem">b</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">a</span> <span class="keyword1">div</span> <span class="skolem">b</span><span class="main">)</span> <span class="main">+</span> <span class="skolem">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">&lt;</span> <span class="skolem">b</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">a</span> <span class="keyword1">div</span> <span class="skolem">b</span><span class="main">)</span> <span class="main">+</span> <span class="skolem">b</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S4_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="keyword1">mod</span> <span class="skolem">b</span> <span class="main">&lt;</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> mod_less_divisor<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> S4_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">a</span> <span class="keyword1">div</span> <span class="skolem">b</span><span class="main">)</span> <span class="main">+</span> <span class="skolem">a</span> <span class="keyword1">mod</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> mult_div_mod_eq<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> S4_1 <span class="keyword1"><span class="command">have</span></span> S4_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">a</span> <span class="keyword1">div</span> <span class="skolem">b</span><span class="main">)</span> <span class="main">+</span> <span class="skolem">a</span> <span class="keyword1">mod</span> <span class="skolem">b</span> <span class="main">&lt;</span> <span class="skolem">b</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">a</span> <span class="keyword1">div</span> <span class="skolem">b</span><span class="main">)</span> <span class="main">+</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
        <span class="keyword1"><span class="command">from</span></span> S4_2 S4_3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">from</span></span> S3 S4 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> h_is_min<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">z</span> <span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">h</span> <span class="bound">a</span> <span class="bound">b</span> <span class="main">⟶</span> <span class="skolem">f</span> <span class="bound">a</span> <span class="bound">b</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="skolem">z</span> <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">&lt;</span> <span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="skolem">z</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> A h_def <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">&lt;</span> <span class="skolem">a</span> <span class="keyword1">div</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="keyword1">div</span> <span class="skolem">b</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="keyword1">div</span> <span class="skolem">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> b_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">+</span><span class="main">1</span> <span class="main">≤</span> <span class="skolem">a</span> <span class="keyword1">div</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> b_pos <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">b</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">b</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">a</span> <span class="keyword1">div</span> <span class="skolem">b</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">z</span><span class="main">+</span><span class="main">1</span> <span class="main">≤</span> <span class="skolem">a</span> <span class="keyword1">div</span> <span class="skolem">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_mult_le_cancel1<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> S4 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">*</span><span class="main">(</span><span class="skolem">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">b</span><span class="main">*</span><span class="main">(</span><span class="skolem">a</span> <span class="keyword1">div</span> <span class="skolem">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">*</span><span class="main">(</span><span class="skolem">a</span> <span class="keyword1">div</span> <span class="skolem">b</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">*</span><span class="main">(</span><span class="skolem">a</span> <span class="keyword1">div</span> <span class="skolem">b</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">a</span> <span class="keyword1">mod</span> <span class="skolem">b</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> mult_div_mod_eq<span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="skolem">a</span> <span class="keyword1">mod</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">*</span><span class="main">(</span><span class="skolem">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">a</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> minus_mod_eq_mult_div <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">*</span><span class="main">(</span><span class="skolem">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">-</span> <span class="skolem">a</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> S3 f_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> f_is_pr g_is_pr h_lt_g f_at_h_nz h_is_min <span class="keyword1"><span class="command">have</span></span> h_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> b_least2_scheme2<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> h_def <span class="main">[</span><span class="operator">abs_def</span><span class="main">]</span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> mod_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="bound">a</span> <span class="keyword1">mod</span> <span class="bound">b</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="main">(</span><span class="bound">a</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">(</span><span class="bound">b</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="bound">a</span> <span class="keyword1">mod</span> <span class="bound">b</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="bound">a</span> <span class="main">-</span> <span class="main">(</span><span class="bound">a</span> <span class="keyword1">div</span> <span class="bound">b</span><span class="main">)</span> <span class="main">*</span> <span class="bound">b</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ext<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ext<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">a</span><span class="main">::</span>nat<span class="main">)</span> <span class="keyword1">mod</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">a</span> <span class="main">-</span> <span class="main">(</span><span class="skolem">a</span> <span class="keyword1">div</span> <span class="skolem">b</span><span class="main">)</span> <span class="main">*</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> minus_div_mult_eq_mod <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> div_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="bound">a</span> <span class="main">-</span> <span class="main">(</span><span class="bound">a</span> <span class="keyword1">div</span> <span class="bound">b</span><span class="main">)</span> <span class="main">*</span> <span class="bound">b</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> pr_rec_last_scheme<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">g</span> <span class="main">∈</span> PrimRec1<span class="main">;</span> <span class="free">h</span> <span class="main">∈</span> PrimRec3<span class="main">;</span> <span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">0</span> <span class="main">=</span> <span class="free">g</span> <span class="bound">x</span><span class="main">;</span> <span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">h</span> <span class="bound">x</span> <span class="main">(</span><span class="free">f</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="bound">y</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> h_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> PrimRec3"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> f_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">0</span> <span class="main">=</span> <span class="free">g</span> <span class="bound">x</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> f_at_Suc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">h</span> <span class="bound">x</span> <span class="main">(</span><span class="free">f</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="bound">y</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> f_at_0 f_at_Suc <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">f</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> PrimRecOp_last <span class="free">g</span> <span class="free">h</span> <span class="bound">x</span> <span class="bound">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct_tac</span> <span class="quoted"><span class="improper"><span class="quoted"><span class="improper">y</span></span></span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> PrimRecOp_last <span class="free">g</span> <span class="free">h</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ext<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> g_is_pr h_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_rec_last<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> power_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">(</span><span class="bound">n</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="bound">x</span> <span class="main">^</span> <span class="bound">n</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">a</span> <span class="main">*</span> <span class="skolem">b</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="skolem">c</span> <span class="main">::</span> <span class="quoted">nat</span>
  <span class="keyword1"><span class="command">have</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> g_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> h_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> h_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">(</span><span class="bound">n</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="bound">x</span> <span class="main">^</span> <span class="bound">n</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> f_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="var">?f</span> <span class="bound">x</span> <span class="main">0</span> <span class="main">=</span> <span class="skolem">g</span> <span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">^</span> <span class="main">0</span> <span class="main">=</span> <span class="skolem">g</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> f_at_Suc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="var">?f</span> <span class="bound">x</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">h</span> <span class="bound">x</span> <span class="main">(</span><span class="var">?f</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="bound">y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="skolem">x</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">h</span> <span class="skolem">x</span> <span class="main">(</span><span class="var">?f</span> <span class="skolem">x</span> <span class="skolem">y</span><span class="main">)</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> h_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> g_is_pr h_is_pr f_at_0 f_at_Suc <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_rec_last_scheme<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="files/Utils.ML">
<div class="head">
<h1>File ‹Utils.ML›</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:      Recursion-Theory-I/Utils.ML
    Author:     Michael Nedzelsky, email: MichaelNedzelsky &lt;at&gt; yandex &lt;dot&gt; ru

Some utilities for work with primitive recursive functions.
*)</span>

<span class="comment1">(******** Utility functions. ***************)</span>

<span class="keyword1"><span class="keyword">exception</span></span> <span class="entity">BadArgument</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">extract_prop_arg</span> <span class="main">(</span>Const <span class="main">(</span><span class="antiquoted"><span class="antiquote">@{</span><span class="operator">const_name</span> Pure.prop<span class="antiquote">}</span></span><span class="main">,</span> <span class="main">_</span><span class="main">)</span> $ <span class="entity">t</span><span class="main">)</span> <span class="main">=</span> <span class="entity">t</span>
  <span class="main">|</span> <span class="entity">extract_prop_arg</span>  <span class="main">_</span> <span class="main">=</span> <span class="keyword3"><span class="keyword">raise</span></span> <span class="entity">BadArgument</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">extract_trueprop_arg</span> <span class="main">(</span>Const <span class="main">(</span><span class="antiquoted"><span class="antiquote">@{</span><span class="operator">const_name</span> "Trueprop"<span class="antiquote">}</span></span><span class="main">,</span> <span class="main">_</span><span class="main">)</span> $ <span class="entity">t</span><span class="main">)</span> <span class="main">=</span> <span class="entity">t</span>
  <span class="main">|</span> <span class="entity">extract_trueprop_arg</span>  <span class="main">_</span> <span class="main">=</span> <span class="keyword3"><span class="keyword">raise</span></span> <span class="entity">BadArgument</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">extract_set_args</span> <span class="main">(</span>Const <span class="main">(</span><span class="antiquoted"><span class="antiquote">@{</span><span class="operator">const_name</span> Set.member<span class="antiquote">}</span></span><span class="main">,</span> <span class="main">_</span><span class="main">)</span> $ <span class="entity">t1</span> $ <span class="entity">t2</span><span class="main">)</span>  <span class="main">=</span> <span class="main">(</span><span class="entity">t1</span><span class="main">,</span> <span class="entity">t2</span><span class="main">)</span>
  <span class="main">|</span> <span class="entity">extract_set_args</span>  <span class="main">_</span> <span class="main">=</span> <span class="keyword3"><span class="keyword">raise</span></span> <span class="entity">BadArgument</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">get_num_by_set</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">const_name</span> PRecFun.PrimRec1<span class="antiquote">}</span></span> <span class="main">=</span> <span class="inner_numeral">1</span>
  <span class="main">|</span> <span class="entity">get_num_by_set</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">const_name</span> PRecFun.PrimRec2<span class="antiquote">}</span></span> <span class="main">=</span> <span class="inner_numeral">2</span>
  <span class="main">|</span> <span class="entity">get_num_by_set</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">const_name</span> PRecFun.PrimRec3<span class="antiquote">}</span></span> <span class="main">=</span> <span class="inner_numeral">3</span>
  <span class="main">|</span> <span class="entity">get_num_by_set</span> <span class="main">_</span> <span class="main">=</span> <span class="keyword3"><span class="keyword">raise</span></span> <span class="entity">BadArgument</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">remove_abs</span> <span class="main">(</span>Abs <span class="main">(</span><span class="main">_</span><span class="main">,</span> <span class="main">_</span><span class="main">,</span> <span class="entity">t</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="entity">remove_abs</span> <span class="entity">t</span>
  <span class="main">|</span> <span class="entity">remove_abs</span> <span class="entity">t</span> <span class="main">=</span> <span class="entity">t</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">extract_free_from_app</span> <span class="main">(</span><span class="entity">t1</span> $ <span class="entity">t2</span><span class="main">)</span> <span class="main">(</span><span class="entity">n</span><span class="main">:</span> int<span class="main">)</span> <span class="main">=</span> <span class="entity">extract_free_from_app</span> <span class="entity">t1</span> <span class="main">(</span><span class="entity">n</span> + <span class="inner_numeral">1</span><span class="main">)</span>
  <span class="main">|</span> <span class="entity">extract_free_from_app</span> <span class="main">(</span>Free <span class="main">(</span><span class="entity">s</span><span class="main">,</span> <span class="entity">tp</span><span class="main">)</span><span class="main">)</span> <span class="entity">n</span> <span class="main">=</span> <span class="main">(</span><span class="entity">s</span><span class="main">,</span> <span class="entity">tp</span><span class="main">,</span> <span class="entity">n</span><span class="main">)</span>
  <span class="main">|</span> <span class="entity">extract_free_from_app</span> <span class="main">(</span>Const <span class="main">(</span><span class="entity">s</span><span class="main">,</span> <span class="entity">tp</span><span class="main">)</span><span class="main">)</span> <span class="entity">n</span> <span class="main">=</span> <span class="main">(</span><span class="entity">s</span><span class="main">,</span> <span class="entity">tp</span><span class="main">,</span> <span class="entity">n</span><span class="main">)</span>
  <span class="main">|</span> <span class="entity">extract_free_from_app</span> <span class="main">_</span> <span class="entity">n</span> <span class="main">=</span> <span class="keyword3"><span class="keyword">raise</span></span> <span class="entity">BadArgument</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">extract_free_arg</span> <span class="entity">t</span> <span class="main">=</span> <span class="entity">extract_free_from_app</span> <span class="main">(</span><span class="entity">remove_abs</span> <span class="entity">t</span><span class="main">)</span> <span class="inner_numeral">0</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">get_comp_by_indexes</span> <span class="main">(</span><span class="inner_numeral">1</span><span class="main">,</span> <span class="inner_numeral">1</span><span class="main">)</span> <span class="main">=</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> pr_comp1_1<span class="antiquote">}</span></span></span>
  <span class="main">|</span> <span class="entity">get_comp_by_indexes</span> <span class="main">(</span><span class="inner_numeral">1</span><span class="main">,</span> <span class="inner_numeral">2</span><span class="main">)</span> <span class="main">=</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> pr_comp1_2<span class="antiquote">}</span></span></span>
  <span class="main">|</span> <span class="entity">get_comp_by_indexes</span> <span class="main">(</span><span class="inner_numeral">1</span><span class="main">,</span> <span class="inner_numeral">3</span><span class="main">)</span> <span class="main">=</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> pr_comp1_3<span class="antiquote">}</span></span></span>
  <span class="main">|</span> <span class="entity">get_comp_by_indexes</span> <span class="main">(</span><span class="inner_numeral">2</span><span class="main">,</span> <span class="inner_numeral">1</span><span class="main">)</span> <span class="main">=</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> pr_comp2_1<span class="antiquote">}</span></span></span>
  <span class="main">|</span> <span class="entity">get_comp_by_indexes</span> <span class="main">(</span><span class="inner_numeral">2</span><span class="main">,</span> <span class="inner_numeral">2</span><span class="main">)</span> <span class="main">=</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> pr_comp2_2<span class="antiquote">}</span></span></span>
  <span class="main">|</span> <span class="entity">get_comp_by_indexes</span> <span class="main">(</span><span class="inner_numeral">2</span><span class="main">,</span> <span class="inner_numeral">3</span><span class="main">)</span> <span class="main">=</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> pr_comp2_3<span class="antiquote">}</span></span></span>
  <span class="main">|</span> <span class="entity">get_comp_by_indexes</span> <span class="main">(</span><span class="inner_numeral">3</span><span class="main">,</span> <span class="inner_numeral">1</span><span class="main">)</span> <span class="main">=</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> pr_comp3_1<span class="antiquote">}</span></span></span>
  <span class="main">|</span> <span class="entity">get_comp_by_indexes</span> <span class="main">(</span><span class="inner_numeral">3</span><span class="main">,</span> <span class="inner_numeral">2</span><span class="main">)</span> <span class="main">=</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> pr_comp3_2<span class="antiquote">}</span></span></span>
  <span class="main">|</span> <span class="entity">get_comp_by_indexes</span> <span class="main">(</span><span class="inner_numeral">3</span><span class="main">,</span> <span class="inner_numeral">3</span><span class="main">)</span> <span class="main">=</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> pr_comp3_3<span class="antiquote">}</span></span></span>
  <span class="main">|</span> <span class="entity">get_comp_by_indexes</span> <span class="main">_</span> <span class="main">=</span> <span class="keyword3"><span class="keyword">raise</span></span> <span class="entity">BadArgument</span>


<span class="comment1">(************ Tactic. ***************)</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">pr_comp_tac</span> <span class="entity">ctxt</span> <span class="main">=</span> SUBGOAL <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="main">(</span><span class="entity">t</span><span class="main">,</span> <span class="entity">i</span><span class="main">)</span> <span class="main">=&gt;</span>
  <span class="keyword2"><span class="keyword">let</span></span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">t</span> <span class="main">=</span> <span class="entity">extract_trueprop_arg</span> <span class="main">(</span>Logic.strip_imp_concl <span class="entity">t</span><span class="main">)</span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="main">(</span><span class="entity">t1</span><span class="main">,</span> <span class="entity">t2</span><span class="main">)</span> <span class="main">=</span> <span class="entity">extract_set_args</span> <span class="entity">t</span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">n2</span> <span class="main">=</span>
      <span class="keyword2"><span class="keyword">let</span></span>
        <span class="keyword1"><span class="keyword">val</span></span> Const <span class="main">(</span><span class="entity">s</span><span class="main">,</span> <span class="main">_</span><span class="main">)</span> <span class="main">=</span> <span class="entity">t2</span>
      <span class="keyword2"><span class="keyword">in</span></span>
        <span class="entity">get_num_by_set</span> <span class="entity">s</span>
      <span class="keyword2"><span class="keyword">end</span></span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="main">(</span><span class="entity">name</span><span class="main">,</span> <span class="main">_</span><span class="main">,</span> <span class="entity">n1</span><span class="main">)</span> <span class="main">=</span> <span class="entity">extract_free_arg</span> <span class="entity">t1</span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">comp</span> <span class="main">=</span> <span class="entity">get_comp_by_indexes</span> <span class="main">(</span><span class="entity">n1</span><span class="main">,</span> <span class="entity">n2</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">in</span></span>
    <span class="entity">Rule_Insts.res_inst_tac</span> <span class="entity">ctxt</span>
      <span class="main">[</span><span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="inner_quoted">"f"</span><span class="main">,</span> <span class="inner_numeral">0</span><span class="main">)</span><span class="main">,</span> Position.none<span class="main">)</span><span class="main">,</span> Variable.revert_fixed <span class="entity">ctxt</span> <span class="entity">name</span><span class="main">)</span><span class="main">]</span> <span class="main">[</span><span class="main">]</span> <span class="entity">comp</span> <span class="entity">i</span>
  <span class="keyword2"><span class="keyword">end</span></span>
  <span class="keyword3"><span class="keyword">handle</span></span> <span class="entity">BadArgument</span> <span class="main">=&gt;</span> no_tac<span class="main">)</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">prec0_tac</span> <span class="entity">ctxt</span> <span class="entity">facts</span> <span class="entity">i</span> <span class="main">=</span>
  <span class="entity">Method.insert_tac</span> <span class="entity">ctxt</span> <span class="entity">facts</span> <span class="entity">i</span> THEN
  REPEAT <span class="main">(</span>assume_tac <span class="entity">ctxt</span> <span class="entity">i</span> ORELSE <span class="entity">pr_comp_tac</span> <span class="entity">ctxt</span> <span class="entity">i</span><span class="main">)</span>
</pre>
</div><div id="PRecList">
<div class="head">
<h1>Theory PRecList</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Primitive recursive coding of lists of natural numbers
    Author:      Michael Nedzelsky &lt;MichaelNedzelsky at yandex.ru&gt;, 2008
    Maintainer:  Michael Nedzelsky &lt;MichaelNedzelsky at yandex.ru&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Primitive recursive coding of lists of natural numbers›</span></span>

<span class="keyword1"><span class="command">theory</span></span> PRecList
<span class="keyword2"><span class="keyword">imports</span></span> <a href="PRecFun.html">PRecFun</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  We introduce a particular coding <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>list_to_nat›</span></span></span></span> from lists of
  natural numbers to natural numbers.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_len</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_len</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="main">(</span><span class="bound">u</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="main">(</span>sgn1 <span class="bound">u</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>c_fst<span class="main">(</span><span class="bound">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecList-c_len_1"><span class="command">lemma</span></span> c_len_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">case</span> <span class="free">u</span> <span class="keyword1">of</span> <span class="main">0</span> <span class="main">⇒</span> <span class="main">0</span> <span class="main">|</span> Suc <span class="bound">v</span> <span class="main">⇒</span> c_fst<span class="main">(</span><span class="bound">v</span><span class="main">)</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> c_len_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">cases</span> <span class="quoted"><span class="free">u</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="PRecList-c_len_is_pr"><span class="command">lemma</span></span> c_len_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> c_len_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_len_def<span class="main">)</span>

<span class="keyword1" id="PRecList-c_len_2"><span class="command">lemma</span></span> c_len_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> c_len <span class="free">u</span> <span class="main">=</span> c_fst<span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_len_def<span class="main">)</span>

<span class="keyword1" id="PRecList-c_len_3"><span class="command">lemma</span></span> c_len_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">&gt;</span><span class="main">0</span> <span class="main">⟹</span> c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_len_2<span class="main">)</span>

<span class="keyword1" id="PRecList-c_len_4"><span class="command">lemma</span></span> c_len_4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_len_3<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 this <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">=</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_len_5"><span class="command">lemma</span></span> c_len_5<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">=</span><span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">c_fold</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat list <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">c_fold</span> <span class="main">[]</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">c_fold</span> <span class="main">[</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">]</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
  <span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">c_fold</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">#</span><span class="free"><span class="bound"><span class="entity">ls</span></span></span><span class="main">)</span> <span class="main">=</span> c_pair <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">(</span><span class="free">c_fold</span> <span class="free"><span class="bound"><span class="entity">ls</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecList-c_fold_0"><span class="command">lemma</span></span> c_fold_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ls</span> <span class="main">≠</span> <span class="main">[]</span> <span class="main">⟹</span> c_fold <span class="main">(</span><span class="free">x</span><span class="main">#</span><span class="free">ls</span><span class="main">)</span> <span class="main">=</span> c_pair <span class="free">x</span> <span class="main">(</span>c_fold <span class="free">ls</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ls</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ls</span> <span class="main">=</span> <span class="main">(</span>hd <span class="free">ls</span><span class="main">)</span><span class="main">#</span><span class="main">(</span>tl <span class="free">ls</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">#</span><span class="free">ls</span> <span class="main">=</span> <span class="free">x</span><span class="main">#</span><span class="main">(</span>hd <span class="free">ls</span><span class="main">)</span><span class="main">#</span><span class="main">(</span>tl <span class="free">ls</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fold <span class="main">(</span><span class="free">x</span><span class="main">#</span><span class="main">(</span>hd <span class="free">ls</span><span class="main">)</span><span class="main">#</span><span class="main">(</span>tl <span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> c_pair <span class="free">x</span> <span class="main">(</span>c_fold <span class="main">(</span><span class="main">(</span>hd <span class="free">ls</span><span class="main">)</span><span class="main">#</span><span class="main">(</span>tl <span class="free">ls</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">primrec</span></span>
  <span class="entity">c_unfold</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat list"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_unfold</span> <span class="main">0</span> <span class="free"><span class="bound"><span class="entity">u</span></span></span> <span class="main">=</span> <span class="main">[]</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">c_unfold</span> <span class="main">(</span>Suc <span class="free"><span class="bound"><span class="entity">k</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">u</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span> <span class="main">[</span><span class="free"><span class="bound"><span class="entity">u</span></span></span><span class="main">]</span> <span class="keyword1">else</span> <span class="main">(</span><span class="main">(</span>c_fst <span class="free"><span class="bound"><span class="entity">u</span></span></span><span class="main">)</span> <span class="main">#</span> <span class="main">(</span><span class="free">c_unfold</span> <span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="main">(</span>c_snd <span class="free"><span class="bound"><span class="entity">u</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecList-c_fold_1"><span class="command">lemma</span></span> c_fold_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_unfold <span class="main">1</span> <span class="main">(</span>c_fold <span class="main">[</span><span class="free">x</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="main">[</span><span class="free">x</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="PRecList-c_fold_2"><span class="command">lemma</span></span> c_fold_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fold <span class="main">(</span>c_unfold <span class="main">1</span> <span class="free">u</span><span class="main">)</span> <span class="main">=</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="PRecList-c_unfold_1"><span class="command">lemma</span></span> c_unfold_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_unfold <span class="main">1</span> <span class="free">u</span> <span class="main">=</span> <span class="main">[</span><span class="free">u</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="PRecList-c_unfold_2"><span class="command">lemma</span></span> c_unfold_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_unfold <span class="main">(</span>Suc <span class="main">1</span><span class="main">)</span> <span class="free">u</span> <span class="main">=</span> <span class="main">(</span>c_fst <span class="free">u</span><span class="main">)</span> <span class="main">#</span> <span class="main">(</span>c_unfold <span class="main">1</span> <span class="main">(</span>c_snd <span class="free">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="PRecList-c_unfold_3"><span class="command">lemma</span></span> c_unfold_3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_unfold <span class="main">(</span>Suc <span class="main">1</span><span class="main">)</span> <span class="free">u</span> <span class="main">=</span> <span class="main">[</span>c_fst <span class="free">u</span><span class="main">,</span> c_snd <span class="free">u</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="PRecList-c_unfold_4"><span class="command">lemma</span></span> c_unfold_4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> c_unfold <span class="main">(</span>Suc <span class="free">k</span><span class="main">)</span> <span class="free">u</span> <span class="main">=</span> <span class="main">(</span>c_fst <span class="free">u</span><span class="main">)</span> <span class="main">#</span> <span class="main">(</span>c_unfold <span class="free">k</span> <span class="main">(</span>c_snd <span class="free">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="PRecList-c_unfold_4_1"><span class="command">lemma</span></span> c_unfold_4_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> c_unfold <span class="main">(</span>Suc <span class="free">k</span><span class="main">)</span> <span class="free">u</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_unfold_4<span class="main">)</span>

<span class="keyword1" id="PRecList-two"><span class="command">lemma</span></span> two<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">=</span> Suc <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="PRecList-c_unfold_5"><span class="command">lemma</span></span> c_unfold_5<span class="main">:</span> <span class="quoted"><span class="quoted">"c_unfold <span class="numeral">2</span> <span class="free">u</span> <span class="main">=</span> <span class="main">[</span>c_fst <span class="free">u</span><span class="main">,</span> c_snd <span class="free">u</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> two<span class="main">)</span>

<span class="keyword1" id="PRecList-c_unfold_6"><span class="command">lemma</span></span> c_unfold_6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">&gt;</span><span class="main">0</span> <span class="main">⟹</span> c_unfold <span class="free">k</span> <span class="free">u</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">&gt;</span><span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?k1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">=</span> Suc <span class="var">?k1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?k1</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?k1</span><span class="main">=</span><span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 A2_1 <span class="keyword1"><span class="command">have</span></span> S2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">=</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> S2_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_unfold_1<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?k1</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A3_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?k1</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A3_1 <span class="keyword1"><span class="command">have</span></span> S3_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_unfold <span class="main">(</span>Suc <span class="var">?k1</span><span class="main">)</span> <span class="free">u</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_unfold_4_1<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> S1 S3_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> S2 S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-th_lm_1"><span class="command">lemma</span></span> th_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">=</span><span class="main">1</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">u</span><span class="main">.</span> c_fold <span class="main">(</span>c_unfold <span class="free">k</span> <span class="bound">u</span><span class="main">)</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_fold_2<span class="main">)</span>

<span class="keyword1" id="PRecList-th_lm_2"><span class="command">lemma</span></span> th_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">k</span><span class="main">&gt;</span><span class="main">0</span><span class="main">;</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">u</span><span class="main">.</span> c_fold <span class="main">(</span>c_unfold <span class="free">k</span> <span class="bound">u</span><span class="main">)</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">u</span><span class="main">.</span> c_fold <span class="main">(</span>c_unfold <span class="main">(</span>Suc <span class="free">k</span><span class="main">)</span> <span class="bound">u</span><span class="main">)</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">&gt;</span><span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">u</span><span class="main">.</span> c_fold <span class="main">(</span>c_unfold <span class="free">k</span> <span class="bound">u</span><span class="main">)</span> <span class="main">=</span> <span class="bound">u</span>"</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_unfold <span class="main">(</span>Suc <span class="free">k</span><span class="main">)</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">(</span>c_fst <span class="skolem">u</span><span class="main">)</span> <span class="main">#</span> <span class="main">(</span>c_unfold <span class="free">k</span> <span class="main">(</span>c_snd <span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_unfold_4<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?ls</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_unfold <span class="free">k</span> <span class="main">(</span>c_snd <span class="skolem">u</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?ls</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_unfold_6<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fold <span class="main">(</span> <span class="main">(</span>c_fst <span class="skolem">u</span><span class="main">)</span> <span class="main">#</span> <span class="var">?ls</span><span class="main">)</span> <span class="main">=</span> c_pair <span class="main">(</span>c_fst <span class="skolem">u</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="var">?ls</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_fold_0<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fold <span class="var">?ls</span> <span class="main">=</span> c_snd <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S3 S4 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fold <span class="main">(</span> <span class="main">(</span>c_fst <span class="skolem">u</span><span class="main">)</span> <span class="main">#</span> <span class="var">?ls</span><span class="main">)</span> <span class="main">=</span> c_pair <span class="main">(</span>c_fst <span class="skolem">u</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="skolem">u</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S5 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fold <span class="main">(</span> <span class="main">(</span>c_fst <span class="skolem">u</span><span class="main">)</span> <span class="main">#</span> <span class="var">?ls</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S6 <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fold <span class="main">(</span>c_unfold <span class="main">(</span>Suc <span class="free">k</span><span class="main">)</span> <span class="skolem">u</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"c_fold <span class="main">(</span>c_unfold <span class="main">(</span>Suc <span class="free">k</span><span class="main">)</span> <span class="skolem">u</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-th_lm_3"><span class="command">lemma</span></span> th_lm_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span> <span class="bound">u</span><span class="main">.</span> c_fold <span class="main">(</span>c_unfold <span class="main">(</span>Suc <span class="free">k</span><span class="main">)</span> <span class="bound">u</span><span class="main">)</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span><span class="main">⟹</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">u</span><span class="main">.</span> c_fold <span class="main">(</span>c_unfold <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="free">k</span><span class="main">)</span><span class="main">)</span> <span class="bound">u</span><span class="main">)</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">u</span><span class="main">.</span> c_fold <span class="main">(</span>c_unfold <span class="main">(</span>Suc <span class="free">k</span><span class="main">)</span> <span class="bound">u</span><span class="main">)</span> <span class="main">=</span> <span class="bound">u</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?k1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Suc <span class="free">k</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?k1</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S1 A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">u</span><span class="main">.</span> c_fold <span class="main">(</span>c_unfold <span class="main">(</span>Suc <span class="var">?k1</span><span class="main">)</span> <span class="bound">u</span><span class="main">)</span> <span class="main">=</span> <span class="bound">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> th_lm_2<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> th_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">u</span><span class="main">.</span> c_fold <span class="main">(</span>c_unfold <span class="main">(</span>Suc <span class="free">k</span><span class="main">)</span> <span class="bound">u</span><span class="main">)</span> <span class="main">=</span> <span class="bound">u</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">k</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_fold_2<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> th_lm_3<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">assumption</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">theorem</span></span> th_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">u</span><span class="main">.</span> c_fold <span class="main">(</span>c_unfold <span class="free">k</span> <span class="bound">u</span><span class="main">)</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">&gt;</span><span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?k1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"Suc <span class="var">?k1</span> <span class="main">=</span> <span class="free">k</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">u</span><span class="main">.</span> c_fold <span class="main">(</span>c_unfold <span class="main">(</span>Suc <span class="var">?k1</span><span class="main">)</span> <span class="bound">u</span><span class="main">)</span> <span class="main">=</span> <span class="bound">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> th_1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_fold_3"><span class="command">lemma</span></span> c_fold_3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_unfold <span class="numeral">2</span> <span class="main">(</span>c_fold <span class="main">[</span><span class="free">x</span><span class="main">,</span> <span class="free">y</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="main">[</span><span class="free">x</span><span class="main">,</span> <span class="free">y</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> two<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> c_unfold_len<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">ALL</span> <span class="bound">u</span><span class="main">.</span> length <span class="main">(</span>c_unfold <span class="free">k</span> <span class="bound">u</span><span class="main">)</span> <span class="main">=</span> <span class="free">k</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">k</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subgoal_tac</span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">=</span><span class="main">(</span><span class="main">0</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">∨</span> <span class="free">n</span><span class="main">&gt;</span><span class="main">0</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">drule</span> disjE<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">prefer</span></span></span></span> 3
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="PRecList-th_3_lm_0"><span class="command">lemma</span></span> th_3_lm_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>c_unfold <span class="main">(</span>length <span class="free">ls</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="free">ls</span><span class="main">)</span> <span class="main">=</span> <span class="free">ls</span><span class="main">;</span> <span class="free">ls</span> <span class="main">=</span> <span class="free">a</span> <span class="main">#</span> <span class="free">ls1</span><span class="main">;</span> <span class="free">ls1</span> <span class="main">=</span> <span class="free">aa</span> <span class="main">#</span> <span class="free">list</span><span class="main">⟧</span> <span class="main">⟹</span> c_unfold <span class="main">(</span>length <span class="main">(</span><span class="free">x</span> <span class="main">#</span> <span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="main">(</span><span class="free">x</span> <span class="main">#</span> <span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span> <span class="main">#</span> <span class="free">ls</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_unfold <span class="main">(</span>length <span class="free">ls</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="free">ls</span><span class="main">)</span> <span class="main">=</span> <span class="free">ls</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ls</span> <span class="main">=</span> <span class="free">a</span> <span class="main">#</span> <span class="free">ls1</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ls1</span> <span class="main">=</span> <span class="free">aa</span> <span class="main">#</span> <span class="free">list</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ls</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fold <span class="main">(</span><span class="free">x</span><span class="main">#</span><span class="free">ls</span><span class="main">)</span> <span class="main">=</span> c_pair <span class="free">x</span> <span class="main">(</span>c_fold <span class="free">ls</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_fold_0<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"length <span class="main">(</span><span class="free">x</span><span class="main">#</span><span class="free">ls</span><span class="main">)</span> <span class="main">=</span> Suc <span class="main">(</span>length <span class="free">ls</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_unfold <span class="main">(</span>length <span class="main">(</span><span class="free">x</span> <span class="main">#</span> <span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="main">(</span><span class="free">x</span> <span class="main">#</span> <span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> c_unfold <span class="main">(</span>Suc <span class="main">(</span>length <span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="main">(</span><span class="free">x</span> <span class="main">#</span> <span class="free">ls</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"length <span class="free">ls</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S5 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"c_unfold <span class="main">(</span>Suc <span class="main">(</span>length <span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="main">(</span><span class="free">x</span> <span class="main">#</span> <span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> c_fst <span class="main">(</span>c_fold <span class="main">(</span><span class="free">x</span> <span class="main">#</span> <span class="free">ls</span><span class="main">)</span><span class="main">)</span><span class="main">#</span><span class="main">(</span>c_unfold <span class="main">(</span>length <span class="free">ls</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_fold <span class="main">(</span><span class="free">x</span><span class="main">#</span><span class="free">ls</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_unfold_4<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fold <span class="main">(</span><span class="free">x</span><span class="main">#</span><span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S8<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="main">(</span>c_fold <span class="main">(</span><span class="free">x</span><span class="main">#</span><span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> c_fold <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S6 S7 S8 <span class="keyword1"><span class="command">have</span></span> S9<span class="main">:</span> <span class="quoted"><span class="quoted">"c_unfold <span class="main">(</span>Suc <span class="main">(</span>length <span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="main">(</span><span class="free">x</span> <span class="main">#</span> <span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span> <span class="main">#</span> <span class="main">(</span>c_unfold <span class="main">(</span>length <span class="free">ls</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="free">ls</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S10<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">#</span> <span class="main">(</span>c_unfold <span class="main">(</span>length <span class="free">ls</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span> <span class="main">#</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S9 S10 <span class="keyword1"><span class="command">have</span></span> S11<span class="main">:</span> <span class="quoted"><span class="quoted">"c_unfold <span class="main">(</span>Suc <span class="main">(</span>length <span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="main">(</span><span class="free">x</span> <span class="main">#</span> <span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">#</span> <span class="free">ls</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-th_3_lm_1"><span class="command">lemma</span></span> th_3_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>c_unfold <span class="main">(</span>length <span class="free">ls</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="free">ls</span><span class="main">)</span> <span class="main">=</span> <span class="free">ls</span><span class="main">;</span> <span class="free">ls</span> <span class="main">=</span> <span class="free">a</span> <span class="main">#</span> <span class="free">ls1</span><span class="main">⟧</span> <span class="main">⟹</span> c_unfold <span class="main">(</span>length <span class="main">(</span><span class="free">x</span> <span class="main">#</span> <span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="main">(</span><span class="free">x</span> <span class="main">#</span> <span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span> <span class="main">#</span> <span class="free">ls</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">ls1</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_fold_1<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="PRecList-th_3_lm_2"><span class="command">lemma</span></span> th_3_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_unfold <span class="main">(</span>length <span class="free">ls</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="free">ls</span><span class="main">)</span> <span class="main">=</span> <span class="free">ls</span> <span class="main">⟹</span> c_unfold <span class="main">(</span>length <span class="main">(</span><span class="free">x</span> <span class="main">#</span> <span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="main">(</span><span class="free">x</span> <span class="main">#</span> <span class="free">ls</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span> <span class="main">#</span> <span class="free">ls</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">ls</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_fold_1<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> th_3_lm_1<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">assumption</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">theorem</span></span> th_3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_unfold <span class="main">(</span>length <span class="free">ls</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="free">ls</span><span class="main">)</span> <span class="main">=</span> <span class="free">ls</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">ls</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> th_3_lm_2<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">assumption</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">list_to_nat</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat list <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">list_to_nat</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">ls</span><span class="main">.</span> <span class="keyword1">if</span> <span class="bound">ls</span><span class="main">=</span><span class="main">[]</span> <span class="keyword1">then</span> <span class="main">0</span> <span class="keyword1">else</span> <span class="main">(</span>c_pair <span class="main">(</span><span class="main">(</span>length <span class="bound">ls</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="bound">ls</span><span class="main">)</span><span class="main">)</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">nat_to_list</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat list"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">nat_to_list</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> <span class="keyword1">if</span> <span class="bound">u</span><span class="main">=</span><span class="main">0</span> <span class="keyword1">then</span> <span class="main">[]</span> <span class="keyword1">else</span> <span class="main">(</span>c_unfold <span class="main">(</span>c_len <span class="bound">u</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="bound">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecList-nat_to_list_of_pos"><span class="command">lemma</span></span> nat_to_list_of_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">&gt;</span><span class="main">0</span> <span class="main">⟹</span> nat_to_list <span class="free">u</span> <span class="main">=</span> c_unfold <span class="main">(</span>c_len <span class="free">u</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_list_def<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> list_to_nat_th <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"list_to_nat <span class="main">(</span>nat_to_list <span class="free">u</span><span class="main">)</span> <span class="main">=</span> <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">=</span><span class="main">0</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> list_to_nat_def nat_to_list_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">&gt;</span><span class="main">0</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">&gt;</span><span class="main">0</span>"</span></span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ls</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ls</span> <span class="main">=</span> nat_to_list <span class="free">u</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> ls_def A1 <span class="keyword1"><span class="command">have</span></span> S2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">ls</span> <span class="main">=</span> c_unfold <span class="main">(</span>c_len <span class="free">u</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_list_def<span class="main">)</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?k</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?k</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_len_3<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> S2_1 <span class="keyword1"><span class="command">have</span></span> S2_3<span class="main">:</span> <span class="quoted"><span class="quoted">"length <span class="skolem">ls</span> <span class="main">=</span> <span class="var">?k</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_unfold_len<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> S2_2 S2_3 <span class="keyword1"><span class="command">have</span></span> S2_4<span class="main">:</span> <span class="quoted"><span class="quoted">"length <span class="skolem">ls</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> S2_4 <span class="keyword1"><span class="command">have</span></span> S2_5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">ls</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> S2_5 <span class="keyword1"><span class="command">have</span></span> S2_6<span class="main">:</span> <span class="quoted"><span class="quoted">"list_to_nat <span class="skolem">ls</span> <span class="main">=</span> c_pair <span class="main">(</span><span class="main">(</span>length <span class="skolem">ls</span><span class="main">)</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="skolem">ls</span><span class="main">)</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> list_to_nat_def<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> S2_7<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fold <span class="skolem">ls</span> <span class="main">=</span> c_snd<span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> S2_1 <span class="keyword1"><span class="command">have</span></span> S2_7_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fold <span class="skolem">ls</span> <span class="main">=</span> c_fold <span class="main">(</span>c_unfold <span class="main">(</span>c_len <span class="free">u</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> S2_2 S2_7_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> th_2<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> S2_8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>length <span class="skolem">ls</span><span class="main">)</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">=</span> c_fst <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> S2_3 <span class="keyword1"><span class="command">have</span></span> S2_8_1<span class="main">:</span> <span class="quoted"><span class="quoted">"length <span class="skolem">ls</span> <span class="main">=</span> c_len <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> A1 S2_8_1 <span class="keyword1"><span class="command">have</span></span> S2_8_2<span class="main">:</span> <span class="quoted"><span class="quoted">"length <span class="skolem">ls</span> <span class="main">=</span> c_fst<span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_len_2<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> S2_8_2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">from</span></span> S2_7 S2_8 <span class="keyword1"><span class="command">have</span></span> S2_9<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="main">(</span><span class="main">(</span>length <span class="skolem">ls</span><span class="main">)</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="skolem">ls</span><span class="main">)</span> <span class="main">=</span> c_pair <span class="main">(</span>c_fst <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
    <span class="keyword1"><span class="command">from</span></span> S2_9 <span class="keyword1"><span class="command">have</span></span> S2_10<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="main">(</span><span class="main">(</span>length <span class="skolem">ls</span><span class="main">)</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="skolem">ls</span><span class="main">)</span> <span class="main">=</span> <span class="free">u</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> S2_6 S2_10 <span class="keyword1"><span class="command">have</span></span> S2_11<span class="main">:</span> <span class="quoted"><span class="quoted">"list_to_nat <span class="skolem">ls</span> <span class="main">=</span> <span class="main">(</span><span class="free">u</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2_12<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">u</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">+</span><span class="main">1</span> <span class="main">=</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> ls_def S2_11 S2_12 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> nat_to_list_th <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_list <span class="main">(</span>list_to_nat <span class="free">ls</span><span class="main">)</span> <span class="main">=</span> <span class="free">ls</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ls</span><span class="main">=</span><span class="main">[]</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_list_def list_to_nat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ls</span> <span class="main">≠</span> <span class="main">[]</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ls</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">=</span> list_to_nat <span class="free">ls</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> u_def A1 <span class="keyword1"><span class="command">have</span></span> S2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="main">(</span><span class="main">(</span>length <span class="free">ls</span><span class="main">)</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="free">ls</span><span class="main">)</span><span class="main">)</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> list_to_nat_def<span class="main">)</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?k</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"length <span class="free">ls</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?k</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> S2_1 <span class="keyword1"><span class="command">have</span></span> S2_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> S2_3 <span class="keyword1"><span class="command">have</span></span> S2_4<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_list <span class="skolem">u</span> <span class="main">=</span> c_unfold <span class="main">(</span>c_len <span class="skolem">u</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="skolem">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_list_def<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> S2_5<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="skolem">u</span> <span class="main">=</span> length <span class="free">ls</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> S2_1 <span class="keyword1"><span class="command">have</span></span> S2_5_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">=</span> c_pair <span class="main">(</span><span class="main">(</span>length <span class="free">ls</span><span class="main">)</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="free">ls</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> S2_5_1 <span class="keyword1"><span class="command">have</span></span> S2_5_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span><span class="skolem">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>length <span class="free">ls</span><span class="main">)</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> S2_2 S2_5_2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span><span class="skolem">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">+</span><span class="main">1</span> <span class="main">=</span> length <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> S2_3 this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_len_2<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> S2_6<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="main">(</span><span class="skolem">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">=</span> c_fold <span class="free">ls</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> S2_1 <span class="keyword1"><span class="command">have</span></span> S2_6_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">=</span> c_pair <span class="main">(</span><span class="main">(</span>length <span class="free">ls</span><span class="main">)</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="free">ls</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> S2_6_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">from</span></span> S2_4 S2_5 S2_6 <span class="keyword1"><span class="command">have</span></span> S2_7<span class="main">:</span><span class="quoted"><span class="quoted">"nat_to_list <span class="skolem">u</span> <span class="main">=</span> c_unfold <span class="main">(</span>length <span class="free">ls</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="free">ls</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> S2_7 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_list <span class="skolem">u</span> <span class="main">=</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> th_3<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> u_def this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ls</span> <span class="main">=</span> <span class="main">[]</span> <span class="main">∨</span> <span class="free">ls</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"list_to_nat <span class="main">[]</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> list_to_nat_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_list <span class="main">0</span> <span class="main">=</span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_list_def<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> c_len_th_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="main">(</span>list_to_nat <span class="free">ls</span><span class="main">)</span> <span class="main">=</span> length <span class="free">ls</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">ls</span><span class="main">=</span><span class="main">[]</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ls</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"list_to_nat <span class="free">ls</span> <span class="main">=</span> c_pair <span class="main">(</span><span class="main">(</span>length <span class="free">ls</span><span class="main">)</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="free">ls</span><span class="main">)</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> list_to_nat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?u</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"list_to_nat <span class="free">ls</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> u_not_zero<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">=</span> c_pair <span class="main">(</span><span class="main">(</span>length <span class="free">ls</span><span class="main">)</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="free">ls</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst<span class="main">(</span><span class="var">?u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>length <span class="free">ls</span><span class="main">)</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S1 this <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst<span class="main">(</span><span class="var">?u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">+</span><span class="main">1</span><span class="main">=</span>length <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> u_not_zero S5 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="main">(</span><span class="var">?u</span><span class="main">)</span> <span class="main">=</span> length <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_len_2<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S6 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="quoted"><span class="quoted">"length <span class="main">(</span>nat_to_list <span class="free">u</span><span class="main">)</span> <span class="main">=</span> c_len <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?ls</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"nat_to_list <span class="free">u</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">=</span> list_to_nat <span class="var">?ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> list_to_nat_th <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> sym<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> c_len_th_1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"length <span class="var">?ls</span> <span class="main">=</span> c_len <span class="main">(</span>list_to_nat <span class="var">?ls</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sym<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ssubst<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_hd</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_hd</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> <span class="keyword1">if</span> <span class="bound">u</span><span class="main">=</span><span class="main">0</span> <span class="keyword1">then</span> <span class="main">0</span> <span class="keyword1">else</span> hd <span class="main">(</span>nat_to_list <span class="bound">u</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_tl</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_tl</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> list_to_nat <span class="main">(</span>tl <span class="main">(</span>nat_to_list <span class="bound">u</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_cons</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_cons</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">u</span><span class="main">.</span> list_to_nat <span class="main">(</span><span class="bound">x</span> <span class="main">#</span> <span class="main">(</span>nat_to_list <span class="bound">u</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"c_hd <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_hd_def<span class="main">)</span>

<span class="keyword1" id="PRecList-c_hd_aux0"><span class="command">lemma</span></span> c_hd_aux0<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⟹</span> nat_to_list <span class="free">u</span> <span class="main">=</span> <span class="main">[</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_list_def c_len_5<span class="main">)</span>

<span class="keyword1" id="PRecList-c_hd_aux1"><span class="command">lemma</span></span> c_hd_aux1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⟹</span> c_hd <span class="free">u</span> <span class="main">=</span> c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_list <span class="free">u</span> <span class="main">=</span> <span class="main">[</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_list_def c_len_5<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_len_5<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_hd_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_hd_aux2"><span class="command">lemma</span></span> c_hd_aux2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">⟹</span> c_hd <span class="free">u</span> <span class="main">=</span> c_fst <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?k</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_len <span class="free">u</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">=</span> Suc <span class="var">?k</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_len_5<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_hd <span class="free">u</span> <span class="main">=</span> hd <span class="main">(</span>nat_to_list <span class="free">u</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_hd_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_list <span class="free">u</span> <span class="main">=</span> c_unfold <span class="main">(</span>c_len <span class="free">u</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_list_of_pos<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S5 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_list <span class="free">u</span> <span class="main">=</span> c_unfold <span class="main">(</span>Suc <span class="var">?k</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?k</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S7 <span class="keyword1"><span class="command">have</span></span> S8<span class="main">:</span> <span class="quoted"><span class="quoted">"c_unfold <span class="main">(</span>Suc <span class="var">?k</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">#</span> <span class="main">(</span>c_unfold <span class="var">?k</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_unfold_4<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S6 S8 <span class="keyword1"><span class="command">have</span></span> S9<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_list <span class="free">u</span> <span class="main">=</span> <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">#</span> <span class="main">(</span>c_unfold <span class="var">?k</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S9 <span class="keyword1"><span class="command">have</span></span> S10<span class="main">:</span> <span class="quoted"><span class="quoted">"hd <span class="main">(</span>nat_to_list <span class="free">u</span><span class="main">)</span> <span class="main">=</span> c_fst <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S4 S10 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_hd_aux3"><span class="command">lemma</span></span> c_hd_aux3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> c_hd <span class="free">u</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="main">(</span>c_len <span class="free">u</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span> <span class="keyword1">then</span> c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="keyword1">else</span> c_fst <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_len_3<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">=</span> <span class="main">1</span> <span class="main">∨</span> c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?tmp</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1">if</span> <span class="main">(</span>c_len <span class="free">u</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span> <span class="keyword1">then</span> c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="keyword1">else</span> c_fst <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_hd <span class="free">u</span> <span class="main">=</span> c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_hd_aux1<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A2_1 <span class="keyword1"><span class="command">have</span></span> S2_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?tmp</span> <span class="main">=</span> c_snd<span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> S2_1 this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A3_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A3_1 <span class="keyword1"><span class="command">have</span></span> S3_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_hd <span class="free">u</span> <span class="main">=</span> c_fst <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_hd_aux2<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A3_1 <span class="keyword1"><span class="command">have</span></span> S3_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?tmp</span> <span class="main">=</span> c_fst <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> S3_1 this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_hd_aux4"><span class="command">lemma</span></span> c_hd_aux4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_hd <span class="free">u</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="free">u</span><span class="main">=</span><span class="main">0</span> <span class="keyword1">then</span> <span class="main">0</span> <span class="keyword1">else</span> <span class="main">(</span><span class="keyword1">if</span> <span class="main">(</span>c_len <span class="free">u</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span> <span class="keyword1">then</span> c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="keyword1">else</span> c_fst <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">=</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_hd_aux3<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_hd_is_pr"><span class="command">lemma</span></span> c_hd_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"c_hd <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_hd <span class="main">=</span> <span class="main">(</span><span class="main">%</span><span class="bound">u</span><span class="main">.</span> <span class="main">(</span><span class="keyword1">if</span> <span class="bound">u</span><span class="main">=</span><span class="main">0</span> <span class="keyword1">then</span> <span class="main">0</span> <span class="keyword1">else</span> <span class="main">(</span><span class="keyword1">if</span> <span class="main">(</span>c_len <span class="bound">u</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span> <span class="keyword1">then</span> c_snd <span class="main">(</span><span class="bound">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="keyword1">else</span> c_fst <span class="main">(</span>c_snd <span class="main">(</span><span class="bound">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_hd_aux4 ext<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> if_is_pr<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id1_1<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_zero<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="keyword1">if</span> c_len <span class="bound">x</span> <span class="main">=</span> <span class="main">1</span> <span class="keyword1">then</span> c_snd <span class="main">(</span><span class="bound">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="keyword1">else</span> c_fst <span class="main">(</span>c_snd <span class="main">(</span><span class="bound">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> if_eq_is_pr<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_len <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_len_is_pr<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">1</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> const_is_pr<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> c_snd <span class="main">(</span><span class="bound">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
      <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> c_fst <span class="main">(</span>c_snd <span class="main">(</span><span class="bound">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"c_tl <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_tl_def<span class="main">)</span>

<span class="keyword1" id="PRecList-c_tl_eq_tl"><span class="command">lemma</span></span> c_tl_eq_tl<span class="main">:</span> <span class="quoted"><span class="quoted">"c_tl <span class="main">(</span>list_to_nat <span class="free">ls</span><span class="main">)</span> <span class="main">=</span> list_to_nat <span class="main">(</span>tl <span class="free">ls</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_tl_def<span class="main">)</span>

<span class="keyword1" id="PRecList-tl_eq_c_tl"><span class="command">lemma</span></span> tl_eq_c_tl<span class="main">:</span> <span class="quoted"><span class="quoted">"tl <span class="main">(</span>nat_to_list <span class="free">x</span><span class="main">)</span> <span class="main">=</span> nat_to_list <span class="main">(</span>c_tl <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_tl_def<span class="main">)</span>

<span class="keyword1" id="PRecList-c_tl_aux1"><span class="command">lemma</span></span> c_tl_aux1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⟹</span> c_tl <span class="free">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> c_tl_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_hd_aux0<span class="main">)</span>

<span class="keyword1" id="PRecList-c_tl_aux2"><span class="command">lemma</span></span> c_tl_aux2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">⟹</span> c_tl <span class="free">u</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="main">(</span>c_len <span class="free">u</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?k</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_len <span class="free">u</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">=</span> Suc <span class="var">?k</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_len_5<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_list <span class="free">u</span> <span class="main">=</span> c_unfold <span class="main">(</span>c_len <span class="free">u</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_list_of_pos<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?k</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S5 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"c_unfold <span class="main">(</span>Suc <span class="var">?k</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">#</span> <span class="main">(</span>c_unfold <span class="var">?k</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_unfold_4<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S6 <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"tl <span class="main">(</span>c_unfold <span class="main">(</span>Suc <span class="var">?k</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> c_unfold <span class="var">?k</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S2 S4 S7 <span class="keyword1"><span class="command">have</span></span> S8<span class="main">:</span> <span class="quoted"><span class="quoted">"tl <span class="main">(</span>nat_to_list <span class="free">u</span><span class="main">)</span> <span class="main">=</span> c_unfold <span class="var">?k</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ls</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ls</span> <span class="main">=</span> tl <span class="main">(</span>nat_to_list <span class="free">u</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> ls_def S8 <span class="keyword1"><span class="command">have</span></span> S9<span class="main">:</span> <span class="quoted"><span class="quoted">"length <span class="skolem">ls</span> <span class="main">=</span> <span class="var">?k</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_unfold_len<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> ls_def <span class="keyword1"><span class="command">have</span></span> S10<span class="main">:</span> <span class="quoted"><span class="quoted">"c_tl <span class="free">u</span> <span class="main">=</span> list_to_nat <span class="skolem">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_tl_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S5 S9 <span class="keyword1"><span class="command">have</span></span> S11<span class="main">:</span> <span class="quoted"><span class="quoted">"length <span class="skolem">ls</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S11 <span class="keyword1"><span class="command">have</span></span> S12<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">ls</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S12 <span class="keyword1"><span class="command">have</span></span> S13<span class="main">:</span> <span class="quoted"><span class="quoted">"list_to_nat <span class="skolem">ls</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="main">(</span><span class="main">(</span>length <span class="skolem">ls</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="skolem">ls</span><span class="main">)</span><span class="main">)</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> list_to_nat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S10 S13 <span class="keyword1"><span class="command">have</span></span> S14<span class="main">:</span> <span class="quoted"><span class="quoted">"c_tl <span class="free">u</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="main">(</span><span class="main">(</span>length <span class="skolem">ls</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="skolem">ls</span><span class="main">)</span><span class="main">)</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S9 <span class="keyword1"><span class="command">have</span></span> S15<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>length <span class="skolem">ls</span><span class="main">)</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">=</span> <span class="var">?k</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S16<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?k</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">=</span> c_len <span class="free">u</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
  <span class="keyword1"><span class="command">from</span></span> S15 S16 <span class="keyword1"><span class="command">have</span></span> S17<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>length <span class="skolem">ls</span><span class="main">)</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">=</span> c_len <span class="free">u</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> ls_def S8 <span class="keyword1"><span class="command">have</span></span> S18<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">ls</span> <span class="main">=</span> c_unfold <span class="var">?k</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S5 <span class="keyword1"><span class="command">have</span></span> S19<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fold <span class="main">(</span>c_unfold <span class="var">?k</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> th_2<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S18 S19 <span class="keyword1"><span class="command">have</span></span> S20<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fold <span class="skolem">ls</span> <span class="main">=</span> c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S14 S17 S20 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_tl_aux3"><span class="command">lemma</span></span> c_tl_aux3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_tl <span class="free">u</span> <span class="main">=</span> <span class="main">(</span>sgn1 <span class="main">(</span><span class="main">(</span>c_len <span class="free">u</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">(</span>c_pair <span class="main">(</span>c_len <span class="free">u</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">=</span><span class="main">0</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">&gt;</span><span class="main">0</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">&gt;</span><span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> S2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_tl_aux1<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> S2_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">≠</span> <span class="main">1</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">assume</span></span> A2_2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">≠</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2_2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_len_3<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> A2_2_1 S2_2_1 <span class="keyword1"><span class="command">have</span></span> S2_2_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> S2_2_3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> S2_2_4<span class="main">:</span> <span class="quoted"><span class="quoted">"sgn1 <span class="main">(</span>c_len <span class="free">u</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">=</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> S2_2_4 <span class="keyword1"><span class="command">have</span></span> S2_2_5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="main">(</span>c_len <span class="free">u</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> S2_2_2 <span class="keyword1"><span class="command">have</span></span> S2_2_6<span class="main">:</span> <span class="quoted"><span class="quoted">"c_tl <span class="free">u</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="main">(</span>c_len <span class="free">u</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_tl_aux2<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> S2_2_5 S2_2_6 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> S2_1 S2_2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_tl_less"><span class="command">lemma</span></span> c_tl_less<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> c_tl <span class="free">u</span> <span class="main">&lt;</span> <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_len_3<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_tl_aux1<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> c_len <span class="free">u</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword1"><span class="command">have</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_tl <span class="free">u</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="main">(</span>c_len <span class="free">u</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_tl_aux2<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">=</span> c_fst<span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_len_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A2 S3 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">&lt;</span> c_fst<span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_pair <span class="main">(</span>c_len <span class="free">u</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="main">(</span>c_pair <span class="main">(</span>c_fst<span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_strict_mono1<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_snd_le_arg<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_pair <span class="main">(</span>c_fst<span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="main">(</span>c_pair <span class="main">(</span>c_fst<span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_mono2<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_pair <span class="main">(</span>c_fst<span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> S5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_pair <span class="main">(</span>c_len <span class="free">u</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">u</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_tl <span class="free">u</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_tl_le"><span class="command">lemma</span></span> c_tl_le<span class="main">:</span> <span class="quoted"><span class="quoted">"c_tl <span class="free">u</span> <span class="main">≤</span> <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">u</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">=</span><span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">v</span> <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">=</span> Suc <span class="skolem">v</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_tl <span class="free">u</span> <span class="main">&lt;</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_tl_less<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_tl <span class="free">u</span> <span class="main">≤</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> c_tl_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"c_tl <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_tl <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> <span class="main">(</span>sgn1 <span class="main">(</span><span class="main">(</span>c_len <span class="bound">u</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">(</span>c_pair <span class="main">(</span>c_len <span class="bound">u</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span><span class="bound">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_tl_aux3 ext<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> c_len_is_pr c_pair_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_cons_aux1"><span class="command">lemma</span></span> c_cons_aux1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_cons <span class="free">x</span> <span class="main">0</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="main">0</span> <span class="free">x</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">unfold</span> c_cons_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">unfold</span> list_to_nat_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="PRecList-c_cons_aux2"><span class="command">lemma</span></span> c_cons_aux2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> c_cons <span class="free">x</span> <span class="free">u</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="main">(</span>c_len <span class="free">u</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">x</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_len <span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_len_3<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_list <span class="free">u</span> <span class="main">=</span> c_unfold <span class="main">(</span>c_len <span class="free">u</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_list_of_pos<span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ls</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ls</span> <span class="main">=</span> nat_to_list <span class="free">u</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> ls_def S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">ls</span> <span class="main">=</span> c_unfold <span class="main">(</span>c_len <span class="free">u</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"length <span class="skolem">ls</span> <span class="main">=</span> c_len <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_unfold_len<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S4 S1 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"length <span class="skolem">ls</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S5 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">ls</span> <span class="main">≠</span> <span class="main">[]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> ls_def <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"c_cons <span class="free">x</span> <span class="free">u</span> <span class="main">=</span> list_to_nat <span class="main">(</span><span class="free">x</span> <span class="main">#</span> <span class="skolem">ls</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_cons_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S8<span class="main">:</span> <span class="quoted"><span class="quoted">"list_to_nat <span class="main">(</span><span class="free">x</span> <span class="main">#</span> <span class="skolem">ls</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="main">(</span><span class="main">(</span>length <span class="main">(</span><span class="free">x</span><span class="main">#</span><span class="skolem">ls</span><span class="main">)</span><span class="main">)</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="main">(</span><span class="free">x</span><span class="main">#</span><span class="skolem">ls</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> list_to_nat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>length <span class="main">(</span><span class="free">x</span><span class="main">#</span><span class="skolem">ls</span><span class="main">)</span><span class="main">)</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">=</span> length <span class="skolem">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S9 S4 S8 <span class="keyword1"><span class="command">have</span></span> S10<span class="main">:</span> <span class="quoted"><span class="quoted">"list_to_nat <span class="main">(</span><span class="free">x</span> <span class="main">#</span> <span class="skolem">ls</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="main">(</span>c_len <span class="free">u</span><span class="main">)</span> <span class="main">(</span>c_fold <span class="main">(</span><span class="free">x</span><span class="main">#</span><span class="skolem">ls</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S11<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fold <span class="main">(</span><span class="free">x</span><span class="main">#</span><span class="skolem">ls</span><span class="main">)</span> <span class="main">=</span> c_pair <span class="free">x</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> S6 <span class="keyword1"><span class="command">have</span></span> S11_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fold <span class="main">(</span><span class="free">x</span><span class="main">#</span><span class="skolem">ls</span><span class="main">)</span> <span class="main">=</span> c_pair <span class="free">x</span> <span class="main">(</span>c_fold <span class="skolem">ls</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_fold_0<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S11_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fold <span class="skolem">ls</span> <span class="main">=</span> c_fold <span class="main">(</span>c_unfold <span class="main">(</span>c_len <span class="free">u</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> S1 S11_2 <span class="keyword1"><span class="command">have</span></span> S11_3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fold <span class="skolem">ls</span> <span class="main">=</span> c_snd <span class="main">(</span><span class="free">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> th_2<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> S11_1 S11_3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> S7 S10 S11 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_cons_aux3"><span class="command">lemma</span></span> c_cons_aux3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_cons <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">u</span><span class="main">.</span> <span class="main">(</span>sgn2 <span class="bound">u</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">(</span>c_pair <span class="main">0</span> <span class="bound">x</span><span class="main">)</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>sgn1 <span class="bound">u</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">(</span>c_pair <span class="main">(</span>c_len <span class="bound">u</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">x</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="bound">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ext<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ext<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">u</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_cons <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">(</span>sgn2 <span class="skolem">u</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">(</span>c_pair <span class="main">0</span> <span class="skolem">x</span><span class="main">)</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>sgn1 <span class="skolem">u</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">(</span>c_pair <span class="main">(</span>c_len <span class="skolem">u</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="skolem">x</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="skolem">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">=</span><span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="main">0</span> <span class="skolem">x</span><span class="main">)</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_cons <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="main">0</span> <span class="skolem">x</span><span class="main">)</span><span class="main">+</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_cons_aux1<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">≠</span><span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="main">(</span>c_len <span class="skolem">u</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="skolem">x</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="skolem">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_cons <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="main">(</span>c_len <span class="skolem">u</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="skolem">x</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="skolem">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_cons_aux2<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_cons <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">=</span> <span class="var">?R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_cons_pos"><span class="command">lemma</span></span> c_cons_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"c_cons <span class="free">x</span> <span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">=</span><span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_cons <span class="free">x</span> <span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_cons_aux1<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">u</span><span class="main">=</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_cons <span class="free">x</span> <span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_cons_aux2<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> c_cons_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"c_cons <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_cons <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">u</span><span class="main">.</span> <span class="main">(</span>sgn2 <span class="bound">u</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">(</span>c_pair <span class="main">0</span> <span class="bound">x</span><span class="main">)</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>sgn1 <span class="bound">u</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">(</span>c_pair <span class="main">(</span>c_len <span class="bound">u</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">x</span> <span class="main">(</span>c_snd <span class="main">(</span><span class="bound">u</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_cons_aux3<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> c_pair_is_pr c_len_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_drop</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_drop</span> <span class="main">=</span> PrimRecOp <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> c_tl <span class="bound">y</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecList-c_drop_at_0"><span class="command">lemma</span></span> c_drop_at_0 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"c_drop <span class="main">0</span> <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_drop_def<span class="main">)</span>

<span class="keyword1" id="PRecList-c_drop_at_Suc"><span class="command">lemma</span></span> c_drop_at_Suc<span class="main">:</span> <span class="quoted"><span class="quoted">"c_drop <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="free">x</span> <span class="main">=</span> c_tl <span class="main">(</span>c_drop <span class="free">y</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_drop_def<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> c_drop_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"c_drop <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id1_1<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> c_tl_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> c_tl <span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_drop_def pr_rec<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_tl_c_drop"><span class="command">lemma</span></span> c_tl_c_drop<span class="main">:</span> <span class="quoted"><span class="quoted">"c_tl <span class="main">(</span>c_drop <span class="free">y</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> c_drop <span class="free">y</span> <span class="main">(</span>c_tl <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">y</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_drop_at_Suc<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="PRecList-c_drop_at_Suc1"><span class="command">lemma</span></span> c_drop_at_Suc1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_drop <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="free">x</span> <span class="main">=</span> c_drop <span class="free">y</span> <span class="main">(</span>c_tl <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_drop_at_Suc c_tl_c_drop<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="PRecList-c_drop_df"><span class="command">lemma</span></span> c_drop_df<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">ls</span><span class="main">.</span> drop <span class="free">n</span> <span class="bound">ls</span> <span class="main">=</span> nat_to_list <span class="main">(</span>c_drop <span class="free">n</span> <span class="main">(</span>list_to_nat <span class="bound">ls</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">ls</span><span class="main">.</span> drop <span class="main">0</span> <span class="bound">ls</span> <span class="main">=</span> nat_to_list <span class="main">(</span>c_drop <span class="main">0</span> <span class="main">(</span>list_to_nat <span class="bound">ls</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_drop_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">ls</span><span class="main">.</span> drop <span class="skolem">n</span> <span class="bound">ls</span> <span class="main">=</span> nat_to_list <span class="main">(</span>c_drop <span class="skolem">n</span> <span class="main">(</span>list_to_nat <span class="bound">ls</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">ls</span><span class="main">.</span> drop <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="bound">ls</span> <span class="main">=</span> nat_to_list <span class="main">(</span>c_drop <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">(</span>list_to_nat <span class="bound">ls</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">ls</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat list"</span></span>
    <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"drop <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="skolem">ls</span> <span class="main">=</span> drop <span class="skolem">n</span> <span class="main">(</span>tl <span class="skolem">ls</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> drop_Suc<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"drop <span class="skolem">n</span> <span class="main">(</span>tl <span class="skolem">ls</span><span class="main">)</span> <span class="main">=</span> nat_to_list <span class="main">(</span>c_drop <span class="skolem">n</span> <span class="main">(</span>list_to_nat <span class="main">(</span>tl <span class="skolem">ls</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> nat_to_list <span class="main">(</span>c_drop <span class="skolem">n</span> <span class="main">(</span>c_tl <span class="main">(</span>list_to_nat <span class="skolem">ls</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span>  <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_tl_eq_tl<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> nat_to_list <span class="main">(</span>c_drop <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">(</span>list_to_nat <span class="skolem">ls</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span>  <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_drop_at_Suc1<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"drop <span class="skolem">n</span> <span class="main">(</span>tl <span class="skolem">ls</span><span class="main">)</span> <span class="main">=</span> nat_to_list <span class="main">(</span>c_drop <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">(</span>list_to_nat <span class="skolem">ls</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"drop <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="skolem">ls</span> <span class="main">=</span> nat_to_list <span class="main">(</span>c_drop <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">(</span>list_to_nat <span class="skolem">ls</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>    
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_nth</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_nth</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">n</span><span class="main">.</span> c_hd <span class="main">(</span>c_drop <span class="bound">n</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecList-c_nth_is_pr"><span class="command">lemma</span></span> c_nth_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"c_nth <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> c_nth_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> c_hd_is_pr c_drop_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">n</span><span class="main">.</span> c_hd <span class="main">(</span>c_drop <span class="bound">n</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_nth_at_0"><span class="command">lemma</span></span> c_nth_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"c_nth <span class="free">x</span> <span class="main">0</span> <span class="main">=</span> c_hd <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_nth_def<span class="main">)</span>

<span class="keyword1" id="PRecList-c_hd_c_cons"><span class="command">lemma</span></span> c_hd_c_cons <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"c_hd <span class="main">(</span>c_cons <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_cons <span class="free">x</span> <span class="free">y</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_cons_pos<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_hd_def c_cons_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_tl_c_cons"><span class="command">lemma</span></span> c_tl_c_cons <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"c_tl <span class="main">(</span>c_cons <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_tl_def c_cons_def<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_f_list</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_f_list</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span><span class="main">.</span>
    <span class="keyword1">let</span> <span class="bound">g</span> <span class="main">=</span> <span class="main">(</span><span class="main">%</span><span class="bound">x</span><span class="main">.</span> c_cons <span class="main">(</span><span class="bound">f</span> <span class="main">0</span> <span class="bound">x</span><span class="main">)</span> <span class="main">0</span><span class="main">)</span><span class="main">;</span> <span class="bound">h</span> <span class="main">=</span> <span class="main">(</span><span class="main">%</span><span class="bound">a</span> <span class="bound">b</span> <span class="bound">c</span><span class="main">.</span> c_cons <span class="main">(</span><span class="bound">f</span> <span class="main">(</span>Suc <span class="bound">a</span><span class="main">)</span> <span class="bound">c</span><span class="main">)</span> <span class="bound">b</span><span class="main">)</span> <span class="keyword1">in</span> PrimRecOp <span class="bound">g</span> <span class="bound">h</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecList-c_f_list_at_0"><span class="command">lemma</span></span> c_f_list_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"c_f_list <span class="free">f</span> <span class="main">0</span> <span class="free">x</span> <span class="main">=</span> c_cons <span class="main">(</span><span class="free">f</span> <span class="main">0</span> <span class="free">x</span><span class="main">)</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_f_list_def Let_def<span class="main">)</span>

<span class="keyword1" id="PRecList-c_f_list_at_Suc"><span class="command">lemma</span></span> c_f_list_at_Suc<span class="main">:</span> <span class="quoted"><span class="quoted">"c_f_list <span class="free">f</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="free">x</span> <span class="main">=</span> c_cons <span class="main">(</span><span class="free">f</span> <span class="main">(</span>Suc <span class="free">y</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>c_f_list <span class="free">f</span> <span class="free">y</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_f_list_def Let_def<span class="main">)</span><span class="main">)</span>

<span class="keyword1" id="PRecList-c_f_list_is_pr"><span class="command">lemma</span></span> c_f_list_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec2 <span class="main">⟹</span> c_f_list <span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">%</span><span class="bound">x</span><span class="main">.</span> c_cons <span class="main">(</span><span class="free">f</span> <span class="main">0</span> <span class="bound">x</span><span class="main">)</span> <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 c_cons_is_pr <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?g</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?h</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">%</span><span class="bound">a</span> <span class="bound">b</span> <span class="bound">c</span><span class="main">.</span> c_cons <span class="main">(</span><span class="free">f</span> <span class="main">(</span>Suc <span class="bound">a</span><span class="main">)</span> <span class="bound">c</span><span class="main">)</span> <span class="bound">b</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 c_cons_is_pr <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?h</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_rec c_f_list_def Let_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_f_list_to_f_0"><span class="command">lemma</span></span> c_f_list_to_f_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">y</span> <span class="free">x</span> <span class="main">=</span> c_hd <span class="main">(</span>c_f_list <span class="free">f</span> <span class="free">y</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">y</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_f_list_at_0<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_f_list_at_Suc<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="PRecList-c_f_list_to_f"><span class="command">lemma</span></span> c_f_list_to_f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">.</span> c_hd <span class="main">(</span>c_f_list <span class="free">f</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> ext<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ext<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> c_f_list_to_f_0<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="PRecList-c_f_list_f_is_pr"><span class="command">lemma</span></span> c_f_list_f_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"c_f_list <span class="free">f</span> <span class="main">∈</span> PrimRec2 <span class="main">⟹</span> <span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_f_list <span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">.</span> c_hd <span class="main">(</span>c_f_list <span class="free">f</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_f_list_to_f<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 c_hd_is_pr <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">.</span> c_hd <span class="main">(</span>c_f_list <span class="free">f</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_f_list_lm_1"><span class="command">lemma</span></span> c_f_list_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_nth <span class="main">(</span>c_cons <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">(</span>Suc <span class="free">z</span><span class="main">)</span> <span class="main">=</span> c_nth <span class="free">y</span> <span class="free">z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_nth_def c_drop_at_Suc1<span class="main">)</span>

<span class="keyword1" id="PRecList-c_f_list_lm_2"><span class="command">lemma</span></span> c_f_list_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">" <span class="free">z</span> <span class="main">&lt;</span> Suc <span class="free">n</span> <span class="main">⟹</span> c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>Suc <span class="free">n</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span> <span class="main">=</span> c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">&lt;</span> Suc <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="free">n</span> <span class="main">-</span> <span class="free">z</span> <span class="main">=</span> Suc <span class="main">(</span><span class="free">n</span><span class="main">-</span><span class="free">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>Suc <span class="free">n</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span> <span class="main">=</span> c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>Suc <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> c_nth <span class="main">(</span>c_cons <span class="main">(</span><span class="free">f</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>c_f_list <span class="free">f</span> <span class="free">n</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Suc <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_f_list_at_Suc<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="free">n</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_f_list_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_f_list_nth"><span class="command">lemma</span></span> c_f_list_nth<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">≤</span> <span class="free">y</span> <span class="main">⟶</span> c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="free">y</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="free">y</span><span class="main">-</span><span class="free">z</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span> <span class="free">z</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">y</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">≤</span> <span class="main">0</span> <span class="main">⟶</span> c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="main">0</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="main">0</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span> <span class="free">z</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">z</span><span class="main">=</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="main">0</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="main">0</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span> <span class="main">=</span> c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="main">0</span> <span class="free">x</span><span class="main">)</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> c_hd <span class="main">(</span>c_f_list <span class="free">f</span> <span class="main">0</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_nth_at_0<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> c_hd <span class="main">(</span>c_cons <span class="main">(</span><span class="free">f</span> <span class="main">0</span> <span class="free">x</span><span class="main">)</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_f_list_at_0<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="free">f</span> <span class="main">0</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="main">0</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="main">0</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span> <span class="free">z</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> A1<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">" <span class="free">z</span> <span class="main">≤</span> <span class="skolem">n</span> <span class="main">⟶</span> c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="skolem">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span> <span class="free">z</span> <span class="free">x</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">≤</span> Suc <span class="skolem">n</span> <span class="main">⟶</span> c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>Suc <span class="skolem">n</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span> <span class="free">z</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">≤</span> Suc <span class="skolem">n</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">" <span class="free">z</span> <span class="main">≤</span> Suc <span class="skolem">n</span> <span class="main">⟹</span> c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>Suc <span class="skolem">n</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span> <span class="free">z</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> AA1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">≤</span> <span class="skolem">n</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> AA2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">&lt;</span> Suc <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> A2 this <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="skolem">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span> <span class="free">z</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> AA2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>Suc <span class="skolem">n</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span> <span class="main">=</span> c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="skolem">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_f_list_lm_2<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>Suc <span class="skolem">n</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span> <span class="free">z</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">z</span> <span class="main">≤</span> <span class="skolem">n</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> A3 this <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">=</span> Suc <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">n</span> <span class="main">-</span> <span class="free">z</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>Suc <span class="skolem">n</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span> <span class="main">=</span> c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> c_hd <span class="main">(</span>c_f_list <span class="free">f</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_nth_at_0<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> c_hd <span class="main">(</span>c_cons <span class="main">(</span><span class="free">f</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>c_f_list <span class="free">f</span> <span class="skolem">n</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_f_list_at_Suc<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="free">f</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_nth <span class="main">(</span>c_f_list <span class="free">f</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>Suc <span class="skolem">n</span> <span class="main">-</span> <span class="free">z</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span> <span class="free">z</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> S1<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> th_pr_rec<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">g</span> <span class="main">∈</span> PrimRec1<span class="main">;</span> <span class="free">h</span> <span class="main">∈</span> PrimRec3<span class="main">;</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="main">0</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">;</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">h</span> <span class="bound">y</span> <span class="main">(</span><span class="free">f</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> h_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> PrimRec3"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> f_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">0</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">g</span> <span class="bound">x</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> f_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">h</span> <span class="bound">y</span> <span class="main">(</span><span class="free">f</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"PrimRecOp <span class="free">g</span> <span class="free">h</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> g_is_pr h_is_pr <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_rec<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> f_2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="var">?f</span> <span class="main">0</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">g</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> f_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="var">?f</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">h</span> <span class="bound">y</span> <span class="main">(</span><span class="var">?f</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> <span class="var">?f</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">f</span> <span class="bound">y</span> <span class="bound">x</span> <span class="main">=</span> <span class="var">?f</span> <span class="bound">y</span> <span class="bound">x</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">induct_tac</span> <span class="quoted"><span class="improper"><span class="quoted"><span class="improper">y</span></span></span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">insert</span> f_0 f_1<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> <span class="var">?f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ext<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> th_rec<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">g</span> <span class="main">∈</span> PrimRec1<span class="main">;</span> <span class="free">α</span> <span class="main">∈</span> PrimRec2<span class="main">;</span> <span class="free">h</span> <span class="main">∈</span> PrimRec3<span class="main">;</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">α</span> <span class="bound">y</span> <span class="bound">x</span> <span class="main">≤</span> <span class="bound">y</span><span class="main">)</span><span class="main">;</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="main">0</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">;</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">h</span> <span class="bound">y</span> <span class="main">(</span><span class="free">f</span> <span class="main">(</span><span class="free">α</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> a_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">α</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> h_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> PrimRec3"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> a_le<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">α</span> <span class="bound">y</span> <span class="bound">x</span> <span class="main">≤</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> f_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">0</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">g</span> <span class="bound">x</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> f_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">h</span> <span class="bound">y</span> <span class="main">(</span><span class="free">f</span> <span class="main">(</span><span class="free">α</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> c_cons <span class="main">(</span><span class="free">g</span> <span class="bound">x</span><span class="main">)</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?h'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">a</span> <span class="bound">b</span> <span class="bound">c</span><span class="main">.</span> c_cons <span class="main">(</span><span class="free">h</span> <span class="bound">a</span> <span class="main">(</span>c_nth <span class="bound">b</span> <span class="main">(</span><span class="bound">a</span> <span class="main">-</span> <span class="main">(</span><span class="free">α</span> <span class="bound">a</span> <span class="bound">c</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="bound">c</span><span class="main">)</span> <span class="bound">b</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?r</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_f_list <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> g_is_pr c_cons_is_pr <span class="keyword1"><span class="command">have</span></span> g'_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?g'</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">from</span></span> h_is_pr c_cons_is_pr c_nth_is_pr a_is_pr <span class="keyword1"><span class="command">have</span></span> h'_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?h'</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="var">?r</span> <span class="main">0</span> <span class="bound">x</span> <span class="main">=</span> <span class="var">?g'</span> <span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?r</span> <span class="main">0</span> <span class="skolem">x</span> <span class="main">=</span> c_cons <span class="main">(</span><span class="free">f</span> <span class="main">0</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_f_list_at_0<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> f_0 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?r</span> <span class="main">0</span> <span class="skolem">x</span> <span class="main">=</span> c_cons <span class="main">(</span><span class="free">g</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?r</span> <span class="main">0</span> <span class="skolem">x</span> <span class="main">=</span> <span class="var">?g'</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="var">?r</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="bound">x</span> <span class="main">=</span> <span class="var">?h'</span> <span class="bound">y</span> <span class="main">(</span><span class="var">?r</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?r</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> <span class="var">?h'</span> <span class="skolem">y</span> <span class="main">(</span><span class="var">?r</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="skolem">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> S2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?r</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> c_cons <span class="main">(</span><span class="free">f</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">(</span><span class="var">?r</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_f_list_at_Suc<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> f_1 <span class="keyword1"><span class="command">have</span></span> S2_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">h</span> <span class="skolem">y</span> <span class="main">(</span><span class="free">f</span> <span class="main">(</span><span class="free">α</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> a_le <span class="keyword1"><span class="command">have</span></span> S2_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">α</span> <span class="skolem">y</span> <span class="skolem">x</span> <span class="main">≤</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2_4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">(</span><span class="free">α</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> c_nth <span class="main">(</span><span class="var">?r</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">(</span><span class="skolem">y</span><span class="main">-</span><span class="main">(</span><span class="free">α</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_f_list_nth<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> S2_1 S2_2 S2_4 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> g'_is_pr h'_is_pr S1 S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?r</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> th_pr_rec<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_f_list_f_is_pr<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">declare</span></span> c_tl_less <span class="main">[</span><span class="operator">termination_simp</span><span class="main">]</span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">c_assoc_have_key</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  c_assoc_have_key_df <span class="main">[</span><span class="operator">simp</span> <span class="quasi_keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span class="quasi_keyword">del</span></span></span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c_assoc_have_key</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span> <span class="main">1</span> <span class="keyword1">else</span>
    <span class="main">(</span><span class="keyword1">if</span> c_fst <span class="main">(</span>c_hd <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">then</span> <span class="main">0</span> <span class="keyword1">else</span> <span class="free">c_assoc_have_key</span> <span class="main">(</span>c_tl <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecList-c_assoc_have_key_lm_1"><span class="command">lemma</span></span> c_assoc_have_key_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> c_assoc_have_key <span class="free">y</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> c_fst <span class="main">(</span>c_hd <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span> <span class="keyword1">then</span> <span class="main">0</span> <span class="keyword1">else</span> c_assoc_have_key <span class="main">(</span>c_tl <span class="free">y</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_have_key_df<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> c_assoc_have_key_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?h</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">a</span> <span class="bound">b</span> <span class="bound">c</span><span class="main">.</span> <span class="keyword1">if</span> c_fst <span class="main">(</span>c_hd <span class="main">(</span>Suc <span class="bound">a</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="bound">c</span> <span class="keyword1">then</span> <span class="main">0</span> <span class="keyword1">else</span> <span class="bound">b</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?a</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">.</span> c_tl <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?g</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> const_is_pr<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> c_tl_is_pr <span class="keyword1"><span class="command">have</span></span> a_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?a</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> h_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?h</span> <span class="main">∈</span> PrimRec3"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> if_eq_is_pr3<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> c_fst_is_pr c_hd_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> c_fst <span class="main">(</span>c_hd <span class="main">(</span>Suc <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">z</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id3_3<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id3_2<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> a_le<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="var">?a</span> <span class="bound">y</span> <span class="bound">x</span> <span class="main">≤</span> <span class="bound">y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?a</span> <span class="skolem">y</span> <span class="skolem">x</span> <span class="main">≤</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">y</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?a</span> <span class="skolem">y</span> <span class="skolem">x</span> <span class="main">&lt;</span> Suc <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_tl_less<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> f_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> c_assoc_have_key <span class="main">0</span> <span class="bound">x</span> <span class="main">=</span> <span class="var">?g</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_have_key_df<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> f_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> c_assoc_have_key <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="bound">x</span> <span class="main">=</span> <span class="var">?h</span> <span class="bound">y</span> <span class="main">(</span>c_assoc_have_key <span class="main">(</span><span class="var">?a</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_have_key_df<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> g_is_pr a_is_pr h_is_pr a_le f_0 f_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> th_rec<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">c_assoc_value</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  c_assoc_value_df <span class="main">[</span><span class="operator">simp</span> <span class="quasi_keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span class="quasi_keyword">del</span></span></span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c_assoc_value</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span> <span class="main">0</span> <span class="keyword1">else</span>
    <span class="main">(</span><span class="keyword1">if</span> c_fst <span class="main">(</span>c_hd <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">then</span> c_snd <span class="main">(</span>c_hd <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="keyword1">else</span> <span class="free">c_assoc_value</span> <span class="main">(</span>c_tl <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecList-c_assoc_value_lm_1"><span class="command">lemma</span></span> c_assoc_value_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> c_assoc_value <span class="free">y</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> c_fst <span class="main">(</span>c_hd <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span> <span class="keyword1">then</span> c_snd <span class="main">(</span>c_hd <span class="free">y</span><span class="main">)</span> <span class="keyword1">else</span> c_assoc_value <span class="main">(</span>c_tl <span class="free">y</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_value_df<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> c_assoc_value_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?h</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">a</span> <span class="bound">b</span> <span class="bound">c</span><span class="main">.</span> <span class="keyword1">if</span> c_fst <span class="main">(</span>c_hd <span class="main">(</span>Suc <span class="bound">a</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="bound">c</span> <span class="keyword1">then</span> c_snd <span class="main">(</span>c_hd <span class="main">(</span>Suc <span class="bound">a</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">else</span> <span class="bound">b</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?a</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">.</span> c_tl <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">0</span><span class="main">::</span>nat<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?g</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> const_is_pr<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> c_tl_is_pr <span class="keyword1"><span class="command">have</span></span> a_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?a</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> h_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?h</span> <span class="main">∈</span> PrimRec3"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> if_eq_is_pr3<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> c_fst_is_pr c_hd_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> c_fst <span class="main">(</span>c_hd <span class="main">(</span>Suc <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">z</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id3_3<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> c_snd_is_pr c_hd_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> c_snd <span class="main">(</span>c_hd <span class="main">(</span>Suc <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id3_2<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> a_le<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="var">?a</span> <span class="bound">y</span> <span class="bound">x</span> <span class="main">≤</span> <span class="bound">y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?a</span> <span class="skolem">y</span> <span class="skolem">x</span> <span class="main">≤</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">y</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?a</span> <span class="skolem">y</span> <span class="skolem">x</span> <span class="main">&lt;</span> Suc <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_tl_less<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> f_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> c_assoc_value <span class="main">0</span> <span class="bound">x</span> <span class="main">=</span> <span class="var">?g</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_value_df<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> f_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> c_assoc_value <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="bound">x</span> <span class="main">=</span> <span class="var">?h</span> <span class="bound">y</span> <span class="main">(</span>c_assoc_value <span class="main">(</span><span class="var">?a</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_value_df<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> g_is_pr a_is_pr h_is_pr a_le f_0 f_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> th_rec<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_assoc_lm_1"><span class="command">lemma</span></span> c_assoc_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>c_cons <span class="main">(</span>c_pair <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="free">z</span><span class="main">)</span> <span class="free">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_have_key_df<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_cons_pos<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="PRecList-c_assoc_lm_2"><span class="command">lemma</span></span> c_assoc_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="main">(</span>c_cons <span class="main">(</span>c_pair <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="free">z</span><span class="main">)</span> <span class="free">x</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_value_df<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">insert</span> c_cons_pos <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">(</span></span>c_pair <span class="free"><span class="free">x</span></span> <span class="free"><span class="free">y</span></span><span class="main"><span class="main">)</span></span>"</span></span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">and</span></span></span></span> u<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">"<span class="free"><span class="free">z</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="PRecList-c_assoc_lm_3"><span class="command">lemma</span></span> c_assoc_lm_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x1</span> <span class="main">≠</span> <span class="free">x</span> <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>c_cons <span class="main">(</span>c_pair <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="free">z</span><span class="main">)</span> <span class="free">x1</span> <span class="main">=</span> c_assoc_have_key <span class="free">z</span> <span class="free">x1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x1</span> <span class="main">≠</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?ls</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_cons <span class="main">(</span>c_pair <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="free">z</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?ls</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_cons_pos<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="var">?ls</span> <span class="free">x1</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> c_fst <span class="main">(</span>c_hd <span class="var">?ls</span><span class="main">)</span> <span class="main">=</span> <span class="free">x1</span> <span class="keyword1">then</span> <span class="main">0</span> <span class="keyword1">else</span> c_assoc_have_key <span class="main">(</span>c_tl <span class="var">?ls</span><span class="main">)</span> <span class="free">x1</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_assoc_have_key_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_hd <span class="var">?ls</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>c_fst <span class="main">(</span>c_hd <span class="var">?ls</span><span class="main">)</span> <span class="main">=</span> <span class="free">x1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S4 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">=</span> c_assoc_have_key <span class="main">(</span>c_tl <span class="var">?ls</span><span class="main">)</span> <span class="free">x1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> if_not_P<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 S5 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecList-c_assoc_lm_4"><span class="command">lemma</span></span> c_assoc_lm_4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x1</span> <span class="main">≠</span> <span class="free">x</span> <span class="main">⟹</span> c_assoc_value <span class="main">(</span>c_cons <span class="main">(</span>c_pair <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="free">z</span><span class="main">)</span> <span class="free">x1</span> <span class="main">=</span> c_assoc_value <span class="free">z</span> <span class="free">x1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x1</span> <span class="main">≠</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?ls</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_cons <span class="main">(</span>c_pair <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="free">z</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?ls</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_cons_pos<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="var">?ls</span> <span class="free">x1</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> c_fst <span class="main">(</span>c_hd <span class="var">?ls</span><span class="main">)</span> <span class="main">=</span> <span class="free">x1</span> <span class="keyword1">then</span> c_snd <span class="main">(</span>c_hd <span class="var">?ls</span><span class="main">)</span> <span class="keyword1">else</span> c_assoc_value <span class="main">(</span>c_tl <span class="var">?ls</span><span class="main">)</span> <span class="free">x1</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_assoc_value_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_hd <span class="var">?ls</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>c_fst <span class="main">(</span>c_hd <span class="var">?ls</span><span class="main">)</span> <span class="main">=</span> <span class="free">x1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S4 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">=</span> c_assoc_value <span class="main">(</span>c_tl <span class="var">?ls</span><span class="main">)</span> <span class="free">x1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> if_not_P<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 S5 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="PRecFun2">
<div class="head">
<h1>Theory PRecFun2</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Primitive recursive functions of one variable
    Author:      Michael Nedzelsky &lt;MichaelNedzelsky at yandex.ru&gt;, 2008
    Maintainer:  Michael Nedzelsky &lt;MichaelNedzelsky at yandex.ru&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Primitive recursive functions of one variable›</span></span>

<span class="keyword1"><span class="command">theory</span></span> PRecFun2
<span class="keyword2"><span class="keyword">imports</span></span> <a href="PRecFun.html">PRecFun</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Alternative definition of primitive recursive functions of one variable›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">UnaryRecOp</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">UnaryRecOp</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">g</span> <span class="bound">h</span><span class="main">.</span> pr_conv_2_to_1 <span class="main">(</span>PrimRecOp <span class="bound">g</span> <span class="main">(</span>pr_conv_1_to_3 <span class="bound">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecFun2-unary_rec_into_pr"><span class="command">lemma</span></span> unary_rec_into_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">g</span> <span class="main">∈</span> PrimRec1<span class="main">;</span> <span class="free">h</span> <span class="main">∈</span> PrimRec1 <span class="main">⟧</span> <span class="main">⟹</span> UnaryRecOp <span class="free">g</span> <span class="free">h</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> UnaryRecOp_def pr_conv_1_to_3_lm pr_conv_2_to_1_lm pr_rec<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_f_pair</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_f_pair</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span> <span class="bound">g</span> <span class="bound">x</span><span class="main">.</span> c_pair <span class="main">(</span><span class="bound">f</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="bound">g</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecFun2-c_f_pair_to_pr"><span class="command">lemma</span></span> c_f_pair_to_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">f</span> <span class="main">∈</span> PrimRec1<span class="main">;</span> <span class="free">g</span> <span class="main">∈</span> PrimRec1 <span class="main">⟧</span> <span class="main">⟹</span> c_f_pair <span class="free">f</span> <span class="free">g</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> c_f_pair_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>

<span class="keyword1"><span class="command">inductive_set</span></span> <span class="entity">PrimRec1'</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> set"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  zero<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec1'</span>"</span></span>
  <span class="main">|</span> suc<span class="main">:</span>  <span class="quoted"><span class="quoted">"Suc <span class="main">∈</span> <span class="free">PrimRec1'</span>"</span></span>
  <span class="main">|</span> fst<span class="main">:</span>  <span class="quoted"><span class="quoted">"c_fst <span class="main">∈</span> <span class="free">PrimRec1'</span>"</span></span>
  <span class="main">|</span> snd<span class="main">:</span>  <span class="quoted"><span class="quoted">"c_snd <span class="main">∈</span> <span class="free">PrimRec1'</span>"</span></span>
  <span class="main">|</span> comp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1'</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1'</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">PrimRec1'</span>"</span></span>
  <span class="main">|</span> pair<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1'</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1'</span> <span class="main">⟧</span> <span class="main">⟹</span> c_f_pair <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1'</span>"</span></span>
  <span class="main">|</span> un_rec<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1'</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1'</span> <span class="main">⟧</span> <span class="main">⟹</span> UnaryRecOp <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∈</span> <span class="free">PrimRec1'</span>"</span></span>

<span class="keyword1" id="PRecFun2-primrec'_into_primrec"><span class="command">lemma</span></span> primrec'_into_primrec<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec1' <span class="main">⟹</span> <span class="free">f</span> <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">f</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> PrimRec1'.induct<span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> zero <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_zero<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> suc <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_suc<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> fst <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_fst_is_pr<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> snd <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_snd_is_pr<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> comp <span class="keyword1"><span class="command">from</span></span> comp <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_comp1_1<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> pair <span class="keyword1"><span class="command">from</span></span> pair <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_f_pair_to_pr<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> un_rec <span class="keyword1"><span class="command">from</span></span> un_rec <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> unary_rec_into_pr<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-pr_id1_1'"><span class="command">lemma</span></span> pr_id1_1'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_f_pair c_fst c_snd <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PrimRec1'.fst PrimRec1'.snd PrimRec1'.pair<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_f_pair c_fst c_snd <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_f_pair_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-pr_id2_1'"><span class="command">lemma</span></span> pr_id2_1'<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_conv_2_to_1 <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_2_to_1_def PrimRec1'.fst<span class="main">)</span>

<span class="keyword1" id="PRecFun2-pr_id2_2'"><span class="command">lemma</span></span> pr_id2_2'<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_conv_2_to_1 <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_2_to_1_def PrimRec1'.snd<span class="main">)</span>

<span class="keyword1" id="PRecFun2-pr_id3_1'"><span class="command">lemma</span></span> pr_id3_1'<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> c_fst <span class="main">(</span>c_fst <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_3_to_1_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> PrimRec1'.fst PrimRec1'.fst <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> c_fst <span class="main">(</span>c_fst <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> PrimRec1'.comp<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-pr_id3_2'"><span class="command">lemma</span></span> pr_id3_2'<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> c_snd <span class="main">(</span>c_fst <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_3_to_1_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> PrimRec1'.snd PrimRec1'.fst <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> c_snd <span class="main">(</span>c_fst <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> PrimRec1'.comp<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-pr_id3_3'"><span class="command">lemma</span></span> pr_id3_3'<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">z</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">z</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> c_snd <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_3_to_1_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PrimRec1'.snd<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-pr_comp2_1'"><span class="command">lemma</span></span> pr_comp2_1'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> pr_conv_2_to_1 <span class="free">f</span> <span class="main">∈</span> PrimRec1'<span class="main">;</span> <span class="free">g</span> <span class="main">∈</span> PrimRec1'<span class="main">;</span> <span class="free">h</span> <span class="main">∈</span> PrimRec1' <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free">h</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_conv_2_to_1 <span class="free">f</span> <span class="main">∈</span> PrimRec1'"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> PrimRec1'"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> PrimRec1'"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"pr_conv_2_to_1 <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">%</span><span class="bound">x</span><span class="main">.</span> <span class="var">?f1</span> <span class="main">(</span><span class="main">(</span>c_f_pair <span class="free">g</span> <span class="free">h</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free">h</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_f_pair_def pr_conv_2_to_1_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A2 A3 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_f_pair <span class="free">g</span> <span class="free">h</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> PrimRec1'.pair<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">%</span><span class="bound">x</span><span class="main">.</span> <span class="var">?f1</span> <span class="main">(</span><span class="main">(</span>c_f_pair <span class="free">g</span> <span class="free">h</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> PrimRec1'.comp<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-pr_comp3_1'"><span class="command">lemma</span></span> pr_comp3_1'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> pr_conv_3_to_1 <span class="free">f</span> <span class="main">∈</span> PrimRec1'<span class="main">;</span> <span class="free">g</span> <span class="main">∈</span> PrimRec1'<span class="main">;</span> <span class="free">h</span> <span class="main">∈</span> PrimRec1'<span class="main">;</span> <span class="free">k</span> <span class="main">∈</span> PrimRec1' <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free">h</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free">k</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="free">f</span> <span class="main">∈</span> PrimRec1'"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> PrimRec1'"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> PrimRec1'"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">∈</span> PrimRec1'"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_f_pair <span class="free">g</span> <span class="free">h</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> PrimRec1'.pair<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_f_pair <span class="main">(</span>c_f_pair <span class="free">g</span> <span class="free">h</span><span class="main">)</span> <span class="free">k</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> PrimRec1'.pair<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">%</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span>pr_conv_3_to_1 <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span>c_f_pair <span class="main">(</span>c_f_pair <span class="free">g</span> <span class="free">h</span><span class="main">)</span> <span class="free">k</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> PrimRec1'.comp<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_f_pair_def pr_conv_3_to_1_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-pr_comp1_2'"><span class="command">lemma</span></span> pr_comp1_2'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">f</span> <span class="main">∈</span> PrimRec1'<span class="main">;</span> pr_conv_2_to_1 <span class="free">g</span> <span class="main">∈</span> PrimRec1' <span class="main">⟧</span> <span class="main">⟹</span> pr_conv_2_to_1 <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec1'"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pr_conv_2_to_1 <span class="free">g</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g1</span> <span class="main">∈</span> PrimRec1'"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span><span class="var">?g1</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> PrimRec1'.comp<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_2_to_1_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-pr_comp1_3'"><span class="command">lemma</span></span> pr_comp1_3'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">f</span> <span class="main">∈</span> PrimRec1'<span class="main">;</span> pr_conv_3_to_1 <span class="free">g</span> <span class="main">∈</span> PrimRec1' <span class="main">⟧</span> <span class="main">⟹</span> pr_conv_3_to_1 <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec1'"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="free">g</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g1</span> <span class="main">∈</span> PrimRec1'"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span><span class="var">?g1</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> PrimRec1'.comp<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_3_to_1_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-pr_comp2_2'"><span class="command">lemma</span></span> pr_comp2_2'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> pr_conv_2_to_1 <span class="free">f</span> <span class="main">∈</span> PrimRec1'<span class="main">;</span> pr_conv_2_to_1 <span class="free">g</span> <span class="main">∈</span> PrimRec1'<span class="main">;</span> pr_conv_2_to_1 <span class="free">h</span> <span class="main">∈</span> PrimRec1' <span class="main">⟧</span> <span class="main">⟹</span> pr_conv_2_to_1 <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">(</span><span class="free">h</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"pr_conv_2_to_1 <span class="free">f</span> <span class="main">∈</span> PrimRec1'"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pr_conv_2_to_1 <span class="free">g</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g1</span> <span class="main">∈</span> PrimRec1'"</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pr_conv_2_to_1 <span class="free">h</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?h1</span> <span class="main">∈</span> PrimRec1'"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span><span class="var">?g1</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="var">?h1</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_comp2_1'<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_2_to_1_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-pr_comp2_3'"><span class="command">lemma</span></span> pr_comp2_3'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> pr_conv_2_to_1 <span class="free">f</span> <span class="main">∈</span> PrimRec1'<span class="main">;</span> pr_conv_3_to_1 <span class="free">g</span> <span class="main">∈</span> PrimRec1'<span class="main">;</span> pr_conv_3_to_1 <span class="free">h</span> <span class="main">∈</span> PrimRec1' <span class="main">⟧</span> <span class="main">⟹</span> pr_conv_3_to_1 <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="main">(</span><span class="free">h</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"pr_conv_2_to_1 <span class="free">f</span> <span class="main">∈</span> PrimRec1'"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="free">g</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g1</span> <span class="main">∈</span> PrimRec1'"</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="free">h</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?h1</span> <span class="main">∈</span> PrimRec1'"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span><span class="var">?g1</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="var">?h1</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_comp2_1'<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_3_to_1_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-pr_comp3_2'"><span class="command">lemma</span></span> pr_comp3_2'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> pr_conv_3_to_1 <span class="free">f</span> <span class="main">∈</span> PrimRec1'<span class="main">;</span> pr_conv_2_to_1 <span class="free">g</span> <span class="main">∈</span> PrimRec1'<span class="main">;</span> pr_conv_2_to_1 <span class="free">h</span> <span class="main">∈</span> PrimRec1'<span class="main">;</span> pr_conv_2_to_1 <span class="free">k</span> <span class="main">∈</span> PrimRec1' <span class="main">⟧</span> <span class="main">⟹</span> pr_conv_2_to_1 <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">(</span><span class="free">h</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">(</span><span class="free">k</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="free">f</span> <span class="main">∈</span> PrimRec1'"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pr_conv_2_to_1 <span class="free">g</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g1</span> <span class="main">∈</span> PrimRec1'"</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pr_conv_2_to_1 <span class="free">h</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?h1</span> <span class="main">∈</span> PrimRec1'"</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pr_conv_2_to_1 <span class="free">k</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?k1</span> <span class="main">∈</span> PrimRec1'"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span><span class="var">?g1</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="var">?h1</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="var">?k1</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_comp3_1'<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_2_to_1_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-pr_comp3_3'"><span class="command">lemma</span></span> pr_comp3_3'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> pr_conv_3_to_1 <span class="free">f</span> <span class="main">∈</span> PrimRec1'<span class="main">;</span> pr_conv_3_to_1 <span class="free">g</span> <span class="main">∈</span> PrimRec1'<span class="main">;</span> pr_conv_3_to_1 <span class="free">h</span> <span class="main">∈</span> PrimRec1'<span class="main">;</span> pr_conv_3_to_1 <span class="free">k</span> <span class="main">∈</span> PrimRec1' <span class="main">⟧</span> <span class="main">⟹</span> pr_conv_3_to_1 <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="main">(</span><span class="free">h</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span> <span class="main">(</span><span class="free">k</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="free">f</span> <span class="main">∈</span> PrimRec1'"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="free">g</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g1</span> <span class="main">∈</span> PrimRec1'"</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="free">h</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?h1</span> <span class="main">∈</span> PrimRec1'"</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="free">k</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?k1</span> <span class="main">∈</span> PrimRec1'"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">(</span><span class="var">?g1</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="var">?h1</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="var">?k1</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_comp3_1'<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_3_to_1_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-lm'"><span class="command">lemma</span></span> lm'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f1</span> <span class="main">∈</span> PrimRec1 <span class="main">⟶</span> <span class="free">f1</span> <span class="main">∈</span> PrimRec1'<span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="free">g1</span> <span class="main">∈</span> PrimRec2 <span class="main">⟶</span> pr_conv_2_to_1 <span class="free">g1</span> <span class="main">∈</span> PrimRec1'<span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="free">h1</span> <span class="main">∈</span> PrimRec3 <span class="main">⟶</span> pr_conv_3_to_1 <span class="free">h1</span> <span class="main">∈</span> PrimRec1'<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> PrimRec1_PrimRec2_PrimRec3.induct<span class="main">)</span>
     <span class="keyword3"><span class="command">case</span></span> zero <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> PrimRec1'.zero<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> suc <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> PrimRec1'.suc<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> id1_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id1_1'<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> id2_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id2_1'<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> id2_2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id2_2'<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> id3_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id3_1'<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> id3_2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id3_2'<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> id3_3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id3_3'<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> comp1_1 <span class="keyword1"><span class="command">from</span></span> comp1_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PrimRec1'.comp<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> comp1_2 <span class="keyword1"><span class="command">from</span></span> comp1_2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_comp1_2'<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> comp1_3 <span class="keyword1"><span class="command">from</span></span> comp1_3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_comp1_3'<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> comp2_1 <span class="keyword1"><span class="command">from</span></span> comp2_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_comp2_1'<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> comp2_2 <span class="keyword1"><span class="command">from</span></span> comp2_2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_comp2_2'<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> comp2_3 <span class="keyword1"><span class="command">from</span></span> comp2_3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_comp2_3'<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> comp3_1 <span class="keyword1"><span class="command">from</span></span> comp3_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_comp3_1'<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> comp3_2 <span class="keyword1"><span class="command">from</span></span> comp3_2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_comp3_2'<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> comp3_3 <span class="keyword1"><span class="command">from</span></span> comp3_3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_comp3_3'<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> prim_rec
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"pr_conv_3_to_1 <span class="skolem">h</span> <span class="main">∈</span> PrimRec1'"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"UnaryRecOp <span class="skolem">g</span> <span class="main">(</span>pr_conv_3_to_1 <span class="skolem">h</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> PrimRec1'.un_rec<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"UnaryRecOp <span class="skolem">g</span> <span class="main">(</span>pr_conv_3_to_1 <span class="skolem">h</span><span class="main">)</span> <span class="main">=</span> pr_conv_2_to_1 <span class="main">(</span>PrimRecOp <span class="skolem">g</span> <span class="skolem">h</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> UnaryRecOp_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pr_conv_2_to_1 <span class="main">(</span>PrimRecOp <span class="skolem">g</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> pr_1_eq_1'<span class="main">:</span> <span class="quoted"><span class="quoted">"PrimRec1 <span class="main">=</span> PrimRec1'"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> PrimRec1 <span class="main">⟶</span> <span class="bound">f</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lm'<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> PrimRec1' <span class="main">⟶</span> <span class="bound">f</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> primrec'_into_primrec<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹The scheme datatype›</span></span>

<span class="keyword1"><span class="command">datatype</span></span> PrimScheme <span class="main">=</span> Base_zero <span class="main">|</span> Base_suc <span class="main">|</span> Base_fst <span class="main">|</span> Base_snd
                      <span class="main">|</span> Comp_op <span class="quoted">PrimScheme</span> <span class="quoted">PrimScheme</span>
                      <span class="main">|</span> Pair_op <span class="quoted">PrimScheme</span> <span class="quoted">PrimScheme</span>
                      <span class="main">|</span> Rec_op <span class="quoted">PrimScheme</span> <span class="quoted">PrimScheme</span>

<span class="keyword1"><span class="command">primrec</span></span>
  <span class="entity">sch_to_pr</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"PrimScheme <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">sch_to_pr</span> Base_zero <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">sch_to_pr</span> Base_suc <span class="main">=</span> Suc"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">sch_to_pr</span> Base_fst <span class="main">=</span> c_fst"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">sch_to_pr</span> Base_snd <span class="main">=</span> c_snd"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">sch_to_pr</span> <span class="main">(</span>Comp_op <span class="free"><span class="bound"><span class="entity">t1</span></span></span> <span class="free"><span class="bound"><span class="entity">t2</span></span></span><span class="main">)</span>  <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="free">sch_to_pr</span> <span class="free"><span class="bound"><span class="entity">t1</span></span></span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="free">sch_to_pr</span> <span class="free"><span class="bound"><span class="entity">t2</span></span></span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">sch_to_pr</span> <span class="main">(</span>Pair_op <span class="free"><span class="bound"><span class="entity">t1</span></span></span> <span class="free"><span class="bound"><span class="entity">t2</span></span></span><span class="main">)</span>  <span class="main">=</span> c_f_pair <span class="main">(</span><span class="free">sch_to_pr</span> <span class="free"><span class="bound"><span class="entity">t1</span></span></span><span class="main">)</span> <span class="main">(</span><span class="free">sch_to_pr</span> <span class="free"><span class="bound"><span class="entity">t2</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">sch_to_pr</span> <span class="main">(</span>Rec_op <span class="free"><span class="bound"><span class="entity">t1</span></span></span> <span class="free"><span class="bound"><span class="entity">t2</span></span></span><span class="main">)</span>  <span class="main">=</span> UnaryRecOp <span class="main">(</span><span class="free">sch_to_pr</span> <span class="free"><span class="bound"><span class="entity">t1</span></span></span><span class="main">)</span> <span class="main">(</span><span class="free">sch_to_pr</span> <span class="free"><span class="bound"><span class="entity">t2</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecFun2-sch_to_pr_into_pr"><span class="command">lemma</span></span> sch_to_pr_into_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"sch_to_pr <span class="free">sch</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_1_eq_1'<span class="main"><span class="keyword3">,</span></span> <span class="operator">induct</span> <span class="quoted"><span class="free">sch</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PrimRec1'.intros<span class="main">)</span>

<span class="keyword1" id="PRecFun2-sch_to_pr_srj"><span class="command">lemma</span></span> sch_to_pr_srj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec1 <span class="main">⟹</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">sch</span><span class="main">.</span> <span class="free">f</span> <span class="main">=</span> sch_to_pr <span class="bound">sch</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec1'"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_1_eq_1'<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">f</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> PrimRec1'.induct<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> sch_to_pr Base_zero"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">sch</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span><span class="bound">u</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> sch_to_pr <span class="bound">sch</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="main">=</span> sch_to_pr Base_suc"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">sch</span><span class="main">.</span> Suc <span class="main">=</span> sch_to_pr <span class="bound">sch</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="main">=</span> sch_to_pr Base_fst"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">sch</span><span class="main">.</span> c_fst <span class="main">=</span> sch_to_pr <span class="bound">sch</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_snd <span class="main">=</span> sch_to_pr Base_snd"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">sch</span><span class="main">.</span> c_snd <span class="main">=</span> sch_to_pr <span class="bound">sch</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f1</span> <span class="skolem">f2</span> <span class="keyword3"><span class="command">assume</span></span> B1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">sch</span><span class="main">.</span> <span class="skolem">f1</span> <span class="main">=</span> sch_to_pr <span class="bound">sch</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> B2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">sch</span><span class="main">.</span> <span class="skolem">f2</span> <span class="main">=</span> sch_to_pr <span class="bound">sch</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> B1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">sch1</span></span> <span class="keyword2"><span class="keyword">where</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f1</span> <span class="main">=</span> sch_to_pr <span class="skolem">sch1</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">from</span></span> B2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">sch2</span></span> <span class="keyword2"><span class="keyword">where</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f2</span> <span class="main">=</span> sch_to_pr <span class="skolem">sch2</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">f1</span> <span class="main">(</span><span class="skolem">f2</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> sch_to_pr <span class="main">(</span>Comp_op <span class="skolem">sch1</span> <span class="skolem">sch2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">sch</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="skolem">f1</span> <span class="main">(</span><span class="skolem">f2</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> sch_to_pr <span class="bound">sch</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f1</span> <span class="skolem">f2</span> <span class="keyword3"><span class="command">assume</span></span> B1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">sch</span><span class="main">.</span> <span class="skolem">f1</span> <span class="main">=</span> sch_to_pr <span class="bound">sch</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> B2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">sch</span><span class="main">.</span> <span class="skolem">f2</span> <span class="main">=</span> sch_to_pr <span class="bound">sch</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> B1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">sch1</span></span> <span class="keyword2"><span class="keyword">where</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f1</span> <span class="main">=</span> sch_to_pr <span class="skolem">sch1</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">from</span></span> B2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">sch2</span></span> <span class="keyword2"><span class="keyword">where</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f2</span> <span class="main">=</span> sch_to_pr <span class="skolem">sch2</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_f_pair <span class="skolem">f1</span> <span class="skolem">f2</span> <span class="main">=</span> sch_to_pr <span class="main">(</span>Pair_op <span class="skolem">sch1</span> <span class="skolem">sch2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">sch</span><span class="main">.</span> c_f_pair <span class="skolem">f1</span> <span class="skolem">f2</span> <span class="main">=</span> sch_to_pr <span class="bound">sch</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f1</span> <span class="skolem">f2</span> <span class="keyword3"><span class="command">assume</span></span> B1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">sch</span><span class="main">.</span> <span class="skolem">f1</span> <span class="main">=</span> sch_to_pr <span class="bound">sch</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> B2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">sch</span><span class="main">.</span> <span class="skolem">f2</span> <span class="main">=</span> sch_to_pr <span class="bound">sch</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> B1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">sch1</span></span> <span class="keyword2"><span class="keyword">where</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f1</span> <span class="main">=</span> sch_to_pr <span class="skolem">sch1</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">from</span></span> B2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">sch2</span></span> <span class="keyword2"><span class="keyword">where</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f2</span> <span class="main">=</span> sch_to_pr <span class="skolem">sch2</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"UnaryRecOp <span class="skolem">f1</span> <span class="skolem">f2</span> <span class="main">=</span> sch_to_pr <span class="main">(</span>Rec_op <span class="skolem">sch1</span> <span class="skolem">sch2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">sch</span><span class="main">.</span> UnaryRecOp <span class="skolem">f1</span> <span class="skolem">f2</span> <span class="main">=</span> sch_to_pr <span class="bound">sch</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">loc_f</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> PrimScheme <span class="main">⇒</span> PrimScheme <span class="main">⇒</span> PrimScheme"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">loc_f</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">sch1</span></span></span> <span class="free"><span class="bound"><span class="entity">sch2</span></span></span> <span class="main">=</span>
    <span class="main">(</span><span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">=</span><span class="main">0</span> <span class="keyword1">then</span> Base_zero <span class="keyword1">else</span>
     <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">=</span><span class="main">1</span> <span class="keyword1">then</span> Base_suc <span class="keyword1">else</span>
     <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">=</span><span class="numeral">2</span> <span class="keyword1">then</span> Base_fst <span class="keyword1">else</span>
     <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">=</span><span class="numeral">3</span> <span class="keyword1">then</span> Base_snd <span class="keyword1">else</span>
     <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">=</span><span class="numeral">4</span> <span class="keyword1">then</span> <span class="main">(</span>Comp_op <span class="free"><span class="bound"><span class="entity">sch1</span></span></span> <span class="free"><span class="bound"><span class="entity">sch2</span></span></span><span class="main">)</span> <span class="keyword1">else</span>
     <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">=</span><span class="numeral">5</span> <span class="keyword1">then</span> <span class="main">(</span>Pair_op <span class="free"><span class="bound"><span class="entity">sch1</span></span></span> <span class="free"><span class="bound"><span class="entity">sch2</span></span></span><span class="main">)</span> <span class="keyword1">else</span>
     <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">=</span><span class="numeral">6</span> <span class="keyword1">then</span> <span class="main">(</span>Rec_op <span class="free"><span class="bound"><span class="entity">sch1</span></span></span> <span class="free"><span class="bound"><span class="entity">sch2</span></span></span><span class="main">)</span> <span class="keyword1">else</span>
     Base_zero<span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">mod7</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">mod7</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="keyword1">mod</span> <span class="numeral">7</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecFun2-c_snd_snd_lt"><span class="command">lemma</span></span> c_snd_snd_lt <span class="main">[</span><span class="operator">termination_simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="main">(</span>c_snd <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> Suc <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Suc <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?y</span> <span class="main">&lt;</span> <span class="var">?y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_snd_less_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_snd <span class="main">(</span>c_snd <span class="var">?y</span><span class="main">)</span> <span class="main">≤</span> c_snd <span class="var">?y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_snd_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-c_fst_snd_lt"><span class="command">lemma</span></span> c_fst_snd_lt <span class="main">[</span><span class="operator">termination_simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_snd <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> Suc <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Suc <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?y</span> <span class="main">&lt;</span> <span class="var">?y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_snd_less_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_snd <span class="var">?y</span><span class="main">)</span> <span class="main">≤</span> c_snd <span class="var">?y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_fst_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">nat_to_sch</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> PrimScheme"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">nat_to_sch</span> <span class="main">0</span> <span class="main">=</span> Base_zero"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">nat_to_sch</span> <span class="main">(</span>Suc <span class="main">0</span><span class="main">)</span> <span class="main">=</span> Base_zero"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">nat_to_sch</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span>mod7 <span class="main">(</span>c_fst <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span><span class="free">nat_to_sch</span> <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span><span class="free">nat_to_sch</span> <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">sch_to_nat</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"PrimScheme <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">sch_to_nat</span> Base_zero <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">sch_to_nat</span> Base_suc <span class="main">=</span> c_pair <span class="main">1</span> <span class="main">0</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">sch_to_nat</span> Base_fst <span class="main">=</span> c_pair <span class="numeral">2</span> <span class="main">0</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">sch_to_nat</span> Base_snd <span class="main">=</span> c_pair <span class="numeral">3</span> <span class="main">0</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">sch_to_nat</span> <span class="main">(</span>Comp_op <span class="free"><span class="bound"><span class="entity">t1</span></span></span> <span class="free"><span class="bound"><span class="entity">t2</span></span></span><span class="main">)</span> <span class="main">=</span> c_pair <span class="numeral">4</span> <span class="main">(</span>c_pair <span class="main">(</span><span class="free">sch_to_nat</span> <span class="free"><span class="bound"><span class="entity">t1</span></span></span><span class="main">)</span> <span class="main">(</span><span class="free">sch_to_nat</span> <span class="free"><span class="bound"><span class="entity">t2</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">sch_to_nat</span> <span class="main">(</span>Pair_op <span class="free"><span class="bound"><span class="entity">t1</span></span></span> <span class="free"><span class="bound"><span class="entity">t2</span></span></span><span class="main">)</span> <span class="main">=</span> c_pair <span class="numeral">5</span> <span class="main">(</span>c_pair <span class="main">(</span><span class="free">sch_to_nat</span> <span class="free"><span class="bound"><span class="entity">t1</span></span></span><span class="main">)</span> <span class="main">(</span><span class="free">sch_to_nat</span> <span class="free"><span class="bound"><span class="entity">t2</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">sch_to_nat</span> <span class="main">(</span>Rec_op <span class="free"><span class="bound"><span class="entity">t1</span></span></span> <span class="free"><span class="bound"><span class="entity">t2</span></span></span><span class="main">)</span>  <span class="main">=</span> c_pair <span class="numeral">6</span> <span class="main">(</span>c_pair <span class="main">(</span><span class="free">sch_to_nat</span> <span class="free"><span class="bound"><span class="entity">t1</span></span></span><span class="main">)</span> <span class="main">(</span><span class="free">sch_to_nat</span> <span class="free"><span class="bound"><span class="entity">t2</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecFun2-loc_srj_lm_1"><span class="command">lemma</span></span> loc_srj_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span>mod7 <span class="main">(</span>c_fst <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span><span class="main">)</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="PRecFun2-loc_srj_lm_2"><span class="command">lemma</span></span> loc_srj_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">⟹</span> nat_to_sch <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span>mod7 <span class="main">(</span>c_fst <span class="free">x</span><span class="main">)</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="free">x</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">-</span><span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> Suc <span class="main">(</span>Suc <span class="var">?y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="var">?y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span>mod7 <span class="main">(</span>c_fst <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="var">?y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="var">?y</span><span class="main">)</span><span class="main">)</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_srj_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-loc_srj_0"><span class="command">lemma</span></span> loc_srj_0<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="main">(</span>c_pair <span class="main">1</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> Base_suc"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="main">1</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def sf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">=</span> Suc <span class="main">(</span>Suc <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Suc <span class="main">(</span>Suc <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="var">?y</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span>mod7 <span class="main">(</span>c_fst <span class="var">?y</span><span class="main">)</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="var">?y</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_srj_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="var">?y</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="var">?y</span> <span class="main">=</span> c_fst <span class="var">?x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?y</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?y</span> <span class="main">=</span> c_snd <span class="var">?x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> S4 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"mod7 <span class="main">(</span>c_fst <span class="var">?y</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mod7_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 S5 S6 <span class="keyword1"><span class="command">have</span></span> S9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">=</span> loc_f <span class="main">1</span> Base_zero Base_zero"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def c_fst_at_0 c_snd_at_0<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S10<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">=</span> Base_suc"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_f_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S11<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="var">?y</span> <span class="main">=</span> Base_suc"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S2 this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-nat_to_sch_at_2"><span class="command">lemma</span></span> nat_to_sch_at_2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="numeral">2</span> <span class="main">=</span> Base_suc"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="main">1</span> <span class="main">0</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def sf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="main">(</span>c_pair <span class="main">1</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> Base_suc"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_srj_0<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-loc_srj_1"><span class="command">lemma</span></span> loc_srj_1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="main">(</span>c_pair <span class="numeral">2</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> Base_fst"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="numeral">2</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">=</span> <span class="numeral">5</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def sf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">=</span> Suc <span class="main">(</span>Suc <span class="numeral">3</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Suc <span class="main">(</span>Suc <span class="numeral">3</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="var">?y</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span>mod7 <span class="main">(</span>c_fst <span class="var">?y</span><span class="main">)</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="var">?y</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_srj_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="var">?y</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="var">?y</span> <span class="main">=</span> c_fst <span class="var">?x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?y</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?y</span> <span class="main">=</span> c_snd <span class="var">?x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> S4 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"mod7 <span class="main">(</span>c_fst <span class="var">?y</span><span class="main">)</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mod7_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 S5 S6 <span class="keyword1"><span class="command">have</span></span> S9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">=</span> loc_f <span class="numeral">2</span> Base_zero Base_zero"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def c_fst_at_0 c_snd_at_0<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S10<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">=</span> Base_fst"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_f_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S11<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="var">?y</span> <span class="main">=</span> Base_fst"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S2 this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-loc_srj_2"><span class="command">lemma</span></span> loc_srj_2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="main">(</span>c_pair <span class="numeral">3</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> Base_snd"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="numeral">3</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def sf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="var">?x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span>mod7 <span class="main">(</span>c_fst <span class="var">?x</span><span class="main">)</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="var">?x</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_srj_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="var">?x</span> <span class="main">=</span> <span class="numeral">3</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?x</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"mod7 <span class="main">(</span>c_fst <span class="var">?x</span><span class="main">)</span> <span class="main">=</span> <span class="numeral">3</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mod7_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 S4 S6 <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">=</span> loc_f <span class="numeral">3</span> Base_zero Base_zero"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def c_fst_at_0 c_snd_at_0<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">=</span> Base_snd"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_f_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S10<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="var">?x</span> <span class="main">=</span> Base_snd"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S2 this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-loc_srj_3"><span class="command">lemma</span></span> loc_srj_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>nat_to_sch <span class="main">(</span>sch_to_nat <span class="free">sch1</span><span class="main">)</span> <span class="main">=</span> <span class="free">sch1</span><span class="main">;</span> nat_to_sch <span class="main">(</span>sch_to_nat <span class="free">sch2</span><span class="main">)</span> <span class="main">=</span> <span class="free">sch2</span><span class="main">⟧</span>
       <span class="main">⟹</span> nat_to_sch <span class="main">(</span>c_pair <span class="numeral">4</span> <span class="main">(</span>c_pair <span class="main">(</span>sch_to_nat <span class="free">sch1</span><span class="main">)</span> <span class="main">(</span>sch_to_nat <span class="free">sch2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Comp_op <span class="free">sch1</span> <span class="free">sch2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="main">(</span>sch_to_nat <span class="free">sch1</span><span class="main">)</span> <span class="main">=</span> <span class="free">sch1</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="main">(</span>sch_to_nat <span class="free">sch2</span><span class="main">)</span> <span class="main">=</span> <span class="free">sch2</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="numeral">4</span> <span class="main">(</span>c_pair <span class="main">(</span>sch_to_nat <span class="free">sch1</span><span class="main">)</span> <span class="main">(</span>sch_to_nat <span class="free">sch2</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def sf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="var">?x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span>mod7 <span class="main">(</span>c_fst <span class="var">?x</span><span class="main">)</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="var">?x</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_srj_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="var">?x</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?x</span> <span class="main">=</span> c_pair <span class="main">(</span>sch_to_nat <span class="free">sch1</span><span class="main">)</span> <span class="main">(</span>sch_to_nat <span class="free">sch2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"mod7 <span class="main">(</span>c_fst <span class="var">?x</span><span class="main">)</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mod7_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 S4 S5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">=</span> Comp_op <span class="free">sch1</span> <span class="free">sch2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def c_fst_at_0 c_snd_at_0 loc_f_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-loc_srj_3_1"><span class="command">lemma</span></span> loc_srj_3_1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="main">(</span>c_pair <span class="numeral">4</span> <span class="main">(</span>c_pair <span class="free">n1</span> <span class="free">n2</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Comp_op <span class="main">(</span>nat_to_sch <span class="free">n1</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="free">n2</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="numeral">4</span> <span class="main">(</span>c_pair <span class="free">n1</span> <span class="free">n2</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def sf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="var">?x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span>mod7 <span class="main">(</span>c_fst <span class="var">?x</span><span class="main">)</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="var">?x</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_srj_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="var">?x</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?x</span> <span class="main">=</span> c_pair <span class="free">n1</span> <span class="free">n2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"mod7 <span class="main">(</span>c_fst <span class="var">?x</span><span class="main">)</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mod7_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S4 S5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">=</span> Comp_op <span class="main">(</span>nat_to_sch <span class="free">n1</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="free">n2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def c_fst_at_0 c_snd_at_0 loc_f_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-loc_srj_4"><span class="command">lemma</span></span> loc_srj_4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>nat_to_sch <span class="main">(</span>sch_to_nat <span class="free">sch1</span><span class="main">)</span> <span class="main">=</span> <span class="free">sch1</span><span class="main">;</span> nat_to_sch <span class="main">(</span>sch_to_nat <span class="free">sch2</span><span class="main">)</span> <span class="main">=</span> <span class="free">sch2</span><span class="main">⟧</span>
       <span class="main">⟹</span> nat_to_sch <span class="main">(</span>c_pair <span class="numeral">5</span> <span class="main">(</span>c_pair <span class="main">(</span>sch_to_nat <span class="free">sch1</span><span class="main">)</span> <span class="main">(</span>sch_to_nat <span class="free">sch2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Pair_op <span class="free">sch1</span> <span class="free">sch2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="main">(</span>sch_to_nat <span class="free">sch1</span><span class="main">)</span> <span class="main">=</span> <span class="free">sch1</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="main">(</span>sch_to_nat <span class="free">sch2</span><span class="main">)</span> <span class="main">=</span> <span class="free">sch2</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="numeral">5</span> <span class="main">(</span>c_pair <span class="main">(</span>sch_to_nat <span class="free">sch1</span><span class="main">)</span> <span class="main">(</span>sch_to_nat <span class="free">sch2</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def sf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="var">?x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span>mod7 <span class="main">(</span>c_fst <span class="var">?x</span><span class="main">)</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="var">?x</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_srj_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="var">?x</span> <span class="main">=</span> <span class="numeral">5</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?x</span> <span class="main">=</span> c_pair <span class="main">(</span>sch_to_nat <span class="free">sch1</span><span class="main">)</span> <span class="main">(</span>sch_to_nat <span class="free">sch2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"mod7 <span class="main">(</span>c_fst <span class="var">?x</span><span class="main">)</span> <span class="main">=</span> <span class="numeral">5</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mod7_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 S4 S5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">=</span> Pair_op <span class="free">sch1</span> <span class="free">sch2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def c_fst_at_0 c_snd_at_0 loc_f_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-loc_srj_4_1"><span class="command">lemma</span></span> loc_srj_4_1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="main">(</span>c_pair <span class="numeral">5</span> <span class="main">(</span>c_pair <span class="free">n1</span> <span class="free">n2</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Pair_op <span class="main">(</span>nat_to_sch <span class="free">n1</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="free">n2</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="numeral">5</span> <span class="main">(</span>c_pair <span class="free">n1</span> <span class="free">n2</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def sf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="var">?x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span>mod7 <span class="main">(</span>c_fst <span class="var">?x</span><span class="main">)</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="var">?x</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_srj_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="var">?x</span> <span class="main">=</span> <span class="numeral">5</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?x</span> <span class="main">=</span> c_pair <span class="free">n1</span> <span class="free">n2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"mod7 <span class="main">(</span>c_fst <span class="var">?x</span><span class="main">)</span> <span class="main">=</span> <span class="numeral">5</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mod7_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S4 S5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">=</span> Pair_op <span class="main">(</span>nat_to_sch <span class="free">n1</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="free">n2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def c_fst_at_0 c_snd_at_0 loc_f_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-loc_srj_5"><span class="command">lemma</span></span> loc_srj_5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>nat_to_sch <span class="main">(</span>sch_to_nat <span class="free">sch1</span><span class="main">)</span> <span class="main">=</span> <span class="free">sch1</span><span class="main">;</span> nat_to_sch <span class="main">(</span>sch_to_nat <span class="free">sch2</span><span class="main">)</span> <span class="main">=</span> <span class="free">sch2</span><span class="main">⟧</span>
       <span class="main">⟹</span> nat_to_sch <span class="main">(</span>c_pair <span class="numeral">6</span> <span class="main">(</span>c_pair <span class="main">(</span>sch_to_nat <span class="free">sch1</span><span class="main">)</span> <span class="main">(</span>sch_to_nat <span class="free">sch2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Rec_op <span class="free">sch1</span> <span class="free">sch2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="main">(</span>sch_to_nat <span class="free">sch1</span><span class="main">)</span> <span class="main">=</span> <span class="free">sch1</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="main">(</span>sch_to_nat <span class="free">sch2</span><span class="main">)</span> <span class="main">=</span> <span class="free">sch2</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="numeral">6</span> <span class="main">(</span>c_pair <span class="main">(</span>sch_to_nat <span class="free">sch1</span><span class="main">)</span> <span class="main">(</span>sch_to_nat <span class="free">sch2</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def sf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="var">?x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span>mod7 <span class="main">(</span>c_fst <span class="var">?x</span><span class="main">)</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="var">?x</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_srj_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="var">?x</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?x</span> <span class="main">=</span> c_pair <span class="main">(</span>sch_to_nat <span class="free">sch1</span><span class="main">)</span> <span class="main">(</span>sch_to_nat <span class="free">sch2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"mod7 <span class="main">(</span>c_fst <span class="var">?x</span><span class="main">)</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mod7_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 S4 S5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">=</span> Rec_op <span class="free">sch1</span> <span class="free">sch2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def c_fst_at_0 c_snd_at_0 loc_f_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-loc_srj_5_1"><span class="command">lemma</span></span> loc_srj_5_1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="main">(</span>c_pair <span class="numeral">6</span> <span class="main">(</span>c_pair <span class="free">n1</span> <span class="free">n2</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Rec_op <span class="main">(</span>nat_to_sch <span class="free">n1</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="free">n2</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="numeral">6</span> <span class="main">(</span>c_pair <span class="free">n1</span> <span class="free">n2</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def sf_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="var">?x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span>mod7 <span class="main">(</span>c_fst <span class="var">?x</span><span class="main">)</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="var">?x</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?R</span>"</span></span><span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_srj_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="var">?x</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?x</span> <span class="main">=</span> c_pair <span class="free">n1</span> <span class="free">n2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"mod7 <span class="main">(</span>c_fst <span class="var">?x</span><span class="main">)</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mod7_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S4 S5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">=</span> Rec_op <span class="main">(</span>nat_to_sch <span class="free">n1</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="free">n2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def c_fst_at_0 c_snd_at_0 loc_f_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> nat_to_sch_srj<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="main">(</span>sch_to_nat <span class="free">sch</span><span class="main">)</span> <span class="main">=</span> <span class="free">sch</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">sch</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_srj_0 loc_srj_1 loc_srj_2 loc_srj_3 loc_srj_4 loc_srj_5<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">insert</span> loc_srj_0<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Indexes of primitive recursive functions of one variables›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">nat_to_pr</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">nat_to_pr</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> sch_to_pr <span class="main">(</span>nat_to_sch <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">theorem</span></span> nat_to_pr_into_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="free">n</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_def sch_to_pr_into_pr<span class="main">)</span>

<span class="keyword1" id="PRecFun2-nat_to_pr_srj"><span class="command">lemma</span></span> nat_to_pr_srj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec1 <span class="main">⟹</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">n</span><span class="main">.</span> <span class="free">f</span> <span class="main">=</span> nat_to_pr <span class="bound">n</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span> <span class="bound">t</span><span class="main">.</span> <span class="free">f</span> <span class="main">=</span> sch_to_pr <span class="bound">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sch_to_pr_srj<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> sch_to_pr <span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"sch_to_nat <span class="skolem">t</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="var">?n</span> <span class="main">=</span> sch_to_pr <span class="main">(</span>nat_to_sch <span class="var">?n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="var">?n</span> <span class="main">=</span> <span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_sch_srj<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 S4 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="var">?n</span> <span class="main">=</span> sch_to_pr <span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S2 S5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="var">?n</span> <span class="main">=</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> nat_to_pr <span class="var">?n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">..</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-nat_to_pr_at_0"><span class="command">lemma</span></span> nat_to_pr_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="main">0</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_def<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">index_of_pr</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">index_of_pr</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">=</span> nat_to_pr <span class="bound">n</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">theorem</span></span> index_of_pr_is_real<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec1 <span class="main">⟹</span> nat_to_pr <span class="main">(</span>index_of_pr <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">n</span><span class="main">.</span> <span class="free">f</span> <span class="main">=</span> nat_to_pr <span class="bound">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_pr_srj<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> nat_to_pr <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">n</span><span class="main">.</span> <span class="free">f</span> <span class="main">=</span> nat_to_pr <span class="bound">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> someI_ex<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_pr_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">comp_by_index</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">comp_by_index</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">n1</span> <span class="bound">n2</span><span class="main">.</span> c_pair <span class="numeral">4</span> <span class="main">(</span>c_pair <span class="bound">n1</span> <span class="bound">n2</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">pair_by_index</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">pair_by_index</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">n1</span> <span class="bound">n2</span><span class="main">.</span> c_pair <span class="numeral">5</span> <span class="main">(</span>c_pair <span class="bound">n1</span> <span class="bound">n2</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">rec_by_index</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">rec_by_index</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">n1</span> <span class="bound">n2</span><span class="main">.</span> c_pair <span class="numeral">6</span> <span class="main">(</span>c_pair <span class="bound">n1</span> <span class="bound">n2</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecFun2-comp_by_index_is_pr"><span class="command">lemma</span></span> comp_by_index_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"comp_by_index <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> comp_by_index_def
  <span class="keyword1"><span class="command">using</span></span> const_is_pr_2 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="numeral">4</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>

<span class="keyword1" id="PRecFun2-comp_by_index_inj"><span class="command">lemma</span></span> comp_by_index_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"comp_by_index <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> comp_by_index <span class="free">x2</span> <span class="free">y2</span> <span class="main">⟹</span> <span class="free">x1</span><span class="main">=</span><span class="free">x2</span> <span class="main">∧</span> <span class="free">y1</span><span class="main">=</span><span class="free">y2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"comp_by_index <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> comp_by_index <span class="free">x2</span> <span class="free">y2</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="numeral">4</span> <span class="main">(</span>c_pair <span class="free">x1</span> <span class="free">y1</span><span class="main">)</span> <span class="main">=</span> c_pair <span class="numeral">4</span> <span class="main">(</span>c_pair <span class="free">x2</span> <span class="free">y2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> comp_by_index_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> c_pair <span class="free">x2</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_inj2<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_inj<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-comp_by_index_inj1"><span class="command">lemma</span></span> comp_by_index_inj1<span class="main">:</span> <span class="quoted"><span class="quoted">"comp_by_index <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> comp_by_index <span class="free">x2</span> <span class="free">y2</span> <span class="main">⟹</span> <span class="free">x1</span> <span class="main">=</span> <span class="free">x2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">frule</span> comp_by_index_inj<span class="main"><span class="keyword3">,</span></span> <span class="operator">drule</span> conjunct1<span class="main">)</span>

<span class="keyword1" id="PRecFun2-comp_by_index_inj2"><span class="command">lemma</span></span> comp_by_index_inj2<span class="main">:</span> <span class="quoted"><span class="quoted">"comp_by_index <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> comp_by_index <span class="free">x2</span> <span class="free">y2</span> <span class="main">⟹</span> <span class="free">y1</span> <span class="main">=</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">frule</span> comp_by_index_inj<span class="main"><span class="keyword3">,</span></span> <span class="operator">drule</span> conjunct2<span class="main">)</span>

<span class="keyword1" id="PRecFun2-comp_by_index_main"><span class="command">lemma</span></span> comp_by_index_main<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="main">(</span>comp_by_index <span class="free">n1</span> <span class="free">n2</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span>nat_to_pr <span class="free">n1</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span>nat_to_pr <span class="free">n2</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> comp_by_index_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> nat_to_pr_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_srj_3_1<span class="main">)</span>

<span class="keyword1" id="PRecFun2-pair_by_index_is_pr"><span class="command">lemma</span></span> pair_by_index_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"pair_by_index <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> pair_by_index_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">insert</span> const_is_pr_2 <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?n</span><span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main"><span class="main">(</span></span></span><span class="numeral"><span class="numeral"><span class="numeral">5</span></span></span><span class="main"><span class="main"><span class="main">::</span></span></span>nat<span class="main"><span class="main"><span class="main">)</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">prec</span><span class="main">)</span>

<span class="keyword1" id="PRecFun2-pair_by_index_inj"><span class="command">lemma</span></span> pair_by_index_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"pair_by_index <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> pair_by_index <span class="free">x2</span> <span class="free">y2</span> <span class="main">⟹</span> <span class="free">x1</span><span class="main">=</span><span class="free">x2</span> <span class="main">∧</span> <span class="free">y1</span><span class="main">=</span><span class="free">y2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"pair_by_index <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> pair_by_index <span class="free">x2</span> <span class="free">y2</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="numeral">5</span> <span class="main">(</span>c_pair <span class="free">x1</span> <span class="free">y1</span><span class="main">)</span> <span class="main">=</span> c_pair <span class="numeral">5</span> <span class="main">(</span>c_pair <span class="free">x2</span> <span class="free">y2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> pair_by_index_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> c_pair <span class="free">x2</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_inj2<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_inj<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-pair_by_index_inj1"><span class="command">lemma</span></span> pair_by_index_inj1<span class="main">:</span> <span class="quoted"><span class="quoted">"pair_by_index <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> pair_by_index <span class="free">x2</span> <span class="free">y2</span> <span class="main">⟹</span> <span class="free">x1</span> <span class="main">=</span> <span class="free">x2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">frule</span> pair_by_index_inj<span class="main"><span class="keyword3">,</span></span> <span class="operator">drule</span> conjunct1<span class="main">)</span>

<span class="keyword1" id="PRecFun2-pair_by_index_inj2"><span class="command">lemma</span></span> pair_by_index_inj2<span class="main">:</span> <span class="quoted"><span class="quoted">"pair_by_index <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> pair_by_index <span class="free">x2</span> <span class="free">y2</span> <span class="main">⟹</span> <span class="free">y1</span> <span class="main">=</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">frule</span> pair_by_index_inj<span class="main"><span class="keyword3">,</span></span> <span class="operator">drule</span> conjunct2<span class="main">)</span>

<span class="keyword1" id="PRecFun2-pair_by_index_main"><span class="command">lemma</span></span> pair_by_index_main<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="main">(</span>pair_by_index <span class="free">n1</span> <span class="free">n2</span><span class="main">)</span> <span class="main">=</span> c_f_pair <span class="main">(</span>nat_to_pr <span class="free">n1</span><span class="main">)</span> <span class="main">(</span>nat_to_pr <span class="free">n2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> pair_by_index_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> nat_to_pr_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_srj_4_1<span class="main">)</span>

<span class="keyword1" id="PRecFun2-nat_to_sch_of_pair_by_index"><span class="command">lemma</span></span> nat_to_sch_of_pair_by_index <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="main">(</span>pair_by_index <span class="free">n1</span> <span class="free">n2</span><span class="main">)</span> <span class="main">=</span> Pair_op <span class="main">(</span>nat_to_sch <span class="free">n1</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="free">n2</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pair_by_index_def loc_srj_4_1<span class="main">)</span>

<span class="keyword1" id="PRecFun2-rec_by_index_is_pr"><span class="command">lemma</span></span> rec_by_index_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"rec_by_index <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> rec_by_index_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">insert</span> const_is_pr_2 <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?n</span><span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main"><span class="main">(</span></span></span><span class="numeral"><span class="numeral"><span class="numeral">6</span></span></span><span class="main"><span class="main"><span class="main">::</span></span></span>nat<span class="main"><span class="main"><span class="main">)</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">prec</span><span class="main">)</span>

<span class="keyword1" id="PRecFun2-rec_by_index_inj"><span class="command">lemma</span></span> rec_by_index_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"rec_by_index <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> rec_by_index <span class="free">x2</span> <span class="free">y2</span> <span class="main">⟹</span> <span class="free">x1</span><span class="main">=</span><span class="free">x2</span> <span class="main">∧</span> <span class="free">y1</span><span class="main">=</span><span class="free">y2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"rec_by_index <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> rec_by_index <span class="free">x2</span> <span class="free">y2</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="numeral">6</span> <span class="main">(</span>c_pair <span class="free">x1</span> <span class="free">y1</span><span class="main">)</span> <span class="main">=</span> c_pair <span class="numeral">6</span> <span class="main">(</span>c_pair <span class="free">x2</span> <span class="free">y2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> rec_by_index_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> c_pair <span class="free">x2</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_inj2<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_inj<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-rec_by_index_inj1"><span class="command">lemma</span></span> rec_by_index_inj1<span class="main">:</span> <span class="quoted"><span class="quoted">"rec_by_index <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> rec_by_index <span class="free">x2</span> <span class="free">y2</span> <span class="main">⟹</span> <span class="free">x1</span> <span class="main">=</span> <span class="free">x2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">frule</span> rec_by_index_inj<span class="main"><span class="keyword3">,</span></span> <span class="operator">drule</span> conjunct1<span class="main">)</span>

<span class="keyword1" id="PRecFun2-rec_by_index_inj2"><span class="command">lemma</span></span> rec_by_index_inj2<span class="main">:</span> <span class="quoted"><span class="quoted">"rec_by_index <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> rec_by_index <span class="free">x2</span> <span class="free">y2</span> <span class="main">⟹</span> <span class="free">y1</span> <span class="main">=</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">frule</span> rec_by_index_inj<span class="main"><span class="keyword3">,</span></span> <span class="operator">drule</span> conjunct2<span class="main">)</span>

<span class="keyword1" id="PRecFun2-rec_by_index_main"><span class="command">lemma</span></span> rec_by_index_main<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="main">(</span>rec_by_index <span class="free">n1</span> <span class="free">n2</span><span class="main">)</span> <span class="main">=</span> UnaryRecOp <span class="main">(</span>nat_to_pr <span class="free">n1</span><span class="main">)</span> <span class="main">(</span>nat_to_pr <span class="free">n2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> rec_by_index_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> nat_to_pr_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_srj_5_1<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹s-1-1 theorem for primitive recursive functions of one variable›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">index_of_const</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">index_of_const</span> <span class="main">=</span> PrimRecOp1 <span class="main">0</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> c_pair <span class="numeral">4</span> <span class="main">(</span>c_pair <span class="numeral">2</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecFun2-index_of_const_is_pr"><span class="command">lemma</span></span> index_of_const_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"index_of_const <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> c_pair <span class="main">(</span><span class="numeral">4</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> const_is_pr_2 <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?n</span><span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main"><span class="main">(</span></span></span><span class="numeral"><span class="numeral"><span class="numeral">4</span></span></span><span class="main"><span class="main"><span class="main">::</span></span></span>nat<span class="main"><span class="main"><span class="main">)</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">prec</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_const_def pr_rec1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-index_of_const_at_0"><span class="command">lemma</span></span> index_of_const_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"index_of_const <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_const_def<span class="main">)</span>

<span class="keyword1" id="PRecFun2-index_of_const_at_suc"><span class="command">lemma</span></span> index_of_const_at_suc<span class="main">:</span> <span class="quoted"><span class="quoted">"index_of_const <span class="main">(</span>Suc <span class="free">u</span><span class="main">)</span> <span class="main">=</span> c_pair <span class="numeral">4</span> <span class="main">(</span>c_pair <span class="numeral">2</span> <span class="main">(</span>index_of_const <span class="free">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> index_of_const_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">induct</span> <span class="quoted"><span class="free">u</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="PRecFun2-index_of_const_main"><span class="command">lemma</span></span> index_of_const_main<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="main">(</span>index_of_const <span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free">n</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="free">n</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_const_at_0 nat_to_pr_at_0<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="skolem">n</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_const_at_suc nat_to_sch_at_2 nat_to_pr_def loc_srj_3_1<span class="main">)</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-index_of_const_lm_1"><span class="command">lemma</span></span> index_of_const_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat_to_pr <span class="main">(</span>index_of_const <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span> <span class="main">=</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_const_main<span class="main">)</span>

<span class="keyword1" id="PRecFun2-index_of_const_inj"><span class="command">lemma</span></span> index_of_const_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"index_of_const <span class="free">n1</span> <span class="main">=</span> index_of_const <span class="free">n2</span> <span class="main">⟹</span> <span class="free">n1</span> <span class="main">=</span> <span class="free">n2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"index_of_const <span class="free">n1</span> <span class="main">=</span> index_of_const <span class="free">n2</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat_to_pr <span class="main">(</span>index_of_const <span class="free">n1</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span>  <span class="main">=</span> <span class="main">(</span>nat_to_pr <span class="main">(</span>index_of_const <span class="free">n2</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_const_lm_1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">index_of_zero</span> <span class="main">=</span> sch_to_nat Base_zero"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">index_of_suc</span> <span class="main">=</span> sch_to_nat Base_suc"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">index_of_c_fst</span> <span class="main">=</span> sch_to_nat Base_fst"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">index_of_c_snd</span> <span class="main">=</span> sch_to_nat Base_snd"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">index_of_id</span> <span class="main">=</span> pair_by_index index_of_c_fst index_of_c_snd"</span></span>

<span class="keyword1" id="PRecFun2-index_of_zero_main"><span class="command">lemma</span></span> index_of_zero_main<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr index_of_zero <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_zero_def nat_to_pr_def<span class="main">)</span>

<span class="keyword1" id="PRecFun2-index_of_suc_main"><span class="command">lemma</span></span> index_of_suc_main<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr index_of_suc <span class="main">=</span> Suc"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_suc_def nat_to_pr_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">insert</span> loc_srj_0<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="PRecFun2-index_of_c_fst_main"><span class="command">lemma</span></span> index_of_c_fst_main<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr index_of_c_fst <span class="main">=</span> c_fst"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_c_fst_def nat_to_pr_def loc_srj_1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch index_of_c_fst <span class="main">=</span> Base_fst"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> index_of_c_fst_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> nat_to_sch_srj<span class="main">)</span>

<span class="keyword1" id="PRecFun2-index_of_c_snd_main"><span class="command">lemma</span></span> index_of_c_snd_main<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr index_of_c_snd <span class="main">=</span> c_snd"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_c_snd_def nat_to_pr_def loc_srj_2<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch index_of_c_snd <span class="main">=</span> Base_snd"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> index_of_c_snd_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> nat_to_sch_srj<span class="main">)</span>

<span class="keyword1" id="PRecFun2-index_of_id_main"><span class="command">lemma</span></span> index_of_id_main<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr index_of_id <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_id_def nat_to_pr_def c_f_pair_def<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">index_of_c_pair_n</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">index_of_c_pair_n</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> pair_by_index <span class="main">(</span>index_of_const <span class="bound">n</span><span class="main">)</span> index_of_id<span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecFun2-index_of_c_pair_n_is_pr"><span class="command">lemma</span></span> index_of_c_pair_n_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"index_of_c_pair_n <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> index_of_id<span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> const_is_pr<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> pair_by_index_is_pr index_of_const_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> pair_by_index <span class="main">(</span>index_of_const <span class="bound">n</span><span class="main">)</span> index_of_id<span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">fold</span> index_of_c_pair_n_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-index_of_c_pair_n_main"><span class="command">lemma</span></span> index_of_c_pair_n_main<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="main">(</span>index_of_c_pair_n <span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> c_pair <span class="free">n</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="main">(</span>index_of_c_pair_n <span class="free">n</span><span class="main">)</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>pair_by_index <span class="main">(</span>index_of_const <span class="free">n</span><span class="main">)</span> index_of_id<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_c_pair_n_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> c_f_pair <span class="main">(</span>nat_to_pr <span class="main">(</span>index_of_const <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>nat_to_pr index_of_id<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pair_by_index_main<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> c_f_pair <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free">n</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_const_main index_of_id_main<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_f_pair_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-index_of_c_pair_n_inj"><span class="command">lemma</span></span> index_of_c_pair_n_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"index_of_c_pair_n <span class="free">x1</span> <span class="main">=</span> index_of_c_pair_n <span class="free">x2</span> <span class="main">⟹</span> <span class="free">x1</span><span class="main">=</span><span class="free">x2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"index_of_c_pair_n <span class="free">x1</span> <span class="main">=</span> index_of_c_pair_n <span class="free">x2</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"pair_by_index <span class="main">(</span>index_of_const <span class="free">x1</span><span class="main">)</span> index_of_id <span class="main">=</span> pair_by_index <span class="main">(</span>index_of_const <span class="free">x2</span><span class="main">)</span> index_of_id"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> index_of_c_pair_n_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"index_of_const <span class="free">x1</span> <span class="main">=</span> index_of_const <span class="free">x2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pair_by_index_inj1<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> index_of_const_inj<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">s1_1</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">s1_1</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span> <span class="bound">x</span><span class="main">.</span> comp_by_index <span class="bound">n</span> <span class="main">(</span>index_of_c_pair_n <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecFun2-s1_1_is_pr"><span class="command">lemma</span></span> s1_1_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"s1_1 <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> s1_1_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">insert</span> comp_by_index_is_pr index_of_c_pair_n_is_pr<span class="main"><span class="keyword3">,</span></span> <span class="operator">prec</span><span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> s1_1_th<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span>nat_to_pr <span class="free">n</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>s1_1 <span class="free">n</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="main">(</span>s1_1 <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>comp_by_index <span class="free">n</span> <span class="main">(</span>index_of_c_pair_n <span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> s1_1_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span>nat_to_pr <span class="free">n</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span>nat_to_pr <span class="main">(</span>index_of_c_pair_n <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_by_index_main<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span>nat_to_pr <span class="free">n</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> c_pair <span class="free">x</span> <span class="bound">u</span><span class="main">)</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_c_pair_n_main<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-s1_1_inj"><span class="command">lemma</span></span> s1_1_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"s1_1 <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> s1_1 <span class="free">x2</span> <span class="free">y2</span> <span class="main">⟹</span> <span class="free">x1</span><span class="main">=</span><span class="free">x2</span> <span class="main">∧</span> <span class="free">y1</span><span class="main">=</span><span class="free">y2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"s1_1 <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> s1_1 <span class="free">x2</span> <span class="free">y2</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"comp_by_index <span class="free">x1</span> <span class="main">(</span>index_of_c_pair_n <span class="free">y1</span><span class="main">)</span> <span class="main">=</span> comp_by_index <span class="free">x2</span> <span class="main">(</span>index_of_c_pair_n <span class="free">y2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> s1_1_def<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x1</span><span class="main">=</span><span class="free">x2</span> <span class="main">∧</span> index_of_c_pair_n <span class="free">y1</span> <span class="main">=</span> index_of_c_pair_n <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> comp_by_index_inj<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x1</span><span class="main">=</span><span class="free">x2</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"index_of_c_pair_n <span class="free">y1</span> <span class="main">=</span> index_of_c_pair_n <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">y1</span> <span class="main">=</span> <span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> index_of_c_pair_n_inj<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">..</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-s1_1_inj1"><span class="command">lemma</span></span> s1_1_inj1<span class="main">:</span> <span class="quoted"><span class="quoted">"s1_1 <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> s1_1 <span class="free">x2</span> <span class="free">y2</span> <span class="main">⟹</span> <span class="free">x1</span><span class="main">=</span><span class="free">x2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">frule</span> s1_1_inj<span class="main"><span class="keyword3">,</span></span> <span class="operator">drule</span> conjunct1<span class="main">)</span>

<span class="keyword1" id="PRecFun2-s1_1_inj2"><span class="command">lemma</span></span> s1_1_inj2<span class="main">:</span> <span class="quoted"><span class="quoted">"s1_1 <span class="free">x1</span> <span class="free">y1</span> <span class="main">=</span> s1_1 <span class="free">x2</span> <span class="free">y2</span> <span class="main">⟹</span> <span class="free">y1</span><span class="main">=</span><span class="free">y2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">frule</span> s1_1_inj<span class="main"><span class="keyword3">,</span></span> <span class="operator">drule</span> conjunct2<span class="main">)</span>

<span class="keyword1"><span class="command">primrec</span></span>
  <span class="entity">pr_index_enumerator</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">pr_index_enumerator</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">0</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">pr_index_enumerator</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">(</span>Suc <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span> <span class="main">=</span> comp_by_index index_of_id <span class="main">(</span><span class="free">pr_index_enumerator</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">theorem</span></span> pr_index_enumerator_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="quoted">nat</span>
  <span class="keyword1"><span class="command">have</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> g_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> pr_id1_1<span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="skolem">c</span> <span class="main">=</span> comp_by_index index_of_id <span class="skolem">b</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="skolem">c</span> <span class="main">::</span> <span class="quoted">nat</span>
  <span class="keyword1"><span class="command">from</span></span> comp_by_index_is_pr <span class="keyword1"><span class="command">have</span></span> h_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> h_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"pr_index_enumerator"</span></span>
  <span class="keyword1"><span class="command">from</span></span> g_def <span class="keyword1"><span class="command">have</span></span> f_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="var">?f</span> <span class="bound">x</span> <span class="main">0</span> <span class="main">=</span> <span class="skolem">g</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> h_def <span class="keyword1"><span class="command">have</span></span> f_at_Suc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="var">?f</span> <span class="bound">x</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">h</span> <span class="bound">x</span> <span class="main">(</span><span class="var">?f</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="bound">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> g_is_pr h_is_pr f_at_0 f_at_Suc <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_rec_last_scheme<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-pr_index_enumerator_increase1"><span class="command">lemma</span></span> pr_index_enumerator_increase1<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="free">n</span> <span class="free">m</span> <span class="main">&lt;</span> pr_index_enumerator <span class="main">(</span><span class="free">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="free">m</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">m</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="free">n</span> <span class="main">0</span> <span class="main">&lt;</span> pr_index_enumerator <span class="main">(</span><span class="free">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">na</span> <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="free">n</span> <span class="skolem">na</span> <span class="main">&lt;</span> pr_index_enumerator <span class="main">(</span><span class="free">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="skolem">na</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="free">n</span> <span class="main">(</span>Suc <span class="skolem">na</span><span class="main">)</span> <span class="main">&lt;</span> pr_index_enumerator <span class="main">(</span><span class="free">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">(</span>Suc <span class="skolem">na</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?a</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="free">n</span> <span class="skolem">na</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?b</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="main">(</span><span class="free">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="skolem">na</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="free">n</span> <span class="main">(</span>Suc <span class="skolem">na</span><span class="main">)</span> <span class="main">=</span> comp_by_index index_of_id <span class="var">?a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="main">(</span><span class="free">n</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">(</span>Suc <span class="skolem">na</span><span class="main">)</span> <span class="main">=</span> comp_by_index index_of_id <span class="var">?b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair index_of_id <span class="var">?a</span> <span class="main">&lt;</span> c_pair index_of_id <span class="var">?b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_strict_mono2<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="numeral">4</span> <span class="main">(</span>c_pair index_of_id <span class="var">?a</span><span class="main">)</span> <span class="main">&lt;</span> c_pair <span class="numeral">4</span> <span class="main">(</span>c_pair index_of_id <span class="var">?b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_strict_mono2<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"comp_by_index index_of_id <span class="var">?a</span> <span class="main">&lt;</span> c_pair <span class="numeral">4</span> <span class="main">(</span>c_pair index_of_id <span class="var">?b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_by_index_def<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"comp_by_index index_of_id <span class="var">?a</span> <span class="main">&lt;</span> comp_by_index index_of_id <span class="var">?b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_by_index_def<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> S1 L1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-pr_index_enumerator_increase2"><span class="command">lemma</span></span> pr_index_enumerator_increase2<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="free">n</span> <span class="free">m</span> <span class="main">&lt;</span> pr_index_enumerator <span class="free">n</span> <span class="main">(</span><span class="free">m</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?a</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="free">n</span> <span class="free">m</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="free">n</span> <span class="main">(</span><span class="free">m</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> comp_by_index index_of_id <span class="var">?a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"comp_by_index index_of_id <span class="var">?a</span> <span class="main">=</span> c_pair <span class="numeral">4</span> <span class="main">(</span>c_pair index_of_id <span class="var">?a</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_by_index_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="numeral">4</span> <span class="main">+</span> c_pair index_of_id <span class="var">?a</span> <span class="main">≤</span> c_pair <span class="numeral">4</span> <span class="main">(</span>c_pair index_of_id <span class="var">?a</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sum_le_c_pair<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair index_of_id <span class="var">?a</span> <span class="main">&lt;</span> c_pair <span class="numeral">4</span> <span class="main">(</span>c_pair index_of_id <span class="var">?a</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?a</span> <span class="main">≤</span> c_pair index_of_id <span class="var">?a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> arg2_le_c_pair<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S4 S5 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?a</span> <span class="main">&lt;</span> c_pair <span class="numeral">4</span> <span class="main">(</span>c_pair index_of_id <span class="var">?a</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-f_inc_mono"><span class="command">lemma</span></span> f_inc_mono<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span><span class="main">::</span>nat<span class="main">⇒</span>nat<span class="main">)</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">f</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">∀</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">(</span><span class="bound">y</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">&lt;</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">f</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">f</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">" <span class="skolem">x</span> <span class="main">&lt;</span> <span class="skolem">y</span> <span class="main">⟶</span> <span class="free">f</span> <span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">f</span> <span class="skolem">y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">&lt;</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> <span class="free">f</span> <span class="bound">u</span> <span class="main">&lt;</span> <span class="free">f</span> <span class="main">(</span><span class="bound">u</span> <span class="main">+</span> <span class="main">(</span><span class="bound">v</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span> <span class="skolem">v</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="skolem">u</span> <span class="main">&lt;</span> <span class="free">f</span> <span class="main">(</span><span class="skolem">u</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">v</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">v</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> A <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="skolem">u</span> <span class="main">&lt;</span> <span class="free">f</span> <span class="main">(</span><span class="skolem">u</span> <span class="main">+</span> <span class="main">(</span><span class="main">0</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">v</span> <span class="skolem">n</span>
        <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="skolem">u</span> <span class="main">&lt;</span> <span class="free">f</span> <span class="main">(</span><span class="skolem">u</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">(</span><span class="skolem">u</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">f</span> <span class="main">(</span><span class="skolem">u</span> <span class="main">+</span> <span class="main">(</span>Suc <span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> A2 S1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">" <span class="free">f</span> <span class="skolem">u</span> <span class="main">&lt;</span> <span class="free">f</span> <span class="main">(</span><span class="skolem">u</span> <span class="main">+</span> <span class="main">(</span>Suc <span class="skolem">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> less_trans<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?v</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span> <span class="main">-</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> <span class="skolem">x</span> <span class="main">+</span> <span class="main">(</span><span class="var">?v</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">f</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">+</span> <span class="main">(</span><span class="var">?v</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> L1<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">f</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-pr_index_enumerator_mono1"><span class="command">lemma</span></span> pr_index_enumerator_mono1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n1</span> <span class="main">&lt;</span> <span class="free">n2</span> <span class="main">⟹</span> pr_index_enumerator <span class="free">n1</span> <span class="free">m</span> <span class="main">&lt;</span> pr_index_enumerator <span class="free">n2</span> <span class="free">m</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n1</span> <span class="main">&lt;</span> <span class="free">n2</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="main">=</span> pr_index_enumerator <span class="skolem">x</span> <span class="free">m</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">have</span></span> f_inc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">f</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="main">&lt;</span> <span class="skolem">f</span> <span class="main">(</span><span class="skolem">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> f_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> pr_index_enumerator_increase1<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> f_inc <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">&lt;</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="skolem">f</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">f</span> <span class="bound">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> f_inc_mono<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A f_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-pr_index_enumerator_mono2"><span class="command">lemma</span></span> pr_index_enumerator_mono2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m1</span> <span class="main">&lt;</span> <span class="free">m2</span> <span class="main">⟹</span> pr_index_enumerator <span class="free">n</span> <span class="free">m1</span> <span class="main">&lt;</span> pr_index_enumerator <span class="free">n</span> <span class="free">m2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m1</span> <span class="main">&lt;</span> <span class="free">m2</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="main">=</span> pr_index_enumerator <span class="free">n</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">have</span></span> f_inc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">f</span> <span class="main">(</span><span class="bound">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="main">&lt;</span> <span class="skolem">f</span> <span class="main">(</span><span class="skolem">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> f_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> pr_index_enumerator_increase2<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> f_inc <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">&lt;</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="skolem">f</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">f</span> <span class="bound">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> f_inc_mono<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A f_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFun2-f_mono_inj"><span class="command">lemma</span></span> f_mono_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">(</span><span class="bound">y</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">&lt;</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="main">(</span><span class="free">f</span><span class="main">::</span>nat<span class="main">⇒</span>nat<span class="main">)</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">f</span> <span class="bound">y</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">∀</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">(</span><span class="bound">y</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">f</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="free">f</span> <span class="bound">y</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">f</span> <span class="skolem">y</span> <span class="main">⟶</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">f</span> <span class="skolem">y</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≠</span> <span class="skolem">y</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
        <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">&lt;</span> <span class="skolem">y</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> A A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">f</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">x</span> <span class="main">&lt;</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">&lt;</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> A A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="skolem">y</span> <span class="main">&lt;</span> <span class="free">f</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> pr_index_enumerator_inj1<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="free">n1</span> <span class="free">m</span> <span class="main">=</span> pr_index_enumerator <span class="free">n2</span> <span class="free">m</span> <span class="main">⟹</span> <span class="free">n1</span> <span class="main">=</span> <span class="free">n2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="free">n1</span> <span class="free">m</span> <span class="main">=</span> pr_index_enumerator <span class="free">n2</span> <span class="free">m</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="main">=</span> pr_index_enumerator <span class="skolem">x</span> <span class="free">m</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">have</span></span> f_mono<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">&lt;</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="skolem">f</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">f</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">&lt;</span> <span class="skolem">y</span> <span class="main">⟶</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">&lt;</span> <span class="skolem">f</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> f_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_index_enumerator_mono1<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> f_mono <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="skolem">f</span> <span class="bound">x</span> <span class="main">=</span> <span class="skolem">f</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> f_mono_inj<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A f_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> pr_index_enumerator_inj2<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="free">n</span> <span class="free">m1</span> <span class="main">=</span> pr_index_enumerator <span class="free">n</span> <span class="free">m2</span> <span class="main">⟹</span> <span class="free">m1</span> <span class="main">=</span> <span class="free">m2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="free">n</span> <span class="free">m1</span> <span class="main">=</span> pr_index_enumerator <span class="free">n</span> <span class="free">m2</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="main">=</span> pr_index_enumerator <span class="free">n</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">have</span></span> f_mono<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">&lt;</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="skolem">f</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="skolem">f</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">&lt;</span> <span class="skolem">y</span> <span class="main">⟶</span> <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">&lt;</span> <span class="skolem">f</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> f_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_index_enumerator_mono2<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> f_mono <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="skolem">f</span> <span class="bound">x</span> <span class="main">=</span> <span class="skolem">f</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> f_mono_inj<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A f_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> pr_index_enumerator_main<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="free">n</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>pr_index_enumerator <span class="free">n</span> <span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">m</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="free">n</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>pr_index_enumerator <span class="free">n</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">na</span> <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="free">n</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>pr_index_enumerator <span class="free">n</span> <span class="skolem">na</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="free">n</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>pr_index_enumerator <span class="free">n</span> <span class="main">(</span>Suc <span class="skolem">na</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?a</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="free">n</span> <span class="skolem">na</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_index_enumerator <span class="free">n</span> <span class="main">(</span>Suc <span class="skolem">na</span><span class="main">)</span> <span class="main">=</span> comp_by_index index_of_id <span class="var">?a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="main">(</span>comp_by_index index_of_id <span class="var">?a</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span>nat_to_pr index_of_id<span class="main">)</span> <span class="main">(</span>nat_to_pr <span class="var">?a</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> comp_by_index_main<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> index_of_id_main <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="main">(</span>comp_by_index index_of_id <span class="var">?a</span><span class="main">)</span> <span class="main">=</span> nat_to_pr <span class="var">?a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="PRecFinSet">
<div class="head">
<h1>Theory PRecFinSet</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Primitive recursive coding of finite sets
    Author:      Michael Nedzelsky &lt;MichaelNedzelsky at yandex.ru&gt;, 2008
    Maintainer:  Michael Nedzelsky &lt;MichaelNedzelsky at yandex.ru&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Finite sets›</span></span>

<span class="keyword1"><span class="command">theory</span></span> PRecFinSet
<span class="keyword2"><span class="keyword">imports</span></span> <a href="PRecFun.html">PRecFun</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  We introduce a particular mapping <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>nat_to_set›</span></span></span></span> from natural
  numbers to finite sets of natural numbers and a particular mapping
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>set_to_nat›</span></span></span></span> from finite sets of natural numbers to natural
  numbers.  See \cite{Rogers} and \cite{Soare} for more information.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_in</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_in</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">u</span><span class="main">.</span> <span class="main">(</span><span class="bound">u</span> <span class="keyword1">div</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">^</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">2</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecFinSet-c_in_is_pr"><span class="command">lemma</span></span> c_in_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"c_in <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> mod_is_pr power_is_pr div_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">u</span><span class="main">.</span> <span class="main">(</span><span class="bound">u</span> <span class="keyword1">div</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">^</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">with</span></span> c_in_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">nat_to_set</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">nat_to_set</span> <span class="free"><span class="bound"><span class="entity">u</span></span></span> <span class="main">≡</span> <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="numeral">2</span><span class="main">^</span><span class="bound">x</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">u</span></span></span> <span class="main">∧</span> c_in <span class="bound">x</span> <span class="free"><span class="bound"><span class="entity">u</span></span></span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>"</span></span>

<span class="keyword1" id="PRecFinSet-c_in_upper_bound"><span class="command">lemma</span></span> c_in_upper_bound<span class="main">:</span> <span class="quoted"><span class="quoted">"c_in <span class="free">x</span> <span class="free">u</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⟹</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_in <span class="free">x</span> <span class="free">u</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">u</span> <span class="keyword1">div</span> <span class="main">(</span><span class="numeral">2</span><span class="main">^</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> c_in_def<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="keyword1">div</span> <span class="main">(</span><span class="numeral">2</span><span class="main">^</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">u</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="keyword1">div</span> <span class="main">(</span><span class="numeral">2</span><span class="main">^</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> div_less<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-nat_to_set_upper_bound"><span class="command">lemma</span></span> nat_to_set_upper_bound<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> nat_to_set <span class="free">u</span> <span class="main">⟹</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_set_def<span class="main">)</span>

<span class="keyword1" id="PRecFinSet-x_lt_2_x"><span class="command">lemma</span></span> x_lt_2_x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">x</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1" id="PRecFinSet-nat_to_set_upper_bound1"><span class="command">lemma</span></span> nat_to_set_upper_bound1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> nat_to_set <span class="free">u</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> nat_to_set <span class="free">u</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> x_lt_2_x<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-nat_to_set_upper_bound2"><span class="command">lemma</span></span> nat_to_set_upper_bound2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="free">u</span> <span class="main">⊆</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> <span class="free">u</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> nat_to_set_upper_bound1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-nat_to_set_is_finite"><span class="command">lemma</span></span> nat_to_set_is_finite<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>nat_to_set <span class="free">u</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="free">u</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="free">u</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span> <span class="main">=</span> <span class="var">?f</span> <span class="main">`</span> <span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"finite <span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_seg_image_imp_finite<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="free">u</span> <span class="main">⊆</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="free">u</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_set_upper_bound2<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> finite_subset<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-x_in_u_eq"><span class="command">lemma</span></span> x_in_u_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">∈</span> nat_to_set <span class="free">u</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>c_in <span class="free">x</span> <span class="free">u</span> <span class="main">=</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_set_def c_in_upper_bound<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">log2</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">log2</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> Least<span class="main">(</span><span class="main">%</span><span class="bound">z</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="main">(</span><span class="bound">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecFinSet-log2_at_0"><span class="command">lemma</span></span> log2_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"log2 <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?v</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"log2 <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="var">?v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">=</span> Least<span class="main">(</span><span class="main">%</span><span class="main">(</span><span class="bound">z</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">0</span><span class="main">::</span>nat<span class="main">)</span><span class="main">&lt;</span><span class="numeral">2</span><span class="main">^</span><span class="main">(</span><span class="bound">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> log2_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">0</span><span class="main">::</span>nat<span class="main">)</span><span class="main">&lt;</span><span class="numeral">2</span><span class="main">^</span><span class="main">(</span><span class="main">0</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"Least<span class="main">(</span><span class="main">%</span><span class="main">(</span><span class="bound">z</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">0</span><span class="main">::</span>nat<span class="main">)</span><span class="main">&lt;</span><span class="numeral">2</span><span class="main">^</span><span class="main">(</span><span class="bound">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Least_le<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 S4 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S5 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-log2_at_1"><span class="command">lemma</span></span> log2_at_1<span class="main">:</span> <span class="quoted"><span class="quoted">"log2 <span class="main">1</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?v</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"log2 <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="var">?v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">=</span> Least<span class="main">(</span><span class="main">%</span><span class="main">(</span><span class="bound">z</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">&lt;</span><span class="numeral">2</span><span class="main">^</span><span class="main">(</span><span class="bound">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> log2_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">&lt;</span><span class="numeral">2</span><span class="main">^</span><span class="main">(</span><span class="main">0</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"Least<span class="main">(</span><span class="main">%</span><span class="main">(</span><span class="bound">z</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">&lt;</span><span class="numeral">2</span><span class="main">^</span><span class="main">(</span><span class="bound">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Least_le<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 S4 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S5 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-log2_le"><span class="command">lemma</span></span> log2_le<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> <span class="numeral">2</span> <span class="main">^</span> log2 <span class="free">x</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"log2 <span class="free">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"log2 <span class="free">x</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"log2 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> log2 <span class="free">x</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> S1 y_def <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"log2 <span class="free">x</span> <span class="main">=</span> <span class="skolem">y</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">&lt;</span> log2 <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span><span class="main">^</span><span class="main">(</span><span class="skolem">y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="numeral">2</span><span class="main">^</span><span class="main">(</span><span class="skolem">y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="main">(</span><span class="skolem">y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"log2 <span class="free">x</span> <span class="main">≤</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> log2_def Least_le<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> S3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">qed</span></span>
   <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-log2_gt"><span class="command">lemma</span></span> log2_gt<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="numeral">2</span> <span class="main">^</span> <span class="main">(</span>log2 <span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> x_lt_2_x<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> S1 y_def <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="main">(</span><span class="skolem">y</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">z</span><span class="main">.</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="main">(</span><span class="bound">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">(</span>Least <span class="var">?P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> LeastI<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> log2_def <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"log2 <span class="free">x</span> <span class="main">=</span> Least <span class="var">?P</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> log2_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S4 S5 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-x_div_x"><span class="command">lemma</span></span> x_div_x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>nat<span class="main">)</span> <span class="keyword1">div</span> <span class="free">x</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1" id="PRecFinSet-div_ge"><span class="command">lemma</span></span> div_ge<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">k</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">≤</span> <span class="free">m</span> <span class="keyword1">div</span> <span class="free">n</span> <span class="main">⟹</span> <span class="free">n</span><span class="main">*</span><span class="free">k</span> <span class="main">≤</span> <span class="free">m</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">≤</span> <span class="free">m</span> <span class="keyword1">div</span> <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">*</span> <span class="main">(</span><span class="free">m</span> <span class="keyword1">div</span> <span class="free">n</span><span class="main">)</span> <span class="main">+</span> <span class="free">m</span> <span class="keyword1">mod</span> <span class="free">n</span> <span class="main">=</span> <span class="free">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> mult_div_mod_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">m</span> <span class="keyword1">mod</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">*</span> <span class="main">(</span><span class="free">m</span> <span class="keyword1">div</span> <span class="free">n</span><span class="main">)</span> <span class="main">≤</span> <span class="free">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">*</span> <span class="free">k</span> <span class="main">≤</span>  <span class="free">n</span> <span class="main">*</span> <span class="main">(</span><span class="free">m</span> <span class="keyword1">div</span> <span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S4 S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> order_trans<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1" id="PRecFinSet-div_lt"><span class="command">lemma</span></span> div_lt<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">&lt;</span> <span class="free">n</span><span class="main">*</span><span class="free">k</span> <span class="main">⟹</span> <span class="free">m</span> <span class="keyword1">div</span> <span class="free">n</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">k</span><span class="main">::</span>nat<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">&lt;</span> <span class="free">n</span><span class="main">*</span><span class="free">k</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">m</span> <span class="keyword1">div</span> <span class="free">n</span> <span class="main">&lt;</span> <span class="free">k</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">≤</span> <span class="free">m</span> <span class="keyword1">div</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">*</span><span class="free">k</span> <span class="main">≤</span> <span class="free">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> div_ge<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-log2_lm1"><span class="command">lemma</span></span> log2_lm1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span> <span class="main">^</span> <span class="main">(</span>log2 <span class="free">u</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span><span class="main">^</span><span class="main">(</span>log2 <span class="free">u</span><span class="main">)</span> <span class="main">≤</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> log2_le<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="main">(</span>log2 <span class="free">u</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> log2_gt<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&lt;</span> <span class="main">(</span><span class="numeral">2</span><span class="main">^</span>log2 <span class="free">u</span><span class="main">)</span><span class="main">*</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span>log2 <span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span>log2 <span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span>log2 <span class="free">u</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span>log2 <span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span>log2 <span class="free">u</span>  <span class="main">≤</span> <span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span>log2 <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> div_le_mono<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S4 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span>log2 <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span>log2 <span class="free">u</span> <span class="main">&lt;</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> div_lt<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S6 S7 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-log2_lm2"><span class="command">lemma</span></span> log2_lm2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> c_in <span class="main">(</span>log2 <span class="free">u</span><span class="main">)</span> <span class="free">u</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span> <span class="main">^</span> <span class="main">(</span>log2 <span class="free">u</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> log2_lm1<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_in <span class="main">(</span>log2 <span class="free">u</span><span class="main">)</span> <span class="free">u</span> <span class="main">=</span> <span class="main">(</span><span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span> <span class="main">^</span> <span class="main">(</span>log2 <span class="free">u</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_in_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">1</span> <span class="keyword1">mod</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-log2_lm3"><span class="command">lemma</span></span> log2_lm3<span class="main">:</span> <span class="quoted"><span class="quoted">"log2 <span class="free">u</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> c_in <span class="free">x</span> <span class="free">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"log2 <span class="free">u</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>log2 <span class="free">u</span><span class="main">)</span><span class="main">+</span><span class="main">1</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span> <span class="main">(</span><span class="main">(</span>log2 <span class="free">u</span><span class="main">)</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> <span class="numeral">2</span><span class="main">^</span><span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> power_increasing<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&lt;</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span> <span class="main">(</span><span class="main">(</span>log2 <span class="free">u</span><span class="main">)</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> log2_gt<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 S4 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span><span class="free">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> div_less<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_in <span class="free">x</span> <span class="free">u</span> <span class="main">=</span> <span class="main">(</span><span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span><span class="free">x</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_in_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> S6 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">mod</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-log2_lm4"><span class="command">lemma</span></span> log2_lm4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_in <span class="free">x</span> <span class="free">u</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">≤</span> log2 <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_in <span class="free">x</span> <span class="free">u</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">x</span> <span class="main">≤</span> log2 <span class="free">u</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"log2 <span class="free">u</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_in <span class="free">x</span> <span class="free">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> log2_lm3<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-nat_to_set_lub"><span class="command">lemma</span></span> nat_to_set_lub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> nat_to_set <span class="free">u</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">≤</span> log2 <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> nat_to_set <span class="free">u</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_in <span class="free">x</span> <span class="free">u</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_u_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> log2_lm4<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-log2_lm5"><span class="command">lemma</span></span> log2_lm5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> log2 <span class="free">u</span> <span class="main">∈</span> nat_to_set <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_in <span class="main">(</span>log2 <span class="free">u</span><span class="main">)</span> <span class="free">u</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> log2_lm2<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_u_eq<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-pos_imp_ne"><span class="command">lemma</span></span> pos_imp_ne<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> nat_to_set <span class="free">u</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"log2 <span class="free">u</span> <span class="main">∈</span> nat_to_set <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> log2_lm5<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-empty_is_zero"><span class="command">lemma</span></span> empty_is_zero<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="free">u</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="free">u</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="free">u</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pos_imp_ne<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-log2_is_max"><span class="command">lemma</span></span> log2_is_max<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> log2 <span class="free">u</span> <span class="main">=</span> Max <span class="main">(</span>nat_to_set <span class="free">u</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"log2 <span class="free">u</span> <span class="main">∈</span> nat_to_set <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> log2_lm5<span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">max</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">max</span> <span class="main">=</span> Max <span class="main">(</span>nat_to_set <span class="free">u</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> ne<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="free">u</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pos_imp_ne<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> finite<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>nat_to_set <span class="free">u</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_set_is_finite<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> max_def finite ne <span class="keyword1"><span class="command">have</span></span> max_in<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">max</span> <span class="main">∈</span> nat_to_set <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> max_in <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_in <span class="skolem">max</span> <span class="free">u</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_u_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">max</span> <span class="main">≤</span> log2 <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> log2_lm4<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> finite ne S1 max_def <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"log2 <span class="free">u</span> <span class="main">≤</span> <span class="skolem">max</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S3 S4 max_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-zero_is_empty"><span class="command">lemma</span></span> zero_is_empty<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">0</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="main">(</span><span class="main">0</span><span class="main">::</span>nat<span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">0</span> <span class="main">⊆</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="main">0</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_set_upper_bound2<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-ne_imp_pos"><span class="command">lemma</span></span> ne_imp_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="free">u</span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="free">u</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="free">u</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> zero_is_empty<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-div_mod_lm"><span class="command">lemma</span></span> div_mod_lm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">(</span><span class="free">u</span> <span class="main">+</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">div</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="free">y</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span><span class="free">u</span> <span class="keyword1">div</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="free">y</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> y_lt_x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> n_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="var">?n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?s</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">-</span><span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> y_lt_x <span class="keyword1"><span class="command">have</span></span> s_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="var">?s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> y_lt_x <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="free">y</span> <span class="main">+</span> <span class="var">?s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="main">(</span><span class="free">y</span> <span class="main">+</span> <span class="var">?s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="main">(</span><span class="free">y</span> <span class="main">+</span><span class="var">?s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="free">y</span> <span class="main">*</span> <span class="numeral">2</span><span class="main">^</span> <span class="var">?s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> power_add<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="free">x</span> <span class="main">=</span> <span class="numeral">2</span><span class="main">^</span><span class="free">y</span> <span class="main">*</span> <span class="numeral">2</span><span class="main">^</span><span class="var">?s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">+</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="free">x</span> <span class="main">=</span> <span class="free">u</span> <span class="main">+</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="free">y</span> <span class="main">*</span> <span class="numeral">2</span><span class="main">^</span><span class="var">?s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> n_pos <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">u</span> <span class="main">+</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="free">y</span> <span class="main">*</span> <span class="numeral">2</span><span class="main">^</span><span class="var">?s</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span><span class="free">y</span> <span class="main">=</span> <span class="numeral">2</span><span class="main">^</span><span class="var">?s</span> <span class="main">+</span> <span class="main">(</span><span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span><span class="free">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S4 S5 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">u</span> <span class="main">+</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="free">x</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span><span class="free">y</span> <span class="main">=</span> <span class="numeral">2</span><span class="main">^</span><span class="var">?s</span> <span class="main">+</span> <span class="main">(</span><span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span><span class="free">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> s_pos <span class="keyword1"><span class="command">have</span></span> S8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?s</span> <span class="main">=</span> <span class="main">(</span><span class="var">?s</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="main">(</span><span class="main">(</span><span class="var">?s</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="main">(</span><span class="var">?s</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="numeral">2</span><span class="main">^</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> power_add<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S8 <span class="keyword1"><span class="command">have</span></span> S9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="var">?s</span> <span class="main">=</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="main">(</span><span class="var">?s</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S10<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span><span class="main">^</span><span class="var">?s</span> <span class="main">+</span> <span class="main">(</span><span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span><span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span><span class="free">y</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="main">(</span><span class="var">?s</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> S11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span><span class="free">y</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="main">(</span><span class="var">?s</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="numeral">2</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span><span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span><span class="free">y</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> mod_mult_self1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S6 S10 S11 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-add_power"><span class="command">lemma</span></span> add_power<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="free">x</span> <span class="main">⟹</span> nat_to_set <span class="main">(</span><span class="free">u</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">^</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> nat_to_set <span class="free">u</span> <span class="main">∪</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> log2_is_x<span class="main">:</span> <span class="quoted"><span class="quoted">"log2 <span class="main">(</span><span class="free">u</span><span class="main">+</span><span class="numeral">2</span><span class="main">^</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> log2_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> Least_equality<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span><span class="main">+</span><span class="numeral">2</span><span class="main">^</span><span class="free">x</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span>
    <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">^</span><span class="free">x</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="main">(</span><span class="skolem">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="skolem">z</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">x</span> <span class="main">≤</span> <span class="skolem">z</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">+</span><span class="main">1</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> L1 L2 <span class="keyword1"><span class="command">have</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="main">(</span><span class="skolem">z</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> power_increasing<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> subset_antisym<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">(</span><span class="free">u</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span><span class="main">)</span> <span class="main">⊆</span> nat_to_set <span class="free">u</span> <span class="main">∪</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
      <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> nat_to_set <span class="main">(</span><span class="free">u</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> nat_to_set <span class="free">u</span> <span class="main">∪</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∉</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≠</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≤</span> log2 <span class="main">(</span><span class="free">u</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_set_lub<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> log2_is_x <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword1"><span class="command">have</span></span> y_lt_x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_in <span class="skolem">y</span> <span class="main">(</span><span class="free">u</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_u_eq<span class="main">)</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">u</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">y</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> c_in_def<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> y_lt_x <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">u</span> <span class="main">+</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">div</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="skolem">y</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span><span class="free">u</span> <span class="keyword1">div</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="skolem">y</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> div_mod_lm<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">y</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_in <span class="skolem">y</span> <span class="free">u</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_in_def<span class="main">)</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> nat_to_set <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_u_eq<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="free">u</span> <span class="main">∪</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">⊆</span> nat_to_set <span class="main">(</span><span class="free">u</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
    <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> nat_to_set <span class="free">u</span> <span class="main">∪</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> nat_to_set <span class="main">(</span><span class="free">u</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">=</span><span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> log2 <span class="main">(</span><span class="free">u</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> log2_is_x<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> log2_lm5<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> y_notin<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∉</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> y_ne_x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≠</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> A1 y_notin <span class="keyword1"><span class="command">have</span></span> y_in<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> nat_to_set <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> y_lt_x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">y</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
        <span class="keyword1"><span class="command">with</span></span> y_ne_x <span class="keyword1"><span class="command">have</span></span> y_gt_x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> y_gt_x this <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="free">x</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> power_strict_increasing<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> y_in <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span><span class="main">^</span><span class="skolem">y</span> <span class="main">≤</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_set_upper_bound<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> L1 L2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="free">x</span> <span class="main">&lt;</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
        <span class="keyword1"><span class="command">with</span></span> A <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">from</span></span> y_in <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_in <span class="skolem">y</span> <span class="free">u</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_u_eq<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">u</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">y</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> c_in_def<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> y_lt_x <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">u</span> <span class="main">+</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">div</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="skolem">y</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span><span class="free">u</span> <span class="keyword1">div</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="skolem">y</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> div_mod_lm<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">u</span> <span class="main">+</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="free">x</span><span class="main">)</span><span class="keyword1">div</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">y</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_in <span class="skolem">y</span> <span class="main">(</span><span class="free">u</span> <span class="main">+</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_in_def<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> nat_to_set <span class="main">(</span><span class="free">u</span> <span class="main">+</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_u_eq<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> nat_to_set_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="free">u</span> <span class="main">=</span> nat_to_set <span class="free">v</span> <span class="main">⟹</span> <span class="free">u</span> <span class="main">=</span> <span class="free">v</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="free">u</span> <span class="main">=</span> nat_to_set <span class="free">v</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="main">(</span><span class="bound">n</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span> <span class="main">(</span><span class="bound">D</span><span class="main">::</span>nat set<span class="main">)</span><span class="main">.</span> finite <span class="bound">D</span> <span class="main">∧</span> card <span class="bound">D</span> <span class="main">≤</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> nat_to_set <span class="bound">u</span> <span class="main">=</span> <span class="bound">D</span> <span class="main">∧</span> nat_to_set <span class="bound">v</span> <span class="main">=</span> <span class="bound">D</span> <span class="main">⟶</span> <span class="bound">u</span> <span class="main">=</span> <span class="bound">v</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> P_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">D</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span> <span class="main">∧</span> card <span class="skolem">D</span> <span class="main">≤</span> <span class="main">0</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∀</span><span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> nat_to_set <span class="bound">u</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">∧</span> nat_to_set <span class="bound">v</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">⟶</span> <span class="bound">u</span> <span class="main">=</span> <span class="bound">v</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span> <span class="main">∧</span> card <span class="skolem">D</span> <span class="main">≤</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"card <span class="skolem">D</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> nat_to_set <span class="bound">u</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">∧</span> nat_to_set <span class="bound">v</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">⟶</span> <span class="bound">u</span> <span class="main">=</span> <span class="bound">v</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span> <span class="skolem">v</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">u</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">∧</span> nat_to_set <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">⟶</span> <span class="skolem">u</span> <span class="main">=</span> <span class="skolem">v</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span>
          <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">" nat_to_set <span class="skolem">u</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">∧</span> nat_to_set <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">D</span>"</span></span>
          <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">u</span> <span class="main">=</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> L1 S3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">u</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> u_z<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> empty_is_zero<span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span> L2 S3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">v</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> v_z<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> empty_is_zero<span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span> u_z v_z <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">=</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> P_at_Suc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n</span><span class="main">.</span> <span class="var">?P</span> <span class="bound">n</span> <span class="main">⟹</span> <span class="var">?P</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span>
    <span class="keyword3"><span class="command">assume</span></span> A_n<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="skolem">n</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">D</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span> <span class="main">∧</span> card <span class="skolem">D</span> <span class="main">≤</span> Suc <span class="skolem">n</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∀</span><span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> nat_to_set <span class="bound">u</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">∧</span> nat_to_set <span class="bound">v</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">⟶</span> <span class="bound">u</span> <span class="main">=</span> <span class="bound">v</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span> <span class="main">∧</span> card <span class="skolem">D</span> <span class="main">≤</span> Suc <span class="skolem">n</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"card <span class="skolem">D</span> <span class="main">≤</span> Suc <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> nat_to_set <span class="bound">u</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">∧</span> nat_to_set <span class="bound">v</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">⟶</span> <span class="bound">u</span> <span class="main">=</span> <span class="bound">v</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span> <span class="skolem">v</span>
        <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">" nat_to_set <span class="skolem">u</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">∧</span> nat_to_set <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">D</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> d_u_d<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">u</span> <span class="main">=</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> d_v_d<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">=</span> <span class="skolem">v</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
          <span class="keyword1"><span class="command">from</span></span> A3 d_u_d <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">u</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> u_z<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> empty_is_zero<span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span> A3 d_v_d <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">v</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> v_z<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> empty_is_zero<span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span> u_z v_z <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">=</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
          <span class="keyword1"><span class="command">from</span></span> A3 d_u_d <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">u</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> u_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ne_imp_pos<span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span> A3 d_v_d <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">v</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> v_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ne_imp_pos<span class="main">)</span>
          <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">=</span> Max <span class="skolem">D</span>"</span></span>
          <span class="keyword1"><span class="command">from</span></span> S1 m_def A3 <span class="keyword1"><span class="command">have</span></span> m_in<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∈</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> d_u_d m_def <span class="keyword1"><span class="command">have</span></span> m_u<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">=</span> Max <span class="main">(</span>nat_to_set <span class="skolem">u</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> d_v_d m_def <span class="keyword1"><span class="command">have</span></span> m_v<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">=</span> Max <span class="main">(</span>nat_to_set <span class="skolem">v</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> u_pos m_u log2_is_max <span class="keyword1"><span class="command">have</span></span> m_log_u<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">=</span> log2 <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> v_pos m_v log2_is_max <span class="keyword1"><span class="command">have</span></span> m_log_v<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">=</span> log2 <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">D1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D1</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">m</span><span class="main">}</span>"</span></span>
          <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">u1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u1</span> <span class="main">=</span> <span class="skolem">u</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">m</span>"</span></span>
          <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">v1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v1</span> <span class="main">=</span> <span class="skolem">v</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">m</span>"</span></span>
          <span class="keyword1"><span class="command">have</span></span> card_D1<span class="main">:</span> <span class="quoted"><span class="quoted">"card <span class="skolem">D1</span> <span class="main">≤</span> <span class="skolem">n</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
            <span class="keyword1"><span class="command">from</span></span> D1_def S1 m_in <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">D1</span> <span class="main">=</span> <span class="main">(</span>card <span class="skolem">D</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> card_Diff_singleton<span class="main">)</span>
            <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">have</span></span> u_u1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">=</span> <span class="skolem">u1</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">m</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
            <span class="keyword1"><span class="command">from</span></span> u_pos <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span> <span class="main">^</span> log2 <span class="skolem">u</span> <span class="main">≤</span> <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> log2_le<span class="main">)</span>
            <span class="keyword1"><span class="command">with</span></span> m_log_u <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span> <span class="main">^</span> <span class="skolem">m</span> <span class="main">≤</span> <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> u1_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">have</span></span> u1_d1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">u1</span> <span class="main">=</span> <span class="skolem">D1</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
            <span class="keyword1"><span class="command">from</span></span> m_log_u log2_gt <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="main">(</span><span class="skolem">m</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> u_u1 <span class="keyword1"><span class="command">have</span></span> u1_lt_2_m<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u1</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> u_u1 <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">u</span> <span class="main">=</span> nat_to_set <span class="skolem">u1</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">m</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> add_power<span class="main">)</span>
            <span class="keyword1"><span class="command">have</span></span> m_notin<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∉</span> nat_to_set <span class="skolem">u1</span>"</span></span>
            <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
              <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">m</span> <span class="main">∉</span> nat_to_set <span class="skolem">u1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∈</span> nat_to_set <span class="skolem">u1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span><span class="main">^</span><span class="skolem">m</span> <span class="main">≤</span> <span class="skolem">u1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_set_upper_bound<span class="main">)</span>
              <span class="keyword1"><span class="command">with</span></span> u1_lt_2_m <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">from</span></span> L1 m_notin <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">u1</span> <span class="main">=</span> nat_to_set <span class="skolem">u</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">m</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> d_u_d <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">u1</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">m</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> D1_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">have</span></span> v_v1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">=</span> <span class="skolem">v1</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">m</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
            <span class="keyword1"><span class="command">from</span></span> v_pos <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span> <span class="main">^</span> log2 <span class="skolem">v</span> <span class="main">≤</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> log2_le<span class="main">)</span>
            <span class="keyword1"><span class="command">with</span></span> m_log_v <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span> <span class="main">^</span> <span class="skolem">m</span> <span class="main">≤</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> v1_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">have</span></span> v1_d1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">v1</span> <span class="main">=</span> <span class="skolem">D1</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
            <span class="keyword1"><span class="command">from</span></span> m_log_v log2_gt <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="main">(</span><span class="skolem">m</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> v_v1 <span class="keyword1"><span class="command">have</span></span> v1_lt_2_m<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v1</span> <span class="main">&lt;</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> v_v1 <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">v</span> <span class="main">=</span> nat_to_set <span class="skolem">v1</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">m</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> add_power<span class="main">)</span>
            <span class="keyword1"><span class="command">have</span></span> m_notin<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∉</span> nat_to_set <span class="skolem">v1</span>"</span></span>
            <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
              <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">m</span> <span class="main">∉</span> nat_to_set <span class="skolem">v1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∈</span> nat_to_set <span class="skolem">v1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span><span class="main">^</span><span class="skolem">m</span> <span class="main">≤</span> <span class="skolem">v1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_set_upper_bound<span class="main">)</span>
              <span class="keyword1"><span class="command">with</span></span> v1_lt_2_m <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">from</span></span> L1 m_notin <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">v1</span> <span class="main">=</span> nat_to_set <span class="skolem">v</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">m</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> d_v_d <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">v1</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">m</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> D1_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">from</span></span> S1 D1_def <span class="keyword1"><span class="command">have</span></span> P1<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> card_D1 <span class="keyword1"><span class="command">have</span></span> P2<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D1</span> <span class="main">∧</span> card <span class="skolem">D1</span> <span class="main">≤</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> A_n P2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> nat_to_set <span class="bound">u</span> <span class="main">=</span> <span class="skolem">D1</span> <span class="main">∧</span> nat_to_set <span class="bound">v</span> <span class="main">=</span> <span class="skolem">D1</span> <span class="main">⟶</span> <span class="bound">u</span> <span class="main">=</span> <span class="bound">v</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> u1_d1 v1_d1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u1</span> <span class="main">=</span> <span class="skolem">v1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> u_u1 v_v1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">=</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> P_at_0 P_at_Suc <span class="keyword1"><span class="command">have</span></span> main<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n</span><span class="main">.</span> <span class="var">?P</span> <span class="bound">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat.induct<span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">D</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">=</span> nat_to_set <span class="free">u</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> D_def A <span class="keyword1"><span class="command">have</span></span> P1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="free">u</span> <span class="main">=</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> D_def A <span class="keyword1"><span class="command">have</span></span> P2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="free">v</span> <span class="main">=</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> D_def nat_to_set_is_finite <span class="keyword1"><span class="command">have</span></span> d_finite<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> card <span class="skolem">D</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> n_def d_finite <span class="keyword1"><span class="command">have</span></span> card_le<span class="main">:</span> <span class="quoted"><span class="quoted">"card <span class="skolem">D</span> <span class="main">≤</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> d_finite card_le <span class="keyword1"><span class="command">have</span></span> P3<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span> <span class="main">∧</span> card <span class="skolem">D</span> <span class="main">≤</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> main <span class="keyword1"><span class="command">have</span></span> P4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> nat_to_set <span class="bound">u</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">∧</span> nat_to_set <span class="bound">v</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">⟶</span> <span class="bound">u</span> <span class="main">=</span> <span class="bound">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> P1 P2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">=</span> <span class="free">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">set_to_nat</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat set <span class="main">=&gt;</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">set_to_nat</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">D</span><span class="main">.</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="numeral">2</span> <span class="main">^</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">D</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecFinSet-two_power_sum"><span class="command">lemma</span></span> two_power_sum<span class="main">:</span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="bound">x</span><span class="main">)</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span> Suc <span class="free">m</span><span class="main">}</span> <span class="main">=</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">^</span> Suc <span class="free">m</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">m</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="bound">x</span><span class="main">)</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span> Suc <span class="main">0</span><span class="main">}</span> <span class="main">=</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">^</span> Suc <span class="main">0</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="bound">x</span><span class="main">)</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span> Suc <span class="skolem">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">^</span> Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="bound">x</span><span class="main">)</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span> Suc <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">^</span> Suc <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="bound">x</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span> Suc <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">≤</span> Suc <span class="skolem">n</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">≤</span> Suc <span class="skolem">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> Suc <span class="skolem">n</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span> Suc <span class="skolem">n</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span> Suc <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> Suc <span class="skolem">n</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span> Suc <span class="skolem">n</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> Suc <span class="skolem">n</span><span class="main">}</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">`</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> Suc <span class="skolem">n</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> Suc <span class="skolem">n</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_seg_image_imp_finite<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">n</span> <span class="main">∉</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> Suc <span class="skolem">n</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> S5 S6 sum.insert <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"sum <span class="var">?f</span> <span class="main">(</span><span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span> Suc <span class="skolem">n</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> Suc <span class="skolem">n</span> <span class="main">+</span> sum <span class="var">?f</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span> Suc <span class="skolem">n</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="var">?f</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span> Suc <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> sum <span class="var">?f</span> <span class="main">(</span><span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span> Suc <span class="skolem">n</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span>Suc <span class="skolem">n</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> S7 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> Suc <span class="skolem">n</span> <span class="main">+</span> sum <span class="var">?f</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span> Suc <span class="skolem">n</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> Suc <span class="skolem">n</span> <span class="main">+</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> Suc <span class="skolem">n</span><span class="main">)</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">^</span> Suc <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-finite_interval"><span class="command">lemma</span></span> finite_interval<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="bound">i</span><span class="main">::</span>nat<span class="main">)</span><span class="main">&lt;</span><span class="free">m</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> <span class="free">m</span><span class="main">}</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">`</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> <span class="free">m</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_seg_image_imp_finite<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-set_to_nat_at_empty"><span class="command">lemma</span></span> set_to_nat_at_empty<span class="main">:</span> <span class="quoted"><span class="quoted">"set_to_nat <span class="main">{}</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> set_to_nat_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> sum.empty<span class="main">)</span>

<span class="keyword1" id="PRecFinSet-set_to_nat_of_interval"><span class="command">lemma</span></span> set_to_nat_of_interval<span class="main">:</span> <span class="quoted"><span class="quoted">"set_to_nat <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="bound">i</span><span class="main">::</span>nat<span class="main">)</span><span class="main">&lt;</span><span class="free">m</span><span class="main">}</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">m</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">m</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"set_to_nat <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> <span class="main">0</span><span class="main">}</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="main">0</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="bound">i</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">&lt;</span> <span class="main">0</span><span class="main">}</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> set_to_nat_at_empty <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_to_nat <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="main">0</span><span class="main">}</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"set_to_nat <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> Suc <span class="skolem">n</span><span class="main">}</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> Suc <span class="skolem">n</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> set_to_nat_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> two_power_sum<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-set_to_nat_mono"><span class="command">lemma</span></span> set_to_nat_mono<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> finite <span class="free">B</span><span class="main">;</span> <span class="free">A</span> <span class="main">⊆</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">⟹</span> set_to_nat <span class="free">A</span> <span class="main">≤</span> set_to_nat <span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> b_finite<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="free">B</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> a_le_b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"set_to_nat <span class="free">A</span> <span class="main">=</span> sum <span class="var">?f</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_to_nat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"set_to_nat <span class="free">B</span> <span class="main">=</span> sum <span class="var">?f</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> set_to_nat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span>  <span class="main">∈</span> <span class="free">B</span> <span class="main">-</span> <span class="free">A</span> <span class="main">⟹</span> <span class="main">0</span> <span class="main">≤</span> <span class="var">?f</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> b_finite a_le_b S3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="var">?f</span> <span class="free">A</span> <span class="main">≤</span> sum <span class="var">?f</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sum_mono2<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> nat_to_set_srj<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span><span class="free">D</span><span class="main">::</span>nat set<span class="main">)</span> <span class="main">⟹</span> nat_to_set <span class="main">(</span>set_to_nat <span class="free">D</span><span class="main">)</span> <span class="main">=</span> <span class="free">D</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="free">D</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="main">(</span><span class="bound">n</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span> <span class="main">(</span><span class="bound">D</span><span class="main">::</span>nat set<span class="main">)</span><span class="main">.</span> finite <span class="bound">D</span> <span class="main">∧</span> card <span class="bound">D</span> <span class="main">=</span> <span class="bound">n</span> <span class="main">⟶</span> nat_to_set <span class="main">(</span>set_to_nat <span class="bound">D</span><span class="main">)</span> <span class="main">=</span> <span class="bound">D</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> P_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">D</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span> <span class="main">∧</span> card <span class="skolem">D</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟶</span> nat_to_set <span class="main">(</span>set_to_nat <span class="skolem">D</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">D</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span> <span class="main">∧</span> card <span class="skolem">D</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"card <span class="skolem">D</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> set_to_nat_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_to_nat <span class="skolem">D</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="numeral">2</span> <span class="main">^</span> <span class="bound">x</span><span class="main">)</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> S3 sum.empty <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_to_nat <span class="skolem">D</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> zero_is_empty S3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">(</span>set_to_nat <span class="skolem">D</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> P_at_Suc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n</span><span class="main">.</span> <span class="var">?P</span> <span class="bound">n</span> <span class="main">⟹</span> <span class="var">?P</span> <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span>
    <span class="keyword3"><span class="command">assume</span></span> A_n<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="skolem">n</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">D</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span> <span class="main">∧</span> card <span class="skolem">D</span> <span class="main">=</span> Suc <span class="skolem">n</span> <span class="main">⟶</span> nat_to_set <span class="main">(</span>set_to_nat <span class="skolem">D</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">D</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span>
        <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span> <span class="main">∧</span> card <span class="skolem">D</span> <span class="main">=</span> Suc <span class="skolem">n</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"card <span class="skolem">D</span> <span class="main">=</span> Suc <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">=</span> Max <span class="skolem">D</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> D_ne<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> S1 m_def <span class="keyword1"><span class="command">have</span></span> m_in<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∈</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">D1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D1</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">m</span><span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> S1 D1_def <span class="keyword1"><span class="command">have</span></span> d1_finite<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> D1_def m_in S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">D1</span> <span class="main">=</span> card <span class="skolem">D</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> card_Diff_singleton<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword1"><span class="command">have</span></span> card_d1<span class="main">:</span> <span class="quoted"><span class="quoted">"card <span class="skolem">D1</span> <span class="main">=</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> d1_finite card_d1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D1</span> <span class="main">∧</span> card <span class="skolem">D1</span> <span class="main">=</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> A_n <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">(</span>set_to_nat <span class="skolem">D1</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">D1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">=</span> set_to_nat <span class="skolem">D</span>"</span></span>
        <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">u1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u1</span> <span class="main">=</span> set_to_nat <span class="skolem">D1</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> S1 m_in <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="main">λ</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="bound">x</span><span class="main">)</span> <span class="skolem">D</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">m</span> <span class="main">+</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="numeral">2</span> <span class="main">^</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">m</span><span class="main">}</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sum.remove<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> set_to_nat_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_to_nat <span class="skolem">D</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">m</span> <span class="main">+</span> set_to_nat <span class="main">(</span><span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">m</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> u_def u1_def D1_def <span class="keyword1"><span class="command">have</span></span> u_u1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">=</span> <span class="skolem">u1</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> S3 u1_def <span class="keyword1"><span class="command">have</span></span> d1_u1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">u1</span> <span class="main">=</span> <span class="skolem">D1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> u1_lt<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u1</span> <span class="main">&lt;</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">m</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">D1</span> <span class="main">⊆</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="skolem">m</span><span class="main">}</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
            <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">D1</span>"</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="skolem">m</span><span class="main">}</span>"</span></span>
            <span class="keyword1"><span class="command">proof</span></span>
              <span class="keyword1"><span class="command">from</span></span> A1 D1_def <span class="keyword1"><span class="command">have</span></span> L1_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">from</span></span> S1 D_ne L1_1 m_def <span class="keyword1"><span class="command">have</span></span> L1_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≤</span> <span class="skolem">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">with</span></span> A1 L1_1 D1_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≠</span> <span class="skolem">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">with</span></span> L1_2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">&lt;</span> <span class="skolem">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="skolem">m</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> finite_interval<span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span> L2 L1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_to_nat <span class="skolem">D1</span> <span class="main">≤</span> set_to_nat <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="skolem">m</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> set_to_nat_mono<span class="main">)</span>
          <span class="keyword1"><span class="command">with</span></span> u1_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u1</span> <span class="main">≤</span> set_to_nat <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="skolem">m</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> set_to_nat_of_interval <span class="keyword1"><span class="command">have</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u1</span> <span class="main">≤</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="skolem">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="skolem">m</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">^</span> <span class="skolem">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> L3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">from</span></span> u_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">(</span>set_to_nat <span class="skolem">D</span><span class="main">)</span> <span class="main">=</span> nat_to_set <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> u_u1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> nat_to_set <span class="main">(</span><span class="skolem">u1</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">m</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> u1_lt <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> nat_to_set <span class="skolem">u1</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">m</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> add_power<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> d1_u1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="skolem">D1</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">m</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> D1_def m_in <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">(</span>set_to_nat <span class="skolem">D</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> P_at_0 P_at_Suc <span class="keyword1"><span class="command">have</span></span> main<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n</span><span class="main">.</span> <span class="var">?P</span> <span class="bound">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat.induct<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A main <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> nat_to_set_srj1<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span><span class="free">D</span><span class="main">::</span>nat set<span class="main">)</span> <span class="main">⟹</span> <span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> nat_to_set <span class="bound">u</span> <span class="main">=</span> <span class="free">D</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="free">D</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">" <span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> nat_to_set <span class="bound">u</span> <span class="main">=</span> <span class="free">D</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword1"><span class="command">from</span></span> A <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">(</span>set_to_nat <span class="free">D</span><span class="main">)</span> <span class="main">=</span> <span class="free">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_set_srj<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-sum_of_pr_is_pr"><span class="command">lemma</span></span> sum_of_pr_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> PrimRec1 <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> sum <span class="free">g</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">n</span> <span class="main">=</span> sum <span class="free">g</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="skolem">n</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span>
  <span class="keyword1"><span class="command">from</span></span> f_def <span class="keyword1"><span class="command">have</span></span> f_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">=</span> <span class="free">g</span> <span class="skolem">a</span> <span class="main">+</span> <span class="skolem">b</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span> <span class="skolem">b</span>
  <span class="keyword1"><span class="command">from</span></span> g_is_pr <span class="keyword1"><span class="command">have</span></span> h_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> h_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> f_at_Suc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">f</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">h</span> <span class="bound">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">h</span> <span class="skolem">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> f_def <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> sum <span class="free">g</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> Suc <span class="skolem">y</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> Suc <span class="skolem">y</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">y</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> finite_interval<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∉</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> sum <span class="free">g</span> <span class="main">(</span><span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="bound">i</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">y</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> S3 S4 sum.insert <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="free">g</span> <span class="skolem">y</span> <span class="main">+</span> sum <span class="free">g</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="skolem">y</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> f_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="free">g</span> <span class="skolem">y</span> <span class="main">+</span> <span class="skolem">f</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> h_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="skolem">h</span> <span class="skolem">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> h_is_pr f_at_0 f_at_Suc <span class="keyword1"><span class="command">have</span></span> f_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_rec1_scheme<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> f_def <span class="main">[</span><span class="operator">abs_def</span><span class="main">]</span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-sum_of_pr_is_pr2"><span class="command">lemma</span></span> sum_of_pr_is_pr2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">∈</span> PrimRec2 <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span> <span class="bound">m</span><span class="main">.</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free">p</span> <span class="bound">x</span> <span class="bound">m</span><span class="main">)</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="bound">n</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">n</span> <span class="skolem">m</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="free">p</span> <span class="bound">x</span> <span class="skolem">m</span><span class="main">)</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="skolem">n</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">n</span> <span class="skolem">m</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">have</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> g_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> const_is_pr <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?n</span><span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="main"><span class="quoted"><span class="main"><span class="quoted"><span class="main">0</span></span></span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> f_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">f</span> <span class="main">0</span> <span class="bound">x</span> <span class="main">=</span> <span class="skolem">g</span> <span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword1"><span class="command">from</span></span> f_def g_def <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">0</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">g</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="skolem">c</span> <span class="main">=</span> <span class="free">p</span> <span class="skolem">a</span> <span class="skolem">c</span> <span class="main">+</span> <span class="skolem">b</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="skolem">c</span>
  <span class="keyword1"><span class="command">from</span></span> p_is_pr <span class="keyword1"><span class="command">have</span></span> h_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> h_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> f_at_Suc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">f</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="bound">x</span> <span class="main">=</span> <span class="skolem">h</span> <span class="bound">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">h</span> <span class="skolem">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="skolem">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> f_def <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">z</span><span class="main">.</span> <span class="free">p</span> <span class="bound">z</span> <span class="skolem">x</span><span class="main">)</span>  <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> Suc <span class="skolem">y</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> Suc <span class="skolem">y</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">y</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> finite_interval<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∉</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g1</span> <span class="skolem">z</span> <span class="main">=</span> <span class="free">p</span> <span class="skolem">z</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">z</span>
      <span class="keyword1"><span class="command">from</span></span> S1 S2 g1_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> sum <span class="skolem">g1</span> <span class="main">(</span><span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="bound">i</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">y</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> S3 S4 sum.insert <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="skolem">g1</span> <span class="skolem">y</span> <span class="main">+</span> sum <span class="skolem">g1</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span><span class="main">&lt;</span><span class="skolem">y</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> f_def g1_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="skolem">g1</span> <span class="skolem">y</span> <span class="main">+</span> <span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> h_def g1_def  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="skolem">h</span> <span class="skolem">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> g_is_pr h_is_pr f_at_0 f_at_Suc <span class="keyword1"><span class="command">have</span></span> f_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_rec_scheme<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> f_def <span class="main">[</span><span class="operator">abs_def</span><span class="main">]</span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-sum_is_pr"><span class="command">lemma</span></span> sum_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> PrimRec1 <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> sum <span class="free">g</span> <span class="main">(</span>nat_to_set <span class="bound">u</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g1</span> <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="main">(</span>c_in <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">1</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">g</span> <span class="skolem">x</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">u</span>
  <span class="keyword1"><span class="command">have</span></span> g1_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g1</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> g1_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> if_eq_is_pr2<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_in <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_in_is_pr<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">1</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> const_is_pr_2 <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?n</span><span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="main"><span class="quoted"><span class="main"><span class="quoted"><span class="main">1</span></span></span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">from</span></span> g_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">g</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> const_is_pr_2 <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?n</span><span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="main"><span class="quoted"><span class="main"><span class="quoted"><span class="main">0</span></span></span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">u</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">g1</span> <span class="bound">x</span> <span class="skolem">u</span><span class="main">)</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="bound">i</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">u</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">u</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f1</span> <span class="skolem">u</span> <span class="skolem">v</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">g1</span> <span class="bound">x</span> <span class="skolem">v</span><span class="main">)</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="bound">i</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">u</span><span class="main">}</span>"</span></span>  <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">u</span> <span class="skolem">v</span>
  <span class="keyword1"><span class="command">from</span></span> g1_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="main">(</span><span class="bound">u</span><span class="main">::</span>nat<span class="main">)</span> <span class="bound">v</span><span class="main">.</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">g1</span> <span class="bound">x</span> <span class="bound">v</span><span class="main">)</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="bound">i</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">&lt;</span> <span class="bound">u</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sum_of_pr_is_pr2<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> f1_def <span class="main">[</span><span class="operator">abs_def</span><span class="main">]</span> <span class="keyword1"><span class="command">have</span></span> f1_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f1</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> f_def f1_def <span class="keyword1"><span class="command">have</span></span> f_f1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> <span class="skolem">f1</span> <span class="bound">u</span> <span class="bound">u</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> f1_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> <span class="skolem">f1</span> <span class="bound">u</span> <span class="bound">u</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">with</span></span> f_f1 <span class="keyword1"><span class="command">have</span></span> f_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> f_is_result<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> sum <span class="free">g</span> <span class="main">(</span>nat_to_set <span class="bound">u</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">u</span> <span class="main">=</span> sum <span class="free">g</span> <span class="main">(</span>nat_to_set <span class="skolem">u</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">U</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">=</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="bound">i</span> <span class="main">&lt;</span> <span class="skolem">u</span><span class="main">}</span>"</span></span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">∈</span> <span class="skolem">U</span><span class="main">.</span> c_in <span class="bound">x</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">1</span><span class="main">}</span>"</span></span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">=</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">∈</span> <span class="skolem">U</span><span class="main">.</span> c_in <span class="bound">x</span> <span class="skolem">u</span> <span class="main">≠</span> <span class="main">1</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> U_finite<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">U</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> U_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> finite_interval<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> A_def U_finite <span class="keyword1"><span class="command">have</span></span> A_finite<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> B_def U_finite <span class="keyword1"><span class="command">have</span></span> B_finite<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> U_def A_def B_def <span class="keyword1"><span class="command">have</span></span> U_A_B<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">=</span> <span class="skolem">A</span> <span class="main">∪</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> U_def A_def B_def <span class="keyword1"><span class="command">have</span></span> A_B<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∩</span> <span class="skolem">B</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> B_def g1_def <span class="keyword1"><span class="command">have</span></span> B_z<span class="main">:</span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">g1</span> <span class="bound">x</span> <span class="skolem">u</span><span class="main">)</span> <span class="skolem">B</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> u_in_U<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">u</span> <span class="main">⊆</span> <span class="skolem">U</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> U_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> nat_to_set_upper_bound2<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> u_in_U x_in_u_eq A_def <span class="keyword1"><span class="command">have</span></span> A_u<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> nat_to_set <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> A_u x_in_u_eq g1_def <span class="keyword1"><span class="command">have</span></span> A_res<span class="main">:</span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">g1</span> <span class="bound">x</span> <span class="skolem">u</span><span class="main">)</span> <span class="skolem">A</span> <span class="main">=</span> sum <span class="free">g</span> <span class="main">(</span>nat_to_set <span class="skolem">u</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> f_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">u</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">g1</span> <span class="bound">x</span> <span class="skolem">u</span><span class="main">)</span> <span class="main">{</span><span class="bound">i</span><span class="main">.</span> <span class="main">(</span><span class="bound">i</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">u</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> U_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">g1</span> <span class="bound">x</span> <span class="skolem">u</span><span class="main">)</span> <span class="skolem">U</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> U_A_B <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">g1</span> <span class="bound">x</span> <span class="skolem">u</span><span class="main">)</span> <span class="main">(</span><span class="skolem">A</span> <span class="main">∪</span> <span class="skolem">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> A_finite B_finite A_B <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">g1</span> <span class="bound">x</span> <span class="skolem">u</span><span class="main">)</span> <span class="skolem">A</span> <span class="main">+</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">g1</span> <span class="bound">x</span> <span class="skolem">u</span><span class="main">)</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sum.union_disjoint<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> B_z <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">g1</span> <span class="bound">x</span> <span class="skolem">u</span><span class="main">)</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> A_res <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> sum <span class="free">g</span> <span class="main">(</span>nat_to_set <span class="skolem">u</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> f_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_card</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_card</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> card <span class="main">(</span>nat_to_set <span class="bound">u</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">theorem</span></span> c_card_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"c_card <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">have</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> g_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> const_is_pr<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_card <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> sum <span class="skolem">g</span> <span class="main">(</span>nat_to_set <span class="bound">u</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_card <span class="skolem">u</span> <span class="main">=</span> sum <span class="skolem">g</span> <span class="main">(</span>nat_to_set <span class="skolem">u</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> c_card_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> g_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> card_eq_sum<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> g_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">u</span><span class="main">.</span> sum <span class="skolem">g</span> <span class="main">(</span>nat_to_set <span class="bound">u</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sum_is_pr<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_insert</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_insert</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">u</span><span class="main">.</span> <span class="keyword1">if</span> c_in <span class="bound">x</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">1</span> <span class="keyword1">then</span> <span class="bound">u</span> <span class="keyword1">else</span> <span class="bound">u</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">^</span><span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecFinSet-c_insert_is_pr"><span class="command">lemma</span></span> c_insert_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"c_insert <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> c_insert_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> if_eq_is_pr2<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_in <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_in_is_pr<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">1</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> const_is_pr_2<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id2_2<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">from</span></span> power_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">^</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"set_to_nat <span class="main">(</span>nat_to_set <span class="free">u</span><span class="main">)</span> <span class="main">=</span> <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">D</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">=</span> nat_to_set <span class="free">u</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> D_def nat_to_set_is_finite <span class="keyword1"><span class="command">have</span></span> D_finite<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">(</span>set_to_nat <span class="skolem">D</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_set_srj<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> D_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">(</span>set_to_nat <span class="skolem">D</span><span class="main">)</span> <span class="main">=</span> nat_to_set <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_to_nat <span class="skolem">D</span> <span class="main">=</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_set_inj<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> D_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-insert_lemma"><span class="command">lemma</span></span> insert_lemma<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∉</span> nat_to_set <span class="free">u</span> <span class="main">⟹</span> set_to_nat <span class="main">(</span>nat_to_set <span class="free">u</span> <span class="main">∪</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">u</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∉</span> nat_to_set <span class="free">u</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">D</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">=</span> nat_to_set <span class="free">u</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A D_def <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∉</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>nat_to_set <span class="free">u</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_set_is_finite<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> D_def <span class="keyword1"><span class="command">have</span></span> D_finite<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> set_to_nat_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_to_nat <span class="main">(</span><span class="skolem">D</span> <span class="main">∪</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> sum <span class="var">?f</span> <span class="main">(</span><span class="skolem">D</span> <span class="main">∪</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> D_finite S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="var">?f</span> <span class="free">x</span> <span class="main">+</span> sum <span class="var">?f</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> set_to_nat_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span> <span class="main">+</span> set_to_nat <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_to_nat <span class="main">(</span><span class="skolem">D</span> <span class="main">∪</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> set_to_nat <span class="skolem">D</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> D_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-c_insert_df"><span class="command">lemma</span></span> c_insert_df<span class="main">:</span> <span class="quoted"><span class="quoted">"c_insert <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">u</span><span class="main">.</span> set_to_nat <span class="main">(</span><span class="main">(</span>nat_to_set <span class="bound">u</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ext<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ext<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">u</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_insert <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">=</span> set_to_nat <span class="main">(</span>nat_to_set <span class="skolem">u</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> nat_to_set <span class="skolem">u</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">u</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">=</span> nat_to_set <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"set_to_nat <span class="main">(</span>nat_to_set <span class="skolem">u</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_in <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_u_eq<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_insert <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">=</span> <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> c_insert_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∉</span> nat_to_set <span class="skolem">u</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_in <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">≠</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_u_eq<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_insert <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">=</span> <span class="skolem">u</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> c_insert_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_to_nat <span class="main">(</span>nat_to_set <span class="skolem">u</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">u</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> insert_lemma<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_remove</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_remove</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">u</span><span class="main">.</span> <span class="keyword1">if</span> c_in <span class="bound">x</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span> <span class="bound">u</span> <span class="keyword1">else</span> <span class="bound">u</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">^</span><span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecFinSet-c_remove_is_pr"><span class="command">lemma</span></span> c_remove_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"c_remove <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> c_remove_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> if_eq_is_pr2<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_in <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_in_is_pr<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">0</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> const_is_pr_2<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id2_2<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">from</span></span> power_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">^</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-remove_lemma"><span class="command">lemma</span></span> remove_lemma<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> nat_to_set <span class="free">u</span> <span class="main">⟹</span> set_to_nat <span class="main">(</span>nat_to_set <span class="free">u</span> <span class="main">-</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">u</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> nat_to_set <span class="free">u</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">D</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">=</span> nat_to_set <span class="free">u</span> <span class="main">-</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A D_def <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∉</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>nat_to_set <span class="free">u</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_set_is_finite<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> D_def <span class="keyword1"><span class="command">have</span></span> D_finite<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span><span class="main">^</span><span class="bound">x</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> set_to_nat_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_to_nat <span class="main">(</span><span class="skolem">D</span> <span class="main">∪</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> sum <span class="var">?f</span> <span class="main">(</span><span class="skolem">D</span> <span class="main">∪</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> D_finite S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="var">?f</span> <span class="free">x</span> <span class="main">+</span> sum <span class="var">?f</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> set_to_nat_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span> <span class="main">+</span> set_to_nat <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"set_to_nat <span class="main">(</span><span class="skolem">D</span> <span class="main">∪</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> set_to_nat <span class="skolem">D</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A D_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">∪</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">=</span> nat_to_set <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">=</span> set_to_nat <span class="skolem">D</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span> <span class="main">^</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_set_upper_bound<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S3 D_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecFinSet-c_remove_df"><span class="command">lemma</span></span> c_remove_df<span class="main">:</span> <span class="quoted"><span class="quoted">"c_remove <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">u</span><span class="main">.</span> set_to_nat <span class="main">(</span><span class="main">(</span>nat_to_set <span class="bound">u</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ext<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ext<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">u</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_remove <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">=</span> set_to_nat <span class="main">(</span>nat_to_set <span class="skolem">u</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> nat_to_set <span class="skolem">u</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_in <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_u_eq<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_remove <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">=</span> <span class="skolem">u</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">^</span><span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_remove_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"set_to_nat <span class="main">(</span>nat_to_set <span class="skolem">u</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">u</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">^</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> remove_lemma<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∉</span> nat_to_set <span class="skolem">u</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_in <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">≠</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_u_eq<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_remove <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">=</span> <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_remove_def c_in_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">u</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">=</span> nat_to_set <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_union</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_union</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> set_to_nat <span class="main">(</span>nat_to_set <span class="bound">u</span> <span class="main">∪</span> nat_to_set <span class="bound">v</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">theorem</span></span> c_union_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"c_union <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">y</span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">have</span></span> f_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> c_fst"</span></span>
    <span class="keyword1"><span class="command">from</span></span> c_fst_is_pr g_def <span class="keyword1"><span class="command">have</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="skolem">c</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> c_in <span class="skolem">a</span> <span class="main">(</span>c_snd <span class="skolem">c</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span> <span class="keyword1">then</span> c_insert <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword1">else</span> <span class="skolem">b</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="skolem">c</span>
    <span class="keyword1"><span class="command">from</span></span> c_in_is_pr c_insert_is_pr <span class="keyword1"><span class="command">have</span></span> h_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> h_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
    <span class="keyword1"><span class="command">have</span></span> f_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">f</span> <span class="main">0</span> <span class="bound">x</span> <span class="main">=</span> <span class="skolem">g</span> <span class="bound">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">0</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">g</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> f_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> g_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> f_at_Suc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">f</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="bound">x</span> <span class="main">=</span> <span class="skolem">h</span> <span class="bound">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">h</span> <span class="skolem">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_in <span class="skolem">y</span> <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="main">(</span>nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_u_eq<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> A h_def <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="skolem">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> c_insert <span class="skolem">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> Suc <span class="skolem">y</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">y</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> nat_to_set_is_finite <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span><span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> nat_to_set_srj f_def <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> f_def <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> Suc <span class="skolem">y</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="main">(</span><span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">y</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> S5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> set_to_nat <span class="main">(</span>nat_to_set <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">y</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> c_insert <span class="skolem">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_insert_df<span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> S2<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> c_in <span class="skolem">y</span> <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∉</span> <span class="main">(</span>nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_u_eq<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> A h_def <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="skolem">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> Suc <span class="skolem">y</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> Suc <span class="skolem">y</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">=</span> <span class="skolem">y</span><span class="main">}</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">from</span></span> nat_to_set_is_finite <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span><span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> nat_to_set_srj f_def <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> f_def <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> Suc <span class="skolem">y</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="main">(</span><span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> S5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> set_to_nat <span class="main">(</span>nat_to_set <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> S2<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">from</span></span> g_is_pr h_is_pr f_at_0 f_at_Suc <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_rec_scheme<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">union</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">union</span> <span class="skolem">u</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">f</span> <span class="skolem">v</span> <span class="main">(</span>c_pair <span class="skolem">u</span> <span class="skolem">v</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">u</span> <span class="skolem">v</span>
  <span class="keyword1"><span class="command">from</span></span> f_is_pr <span class="keyword1"><span class="command">have</span></span> union_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">union</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> union_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> <span class="skolem">union</span> <span class="bound">u</span> <span class="bound">v</span> <span class="main">=</span> set_to_nat <span class="main">(</span>nat_to_set <span class="bound">u</span> <span class="main">∪</span> nat_to_set <span class="bound">v</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span> <span class="skolem">v</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">union</span> <span class="skolem">u</span> <span class="skolem">v</span> <span class="main">=</span> set_to_nat <span class="main">(</span>nat_to_set <span class="skolem">u</span> <span class="main">∪</span> nat_to_set <span class="skolem">v</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> nat_to_set_upper_bound1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="skolem">v</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">v</span><span class="main">}</span> <span class="main">=</span> nat_to_set <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> union_def f_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">union</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> set_to_nat <span class="main">(</span>nat_to_set <span class="bound">u</span> <span class="main">∪</span> nat_to_set <span class="bound">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ext<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> c_union_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_union <span class="main">=</span> <span class="skolem">union</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> union_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_diff</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_diff</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> set_to_nat <span class="main">(</span>nat_to_set <span class="bound">u</span> <span class="main">-</span> nat_to_set <span class="bound">v</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">theorem</span></span> c_diff_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"c_diff <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">y</span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">have</span></span> f_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> c_fst"</span></span>
    <span class="keyword1"><span class="command">from</span></span> c_fst_is_pr g_def <span class="keyword1"><span class="command">have</span></span> g_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="skolem">c</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> c_in <span class="skolem">a</span> <span class="main">(</span>c_snd <span class="skolem">c</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span> <span class="keyword1">then</span> c_remove <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword1">else</span> <span class="skolem">b</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="skolem">c</span>
    <span class="keyword1"><span class="command">from</span></span> c_in_is_pr c_remove_is_pr <span class="keyword1"><span class="command">have</span></span> h_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> h_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
    <span class="keyword1"><span class="command">have</span></span> f_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">f</span> <span class="main">0</span> <span class="bound">x</span> <span class="main">=</span> <span class="skolem">g</span> <span class="bound">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">0</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">g</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> f_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> g_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> f_at_Suc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">f</span> <span class="main">(</span>Suc <span class="bound">y</span><span class="main">)</span> <span class="bound">x</span> <span class="main">=</span> <span class="skolem">h</span> <span class="bound">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="bound">y</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">h</span> <span class="skolem">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_in <span class="skolem">y</span> <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="main">(</span>nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_u_eq<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> A h_def <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="skolem">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> c_remove <span class="skolem">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">y</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span>
              <span class="main">(</span><span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">y</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> lm1<span class="main">:</span> <span class="quoted"><span class="quoted">"set_to_nat <span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">y</span><span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
                        set_to_nat <span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">y</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> Suc <span class="skolem">y</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">y</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> nat_to_set_is_finite <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span><span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> nat_to_set_srj f_def <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> f_def <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> Suc <span class="skolem">y</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">y</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="main">(</span><span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">y</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> lm1<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> S5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> set_to_nat <span class="main">(</span>nat_to_set <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">y</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> c_remove <span class="skolem">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_remove_df<span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> S2<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> c_in <span class="skolem">y</span> <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∉</span> <span class="main">(</span>nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_u_eq<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> A h_def <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="skolem">y</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> Suc <span class="skolem">y</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> Suc <span class="skolem">y</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">=</span> <span class="skolem">y</span><span class="main">}</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">from</span></span> nat_to_set_is_finite <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span><span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> nat_to_set_srj f_def <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> f_def <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">(</span>Suc <span class="skolem">y</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> Suc <span class="skolem">y</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="main">(</span><span class="main">(</span>nat_to_set <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="main">(</span>c_snd <span class="skolem">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">y</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> S5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> set_to_nat <span class="main">(</span>nat_to_set <span class="main">(</span><span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="skolem">f</span> <span class="skolem">y</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> S2<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">from</span></span> g_is_pr h_is_pr f_at_0 f_at_Suc <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_rec_scheme<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">diff</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">diff</span> <span class="skolem">u</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">f</span> <span class="skolem">v</span> <span class="main">(</span>c_pair <span class="skolem">u</span> <span class="skolem">v</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">u</span> <span class="skolem">v</span>
  <span class="keyword1"><span class="command">from</span></span> f_is_pr <span class="keyword1"><span class="command">have</span></span> diff_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">diff</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> diff_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> <span class="skolem">diff</span> <span class="bound">u</span> <span class="bound">v</span> <span class="main">=</span> set_to_nat <span class="main">(</span>nat_to_set <span class="bound">u</span> <span class="main">-</span> nat_to_set <span class="bound">v</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span> <span class="skolem">v</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">diff</span> <span class="skolem">u</span> <span class="skolem">v</span> <span class="main">=</span> set_to_nat <span class="main">(</span>nat_to_set <span class="skolem">u</span> <span class="main">-</span> nat_to_set <span class="skolem">v</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> nat_to_set_upper_bound1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound"><span class="bound">z</span></span> <span class="main">∈</span> nat_to_set <span class="skolem">v</span><span class="main">.</span> <span class="bound">z</span> <span class="main">&lt;</span> <span class="skolem">v</span><span class="main">}</span> <span class="main">=</span> nat_to_set <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> diff_def f_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">diff</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> set_to_nat <span class="main">(</span>nat_to_set <span class="bound">u</span> <span class="main">-</span> nat_to_set <span class="bound">v</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ext<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> c_diff_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_diff <span class="main">=</span> <span class="skolem">diff</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> diff_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_intersect</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_intersect</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> set_to_nat <span class="main">(</span>nat_to_set <span class="bound">u</span> <span class="main">∩</span> nat_to_set <span class="bound">v</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">theorem</span></span> c_intersect_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"c_intersect <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">u</span> <span class="skolem">v</span> <span class="main">=</span> c_diff <span class="main">(</span>c_union <span class="skolem">u</span> <span class="skolem">v</span><span class="main">)</span> <span class="main">(</span>c_union <span class="main">(</span>c_diff <span class="skolem">u</span> <span class="skolem">v</span><span class="main">)</span> <span class="main">(</span>c_diff <span class="skolem">v</span> <span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">u</span> <span class="skolem">v</span>
  <span class="keyword1"><span class="command">from</span></span> c_diff_is_pr c_union_is_pr <span class="keyword1"><span class="command">have</span></span> f_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">u</span> <span class="bound">v</span> <span class="main">=</span> c_intersect <span class="bound">u</span> <span class="bound">v</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span> <span class="skolem">v</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">u</span> <span class="skolem">v</span> <span class="main">=</span> c_intersect <span class="skolem">u</span> <span class="skolem">v</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">u</span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">v</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> A_fin<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="var">?A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_set_is_finite<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> B_fin<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_set_is_finite<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_union <span class="skolem">u</span> <span class="skolem">v</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="var">?A</span> <span class="main">∪</span> <span class="var">?B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_union_def<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_diff <span class="skolem">u</span> <span class="skolem">v</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="var">?A</span> <span class="main">-</span> <span class="var">?B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_diff_def<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_diff <span class="skolem">v</span> <span class="skolem">u</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="var">?B</span> <span class="main">-</span> <span class="var">?A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_diff_def<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> S2 A_fin B_fin <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">(</span>c_diff <span class="skolem">u</span> <span class="skolem">v</span><span class="main">)</span> <span class="main">=</span> <span class="var">?A</span> <span class="main">-</span> <span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span>  <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_set_srj<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> S3 A_fin B_fin <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">(</span>c_diff <span class="skolem">v</span> <span class="skolem">u</span><span class="main">)</span> <span class="main">=</span> <span class="var">?B</span> <span class="main">-</span> <span class="var">?A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span>  <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_set_srj<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> S4 S5 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"c_union <span class="main">(</span>c_diff <span class="skolem">u</span> <span class="skolem">v</span><span class="main">)</span> <span class="main">(</span>c_diff <span class="skolem">v</span> <span class="skolem">u</span><span class="main">)</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="main">(</span><span class="var">?A</span> <span class="main">-</span> <span class="var">?B</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="var">?B</span> <span class="main">-</span> <span class="var">?A</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_union_def<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> S1 A_fin B_fin <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">(</span>c_union <span class="skolem">u</span> <span class="skolem">v</span><span class="main">)</span> <span class="main">=</span> <span class="var">?A</span> <span class="main">∪</span> <span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span>  <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_set_srj<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> S6 A_fin B_fin <span class="keyword1"><span class="command">have</span></span> S8<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="main">(</span>c_union <span class="main">(</span>c_diff <span class="skolem">u</span> <span class="skolem">v</span><span class="main">)</span> <span class="main">(</span>c_diff <span class="skolem">v</span> <span class="skolem">u</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="var">?A</span> <span class="main">-</span> <span class="var">?B</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="var">?B</span> <span class="main">-</span> <span class="var">?A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span>  <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_set_srj<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> S7 S8 <span class="keyword1"><span class="command">have</span></span> S9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">u</span> <span class="skolem">v</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="main">(</span><span class="var">?A</span> <span class="main">∪</span> <span class="var">?B</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="main">(</span><span class="var">?A</span> <span class="main">-</span> <span class="var">?B</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="var">?B</span> <span class="main">-</span> <span class="var">?A</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_diff_def f_def<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> S10<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">∩</span> <span class="var">?B</span> <span class="main">=</span> <span class="main">(</span><span class="var">?A</span> <span class="main">∪</span> <span class="var">?B</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="main">(</span><span class="var">?A</span> <span class="main">-</span> <span class="var">?B</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="var">?B</span> <span class="main">-</span> <span class="var">?A</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> S9 <span class="keyword1"><span class="command">have</span></span> S11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">u</span> <span class="skolem">v</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="var">?A</span> <span class="main">∩</span> <span class="var">?B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_intersect <span class="skolem">u</span> <span class="skolem">v</span> <span class="main">=</span> set_to_nat <span class="main">(</span><span class="var">?A</span> <span class="main">∩</span> <span class="var">?B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_intersect_def<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> S11 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> c_intersect"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ext<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> f_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="PRecUnGr">
<div class="head">
<h1>Theory PRecUnGr</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       The function which is universal for primitive recursive functions of one variable
    Author:      Michael Nedzelsky &lt;MichaelNedzelsky at yandex.ru&gt;, 2008
    Maintainer:  Michael Nedzelsky &lt;MichaelNedzelsky at yandex.ru&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹The function which is universal for primitive recursive functions of one variable›</span></span>

<span class="keyword1"><span class="command">theory</span></span> PRecUnGr
<span class="keyword2"><span class="keyword">imports</span></span> <a href="PRecFun2.html">PRecFun2</a> <a href="PRecList.html">PRecList</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  We introduce a particular function which is universal for primitive
  recursive functions of one variable.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">g_comp</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">g_comp</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="free"><span class="bound"><span class="entity">key</span></span></span> <span class="main">=</span> <span class="main">(</span>
    <span class="keyword1">let</span> <span class="bound">n</span> <span class="main">=</span> c_fst <span class="free"><span class="bound"><span class="entity">key</span></span></span><span class="main">;</span> <span class="bound">x</span> <span class="main">=</span> c_snd <span class="free"><span class="bound"><span class="entity">key</span></span></span><span class="main">;</span> <span class="bound">m</span> <span class="main">=</span> c_snd <span class="bound">n</span><span class="main">;</span>
    <span class="bound">m1</span> <span class="main">=</span> c_fst <span class="bound">m</span><span class="main">;</span> <span class="bound">m2</span> <span class="main">=</span> c_snd <span class="bound">m</span> <span class="keyword1">in</span>
    <span class="comment1">― ‹We have <span class="antiquoted"><span class="raw_text"><span class="operator">‹</span>key = &lt;n, x&gt;; n = &lt;?, m&gt;; m = &lt;m1, m2&gt;›</span></span>.›</span>
    <span class="keyword1">if</span> c_assoc_have_key <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="main">(</span>c_pair <span class="bound">m2</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span>
      <span class="main">(</span><span class="keyword1">let</span> <span class="bound">y</span> <span class="main">=</span> c_assoc_value <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="main">(</span>c_pair <span class="bound">m2</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">in</span>
       <span class="keyword1">if</span> c_assoc_have_key <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="main">(</span>c_pair <span class="bound">m1</span> <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span>
         <span class="main">(</span><span class="keyword1">let</span> <span class="bound">z</span> <span class="main">=</span> c_assoc_value <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="main">(</span>c_pair <span class="bound">m1</span> <span class="bound">y</span><span class="main">)</span> <span class="keyword1">in</span>
         c_cons <span class="main">(</span>c_pair <span class="free"><span class="bound"><span class="entity">key</span></span></span> <span class="bound">z</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span><span class="main">)</span>
       <span class="keyword1">else</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span>
      <span class="main">)</span>
    <span class="keyword1">else</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span>
  <span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">g_pair</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">g_pair</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="free"><span class="bound"><span class="entity">key</span></span></span> <span class="main">=</span> <span class="main">(</span>
    <span class="keyword1">let</span> <span class="bound">n</span> <span class="main">=</span> c_fst <span class="free"><span class="bound"><span class="entity">key</span></span></span><span class="main">;</span> <span class="bound">x</span> <span class="main">=</span> c_snd <span class="free"><span class="bound"><span class="entity">key</span></span></span><span class="main">;</span> <span class="bound">m</span> <span class="main">=</span> c_snd <span class="bound">n</span><span class="main">;</span>
    <span class="bound">m1</span> <span class="main">=</span> c_fst <span class="bound">m</span><span class="main">;</span> <span class="bound">m2</span> <span class="main">=</span> c_snd <span class="bound">m</span> <span class="keyword1">in</span>
    <span class="comment1">― ‹We have <span class="antiquoted"><span class="raw_text"><span class="operator">‹</span>key = &lt;n, x&gt;; n = &lt;?, m&gt;; m = &lt;m1, m2&gt;›</span></span>.›</span>
    <span class="keyword1">if</span> c_assoc_have_key <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="main">(</span>c_pair <span class="bound">m1</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span>
      <span class="main">(</span><span class="keyword1">let</span> <span class="bound">y1</span> <span class="main">=</span> c_assoc_value <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="main">(</span>c_pair <span class="bound">m1</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">in</span>
       <span class="keyword1">if</span> c_assoc_have_key <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="main">(</span>c_pair <span class="bound">m2</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span>
         <span class="main">(</span><span class="keyword1">let</span> <span class="bound">y2</span> <span class="main">=</span> c_assoc_value <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="main">(</span>c_pair <span class="bound">m2</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">in</span>
         c_cons <span class="main">(</span>c_pair <span class="free"><span class="bound"><span class="entity">key</span></span></span> <span class="main">(</span>c_pair <span class="bound">y1</span> <span class="bound">y2</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span><span class="main">)</span>
       <span class="keyword1">else</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span>
      <span class="main">)</span>
    <span class="keyword1">else</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span>
  <span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">g_rec</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">g_rec</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="free"><span class="bound"><span class="entity">key</span></span></span> <span class="main">=</span> <span class="main">(</span>
    <span class="keyword1">let</span> <span class="bound">n</span> <span class="main">=</span> c_fst <span class="free"><span class="bound"><span class="entity">key</span></span></span><span class="main">;</span> <span class="bound">x</span> <span class="main">=</span> c_snd <span class="free"><span class="bound"><span class="entity">key</span></span></span><span class="main">;</span> <span class="bound">m</span> <span class="main">=</span> c_snd <span class="bound">n</span><span class="main">;</span>
    <span class="bound">m1</span> <span class="main">=</span> c_fst <span class="bound">m</span><span class="main">;</span> <span class="bound">m2</span> <span class="main">=</span> c_snd <span class="bound">m</span><span class="main">;</span> <span class="bound">y1</span> <span class="main">=</span> c_fst <span class="bound">x</span><span class="main">;</span> <span class="bound">x1</span> <span class="main">=</span> c_snd <span class="bound">x</span> <span class="keyword1">in</span>
    <span class="comment1">― ‹We have <span class="antiquoted"><span class="raw_text"><span class="operator">‹</span>key = &lt;n, x&gt;; n = &lt;?, m&gt;; m = &lt;m1, m2&gt;; x = &lt;y1, x1&gt;›</span></span>.›</span>
    <span class="keyword1">if</span> <span class="bound">y1</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span>
    <span class="main">(</span>
      <span class="keyword1">if</span> c_assoc_have_key <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="main">(</span>c_pair <span class="bound">m1</span> <span class="bound">x1</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span>
        c_cons <span class="main">(</span>c_pair <span class="free"><span class="bound"><span class="entity">key</span></span></span> <span class="main">(</span>c_assoc_value <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="main">(</span>c_pair <span class="bound">m1</span> <span class="bound">x1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span>
      <span class="keyword1">else</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span>
    <span class="main">)</span>
    <span class="keyword1">else</span>
    <span class="main">(</span>
     <span class="keyword1">let</span> <span class="bound">y2</span> <span class="main">=</span> <span class="bound">y1</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span> <span class="keyword1">in</span>
      <span class="keyword1">if</span> c_assoc_have_key <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="main">(</span>c_pair <span class="bound">n</span> <span class="main">(</span>c_pair <span class="bound">y2</span> <span class="bound">x1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span>
      <span class="main">(</span>   
        <span class="keyword1">let</span> <span class="bound">t1</span> <span class="main">=</span> c_assoc_value <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="main">(</span>c_pair <span class="bound">n</span> <span class="main">(</span>c_pair <span class="bound">y2</span> <span class="bound">x1</span><span class="main">)</span><span class="main">)</span><span class="main">;</span> <span class="bound">t2</span> <span class="main">=</span> c_pair <span class="main">(</span>c_pair <span class="bound">y2</span> <span class="bound">t1</span><span class="main">)</span> <span class="bound">x1</span> <span class="keyword1">in</span>
        <span class="keyword1">if</span> c_assoc_have_key <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="main">(</span>c_pair <span class="bound">m2</span> <span class="bound">t2</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span>
          c_cons <span class="main">(</span>c_pair <span class="free"><span class="bound"><span class="entity">key</span></span></span> <span class="main">(</span>c_assoc_value <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="main">(</span>c_pair <span class="bound">m2</span> <span class="bound">t2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span>
        <span class="keyword1">else</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> 
      <span class="main">)</span>
      <span class="keyword1">else</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span>
    <span class="main">)</span>
  <span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">g_step</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">g_step</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="free"><span class="bound"><span class="entity">key</span></span></span> <span class="main">=</span> <span class="main">(</span>
    <span class="keyword1">let</span> <span class="bound">n</span> <span class="main">=</span> c_fst <span class="free"><span class="bound"><span class="entity">key</span></span></span><span class="main">;</span> <span class="bound">x</span> <span class="main">=</span> c_snd <span class="free"><span class="bound"><span class="entity">key</span></span></span><span class="main">;</span> <span class="bound">n1</span> <span class="main">=</span> <span class="main">(</span>c_fst <span class="bound">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="keyword1">in</span>
    <span class="keyword1">if</span> <span class="bound">n1</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span> c_cons <span class="main">(</span>c_pair <span class="free"><span class="bound"><span class="entity">key</span></span></span> <span class="main">0</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="keyword1">else</span>
    <span class="keyword1">if</span> <span class="bound">n1</span> <span class="main">=</span> <span class="main">1</span> <span class="keyword1">then</span> c_cons <span class="main">(</span>c_pair <span class="free"><span class="bound"><span class="entity">key</span></span></span> <span class="main">(</span>Suc <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="keyword1">else</span>
    <span class="keyword1">if</span> <span class="bound">n1</span> <span class="main">=</span> <span class="numeral">2</span> <span class="keyword1">then</span> c_cons <span class="main">(</span>c_pair <span class="free"><span class="bound"><span class="entity">key</span></span></span> <span class="main">(</span>c_fst <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="keyword1">else</span>
    <span class="keyword1">if</span> <span class="bound">n1</span> <span class="main">=</span> <span class="numeral">3</span> <span class="keyword1">then</span> c_cons <span class="main">(</span>c_pair <span class="free"><span class="bound"><span class="entity">key</span></span></span> <span class="main">(</span>c_snd <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="keyword1">else</span>
    <span class="keyword1">if</span> <span class="bound">n1</span> <span class="main">=</span> <span class="numeral">4</span> <span class="keyword1">then</span> g_comp <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="free"><span class="bound"><span class="entity">key</span></span></span> <span class="keyword1">else</span>
    <span class="keyword1">if</span> <span class="bound">n1</span> <span class="main">=</span> <span class="numeral">5</span> <span class="keyword1">then</span> g_pair <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="free"><span class="bound"><span class="entity">key</span></span></span> <span class="keyword1">else</span>
    <span class="keyword1">if</span> <span class="bound">n1</span> <span class="main">=</span> <span class="numeral">6</span> <span class="keyword1">then</span> g_rec <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span> <span class="free"><span class="bound"><span class="entity">key</span></span></span> <span class="keyword1">else</span>
    <span class="free"><span class="bound"><span class="entity">c_ls</span></span></span>
  <span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">pr_gr</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  pr_gr_def<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">pr_gr</span> <span class="main">=</span> PrimRecOp1 <span class="main">0</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> g_step <span class="bound">b</span> <span class="main">(</span>c_fst <span class="bound">a</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecUnGr-pr_gr_at_0"><span class="command">lemma</span></span> pr_gr_at_0<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_gr_def<span class="main">)</span>

<span class="keyword1" id="PRecUnGr-pr_gr_at_Suc"><span class="command">lemma</span></span> pr_gr_at_Suc<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span> <span class="main">=</span> g_step <span class="main">(</span>pr_gr <span class="free">x</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_gr_def<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">univ_for_pr</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">univ_for_pr</span> <span class="main">=</span> pr_conv_2_to_1 nat_to_pr"</span></span>

<span class="keyword1"><span class="command">theorem</span></span> univ_is_not_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="main">∉</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> univ_for_pr <span class="main">∉</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> univ_for_pr <span class="main">(</span>c_pair <span class="bound">n</span> <span class="bound">n</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n0</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"index_of_pr <span class="var">?f</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="var">?n0</span> <span class="main">=</span> <span class="var">?f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> index_of_pr_is_real<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="var">?n0</span> <span class="var">?n0</span> <span class="main">=</span> <span class="var">?f</span> <span class="var">?n0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="var">?n0</span> <span class="main">=</span> univ_for_pr <span class="main">(</span>c_pair <span class="var">?n0</span> <span class="var">?n0</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S3 S4 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_def pr_conv_2_to_1_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_is_sub_fun</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_is_sub_fun</span> <span class="free"><span class="bound"><span class="entity">ls</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> c_assoc_have_key <span class="free"><span class="bound"><span class="entity">ls</span></span></span> <span class="bound">x</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟶</span> c_assoc_value <span class="free"><span class="bound"><span class="entity">ls</span></span></span> <span class="bound">x</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecUnGr-c_is_sub_fun_lm_1"><span class="command">lemma</span></span> c_is_sub_fun_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> c_is_sub_fun <span class="free">ls</span> <span class="free">f</span><span class="main">;</span> c_assoc_have_key <span class="free">ls</span> <span class="free">x</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟧</span>  <span class="main">⟹</span> c_assoc_value <span class="free">ls</span> <span class="free">x</span> <span class="main">=</span> <span class="free">f</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">unfold</span> c_is_sub_fun_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="PRecUnGr-c_is_sub_fun_lm_2"><span class="command">lemma</span></span> c_is_sub_fun_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="free">ls</span> <span class="free">f</span> <span class="main">⟹</span> c_is_sub_fun <span class="main">(</span>c_cons <span class="main">(</span>c_pair <span class="free">x</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span><span class="main">)</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="free">ls</span> <span class="free">f</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> c_is_sub_fun_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">xa</span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>c_cons <span class="main">(</span>c_pair <span class="free">x</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span><span class="main">)</span> <span class="skolem">xa</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="main">(</span>c_cons <span class="main">(</span>c_pair <span class="free">x</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span><span class="main">)</span> <span class="skolem">xa</span> <span class="main">=</span> <span class="free">f</span> <span class="skolem">xa</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> C1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">xa</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="main">(</span>c_cons <span class="main">(</span>c_pair <span class="free">x</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span><span class="main">)</span> <span class="skolem">xa</span> <span class="main">=</span> <span class="free">f</span> <span class="skolem">xa</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PRecList.c_assoc_lm_2<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> C2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">xa</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>c_cons <span class="main">(</span>c_pair <span class="free">x</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span><span class="main">)</span> <span class="skolem">xa</span> <span class="main">=</span> c_assoc_have_key <span class="free">ls</span> <span class="skolem">xa</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_assoc_lm_3<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> C2 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="main">(</span>c_cons <span class="main">(</span>c_pair <span class="free">x</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span><span class="main">)</span> <span class="skolem">xa</span> <span class="main">=</span> c_assoc_value <span class="free">ls</span> <span class="skolem">xa</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_assoc_lm_4<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> A2 S1 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="skolem">xa</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> A1 S3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="free">ls</span> <span class="skolem">xa</span> <span class="main">=</span> <span class="free">f</span> <span class="skolem">xa</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_is_sub_fun_lm_1<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-mod7_lm"><span class="command">lemma</span></span> mod7_lm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">n</span><span class="main">::</span>nat<span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span>
                <span class="main">(</span><span class="free">n</span><span class="main">::</span>nat<span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">1</span> <span class="main">∨</span>
                <span class="main">(</span><span class="free">n</span><span class="main">::</span>nat<span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">∨</span>
                <span class="main">(</span><span class="free">n</span><span class="main">::</span>nat<span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">3</span> <span class="main">∨</span>
                <span class="main">(</span><span class="free">n</span><span class="main">::</span>nat<span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span> <span class="main">∨</span>
                <span class="main">(</span><span class="free">n</span><span class="main">::</span>nat<span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span> <span class="main">∨</span>
                <span class="main">(</span><span class="free">n</span><span class="main">::</span>nat<span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>

<span class="keyword1" id="PRecUnGr-nat_to_sch_at_pos"><span class="command">lemma</span></span> nat_to_sch_at_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> nat_to_sch <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span><span class="main">(</span>c_fst <span class="free">x</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="free">x</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">=</span> c_pair <span class="main">0</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_pair_def sf_def<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="main">1</span> <span class="main">=</span> c_fst <span class="main">(</span>c_pair <span class="main">0</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="main">1</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">x</span> <span class="main">=</span> Base_zero"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span><span class="main">(</span>c_fst <span class="free">x</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="free">x</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">insert</span> S1 S2<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def loc_f_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">x</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A this <span class="keyword1"><span class="command">have</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span>mod7 <span class="main">(</span>c_fst <span class="free">x</span><span class="main">)</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="free">x</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_srj_lm_2<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span><span class="main">(</span>c_fst <span class="free">x</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="free">x</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mod7_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-nat_to_sch_0"><span class="command">lemma</span></span> nat_to_sch_0<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> nat_to_sch <span class="free">n</span> <span class="main">=</span> Base_zero"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">=</span><span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> Base_zero"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">n</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span><span class="main">(</span>c_fst <span class="free">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="free">n</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_sch_at_pos<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> Base_zero"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def loc_f_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-loc_lm_1"><span class="command">lemma</span></span> loc_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">n</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> False"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_fst_at_0<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">n</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-loc_lm_2"><span class="command">lemma</span></span> loc_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> nat_to_sch <span class="free">n</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span><span class="main">(</span>c_fst <span class="free">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="free">n</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_sch_at_pos<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-nat_to_sch_1"><span class="command">lemma</span></span> nat_to_sch_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⟹</span> nat_to_sch <span class="free">n</span> <span class="main">=</span> Base_suc"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span><span class="main">(</span>c_fst <span class="free">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="free">n</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> Base_suc"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def loc_f_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-nat_to_sch_2"><span class="command">lemma</span></span> nat_to_sch_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">⟹</span> nat_to_sch <span class="free">n</span> <span class="main">=</span> Base_fst"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span><span class="main">(</span>c_fst <span class="free">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="free">n</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> Base_fst"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def loc_f_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-nat_to_sch_3"><span class="command">lemma</span></span> nat_to_sch_3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">3</span> <span class="main">⟹</span> nat_to_sch <span class="free">n</span> <span class="main">=</span> Base_snd"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">3</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span><span class="main">(</span>c_fst <span class="free">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="free">n</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> Base_snd"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def loc_f_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-nat_to_sch_4"><span class="command">lemma</span></span> nat_to_sch_4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span> <span class="main">⟹</span> nat_to_sch <span class="free">n</span> <span class="main">=</span> Comp_op <span class="main">(</span>nat_to_sch <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span><span class="main">(</span>c_fst <span class="free">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="free">n</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> Comp_op <span class="main">(</span>nat_to_sch <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def loc_f_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-nat_to_sch_5"><span class="command">lemma</span></span> nat_to_sch_5<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span> <span class="main">⟹</span> nat_to_sch <span class="free">n</span> <span class="main">=</span> Pair_op <span class="main">(</span>nat_to_sch <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span><span class="main">(</span>c_fst <span class="free">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="free">n</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> Pair_op <span class="main">(</span>nat_to_sch <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def loc_f_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-nat_to_sch_6"><span class="command">lemma</span></span> nat_to_sch_6<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span> <span class="main">⟹</span> nat_to_sch <span class="free">n</span> <span class="main">=</span> Rec_op <span class="main">(</span>nat_to_sch <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">u</span><span class="main">=</span><span class="main">(</span>c_fst <span class="free">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span><span class="main">;</span> <span class="bound">v</span><span class="main">=</span>c_snd <span class="free">n</span><span class="main">;</span> <span class="bound">v1</span><span class="main">=</span>c_fst <span class="bound">v</span><span class="main">;</span> <span class="bound">v2</span> <span class="main">=</span> c_snd <span class="bound">v</span><span class="main">;</span> <span class="bound">sch1</span><span class="main">=</span>nat_to_sch <span class="bound">v1</span><span class="main">;</span> <span class="bound">sch2</span><span class="main">=</span>nat_to_sch <span class="bound">v2</span> <span class="keyword1">in</span> loc_f <span class="bound">u</span> <span class="bound">sch1</span> <span class="bound">sch2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> Rec_op <span class="main">(</span>nat_to_sch <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def loc_f_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-nat_to_pr_lm_0"><span class="command">lemma</span></span> nat_to_pr_lm_0<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> sch_to_pr <span class="main">(</span>nat_to_sch <span class="free">n</span><span class="main">)</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> Base_zero"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_sch_0<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-nat_to_pr_lm_1"><span class="command">lemma</span></span> nat_to_pr_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⟹</span> nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> Suc <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> sch_to_pr <span class="main">(</span>nat_to_sch <span class="free">n</span><span class="main">)</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> Base_suc"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_sch_1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-nat_to_pr_lm_2"><span class="command">lemma</span></span> nat_to_pr_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">⟹</span> nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> c_fst <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> sch_to_pr <span class="main">(</span>nat_to_sch <span class="free">n</span><span class="main">)</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> Base_fst"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_sch_2<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-nat_to_pr_lm_3"><span class="command">lemma</span></span> nat_to_pr_lm_3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">3</span> <span class="main">⟹</span> nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> c_snd <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">3</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> sch_to_pr <span class="main">(</span>nat_to_sch <span class="free">n</span><span class="main">)</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> Base_snd"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_sch_3<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-nat_to_pr_lm_4"><span class="command">lemma</span></span> nat_to_pr_lm_4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span> <span class="main">⟹</span> nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span>nat_to_pr <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>nat_to_pr <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> sch_to_pr <span class="main">(</span>nat_to_sch <span class="free">n</span><span class="main">)</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> Comp_op <span class="main">(</span>nat_to_sch <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_sch_4<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> sch_to_pr <span class="main">(</span>Comp_op <span class="main">(</span>nat_to_sch <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span>sch_to_pr <span class="main">(</span>nat_to_sch <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span>sch_to_pr <span class="main">(</span>nat_to_sch <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S4 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-nat_to_pr_lm_5"><span class="command">lemma</span></span> nat_to_pr_lm_5<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span> <span class="main">⟹</span> nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span>c_f_pair <span class="main">(</span>nat_to_pr <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>nat_to_pr <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> sch_to_pr <span class="main">(</span>nat_to_sch <span class="free">n</span><span class="main">)</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> Pair_op <span class="main">(</span>nat_to_sch <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_sch_5<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> sch_to_pr <span class="main">(</span>Pair_op <span class="main">(</span>nat_to_sch <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-nat_to_pr_lm_6"><span class="command">lemma</span></span> nat_to_pr_lm_6<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span> <span class="main">⟹</span> nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span>UnaryRecOp <span class="main">(</span>nat_to_pr <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>nat_to_pr <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> sch_to_pr <span class="main">(</span>nat_to_sch <span class="free">n</span><span class="main">)</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_sch <span class="free">n</span> <span class="main">=</span> Rec_op <span class="main">(</span>nat_to_sch <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_sch_6<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> sch_to_pr <span class="main">(</span>Rec_op <span class="main">(</span>nat_to_sch <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>nat_to_sch <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-univ_for_pr_lm_0"><span class="command">lemma</span></span> univ_for_pr_lm_0<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> univ_for_pr <span class="free">key</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="free">key</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_def pr_conv_2_to_1_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_lm_0<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-univ_for_pr_lm_1"><span class="command">lemma</span></span> univ_for_pr_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⟹</span> univ_for_pr <span class="free">key</span> <span class="main">=</span> Suc <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="free">key</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_def pr_conv_2_to_1_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_lm_1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-univ_for_pr_lm_2"><span class="command">lemma</span></span> univ_for_pr_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">⟹</span> univ_for_pr <span class="free">key</span> <span class="main">=</span> c_fst <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="free">key</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_def pr_conv_2_to_1_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_lm_2<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-univ_for_pr_lm_3"><span class="command">lemma</span></span> univ_for_pr_lm_3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">3</span> <span class="main">⟹</span> univ_for_pr <span class="free">key</span> <span class="main">=</span> c_snd <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">3</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="free">key</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_def pr_conv_2_to_1_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_lm_3<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-univ_for_pr_lm_4"><span class="command">lemma</span></span> univ_for_pr_lm_4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span> <span class="main">⟹</span> univ_for_pr <span class="free">key</span> <span class="main">=</span> <span class="main">(</span>nat_to_pr <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>nat_to_pr <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="free">key</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_def pr_conv_2_to_1_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_lm_4<span class="main">)</span>
  <span class="comment1">(* nat_to_pr n x = (nat_to_pr (c_fst (c_snd (c_fst key))) (nat_to_pr (c_snd (c_snd (c_fst key))) (c_snd key))) *)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-univ_for_pr_lm_4_1"><span class="command">lemma</span></span> univ_for_pr_lm_4_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span> <span class="main">⟹</span> univ_for_pr <span class="free">key</span> <span class="main">=</span> univ_for_pr <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>univ_for_pr <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="free">key</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_def pr_conv_2_to_1_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_lm_4 univ_for_pr_def pr_conv_2_to_1_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-univ_for_pr_lm_5"><span class="command">lemma</span></span> univ_for_pr_lm_5<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span> <span class="main">⟹</span> univ_for_pr <span class="free">key</span> <span class="main">=</span> c_pair <span class="main">(</span>univ_for_pr <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>univ_for_pr <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="free">key</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_def pr_conv_2_to_1_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_lm_5 c_f_pair_def univ_for_pr_def pr_conv_2_to_1_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-univ_for_pr_lm_6_1"><span class="command">lemma</span></span> univ_for_pr_lm_6_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span><span class="main">;</span> c_fst <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span><span class="main">⟧</span> <span class="main">⟹</span> univ_for_pr <span class="free">key</span> <span class="main">=</span> univ_for_pr <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="free">key</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_def pr_conv_2_to_1_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_lm_6 UnaryRecOp_def univ_for_pr_def pr_conv_2_to_1_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-univ_for_pr_lm_6_2"><span class="command">lemma</span></span> univ_for_pr_lm_6_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span><span class="main">;</span> c_fst <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span> <span class="main">=</span> Suc <span class="free">u</span><span class="main">⟧</span> <span class="main">⟹</span> univ_for_pr <span class="free">key</span> <span class="main">=</span> univ_for_pr
            <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
              <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="free">u</span> <span class="main">(</span>univ_for_pr <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">u</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span> <span class="main">=</span> Suc <span class="free">u</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="free">key</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_def pr_conv_2_to_1_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_pr_lm_6 UnaryRecOp_def univ_for_pr_def pr_conv_2_to_1_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_1_to_3_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-univ_for_pr_lm_6_3"><span class="command">lemma</span></span> univ_for_pr_lm_6_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span><span class="main">;</span> c_fst <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">⟧</span> <span class="main">⟹</span> univ_for_pr <span class="free">key</span> <span class="main">=</span> univ_for_pr
            <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
              <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">(</span>univ_for_pr <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> 
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?u</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span> <span class="main">=</span> Suc <span class="var">?u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="free">key</span> <span class="main">=</span> univ_for_pr
            <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
              <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="var">?u</span> <span class="main">(</span>univ_for_pr <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?u</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> univ_for_pr_lm_6_2<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-g_comp_lm_0"><span class="command">lemma</span></span> g_comp_lm_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span><span class="main">;</span> c_is_sub_fun <span class="free">ls</span> univ_for_pr<span class="main">;</span> g_comp <span class="free">ls</span> <span class="free">key</span> <span class="main">≠</span> <span class="free">ls</span><span class="main">⟧</span> <span class="main">⟹</span> g_comp <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">(</span>univ_for_pr <span class="free">key</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="free">ls</span> univ_for_pr"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"g_comp <span class="free">ls</span> <span class="free">key</span> <span class="main">≠</span> <span class="free">ls</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">key</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">key</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?m</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?n</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?m1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_fst <span class="var">?m</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?m2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?m</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?k1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?m2</span> <span class="var">?x</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="var">?k1</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> A1_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="var">?k1</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"g_comp <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_comp_def<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="free">ls</span> <span class="var">?k1</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">=</span> univ_for_pr <span class="var">?k1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_is_sub_fun_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?k2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?m1</span> <span class="var">?y</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="var">?k2</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> A3_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="var">?k2</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"g_comp <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_comp_def Let_def<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="free">ls</span> <span class="var">?k2</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 S3 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?z</span> <span class="main">=</span> univ_for_pr <span class="var">?k2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_is_sub_fun_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?k2</span> <span class="main">=</span> c_pair <span class="var">?m1</span> <span class="main">(</span>univ_for_pr <span class="var">?k1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S4 S5 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?z</span> <span class="main">=</span> univ_for_pr <span class="main">(</span>c_pair <span class="var">?m1</span> <span class="main">(</span>univ_for_pr <span class="var">?k1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 S6 <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?z</span> <span class="main">=</span> univ_for_pr <span class="free">key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_lm_4_1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S3 S7 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_comp_def Let_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-g_comp_lm_1"><span class="command">lemma</span></span> g_comp_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span><span class="main">;</span> c_is_sub_fun <span class="free">ls</span> univ_for_pr<span class="main">⟧</span> <span class="main">⟹</span> c_is_sub_fun <span class="main">(</span>g_comp <span class="free">ls</span> <span class="free">key</span><span class="main">)</span> univ_for_pr"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="free">ls</span> univ_for_pr"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"g_comp <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> <span class="free">ls</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="main">(</span>g_comp <span class="free">ls</span> <span class="free">key</span><span class="main">)</span> univ_for_pr"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>  
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"g_comp <span class="free">ls</span> <span class="free">key</span> <span class="main">≠</span> <span class="free">ls</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 A2 this <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"g_comp <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">(</span>univ_for_pr <span class="free">key</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> g_comp_lm_0<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="main">(</span>g_comp <span class="free">ls</span> <span class="free">key</span><span class="main">)</span> univ_for_pr"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_is_sub_fun_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-g_pair_lm_0"><span class="command">lemma</span></span> g_pair_lm_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span><span class="main">;</span> c_is_sub_fun <span class="free">ls</span> univ_for_pr<span class="main">;</span> g_pair <span class="free">ls</span> <span class="free">key</span> <span class="main">≠</span> <span class="free">ls</span><span class="main">⟧</span> <span class="main">⟹</span> g_pair <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">(</span>univ_for_pr <span class="free">key</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="free">ls</span> univ_for_pr"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"g_pair <span class="free">ls</span> <span class="free">key</span> <span class="main">≠</span> <span class="free">ls</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">key</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">key</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?m</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?n</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?m1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_fst <span class="var">?m</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?m2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?m</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?k1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?m1</span> <span class="var">?x</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="var">?k1</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> A1_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="var">?k1</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"g_pair <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_pair_def<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="free">ls</span> <span class="var">?k1</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?y1</span> <span class="main">=</span> univ_for_pr <span class="var">?k1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_is_sub_fun_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?k2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?m2</span> <span class="var">?x</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="var">?k2</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> A3_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="var">?k2</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"g_pair <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_pair_def Let_def<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="free">ls</span> <span class="var">?k2</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 S3 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?y2</span> <span class="main">=</span> univ_for_pr <span class="var">?k2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_is_sub_fun_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?y1</span> <span class="var">?y2</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> S2 S4 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?z</span> <span class="main">=</span> c_pair <span class="main">(</span>univ_for_pr <span class="var">?k1</span><span class="main">)</span> <span class="main">(</span>univ_for_pr <span class="var">?k2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 S5 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?z</span> <span class="main">=</span> univ_for_pr <span class="free">key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_lm_5<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S3 S6 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_pair_def Let_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-g_pair_lm_1"><span class="command">lemma</span></span> g_pair_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span><span class="main">;</span> c_is_sub_fun <span class="free">ls</span> univ_for_pr<span class="main">⟧</span> <span class="main">⟹</span> c_is_sub_fun <span class="main">(</span>g_pair <span class="free">ls</span> <span class="free">key</span><span class="main">)</span> univ_for_pr"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="free">ls</span> univ_for_pr"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"g_pair <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> <span class="free">ls</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="main">(</span>g_pair <span class="free">ls</span> <span class="free">key</span><span class="main">)</span> univ_for_pr"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>  
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"g_pair <span class="free">ls</span> <span class="free">key</span> <span class="main">≠</span> <span class="free">ls</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 A2 this <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"g_pair <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">(</span>univ_for_pr <span class="free">key</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> g_pair_lm_0<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="main">(</span>g_pair <span class="free">ls</span> <span class="free">key</span><span class="main">)</span> univ_for_pr"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_is_sub_fun_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-g_rec_lm_0"><span class="command">lemma</span></span> g_rec_lm_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span><span class="main">;</span> c_is_sub_fun <span class="free">ls</span> univ_for_pr<span class="main">;</span> g_rec <span class="free">ls</span> <span class="free">key</span> <span class="main">≠</span> <span class="free">ls</span><span class="main">⟧</span> <span class="main">⟹</span> g_rec <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">(</span>univ_for_pr <span class="free">key</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="free">ls</span> univ_for_pr"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"g_rec <span class="free">ls</span> <span class="free">key</span> <span class="main">≠</span> <span class="free">ls</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">key</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">key</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?m</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?n</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?m1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_fst <span class="var">?m</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?m2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?m</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_fst <span class="var">?x</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="var">?x</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> A1_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?y1</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?k1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?m1</span> <span class="var">?x1</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> S1_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="var">?k1</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="var">?k1</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> A1_1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"g_rec <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_rec_def<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?v</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="free">ls</span> <span class="var">?k1</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A2 S1_1 <span class="keyword1"><span class="command">have</span></span> S1_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">=</span> univ_for_pr <span class="var">?k1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_is_sub_fun_lm_1<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A1 A1_1 S1_2 <span class="keyword1"><span class="command">have</span></span> S1_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">=</span> univ_for_pr <span class="free">key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_lm_6_1<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A1_1 S1_1 S1_3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_rec_def Let_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?y1</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> A2_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?y1</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="var">?y1</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?k2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> S2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="var">?k2</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="var">?k2</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> A2_1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"g_rec <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_rec_def Let_def<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?t1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="free">ls</span> <span class="var">?k2</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A2 S2_1 <span class="keyword1"><span class="command">have</span></span> S2_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?t1</span> <span class="main">=</span> univ_for_pr <span class="var">?k2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_is_sub_fun_lm_1<span class="main">)</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?t2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?t1</span><span class="main">)</span> <span class="var">?x1</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?k3</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?m2</span> <span class="var">?t2</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> S2_3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="var">?k3</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="var">?k3</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> A2_1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"g_rec <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_rec_def Let_def<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?u</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="free">ls</span> <span class="var">?k3</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A2 S2_3 <span class="keyword1"><span class="command">have</span></span> S2_4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?u</span> <span class="main">=</span> univ_for_pr <span class="var">?k3</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_is_sub_fun_lm_1<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> S2_4 S2_2 <span class="keyword1"><span class="command">have</span></span> S2_5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?u</span> <span class="main">=</span> univ_for_pr <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="main">(</span>univ_for_pr <span class="var">?k2</span><span class="main">)</span><span class="main">)</span> <span class="var">?x1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> A1 A2_1 S2_5 <span class="keyword1"><span class="command">have</span></span> S2_6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?u</span> <span class="main">=</span> univ_for_pr <span class="free">key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_lm_6_3<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A2_1 S2_1 S2_3 S2_6 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_rec_def Let_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-g_rec_lm_1"><span class="command">lemma</span></span> g_rec_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span><span class="main">;</span> c_is_sub_fun <span class="free">ls</span> univ_for_pr<span class="main">⟧</span> <span class="main">⟹</span> c_is_sub_fun <span class="main">(</span>g_rec <span class="free">ls</span> <span class="free">key</span><span class="main">)</span> univ_for_pr"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="free">ls</span> univ_for_pr"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"g_rec <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> <span class="free">ls</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="main">(</span>g_rec <span class="free">ls</span> <span class="free">key</span><span class="main">)</span> univ_for_pr"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>  
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"g_rec <span class="free">ls</span> <span class="free">key</span> <span class="main">≠</span> <span class="free">ls</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 A2 this <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"g_rec <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">(</span>univ_for_pr <span class="free">key</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> g_rec_lm_0<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="main">(</span>g_rec <span class="free">ls</span> <span class="free">key</span><span class="main">)</span> univ_for_pr"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_is_sub_fun_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-g_step_lm_0"><span class="command">lemma</span></span> g_step_lm_0<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> g_step <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">0</span><span class="main">)</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_step_def<span class="main">)</span>

<span class="keyword1" id="PRecUnGr-g_step_lm_1"><span class="command">lemma</span></span> g_step_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⟹</span> g_step <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">(</span>Suc <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_step_def Let_def<span class="main">)</span>

<span class="keyword1" id="PRecUnGr-g_step_lm_2"><span class="command">lemma</span></span> g_step_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">⟹</span> g_step <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_step_def Let_def<span class="main">)</span>

<span class="keyword1" id="PRecUnGr-g_step_lm_3"><span class="command">lemma</span></span> g_step_lm_3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">3</span> <span class="main">⟹</span> g_step <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_step_def Let_def<span class="main">)</span>

<span class="keyword1" id="PRecUnGr-g_step_lm_4"><span class="command">lemma</span></span> g_step_lm_4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span> <span class="main">⟹</span> g_step <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> g_comp <span class="free">ls</span> <span class="free">key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_step_def<span class="main">)</span>

<span class="keyword1" id="PRecUnGr-g_step_lm_5"><span class="command">lemma</span></span> g_step_lm_5<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span> <span class="main">⟹</span> g_step <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> g_pair <span class="free">ls</span> <span class="free">key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_step_def<span class="main">)</span>

<span class="keyword1" id="PRecUnGr-g_step_lm_6"><span class="command">lemma</span></span> g_step_lm_6<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="free">key</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span> <span class="main">⟹</span> g_step <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> g_rec <span class="free">ls</span> <span class="free">key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_step_def<span class="main">)</span>

<span class="keyword1" id="PRecUnGr-g_step_lm_7"><span class="command">lemma</span></span> g_step_lm_7<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="free">ls</span> univ_for_pr <span class="main">⟹</span> c_is_sub_fun <span class="main">(</span>g_step <span class="free">ls</span> <span class="free">key</span><span class="main">)</span> univ_for_pr"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="free">ls</span> univ_for_pr"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">key</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">key</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="var">?n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1_1<span class="main">:</span> <span class="quoted"><span class="quoted">"g_step <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">0</span><span class="main">)</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> g_step_lm_0<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> S1_2<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="free">key</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> univ_for_pr_lm_0<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1_3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="main">(</span>c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">(</span>univ_for_pr <span class="free">key</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span><span class="main">)</span> univ_for_pr"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_is_sub_fun_lm_2<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> S1_3 S1_1 S1_2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"g_step <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">(</span>Suc <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> g_step_lm_1<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> S2_2<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="free">key</span> <span class="main">=</span> Suc <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> univ_for_pr_lm_1<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2_3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="main">(</span>c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">(</span>univ_for_pr <span class="free">key</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span><span class="main">)</span> univ_for_pr"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_is_sub_fun_lm_2<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> S2_3 S2_1 S2_2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"g_step <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> g_step_lm_2<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> S2_2<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="free">key</span> <span class="main">=</span> c_fst <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> univ_for_pr_lm_2<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2_3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="main">(</span>c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">(</span>univ_for_pr <span class="free">key</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span><span class="main">)</span> univ_for_pr"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_is_sub_fun_lm_2<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> S2_3 S2_1 S2_2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">3</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">3</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"g_step <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> g_step_lm_3<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> S2_2<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="free">key</span> <span class="main">=</span> c_snd <span class="main">(</span>c_snd <span class="free">key</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> univ_for_pr_lm_3<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2_3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="main">(</span>c_cons <span class="main">(</span>c_pair <span class="free">key</span> <span class="main">(</span>univ_for_pr <span class="free">key</span><span class="main">)</span><span class="main">)</span> <span class="free">ls</span><span class="main">)</span> univ_for_pr"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_is_sub_fun_lm_2<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> S2_3 S2_1 S2_2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">4</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"g_step <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> g_comp <span class="free">ls</span> <span class="free">key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> g_step_lm_4<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A A1 S2_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_comp_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">5</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">5</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"g_step <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> g_pair <span class="free">ls</span> <span class="free">key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> g_step_lm_5<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A A1 S2_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_pair_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">6</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"g_step <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> g_rec <span class="free">ls</span> <span class="free">key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> g_step_lm_6<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A A1 S2_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_rec_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> <span class="var">?n1</span><span class="main">=</span><span class="main">1</span> <span class="main">∨</span> <span class="var">?n1</span><span class="main">=</span><span class="numeral">2</span> <span class="main">∨</span> <span class="var">?n1</span><span class="main">=</span><span class="numeral">3</span> <span class="main">∨</span> <span class="var">?n1</span><span class="main">=</span><span class="numeral">4</span> <span class="main">∨</span> <span class="var">?n1</span><span class="main">=</span><span class="numeral">5</span> <span class="main">∨</span> <span class="var">?n1</span><span class="main">=</span><span class="numeral">6</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> mod7_lm<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S1 S2 S3 S4 S5 S6 S7 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> pr_gr_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="main">(</span>pr_gr <span class="free">x</span><span class="main">)</span> univ_for_pr"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">x</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_gr_at_0 c_is_sub_fun_def c_assoc_have_key_df<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_gr_at_Suc<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_step_lm_7<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="PRecUnGr-comp_next"><span class="command">lemma</span></span> comp_next<span class="main">:</span> <span class="quoted"><span class="quoted">"g_comp <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> <span class="free">ls</span> <span class="main">∨</span> c_tl <span class="main">(</span>g_comp <span class="free">ls</span> <span class="free">key</span><span class="main">)</span> <span class="main">=</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_comp_def Let_def<span class="main">)</span>
<span class="keyword1" id="PRecUnGr-pair_next"><span class="command">lemma</span></span> pair_next<span class="main">:</span> <span class="quoted"><span class="quoted">"g_pair <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> <span class="free">ls</span> <span class="main">∨</span> c_tl <span class="main">(</span>g_pair <span class="free">ls</span> <span class="free">key</span><span class="main">)</span> <span class="main">=</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_pair_def Let_def<span class="main">)</span>
<span class="keyword1" id="PRecUnGr-rec_next"><span class="command">lemma</span></span> rec_next<span class="main">:</span> <span class="quoted"><span class="quoted">"g_rec <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> <span class="free">ls</span> <span class="main">∨</span> c_tl <span class="main">(</span>g_rec <span class="free">ls</span> <span class="free">key</span><span class="main">)</span> <span class="main">=</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_rec_def Let_def<span class="main">)</span>

<span class="keyword1" id="PRecUnGr-step_next"><span class="command">lemma</span></span> step_next<span class="main">:</span> <span class="quoted"><span class="quoted">"g_step <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> <span class="free">ls</span> <span class="main">∨</span> c_tl <span class="main">(</span>g_step <span class="free">ls</span> <span class="free">key</span><span class="main">)</span> <span class="main">=</span> <span class="free">ls</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_step_def comp_next pair_next rec_next Let_def<span class="main">)</span>
<span class="comment1">(* (* apply(simp add: g_step_def g_comp_def g_pair_def g_rec_def Let_def) *)*)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="PRecUnGr-lm1"><span class="command">lemma</span></span> lm1<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span> <span class="main">=</span> pr_gr <span class="free">x</span> <span class="main">∨</span> c_tl <span class="main">(</span>pr_gr <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> pr_gr <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_gr_at_Suc step_next<span class="main">)</span>

<span class="keyword1" id="PRecUnGr-c_assoc_have_key_pos"><span class="command">lemma</span></span> c_assoc_have_key_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="free">x</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">ls</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="free">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ls</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="free">ls</span> <span class="free">x</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_have_key_df<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">ls</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">ls</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">ls</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-lm2"><span class="command">lemma</span></span> lm2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>c_tl <span class="free">ls</span><span class="main">)</span> <span class="free">key</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> c_assoc_have_key <span class="free">ls</span> <span class="free">key</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>c_tl <span class="free">ls</span><span class="main">)</span> <span class="free">key</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_tl <span class="free">ls</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_assoc_have_key_pos<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_tl <span class="free">ls</span> <span class="main">≤</span> <span class="free">ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_tl_le<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ls</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_have_key_lm_1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-lm3"><span class="command">lemma</span></span> lm3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="free">x</span><span class="main">)</span> <span class="free">key</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="free">key</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="free">x</span><span class="main">)</span> <span class="free">key</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span> <span class="main">=</span> pr_gr <span class="free">x</span> <span class="main">∨</span> c_tl <span class="main">(</span>pr_gr <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> pr_gr <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> lm1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span> <span class="main">=</span> pr_gr <span class="free">x</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_tl <span class="main">(</span>pr_gr <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> pr_gr <span class="free">x</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"c_tl <span class="main">(</span>pr_gr <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> pr_gr <span class="free">x</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"c_tl <span class="var">?ls</span> <span class="main">=</span> <span class="main">_</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>c_tl <span class="var">?ls</span><span class="main">)</span> <span class="free">key</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="var">?ls</span> <span class="free">key</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> lm2<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-lm4"><span class="command">lemma</span></span> lm4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="free">x</span><span class="main">)</span> <span class="free">key</span> <span class="main">=</span> <span class="main">0</span><span class="main">;</span> <span class="main">0</span> <span class="main">≤</span> <span class="free">y</span><span class="main">⟧</span> <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="free">y</span><span class="main">)</span><span class="main">)</span> <span class="free">key</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">induct_tac</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">y</span></span></span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lm3<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="PRecUnGr-lm5"><span class="command">lemma</span></span> lm5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="free">x</span><span class="main">)</span> <span class="free">key</span> <span class="main">=</span> <span class="main">0</span><span class="main">;</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">y</span> <span class="main">⟧</span> <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="free">y</span><span class="main">)</span> <span class="free">key</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="free">x</span><span class="main">)</span> <span class="free">key</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main">-</span><span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="var">?z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">=</span> <span class="free">x</span> <span class="main">+</span> <span class="var">?z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 S1 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="var">?z</span><span class="main">)</span><span class="main">)</span> <span class="free">key</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> lm4<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-loc_upb_lm_1"><span class="command">lemma</span></span> loc_upb_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> <span class="main">(</span>c_fst <span class="free">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_fst_at_0<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="PRecUnGr-loc_upb_lm_2"><span class="command">lemma</span></span> loc_upb_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">⟹</span> c_snd <span class="free">n</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> c_fst <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="main">≤</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_fst_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">&gt;</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> S4 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_snd_less_arg<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-loc_upb_lm_2_0"><span class="command">lemma</span></span> loc_upb_lm_2_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span> <span class="main">⟶</span> c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S0<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">n</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_upb_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">≤</span>  c_snd <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_fst_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-loc_upb_lm_2_2"><span class="command">lemma</span></span> loc_upb_lm_2_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span> <span class="main">⟶</span> c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S0<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">n</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_upb_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">≤</span>  c_snd <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_snd_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-loc_upb_lm_2_3"><span class="command">lemma</span></span> loc_upb_lm_2_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span> <span class="main">⟶</span> c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S0<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">n</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_upb_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">≤</span>  c_snd <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_fst_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-loc_upb_lm_2_4"><span class="command">lemma</span></span> loc_upb_lm_2_4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span> <span class="main">⟶</span> c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S0<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">n</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_upb_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">≤</span>  c_snd <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_snd_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-loc_upb_lm_2_5"><span class="command">lemma</span></span> loc_upb_lm_2_5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span> <span class="main">⟶</span> c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S0<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">n</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_upb_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">≤</span>  c_snd <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_fst_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-loc_upb_lm_2_6"><span class="command">lemma</span></span> loc_upb_lm_2_6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span> <span class="main">⟶</span> c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S0<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">n</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_upb_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">≤</span>  c_snd <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_snd_le_arg<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-loc_upb_lm_2_7"><span class="command">lemma</span></span> loc_upb_lm_2_7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">y2</span> <span class="main">=</span> <span class="free">y1</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">;</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">y1</span><span class="main">;</span> <span class="free">x1</span> <span class="main">=</span> c_snd <span class="free">x</span><span class="main">;</span> <span class="free">y1</span> <span class="main">=</span> c_fst <span class="free">x</span><span class="main">⟧</span> <span class="main">⟹</span> c_pair <span class="free">y2</span> <span class="free">x1</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y2</span> <span class="main">=</span> <span class="free">y1</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">y1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x1</span> <span class="main">=</span> c_snd <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y1</span> <span class="main">=</span> c_fst <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y2</span> <span class="main">&lt;</span> <span class="free">y1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">y2</span> <span class="free">x1</span> <span class="main">&lt;</span> c_pair <span class="free">y1</span> <span class="free">x1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_strict_mono1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A3 A4 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">y1</span> <span class="free">x1</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S2 S3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">y2</span> <span class="free">x1</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">function</span></span> <span class="entity">loc_upb</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">loc_upb</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="main">(</span>
     <span class="keyword1">let</span> <span class="bound">n1</span> <span class="main">=</span> <span class="main">(</span>c_fst <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="keyword1">in</span>
       <span class="keyword1">if</span> <span class="bound">n1</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span> <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">0</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span> <span class="keyword1">else</span>
       <span class="keyword1">if</span> <span class="bound">n1</span> <span class="main">=</span> <span class="main">1</span> <span class="keyword1">then</span> <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">0</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span> <span class="keyword1">else</span>
       <span class="keyword1">if</span> <span class="bound">n1</span> <span class="main">=</span> <span class="numeral">2</span> <span class="keyword1">then</span> <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">0</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span> <span class="keyword1">else</span>
       <span class="keyword1">if</span> <span class="bound">n1</span> <span class="main">=</span> <span class="numeral">3</span> <span class="keyword1">then</span> <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">0</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span> <span class="keyword1">else</span>
       <span class="keyword1">if</span> <span class="bound">n1</span> <span class="main">=</span> <span class="numeral">4</span> <span class="keyword1">then</span> <span class="main">(</span>
       <span class="keyword1">let</span> <span class="bound">m</span> <span class="main">=</span> c_snd <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">;</span> <span class="bound">m1</span> <span class="main">=</span> c_fst <span class="bound">m</span><span class="main">;</span> <span class="bound">m2</span> <span class="main">=</span> c_snd <span class="bound">m</span><span class="main">;</span>
       <span class="bound">y</span> <span class="main">=</span> c_assoc_value <span class="main">(</span>pr_gr <span class="main">(</span><span class="free">loc_upb</span> <span class="bound">m2</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">m2</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="keyword1">in</span>
         <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">(</span><span class="free">loc_upb</span> <span class="bound">m2</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> <span class="free">loc_upb</span> <span class="bound">m1</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>
       <span class="main">)</span> <span class="keyword1">else</span>
       <span class="keyword1">if</span> <span class="bound">n1</span> <span class="main">=</span> <span class="numeral">5</span> <span class="keyword1">then</span> <span class="main">(</span>
       <span class="keyword1">let</span> <span class="bound">m</span> <span class="main">=</span> c_snd <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">;</span> <span class="bound">m1</span> <span class="main">=</span> c_fst <span class="bound">m</span><span class="main">;</span> <span class="bound">m2</span> <span class="main">=</span> c_snd <span class="bound">m</span> <span class="keyword1">in</span>
         <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">(</span><span class="free">loc_upb</span> <span class="bound">m1</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> <span class="free">loc_upb</span> <span class="bound">m2</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>
       <span class="main">)</span> <span class="keyword1">else</span>
       <span class="keyword1">if</span> <span class="bound">n1</span> <span class="main">=</span> <span class="numeral">6</span> <span class="keyword1">then</span> <span class="main">(</span>
       <span class="keyword1">let</span> <span class="bound">m</span> <span class="main">=</span> c_snd <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">;</span> <span class="bound">m1</span> <span class="main">=</span> c_fst <span class="bound">m</span><span class="main">;</span> <span class="bound">m2</span> <span class="main">=</span> c_snd <span class="bound">m</span><span class="main">;</span> <span class="bound">y1</span> <span class="main">=</span> c_fst <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">;</span> <span class="bound">x1</span> <span class="main">=</span> c_snd <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">in</span>
         <span class="keyword1">if</span> <span class="bound">y1</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span> <span class="main">(</span>
           <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">(</span><span class="free">loc_upb</span> <span class="bound">m1</span> <span class="bound">x1</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>
         <span class="main">)</span> <span class="keyword1">else</span> <span class="main">(</span>
           <span class="keyword1">let</span> <span class="bound">y2</span> <span class="main">=</span> <span class="bound">y1</span><span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">;</span>
             <span class="bound">t1</span> <span class="main">=</span> c_assoc_value <span class="main">(</span>pr_gr <span class="main">(</span><span class="free">loc_upb</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">(</span>c_pair <span class="bound">y2</span> <span class="bound">x1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">(</span>c_pair <span class="bound">y2</span> <span class="bound">x1</span><span class="main">)</span><span class="main">)</span><span class="main">;</span> <span class="bound">t2</span> <span class="main">=</span> c_pair <span class="main">(</span>c_pair <span class="bound">y2</span> <span class="bound">t1</span><span class="main">)</span> <span class="bound">x1</span> <span class="keyword1">in</span>
             <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">(</span><span class="free">loc_upb</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">(</span>c_pair <span class="bound">y2</span> <span class="bound">x1</span><span class="main">)</span> <span class="main">+</span> <span class="free">loc_upb</span> <span class="bound">m2</span> <span class="bound">t2</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>
         <span class="main">)</span>
       <span class="main">)</span>
       <span class="keyword1">else</span> <span class="main">0</span>
 <span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">termination</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">relation</span> <span class="quoted"><span class="quoted">"measure <span class="main">(</span><span class="main">λ</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span><span class="main">)</span> <span class="keyword1">&lt;*lex*&gt;</span> measure <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="bound">n</span><span class="main">)</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_upb_lm_2_0 loc_upb_lm_2_2 loc_upb_lm_2_3 loc_upb_lm_2_4 loc_upb_lm_2_5 loc_upb_lm_2_6 loc_upb_lm_2_7<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">lex_p</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>nat <span class="main">×</span> nat<span class="main">)</span> <span class="main">×</span> nat <span class="main">×</span> nat<span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">lex_p</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>measure <span class="main">(</span><span class="main">λ</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">m</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">&lt;*lex*&gt;</span> <span class="main">(</span>measure <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="PRecUnGr-wf_lex_p"><span class="command">lemma</span></span> wf_lex_p<span class="main">:</span> <span class="quoted"><span class="quoted">"wf<span class="main">(</span>lex_p<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lex_p_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="PRecUnGr-lex_p_eq"><span class="command">lemma</span></span> lex_p_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">n'</span><span class="main">,</span><span class="free">x'</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free">n</span><span class="main">,</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> lex_p <span class="main">=</span> <span class="main">(</span><span class="free">n'</span><span class="main">&lt;</span><span class="free">n</span> <span class="main">∨</span> <span class="free">n'</span><span class="main">=</span><span class="free">n</span> <span class="main">∧</span> <span class="free">x'</span><span class="main">&lt;</span><span class="free">x</span><span class="main">)</span> "</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lex_p_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="PRecUnGr-loc_upb_lex_0"><span class="command">lemma</span></span> loc_upb_lex_0<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?key</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">n</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?s</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?key</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?ls</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"pr_gr <span class="var">?s</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"loc_upb <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="var">?s</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> g_step <span class="main">(</span>pr_gr <span class="var">?s</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="var">?s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_gr_at_Suc<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"g_step <span class="var">?ls</span> <span class="var">?key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="var">?key</span> <span class="main">0</span><span class="main">)</span> <span class="var">?ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_step_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="var">?key</span> <span class="main">0</span><span class="main">)</span> <span class="var">?ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_lm_1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-loc_upb_lex_1"><span class="command">lemma</span></span> loc_upb_lex_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?key</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">n</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?s</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?key</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?ls</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"pr_gr <span class="var">?s</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"loc_upb <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="var">?s</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> g_step <span class="main">(</span>pr_gr <span class="var">?s</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="var">?s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_gr_at_Suc<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"g_step <span class="var">?ls</span> <span class="var">?key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="var">?key</span> <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="var">?ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_step_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="var">?key</span> <span class="main">(</span>Suc <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="var">?ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_lm_1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-loc_upb_lex_2"><span class="command">lemma</span></span> loc_upb_lex_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?key</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">n</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?s</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?key</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?ls</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"pr_gr <span class="var">?s</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"loc_upb <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="var">?s</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> g_step <span class="main">(</span>pr_gr <span class="var">?s</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="var">?s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_gr_at_Suc<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"g_step <span class="var">?ls</span> <span class="var">?key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="var">?key</span> <span class="main">(</span>c_fst <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="var">?ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_step_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="var">?key</span> <span class="main">(</span>c_fst <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="var">?ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_lm_1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-loc_upb_lex_3"><span class="command">lemma</span></span> loc_upb_lex_3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">3</span> <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">3</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?key</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">n</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?s</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?key</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?ls</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"pr_gr <span class="var">?s</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"loc_upb <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="var">?s</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> g_step <span class="main">(</span>pr_gr <span class="var">?s</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="var">?s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_gr_at_Suc<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"g_step <span class="var">?ls</span> <span class="var">?key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="var">?key</span> <span class="main">(</span>c_snd <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="var">?ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_step_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="var">?key</span> <span class="main">(</span>c_snd <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="var">?ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_lm_1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-loc_upb_lex_4"><span class="command">lemma</span></span> loc_upb_lex_4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">⋀</span> <span class="bound">n'</span> <span class="bound">x'</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">n'</span><span class="main">,</span><span class="bound">x'</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free">n</span><span class="main">,</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> lex_p <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span><span class="main">;</span>
                       c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span><span class="main">⟧</span> <span class="main">⟹</span>
                       c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n'</span> <span class="bound">x'</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">n'</span><span class="main">,</span><span class="bound">x'</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free">n</span><span class="main">,</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> lex_p <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?key</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">n</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?m1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?m2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">upb1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">upb1</span> <span class="main">=</span> loc_upb <span class="var">?m2</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> m2_lt_n<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?m2</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_upb_lm_2_2<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> M2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="var">?m2</span><span class="main">,</span> <span class="free">x</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free">n</span><span class="main">,</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> lex_p"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lex_p_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 upb1_def <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="skolem">upb1</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> M2 <span class="keyword1"><span class="command">have</span></span> M2'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="var">?m2</span><span class="main">,</span> <span class="free">x</span><span class="main">)</span><span class="main">,</span> <span class="free">n</span><span class="main">,</span> <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> measure <span class="main">(</span><span class="main">λ</span><span class="bound">m</span><span class="main">.</span> <span class="bound">m</span><span class="main">)</span> <span class="keyword1">&lt;*lex*&gt;</span> measure <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lex_p_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="main">(</span>pr_gr <span class="skolem">upb1</span><span class="main">)</span> univ_for_pr"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_gr_1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> T1 S1 <span class="keyword1"><span class="command">have</span></span> T2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="main">(</span>pr_gr <span class="skolem">upb1</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> univ_for_pr <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_is_sub_fun_lm_1<span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> c_assoc_value <span class="main">(</span>pr_gr <span class="skolem">upb1</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> T2 y_def <span class="keyword1"><span class="command">have</span></span> T3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> univ_for_pr <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">upb2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">upb2</span> <span class="main">=</span> loc_upb <span class="var">?m1</span> <span class="skolem">y</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?m1</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_upb_lm_2_0<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> M1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="var">?m1</span><span class="main">,</span> <span class="skolem">y</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free">n</span><span class="main">,</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> lex_p"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lex_p_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="var">?m1</span> <span class="skolem">y</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?m1</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> M1 <span class="keyword1"><span class="command">have</span></span> M1'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="var">?m1</span><span class="main">,</span> <span class="skolem">y</span><span class="main">)</span><span class="main">,</span> <span class="free">n</span><span class="main">,</span> <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> measure <span class="main">(</span><span class="main">λ</span><span class="bound">m</span><span class="main">.</span> <span class="bound">m</span><span class="main">)</span> <span class="keyword1">&lt;*lex*&gt;</span> measure <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lex_p_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 upb1_def <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="skolem">upb1</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S2 upb2_def <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="skolem">upb2</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?m1</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?s</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?key</span> <span class="main">(</span><span class="skolem">upb1</span> <span class="main">+</span> <span class="skolem">upb2</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?ls</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"pr_gr <span class="var">?s</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?sum_upb</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">upb1</span> <span class="main">+</span><span class="skolem">upb2</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?m1</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_upb_lm_2_0<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="var">?m1</span><span class="main">,</span> <span class="free">x</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free">n</span><span class="main">,</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> lex_p"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lex_p_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> M1''<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="var">?m1</span><span class="main">,</span> <span class="free">x</span><span class="main">)</span><span class="main">,</span> <span class="free">n</span><span class="main">,</span> <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> measure <span class="main">(</span><span class="main">λ</span><span class="bound">m</span><span class="main">.</span> <span class="bound">m</span><span class="main">)</span> <span class="keyword1">&lt;*lex*&gt;</span> measure <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lex_p_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A2 M2' M1'' <span class="keyword1"><span class="command">have</span></span> S11<span class="main">:</span> <span class="quoted"><span class="quoted">"loc_upb <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">y</span> <span class="main">=</span> c_assoc_value <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span>
                               <span class="keyword1">in</span> <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span>
                                   <span class="main">(</span>loc_upb <span class="var">?m2</span> <span class="free">x</span> <span class="main">+</span> loc_upb <span class="var">?m1</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def<span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">upb</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">upb</span> <span class="main">=</span> loc_upb <span class="free">n</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> S11 y_def upb1_def upb2_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"loc_upb <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="var">?s</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> upb_def <span class="keyword1"><span class="command">have</span></span> S11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">upb</span> <span class="main">=</span> <span class="var">?s</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?sum_upb</span> <span class="main">≤</span> <span class="var">?s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> arg2_le_c_pair<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> upb1_le_s<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">upb1</span> <span class="main">≤</span> <span class="var">?s</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">upb1</span> <span class="main">≤</span> <span class="var">?sum_upb</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Nat.le_add1<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> S1 S7 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> upb2_le_s<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">upb2</span> <span class="main">≤</span> <span class="var">?s</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">upb2</span> <span class="main">≤</span> <span class="var">?sum_upb</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Nat.le_add2<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> S1 S7 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">have</span></span> S18<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="skolem">upb</span> <span class="main">=</span> g_comp <span class="var">?ls</span> <span class="var">?key</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> S11 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="skolem">upb</span> <span class="main">=</span> g_step <span class="main">(</span>pr_gr <span class="var">?s</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="var">?s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_gr_at_Suc<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"g_step <span class="var">?ls</span> <span class="var">?key</span> <span class="main">=</span> g_comp <span class="var">?ls</span> <span class="var">?key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_step_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">from</span></span> S3 upb1_le_s <span class="keyword1"><span class="command">have</span></span> S19<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="var">?ls</span> <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> lm5<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S4 upb2_le_s <span class="keyword1"><span class="command">have</span></span> S20<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="var">?ls</span> <span class="main">(</span>c_pair <span class="var">?m1</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> lm5<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> T_ls<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="var">?ls</span> univ_for_pr"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_gr_1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> T_ls S19 <span class="keyword1"><span class="command">have</span></span> T_ls2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="var">?ls</span> <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> univ_for_pr <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_is_sub_fun_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> T3 T_ls2 <span class="keyword1"><span class="command">have</span></span> T_y<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="var">?ls</span> <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> T_y  S19 S20 <span class="keyword1"><span class="command">have</span></span> S21<span class="main">:</span> <span class="quoted"><span class="quoted">"g_comp <span class="var">?ls</span> <span class="var">?key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="var">?key</span> <span class="main">(</span>c_assoc_value <span class="var">?ls</span> <span class="main">(</span>c_pair <span class="var">?m1</span> <span class="skolem">y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="var">?ls</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold</span> g_comp_def<span class="main">)</span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> loc_upb.simps <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S18 S21 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pr_gr <span class="skolem">upb</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="var">?key</span> <span class="main">(</span>c_assoc_value <span class="var">?ls</span> <span class="main">(</span>c_pair <span class="var">?m1</span> <span class="skolem">y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="var">?ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> upb_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="var">?key</span> <span class="main">(</span>c_assoc_value <span class="var">?ls</span> <span class="main">(</span>c_pair <span class="var">?m1</span> <span class="skolem">y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="var">?ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_lm_1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-loc_upb_lex_5"><span class="command">lemma</span></span> loc_upb_lex_5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">⋀</span> <span class="bound">n'</span> <span class="bound">x'</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">n'</span><span class="main">,</span><span class="bound">x'</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free">n</span><span class="main">,</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> lex_p <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span><span class="main">;</span>
                       c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span><span class="main">⟧</span> <span class="main">⟹</span>
                       c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n'</span> <span class="bound">x'</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">n'</span><span class="main">,</span><span class="bound">x'</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free">n</span><span class="main">,</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> lex_p <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">5</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?key</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">n</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?m1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?m2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?m1</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_upb_lm_2_3<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="var">?m1</span><span class="main">,</span> <span class="free">x</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free">n</span><span class="main">,</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> lex_p"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lex_p_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="var">?m1</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?m1</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?m2</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_upb_lm_2_4<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="var">?m2</span><span class="main">,</span> <span class="free">x</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free">n</span><span class="main">,</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> lex_p"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lex_p_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">upb1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">upb1</span> <span class="main">=</span> loc_upb <span class="var">?m1</span> <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">upb2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">upb2</span> <span class="main">=</span> loc_upb <span class="var">?m2</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> upb1_def S1 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="skolem">upb1</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?m1</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> upb2_def S2 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="skolem">upb2</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?sum_upb</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">upb1</span> <span class="main">+</span><span class="skolem">upb2</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">upb1</span> <span class="main">≤</span> <span class="var">?sum_upb</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Nat.le_add1<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">upb2</span> <span class="main">≤</span> <span class="var">?sum_upb</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Nat.le_add2<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?s</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_pair <span class="var">?key</span> <span class="var">?sum_upb</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?sum_upb</span> <span class="main">≤</span> <span class="var">?s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> arg2_le_c_pair<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S5 S7 <span class="keyword1"><span class="command">have</span></span> S8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">upb1</span> <span class="main">≤</span> <span class="var">?s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S6 S7 <span class="keyword1"><span class="command">have</span></span> S9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">upb2</span> <span class="main">≤</span> <span class="var">?s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?ls</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"pr_gr <span class="var">?s</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 upb1_def upb2_def <span class="keyword1"><span class="command">have</span></span> S10<span class="main">:</span> <span class="quoted"><span class="quoted">"loc_upb <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="var">?s</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def<span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">upb</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">upb</span> <span class="main">=</span> loc_upb <span class="free">n</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> upb_def S10 <span class="keyword1"><span class="command">have</span></span> S11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">upb</span> <span class="main">=</span> <span class="var">?s</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S11 <span class="keyword1"><span class="command">have</span></span> S12<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="skolem">upb</span> <span class="main">=</span> g_step <span class="main">(</span>pr_gr <span class="var">?s</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="var">?s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_gr_at_Suc<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S8 S10 upb_def <span class="keyword1"><span class="command">have</span></span> S13<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">upb1</span> <span class="main">≤</span> <span class="skolem">upb</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S9 S10 upb_def <span class="keyword1"><span class="command">have</span></span> S14<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">upb2</span> <span class="main">≤</span> <span class="skolem">upb</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 S13 <span class="keyword1"><span class="command">have</span></span> S15<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="skolem">upb</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?m1</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> lm5<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S4 S14 <span class="keyword1"><span class="command">have</span></span> S16<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="skolem">upb</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> lm5<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> S17<span class="main">:</span> <span class="quoted"><span class="quoted">"g_step <span class="var">?ls</span> <span class="var">?key</span> <span class="main">=</span> g_pair <span class="var">?ls</span> <span class="var">?key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_step_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S12 S17 <span class="keyword1"><span class="command">have</span></span> S18<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="skolem">upb</span> <span class="main">=</span> g_pair <span class="var">?ls</span> <span class="var">?key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S3 S8 <span class="keyword1"><span class="command">have</span></span> S19<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="var">?ls</span> <span class="main">(</span>c_pair <span class="var">?m1</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> lm5<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S4 S9 <span class="keyword1"><span class="command">have</span></span> S20<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="var">?ls</span> <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> lm5<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="var">?ls</span> <span class="main">(</span>c_pair <span class="var">?m1</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="var">?ls</span> <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?y1</span> <span class="var">?y2</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> S19 S20 <span class="keyword1"><span class="command">have</span></span> S21<span class="main">:</span> <span class="quoted"><span class="quoted">"g_pair <span class="var">?ls</span> <span class="var">?key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="var">?key</span> <span class="var">?y</span><span class="main">)</span> <span class="var">?ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> g_pair_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S18 S21 <span class="keyword1"><span class="command">have</span></span> S22<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="skolem">upb</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="var">?key</span> <span class="var">?y</span><span class="main">)</span> <span class="var">?ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> upb_def S22 <span class="keyword1"><span class="command">have</span></span> S23<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="var">?key</span> <span class="var">?y</span><span class="main">)</span> <span class="var">?ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S23 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_lm_1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-loc_upb_6_z"><span class="command">lemma</span></span> loc_upb_6_z<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span><span class="numeral">6</span><span class="main">;</span> c_fst <span class="free">x</span> <span class="main">=</span> <span class="main">0</span><span class="main">⟧</span> <span class="main">⟹</span>
  loc_upb <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> c_pair <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>loc_upb <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def<span class="main">)</span>

<span class="keyword1" id="PRecUnGr-loc_upb_6"><span class="command">lemma</span></span> loc_upb_6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span><span class="numeral">6</span><span class="main">;</span> c_fst <span class="free">x</span> <span class="main">≠</span> <span class="main">0</span><span class="main">⟧</span> <span class="main">⟹</span> loc_upb <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span>
                              <span class="keyword1">let</span> <span class="bound">m</span> <span class="main">=</span> c_snd <span class="free">n</span><span class="main">;</span> <span class="bound">m1</span> <span class="main">=</span> c_fst <span class="bound">m</span><span class="main">;</span> <span class="bound">m2</span> <span class="main">=</span> c_snd <span class="bound">m</span><span class="main">;</span> <span class="bound">y1</span> <span class="main">=</span> c_fst <span class="free">x</span><span class="main">;</span> <span class="bound">x1</span> <span class="main">=</span> c_snd <span class="free">x</span><span class="main">;</span>
                              <span class="bound">y2</span> <span class="main">=</span> <span class="bound">y1</span> <span class="main">-</span> <span class="main">1</span><span class="main">;</span>
                              <span class="bound">t1</span> <span class="main">=</span> c_assoc_value <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="main">(</span>c_pair <span class="bound">y2</span> <span class="bound">x1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">n</span> <span class="main">(</span>c_pair <span class="bound">y2</span> <span class="bound">x1</span><span class="main">)</span><span class="main">)</span><span class="main">;</span>
                              <span class="bound">t2</span> <span class="main">=</span> c_pair <span class="main">(</span>c_pair <span class="bound">y2</span> <span class="bound">t1</span><span class="main">)</span> <span class="bound">x1</span> <span class="keyword1">in</span>
                                c_pair <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>loc_upb <span class="free">n</span> <span class="main">(</span>c_pair <span class="bound">y2</span> <span class="bound">x1</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>loc_upb <span class="bound">m2</span> <span class="bound">t2</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def<span class="main">)</span>

<span class="keyword1" id="PRecUnGr-loc_upb_lex_6"><span class="command">lemma</span></span> loc_upb_lex_6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">⋀</span> <span class="bound">n'</span> <span class="bound">x'</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">n'</span><span class="main">,</span><span class="bound">x'</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free">n</span><span class="main">,</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> lex_p <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span><span class="main">;</span>
                       c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span><span class="main">⟧</span> <span class="main">⟹</span>
                       c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n'</span> <span class="bound">x'</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">n'</span><span class="main">,</span><span class="bound">x'</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free">n</span><span class="main">,</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> lex_p <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">n</span> <span class="keyword1">mod</span> <span class="numeral">7</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?key</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">n</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?m1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?m2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="main">(</span>c_snd <span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">upb</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">upb</span> <span class="main">=</span> loc_upb <span class="free">n</span> <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?y1</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A2 A <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"loc_upb <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> c_pair <span class="var">?key</span> <span class="main">(</span>loc_upb <span class="var">?m1</span> <span class="main">(</span>c_snd <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_upb_6_z<span class="main">)</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">upb1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">upb1</span> <span class="main">=</span> loc_upb <span class="var">?m1</span> <span class="main">(</span>c_snd <span class="free">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> upb1_def S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"loc_upb <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> c_pair <span class="var">?key</span> <span class="skolem">upb1</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?s</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?key</span> <span class="skolem">upb1</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> pr_gr <span class="main">(</span>Suc <span class="var">?s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>Suc <span class="var">?s</span><span class="main">)</span> <span class="main">=</span> g_step <span class="main">(</span>pr_gr <span class="var">?s</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="var">?s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_gr_at_Suc<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> g_step <span class="main">(</span>pr_gr <span class="var">?s</span><span class="main">)</span> <span class="var">?key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?ls</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"pr_gr <span class="var">?s</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"g_step <span class="var">?ls</span> <span class="var">?key</span> <span class="main">=</span> g_rec <span class="var">?ls</span> <span class="var">?key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_step_def<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> S4 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> g_rec <span class="var">?ls</span> <span class="var">?key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="var">?ls</span> <span class="main">(</span>c_pair <span class="var">?m1</span> <span class="var">?x1</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?m1</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_upb_lm_2_5<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="var">?m1</span><span class="main">,</span><span class="var">?x1</span><span class="main">)</span><span class="main">,</span> <span class="free">n</span><span class="main">,</span> <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> lex_p"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lex_p_eq<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> A1 upb1_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="skolem">upb1</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?m1</span> <span class="var">?x1</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">upb1</span> <span class="main">≤</span> <span class="var">?s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> arg2_le_c_pair<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> lm5<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">from</span></span> A S6 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"g_rec <span class="var">?ls</span> <span class="var">?key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="var">?key</span> <span class="main">(</span>c_assoc_value <span class="var">?ls</span> <span class="main">(</span>c_pair <span class="var">?m1</span> <span class="var">?x1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="var">?ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_rec_def Let_def<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> S5 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">x</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> y1_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="var">?y1</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A2 A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"loc_upb <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span>
                              <span class="keyword1">let</span> <span class="bound">m</span> <span class="main">=</span> c_snd <span class="free">n</span><span class="main">;</span> <span class="bound">m1</span> <span class="main">=</span> c_fst <span class="bound">m</span><span class="main">;</span> <span class="bound">m2</span> <span class="main">=</span> c_snd <span class="bound">m</span><span class="main">;</span> <span class="bound">y1</span> <span class="main">=</span> c_fst <span class="free">x</span><span class="main">;</span> <span class="bound">x1</span> <span class="main">=</span> c_snd <span class="free">x</span><span class="main">;</span>
                              <span class="bound">y2</span> <span class="main">=</span> <span class="bound">y1</span> <span class="main">-</span> <span class="main">1</span><span class="main">;</span>
                              <span class="bound">t1</span> <span class="main">=</span> c_assoc_value <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="main">(</span>c_pair <span class="bound">y2</span> <span class="bound">x1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">n</span> <span class="main">(</span>c_pair <span class="bound">y2</span> <span class="bound">x1</span><span class="main">)</span><span class="main">)</span><span class="main">;</span>
                              <span class="bound">t2</span> <span class="main">=</span> c_pair <span class="main">(</span>c_pair <span class="bound">y2</span> <span class="bound">t1</span><span class="main">)</span> <span class="bound">x1</span> <span class="keyword1">in</span>
                                c_pair <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>loc_upb <span class="free">n</span> <span class="main">(</span>c_pair <span class="bound">y2</span> <span class="bound">x1</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>loc_upb <span class="bound">m2</span> <span class="bound">t2</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_upb_6<span class="main">)</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"loc_upb <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span>
                              <span class="keyword1">let</span>
                              <span class="bound">t1</span> <span class="main">=</span> c_assoc_value <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span><span class="main">)</span><span class="main">;</span>
                              <span class="bound">t2</span> <span class="main">=</span> c_pair <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="bound">t1</span><span class="main">)</span> <span class="var">?x1</span> <span class="keyword1">in</span>
                                c_pair <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>loc_upb <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>loc_upb <span class="var">?m2</span> <span class="bound">t2</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> loc_upb.simps <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def<span class="main">)</span>
   <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?t1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="main">(</span>c_pair <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span><span class="main">)</span>"</span></span>
   <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?t2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?t1</span><span class="main">)</span> <span class="var">?x1</span>"</span></span>
   <span class="keyword1"><span class="command">have</span></span> S1_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
     <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y2</span> <span class="main">&lt;</span> <span class="var">?y1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="var">?y2</span> <span class="var">?x1</span> <span class="main">&lt;</span> c_pair <span class="var">?y1</span> <span class="var">?x1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_strict_mono1<span class="main">)</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">n</span><span class="main">,</span> c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span><span class="main">,</span><span class="free">n</span><span class="main">,</span><span class="free">x</span><span class="main">)</span> <span class="main">∈</span> lex_p"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lex_p_eq<span class="main">)</span>
     <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">qed</span></span>
   <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> univ_for_pr <span class="main">(</span>c_pair <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span><span class="main">)</span>"</span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
     <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> univ_for_pr"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_gr_1<span class="main">)</span>
     <span class="keyword1"><span class="command">with</span></span> S1_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_is_sub_fun_lm_1<span class="main">)</span>
   <span class="keyword1"><span class="command">qed</span></span>
   <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"loc_upb <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> c_pair <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>loc_upb <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span> <span class="main">+</span> loc_upb <span class="var">?m2</span> <span class="var">?t2</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> loc_upb.simps <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def<span class="main">)</span>
   <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?s</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>loc_upb <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span> <span class="main">+</span> loc_upb <span class="var">?m2</span> <span class="var">?t2</span><span class="main">)</span>"</span></span>
   <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> pr_gr <span class="main">(</span>Suc <span class="var">?s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> loc_upb.simps<span class="main">)</span>
   <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>Suc <span class="var">?s</span><span class="main">)</span> <span class="main">=</span> g_step <span class="main">(</span>pr_gr <span class="var">?s</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="var">?s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_gr_at_Suc<span class="main">)</span>
   <span class="keyword1"><span class="command">with</span></span> S4 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> g_step <span class="main">(</span>pr_gr <span class="var">?s</span><span class="main">)</span> <span class="var">?key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> loc_upb.simps<span class="main">)</span>
   <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?ls</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"pr_gr <span class="var">?s</span>"</span></span>
   <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"g_step <span class="var">?ls</span> <span class="var">?key</span> <span class="main">=</span> g_rec <span class="var">?ls</span> <span class="var">?key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_step_def<span class="main">)</span>
   <span class="keyword1"><span class="command">with</span></span> S5 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> g_rec <span class="var">?ls</span> <span class="var">?key</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> loc_upb.simps<span class="main">)</span>
   <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="var">?ls</span> <span class="main">(</span>c_pair <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
     <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"loc_upb <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span> <span class="main">≤</span> loc_upb <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span> <span class="main">+</span> loc_upb <span class="var">?m2</span> <span class="var">?t2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> loc_upb.simps<span class="main">)</span>
     <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"loc_upb <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span> <span class="main">+</span> loc_upb <span class="var">?m2</span> <span class="var">?t2</span> <span class="main">≤</span> <span class="var">?s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> arg2_le_c_pair<span class="main">)</span>
     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> S7_1<span class="main">:</span> <span class="quoted"><span class="quoted">"loc_upb <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span> <span class="main">≤</span> <span class="var">?s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> loc_upb.simps<span class="main">)</span>
     <span class="keyword1"><span class="command">from</span></span> S1_1 S7_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> lm5<span class="main">)</span>
   <span class="keyword1"><span class="command">qed</span></span>
   <span class="keyword1"><span class="command">have</span></span> S8<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="var">?ls</span> <span class="main">(</span>c_pair <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="var">?t1</span>"</span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
     <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="var">?ls</span> univ_for_pr"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_gr_1<span class="main">)</span>
     <span class="keyword1"><span class="command">with</span></span> S7 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_is_sub_fun_lm_1<span class="main">)</span>
   <span class="keyword1"><span class="command">qed</span></span>
   <span class="keyword1"><span class="command">have</span></span> S9<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="var">?ls</span> <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="var">?t2</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
     <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?m2</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_upb_lm_2_6<span class="main">)</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="var">?m2</span><span class="main">,</span><span class="var">?t2</span><span class="main">)</span><span class="main">,</span> <span class="free">n</span><span class="main">,</span> <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> lex_p"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lex_p_eq<span class="main">)</span>
     <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="var">?m2</span> <span class="var">?t2</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="var">?t2</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"loc_upb <span class="var">?m2</span> <span class="var">?t2</span> <span class="main">≤</span> <span class="var">?s</span>"</span></span>
     <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
       <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"loc_upb <span class="var">?m2</span> <span class="var">?t2</span> <span class="main">≤</span> loc_upb <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span> <span class="main">+</span> loc_upb <span class="var">?m2</span> <span class="var">?t2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> loc_upb.simps<span class="main">)</span>
       <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"loc_upb <span class="free">n</span> <span class="main">(</span>c_pair <span class="var">?y2</span> <span class="var">?x1</span><span class="main">)</span> <span class="main">+</span> loc_upb <span class="var">?m2</span> <span class="var">?t2</span> <span class="main">≤</span> <span class="var">?s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> arg2_le_c_pair<span class="main">)</span>
       <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> loc_upb.simps<span class="main">)</span>
     <span class="keyword1"><span class="command">qed</span></span>
     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> lm5<span class="main">)</span>
   <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">from</span></span> A S7 S8 S9 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"g_rec <span class="var">?ls</span> <span class="var">?key</span> <span class="main">=</span> c_cons <span class="main">(</span>c_pair <span class="var">?key</span> <span class="main">(</span>c_assoc_value <span class="var">?ls</span> <span class="main">(</span>c_pair <span class="var">?m2</span> <span class="var">?t2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="var">?ls</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> loc_upb.simps <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> g_rec_def Let_def<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> S6 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_assoc_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-wf_upb_step_0"><span class="command">lemma</span></span> wf_upb_step_0<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">⋀</span> <span class="bound">n'</span> <span class="bound">x'</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">n'</span><span class="main">,</span><span class="bound">x'</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free">n</span><span class="main">,</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> lex_p <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span><span class="main">⟧</span> <span class="main">⟹</span>
      c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n'</span> <span class="bound">x'</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">n'</span><span class="main">,</span><span class="bound">x'</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free">n</span><span class="main">,</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> lex_p <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">n</span><span class="main">)</span> <span class="keyword1">mod</span> <span class="numeral">7</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_upb_lex_0<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_upb_lex_1<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_upb_lex_2<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">3</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">3</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_upb_lex_3<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">4</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 A <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_upb_lex_4<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">5</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">5</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 A <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_upb_lex_5<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">6</span> <span class="main">⟹</span> <span class="var">?thesis</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span> <span class="main">=</span> <span class="numeral">6</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 A <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_upb_lex_6<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n1</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> <span class="var">?n1</span><span class="main">=</span><span class="main">1</span> <span class="main">∨</span> <span class="var">?n1</span><span class="main">=</span><span class="numeral">2</span> <span class="main">∨</span> <span class="var">?n1</span><span class="main">=</span><span class="numeral">3</span> <span class="main">∨</span> <span class="var">?n1</span><span class="main">=</span><span class="numeral">4</span> <span class="main">∨</span> <span class="var">?n1</span><span class="main">=</span><span class="numeral">5</span> <span class="main">∨</span> <span class="var">?n1</span><span class="main">=</span><span class="numeral">6</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> mod7_lm<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 S3 S4 S5 S6 S7 S8 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="PRecUnGr-wf_upb_step"><span class="command">lemma</span></span> wf_upb_step<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">p2</span><span class="main">.</span> <span class="main">(</span><span class="bound">p2</span><span class="main">,</span> <span class="free">p1</span><span class="main">)</span> <span class="main">∈</span> lex_p <span class="main">⟹</span>
    c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="main">(</span>fst <span class="bound">p2</span><span class="main">)</span> <span class="main">(</span>snd <span class="bound">p2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>fst <span class="bound">p2</span><span class="main">)</span> <span class="main">(</span>snd <span class="bound">p2</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="main">(</span>fst <span class="free">p1</span><span class="main">)</span> <span class="main">(</span>snd <span class="free">p1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>fst <span class="free">p1</span><span class="main">)</span> <span class="main">(</span>snd <span class="free">p1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"fst <span class="free">p1</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"snd <span class="free">p1</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">p2</span><span class="main">.</span> <span class="main">(</span><span class="bound">p2</span><span class="main">,</span> <span class="main">(</span><span class="var">?n</span><span class="main">,</span> <span class="var">?x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> lex_p <span class="main">⟹</span>
    c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="main">(</span>fst <span class="bound">p2</span><span class="main">)</span> <span class="main">(</span>snd <span class="bound">p2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>fst <span class="bound">p2</span><span class="main">)</span> <span class="main">(</span>snd <span class="bound">p2</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span> <span class="bound">n'</span> <span class="bound">x'</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">n'</span><span class="main">,</span><span class="bound">x'</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span>fst <span class="free">p1</span><span class="main">,</span> snd <span class="free">p1</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> lex_p
    <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">⟹</span>
      c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="main">(</span>fst <span class="free">p1</span><span class="main">)</span> <span class="main">(</span>snd <span class="free">p1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>fst <span class="free">p1</span><span class="main">)</span> <span class="main">(</span>snd <span class="free">p1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> wf_upb_step_0<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span> <span class="bound">n'</span> <span class="bound">x'</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">n'</span><span class="main">,</span><span class="bound">x'</span><span class="main">)</span><span class="main">,</span> <span class="free">p1</span><span class="main">)</span> <span class="main">∈</span> lex_p <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>
    <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="main">(</span>fst <span class="free">p1</span><span class="main">)</span> <span class="main">(</span>snd <span class="free">p1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>fst <span class="free">p1</span><span class="main">)</span> <span class="main">(</span>snd <span class="free">p1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">n'</span> <span class="bound">x'</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">n'</span><span class="main">,</span> <span class="bound">x'</span><span class="main">)</span><span class="main">,</span> <span class="free">p1</span><span class="main">)</span> <span class="main">∈</span> lex_p <span class="main">⟹</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">n'</span> <span class="bound">x'</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n'</span> <span class="skolem">x'</span>
    <span class="keyword3"><span class="command">assume</span></span> A4_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="skolem">n'</span><span class="main">,</span> <span class="skolem">x'</span><span class="main">)</span><span class="main">,</span> <span class="free">p1</span><span class="main">)</span> <span class="main">∈</span> lex_p"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?p2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">n'</span><span class="main">,</span> <span class="skolem">x'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A4_1 <span class="keyword1"><span class="command">have</span></span> S4_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?p2</span><span class="main">,</span> <span class="free">p1</span><span class="main">)</span> <span class="main">∈</span> lex_p"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> S4_1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="main">(</span>fst <span class="var">?p2</span><span class="main">)</span> <span class="main">(</span>snd <span class="var">?p2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>fst <span class="var">?p2</span><span class="main">)</span> <span class="main">(</span>snd <span class="var">?p2</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> A1<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="skolem">n'</span> <span class="skolem">x'</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="skolem">n'</span> <span class="skolem">x'</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> S4 S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> loc_upb_main<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> loc_upb_lm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">p</span><span class="main">.</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="main">(</span>fst <span class="bound">p</span><span class="main">)</span> <span class="main">(</span>snd <span class="bound">p</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>fst <span class="bound">p</span><span class="main">)</span> <span class="main">(</span>snd <span class="bound">p</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"wf lex_p"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lex_p_def<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> S1 wf_upb_step <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> wf_induct_rule<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?p</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">n</span><span class="main">,</span><span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="main">(</span>fst <span class="var">?p</span><span class="main">)</span> <span class="main">(</span>snd <span class="var">?p</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>fst <span class="var">?p</span><span class="main">)</span> <span class="main">(</span>snd <span class="var">?p</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_upb_lm<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> pr_gr_value<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="main">(</span>pr_gr <span class="main">(</span>loc_upb <span class="free">n</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> univ_for_pr <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> loc_upb.simps <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loc_upb_main pr_gr_1 c_is_sub_fun_lm_1<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> g_comp_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"g_comp <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> c_assoc_have_key_is_pr c_assoc_value_is_pr c_cons_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> g_comp <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> g_comp_def Let_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> g_pair_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"g_pair <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> c_assoc_have_key_is_pr c_assoc_value_is_pr c_cons_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> g_pair <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> g_pair_def Let_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> g_rec_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"g_rec <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> c_assoc_have_key_is_pr c_assoc_value_is_pr c_cons_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> g_rec <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> g_rec_def Let_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> g_step_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"g_step <span class="main">∈</span> PrimRec2"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> g_comp_is_pr g_pair_is_pr g_rec_is_pr mod_is_pr c_assoc_have_key_is_pr c_assoc_value_is_pr c_cons_is_pr <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">ls</span> <span class="bound">key</span><span class="main">.</span> g_step <span class="bound">ls</span> <span class="bound">key</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> g_step_def Let_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> pr_gr_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_gr <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> pr_gr <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> PrimRecOp1 <span class="main">0</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> g_step <span class="bound">y</span> <span class="main">(</span>c_fst <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">=</span> <span class="var">?f</span>"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pr_gr <span class="skolem">x</span> <span class="main">=</span> <span class="var">?f</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">x</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_gr_at_0<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_gr_at_Suc<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"PrimRecOp1 <span class="main">0</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> g_step <span class="bound">y</span> <span class="main">(</span>c_fst <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> pr_rec1<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> g_step_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> g_step <span class="bound">y</span> <span class="main">(</span>c_fst <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="RecEnSet">
<div class="head">
<h1>Theory RecEnSet</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Computably enumerable sets of natural numbers
    Author:      Michael Nedzelsky &lt;MichaelNedzelsky at yandex.ru&gt;, 2008
    Maintainer:  Michael Nedzelsky &lt;MichaelNedzelsky at yandex.ru&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Computably enumerable sets of natural numbers›</span></span>

<span class="keyword1"><span class="command">theory</span></span> RecEnSet
<span class="keyword2"><span class="keyword">imports</span></span> <a href="PRecList.html">PRecList</a> <a href="PRecFun2.html">PRecFun2</a> <a href="PRecFinSet.html">PRecFinSet</a> <a href="PRecUnGr.html">PRecUnGr</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Basic definitions›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">fn_to_set</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> nat set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">fn_to_set</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">=</span> <span class="main">{</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span> <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">ce_sets</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat set<span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ce_sets</span> <span class="main">=</span> <span class="main">{</span> <span class="main">(</span>fn_to_set <span class="bound">p</span><span class="main">)</span> <span class="main">|</span> <span class="bound">p</span><span class="main">.</span> <span class="bound">p</span> <span class="main">∈</span> PrimRec2 <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Basic properties of computably enumerable sets›</span></span>

<span class="keyword1" id="RecEnSet-ce_set_lm_1"><span class="command">lemma</span></span> ce_set_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">∈</span> PrimRec2 <span class="main">⟹</span> fn_to_set <span class="free">p</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ce_sets_def<span class="main">)</span>

<span class="keyword1" id="RecEnSet-ce_set_lm_2"><span class="command">lemma</span></span> ce_set_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">p</span> <span class="main">∈</span> PrimRec2<span class="main">;</span> <span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="free">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="free">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> fn_to_set <span class="free">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> fn_to_set_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> p_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ce_set_lm_1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_set_lm_3"><span class="command">lemma</span></span> ce_set_lm_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets <span class="main">⟹</span> <span class="main">∃</span> <span class="bound">p</span> <span class="main">∈</span> PrimRec2<span class="main">.</span> <span class="free">A</span> <span class="main">=</span> fn_to_set <span class="bound">p</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="main">{</span> <span class="main">(</span>fn_to_set <span class="bound">p</span><span class="main">)</span> <span class="main">|</span> <span class="bound">p</span><span class="main">.</span> <span class="bound">p</span> <span class="main">∈</span> PrimRec2 <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ce_sets_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_set_lm_4"><span class="command">lemma</span></span> ce_set_lm_4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets <span class="main">⟹</span> <span class="main">∃</span> <span class="bound">p</span> <span class="main">∈</span> PrimRec2<span class="main">.</span> <span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">p</span> <span class="main">∈</span> PrimRec2<span class="main">.</span> <span class="free">A</span> <span class="main">=</span> fn_to_set <span class="bound">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_lm_3<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword2"><span class="keyword">and</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> fn_to_set <span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">from</span></span> p_is_pr L1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> fn_to_set_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_set_lm_5"><span class="command">lemma</span></span> ce_set_lm_5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">A</span> <span class="main">∈</span> ce_sets<span class="main">;</span> <span class="free">p</span> <span class="main">∈</span> PrimRec1 <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">p</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">}</span> <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">pA</span> <span class="main">∈</span> PrimRec2<span class="main">.</span> <span class="free">A</span> <span class="main">=</span> fn_to_set <span class="bound">pA</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_lm_3<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">pA</span></span> <span class="keyword2"><span class="keyword">where</span></span> pA_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">pA</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword2"><span class="keyword">and</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> fn_to_set <span class="skolem">pA</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">pA</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span> <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">=</span> <span class="skolem">pA</span> <span class="main">(</span><span class="free">p</span> <span class="skolem">x</span><span class="main">)</span> <span class="skolem">y</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span>
  <span class="keyword1"><span class="command">from</span></span> pA_is_pr A2 <span class="keyword1"><span class="command">have</span></span> q_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> q_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="free">p</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">q</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">p</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">q</span> <span class="skolem">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">pA</span> <span class="main">(</span><span class="free">p</span> <span class="skolem">x</span><span class="main">)</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> q_def<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">q</span> <span class="skolem">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="skolem">q</span> <span class="skolem">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">pA</span> <span class="main">(</span><span class="free">p</span> <span class="skolem">x</span><span class="main">)</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> q_def<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">p</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">}</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">q</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span> <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">p</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">}</span> <span class="main">=</span> fn_to_set <span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> q_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"fn_to_set <span class="skolem">q</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_set_lm_6"><span class="command">lemma</span></span> ce_set_lm_6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">A</span> <span class="main">∈</span> ce_sets<span class="main">;</span> <span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">∃</span> <span class="bound">q</span> <span class="main">∈</span> PrimRec1<span class="main">.</span> <span class="free">A</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">q</span> <span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> UNIV <span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">pA</span> <span class="main">∈</span> PrimRec2<span class="main">.</span> <span class="free">A</span> <span class="main">=</span> fn_to_set <span class="bound">pA</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_lm_3<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">pA</span></span> <span class="keyword2"><span class="keyword">where</span></span> pA_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">pA</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword2"><span class="keyword">and</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> fn_to_set <span class="skolem">pA</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">pA</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span> <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> a_in<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">z</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="skolem">pA</span> <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span> c_fst <span class="skolem">z</span> <span class="keyword1">else</span> <span class="skolem">a</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">z</span>
  <span class="keyword1"><span class="command">from</span></span> pA_is_pr <span class="keyword1"><span class="command">have</span></span> q_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> q_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">q</span> <span class="bound">z</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">z</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">pA</span> <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_fst <span class="skolem">z</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A q_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">z</span> <span class="main">=</span> c_fst <span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">z</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">pA</span> <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> q_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">z</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> a_in <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">z</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="skolem">q</span> <span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> UNIV <span class="main">}</span> <span class="main">⊆</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="main">{</span> <span class="skolem">q</span> <span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> UNIV <span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">q</span> <span class="bound">x</span> <span class="main">|</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> UNIV<span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword1"><span class="command">from</span></span> A S2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">pA</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="skolem">x</span> <span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> L1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="var">?z</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> q_def<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="skolem">q</span> <span class="bound">u</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">u</span><span class="main">.</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">q</span> <span class="bound">u</span> <span class="main">∧</span> <span class="bound">u</span> <span class="main">∈</span> UNIV"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> S4 S5 <span class="keyword1"><span class="command">have</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="main">{</span> <span class="skolem">q</span> <span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> UNIV <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> q_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_set_lm_7"><span class="command">lemma</span></span> ce_set_lm_7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">A</span> <span class="main">∈</span> ce_sets<span class="main">;</span> <span class="free">p</span> <span class="main">∈</span> PrimRec1<span class="main">⟧</span> <span class="main">⟹</span> <span class="main">{</span> <span class="free">p</span> <span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">}</span> <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="free">p</span> <span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">}</span>"</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span> <span class="main">∈</span> <span class="var">?B</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">=</span> <span class="free">p</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">pA</span> <span class="main">∈</span> PrimRec2<span class="main">.</span> <span class="free">A</span> <span class="main">=</span> fn_to_set <span class="bound">pA</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_lm_3<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">pA</span></span> <span class="keyword2"><span class="keyword">where</span></span> pA_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">pA</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword2"><span class="keyword">and</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> fn_to_set <span class="skolem">pA</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">pA</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span> <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">y</span> <span class="skolem">t</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="skolem">y</span> <span class="main">=</span> <span class="free">p</span> <span class="main">(</span>c_snd <span class="skolem">t</span><span class="main">)</span> <span class="keyword1">then</span> <span class="skolem">pA</span> <span class="main">(</span>c_snd <span class="skolem">t</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">t</span><span class="main">)</span> <span class="keyword1">else</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">y</span> <span class="skolem">t</span>
  <span class="keyword1"><span class="command">from</span></span> pA_is_pr A2 <span class="keyword1"><span class="command">have</span></span> q_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> q_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">y</span> <span class="main">∈</span> <span class="var">?B</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">q</span> <span class="bound">y</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span> <span class="main">∈</span> <span class="var">?B</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">q</span> <span class="skolem">y</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> AA1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="var">?B</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x0</span></span> <span class="keyword2"><span class="keyword">where</span></span> LL_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x0</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> LL_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> <span class="free">p</span> <span class="skolem">x0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> LL_4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x0</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">pA</span> <span class="skolem">x0</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> LL_2 LL_4 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z0</span></span> <span class="keyword2"><span class="keyword">where</span></span> LL_5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">pA</span> <span class="skolem">x0</span> <span class="skolem">z0</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">=</span> c_pair <span class="skolem">z0</span> <span class="skolem">x0</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> t_def q_def LL_3 LL_5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">y</span> <span class="skolem">t</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">q</span> <span class="skolem">y</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">q</span> <span class="skolem">y</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z0</span></span> <span class="keyword2"><span class="keyword">where</span></span> LL_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">y</span> <span class="skolem">z0</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">have</span></span> LL2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> <span class="free">p</span> <span class="main">(</span>c_snd <span class="skolem">z0</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≠</span> <span class="free">p</span> <span class="main">(</span>c_snd <span class="skolem">z0</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> q_def LL_1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">y</span> <span class="skolem">z0</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> LL_1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">from</span></span> LL2 LL_1 q_def <span class="keyword1"><span class="command">have</span></span> LL3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">pA</span> <span class="main">(</span>c_snd <span class="skolem">z0</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">z0</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> S3 <span class="keyword1"><span class="command">have</span></span> LL4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="skolem">z0</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> LL2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="main">{</span><span class="free">p</span> <span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?B</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">y</span> <span class="main">|</span> <span class="bound">y</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">q</span> <span class="bound">y</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> fn_to_set_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span> <span class="main">=</span> fn_to_set <span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> q_is_pr ce_set_lm_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> ce_empty<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">a</span><span class="main">.</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> const_is_pr_2<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">a</span><span class="main">.</span> <span class="var">?f</span> <span class="bound">x</span> <span class="bound">a</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">a</span><span class="main">.</span> <span class="var">?f</span> <span class="bound">x</span> <span class="bound">a</span> <span class="main">=</span> <span class="main">0</span> <span class="main">}</span><span class="main">=</span><span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"fn_to_set <span class="var">?f</span> <span class="main">=</span> <span class="main">…</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ce_sets_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> ce_univ<span class="main">:</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">a</span><span class="main">.</span> <span class="main">(</span><span class="main">0</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> const_is_pr_2<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">a</span><span class="main">.</span> <span class="var">?f</span> <span class="bound">x</span> <span class="bound">a</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">a</span><span class="main">.</span> <span class="var">?f</span> <span class="bound">x</span> <span class="bound">a</span> <span class="main">=</span> <span class="main">0</span> <span class="main">}</span><span class="main">=</span>UNIV"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"fn_to_set <span class="var">?f</span> <span class="main">=</span> <span class="main">…</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ce_sets_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> ce_singleton<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">a</span><span class="main">}</span> <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span>abs_of_diff <span class="bound">x</span> <span class="free">a</span><span class="main">)</span> <span class="main">+</span> <span class="bound">y</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">using</span></span> const_is_pr_2 <span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?n</span><span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="free">a</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="var">?f</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="bound">x</span><span class="main">=</span><span class="free">a</span> <span class="main">∧</span> <span class="bound">y</span><span class="main">=</span><span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> abs_of_diff_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="var">?f</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span> <span class="main">}</span><span class="main">=</span><span class="main">{</span><span class="free">a</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"fn_to_set <span class="var">?f</span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="var">?f</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span> <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"fn_to_set <span class="var">?f</span> <span class="main">=</span> <span class="main">{</span><span class="free">a</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ce_sets_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> ce_union<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">A</span> <span class="main">∈</span> ce_sets<span class="main">;</span> <span class="free">B</span> <span class="main">∈</span> ce_sets <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">∪</span> <span class="free">B</span> <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p_a</span></span> <span class="keyword2"><span class="keyword">where</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p_a</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword2"><span class="keyword">and</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> fn_to_set <span class="skolem">p_a</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ce_sets_def<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> ce_sets"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p_b</span></span> <span class="keyword2"><span class="keyword">where</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p_b</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword2"><span class="keyword">and</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">=</span> fn_to_set <span class="skolem">p_b</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ce_sets_def<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?p</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="skolem">p_a</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">p_b</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> S2 S5 <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?p</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> S8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="var">?p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="skolem">p_a</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="skolem">p_b</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"fn_to_set <span class="var">?p</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?C</span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="var">?p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S10<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">p_a</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S6 <span class="keyword1"><span class="command">have</span></span> S11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">p_b</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S10 S11 S9 S8 <span class="keyword1"><span class="command">have</span></span> S12<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?C</span> <span class="main">=</span> <span class="free">A</span> <span class="main">∪</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S7 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ce_sets_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S12 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> ce_intersect<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">A</span> <span class="main">∈</span> ce_sets<span class="main">;</span> <span class="free">B</span> <span class="main">∈</span> ce_sets <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">∩</span> <span class="free">B</span> <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p_a</span></span> <span class="keyword2"><span class="keyword">where</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p_a</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword2"><span class="keyword">and</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> fn_to_set <span class="skolem">p_a</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ce_sets_def<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> ce_sets"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p_b</span></span> <span class="keyword2"><span class="keyword">where</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p_b</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword2"><span class="keyword">and</span></span> S6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">=</span> fn_to_set <span class="skolem">p_b</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ce_sets_def<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?p</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="skolem">p_a</span> <span class="bound">x</span> <span class="main">(</span>c_fst <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">p_b</span> <span class="bound">x</span> <span class="main">(</span>c_snd <span class="bound">y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> S2 S5 <span class="keyword1"><span class="command">have</span></span> S7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?p</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> S8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="var">?p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">p_a</span> <span class="bound">x</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">p_b</span> <span class="bound">x</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="var">?p</span> <span class="skolem">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">p_a</span> <span class="skolem">x</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">p_b</span> <span class="skolem">x</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="var">?p</span> <span class="skolem">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">p_a</span> <span class="skolem">x</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">p_b</span> <span class="skolem">x</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">p_a</span> <span class="skolem">x</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">p_b</span> <span class="skolem">x</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="var">?p</span> <span class="skolem">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">p_a</span> <span class="skolem">x</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">p_b</span> <span class="skolem">x</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z1</span></span> <span class="skolem"><span class="skolem">z2</span></span> <span class="keyword2"><span class="keyword">where</span></span> s_23<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p_a</span> <span class="skolem">x</span> <span class="skolem">z1</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> s_24<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p_b</span> <span class="skolem">x</span> <span class="skolem">z2</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="skolem">z1</span> <span class="skolem">z2</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> s_23 <span class="keyword1"><span class="command">have</span></span> s_25<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p_a</span> <span class="skolem">x</span> <span class="main">(</span>c_fst <span class="var">?y1</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> s_24 <span class="keyword1"><span class="command">have</span></span> s_26<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p_b</span> <span class="skolem">x</span> <span class="main">(</span>c_snd <span class="var">?y1</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> s_25 s_26 <span class="keyword1"><span class="command">have</span></span> s_27<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p_a</span> <span class="skolem">x</span> <span class="main">(</span>c_fst <span class="var">?y1</span><span class="main">)</span> <span class="main">+</span> <span class="skolem">p_b</span> <span class="skolem">x</span> <span class="main">(</span>c_snd <span class="var">?y1</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">from</span></span> 1 2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="var">?p</span> <span class="skolem">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">p_a</span> <span class="skolem">x</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">z</span><span class="main">.</span> <span class="skolem">p_b</span> <span class="skolem">x</span> <span class="bound">z</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> iffI<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"fn_to_set <span class="var">?p</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?C</span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="var">?p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S3 <span class="keyword1"><span class="command">have</span></span> S10<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">p_a</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S6 <span class="keyword1"><span class="command">have</span></span> S11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">p_b</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S10 S11 S9 S8 <span class="keyword1"><span class="command">have</span></span> S12<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?C</span> <span class="main">=</span> <span class="free">A</span> <span class="main">∩</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S7 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ce_sets_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S12 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Enumeration of computably enumerable sets›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">nat_to_ce_set</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> <span class="main">(</span>nat set<span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">nat_to_ce_set</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">n</span><span class="main">.</span> fn_to_set <span class="main">(</span>pr_conv_1_to_2 <span class="main">(</span>nat_to_pr <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="RecEnSet-nat_to_ce_set_lm_1"><span class="command">lemma</span></span> nat_to_ce_set_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="free">n</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span>nat_to_pr <span class="free">n</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="free">n</span> <span class="main">=</span> fn_to_set <span class="main">(</span>pr_conv_1_to_2 <span class="main">(</span>nat_to_pr <span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_ce_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="free">n</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span>pr_conv_1_to_2 <span class="main">(</span>nat_to_pr <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span>pr_conv_1_to_2 <span class="main">(</span>nat_to_pr <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">(</span>nat_to_pr <span class="free">n</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pr_conv_1_to_2_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 S3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-nat_to_ce_set_into_ce"><span class="command">lemma</span></span> nat_to_ce_set_into_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="free">n</span> <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="free">n</span> <span class="main">=</span> fn_to_set <span class="main">(</span>pr_conv_1_to_2 <span class="main">(</span>nat_to_pr <span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_ce_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat_to_pr <span class="free">n</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_pr_into_pr<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>pr_conv_1_to_2 <span class="main">(</span>nat_to_pr <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_conv_1_to_2_lm<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S2 S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ce_set_lm_1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-nat_to_ce_set_srj"><span class="command">lemma</span></span> nat_to_ce_set_srj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets <span class="main">⟹</span> <span class="main">∃</span> <span class="bound">n</span><span class="main">.</span> <span class="free">A</span> <span class="main">=</span> nat_to_ce_set <span class="bound">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">p</span> <span class="main">∈</span> PrimRec2<span class="main">.</span> <span class="free">A</span> <span class="main">=</span> fn_to_set <span class="bound">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_lm_3<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword2"><span class="keyword">and</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> fn_to_set <span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">=</span> pr_conv_2_to_1 <span class="skolem">p</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> p_is_pr <span class="keyword1"><span class="command">have</span></span> q_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> q_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> pr_conv_2_to_1_lm<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> q_def <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"pr_conv_1_to_2 <span class="skolem">q</span> <span class="main">=</span> <span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"index_of_pr <span class="skolem">q</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> q_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="var">?n</span> <span class="main">=</span> <span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> index_of_pr_is_real<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S2 S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> fn_to_set <span class="main">(</span>pr_conv_1_to_2 <span class="main">(</span>nat_to_pr <span class="var">?n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> nat_to_ce_set <span class="var">?n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_ce_set_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">..</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Characteristic functions›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">chf</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat set <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span>"</span></span> <span class="comment1">― ‹Characteristic function›</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">chf</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">A</span> <span class="bound">x</span><span class="main">.</span> <span class="keyword1">if</span> <span class="bound">x</span> <span class="main">∈</span> <span class="bound">A</span> <span class="keyword1">then</span> <span class="main">0</span> <span class="keyword1">else</span> <span class="main">1</span> <span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">zero_set</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> nat set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">zero_set</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span><span class="main">.</span> <span class="main">{</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">f</span> <span class="bound">x</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="RecEnSet-chf_lm_1"><span class="command">lemma</span></span> chf_lm_1 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"zero_set <span class="main">(</span>chf <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> chf_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> zero_set_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>

<span class="keyword1" id="RecEnSet-chf_lm_2"><span class="command">lemma</span></span> chf_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>chf <span class="free">A</span> <span class="free">x</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> chf_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>

<span class="keyword1" id="RecEnSet-chf_lm_3"><span class="command">lemma</span></span> chf_lm_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">∉</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>chf <span class="free">A</span> <span class="free">x</span> <span class="main">=</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> chf_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>

<span class="keyword1" id="RecEnSet-chf_lm_4"><span class="command">lemma</span></span> chf_lm_4<span class="main">:</span> <span class="quoted"><span class="quoted">"chf <span class="free">A</span> <span class="main">∈</span> PrimRec1 <span class="main">⟹</span> <span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"chf <span class="free">A</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">=</span> chf <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A p_def <span class="keyword1"><span class="command">have</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">=</span> <span class="skolem">p</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">::</span> <span class="quoted">nat</span>
  <span class="keyword1"><span class="command">from</span></span> p_is_pr <span class="keyword1"><span class="command">have</span></span> q_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> q_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="skolem">p</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"zero_set <span class="skolem">p</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> p_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> zero_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"fn_to_set <span class="skolem">q</span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">q</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="skolem">p</span> <span class="bound">x</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">q</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> q_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="skolem">p</span> <span class="bound">x</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">q</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> S1 S2 <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"fn_to_set <span class="skolem">q</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> q_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"fn_to_set <span class="skolem">q</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> S5 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-chf_lm_5"><span class="command">lemma</span></span> chf_lm_5<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="free">A</span> <span class="main">⟹</span> chf <span class="free">A</span> <span class="main">∈</span> PrimRec1"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="free">A</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">=</span> set_to_nat <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_set <span class="skolem">u</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> u_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> nat_to_set_srj<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"chf <span class="free">A</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> sgn2 <span class="main">(</span>c_in <span class="bound">x</span> <span class="skolem">u</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"chf <span class="free">A</span> <span class="skolem">x</span> <span class="main">=</span> sgn2 <span class="main">(</span>c_in <span class="skolem">x</span> <span class="skolem">u</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1_1<span class="main">:</span> <span class="quoted"><span class="quoted">"chf <span class="free">A</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> chf_lm_2<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> A S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> nat_to_set <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_in <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_u_eq<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> S1_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∉</span> <span class="free">A</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1_1<span class="main">:</span> <span class="quoted"><span class="quoted">"chf <span class="free">A</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> chf_def<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> A S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∉</span> nat_to_set <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_in <span class="skolem">x</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x_in_u_eq c_in_def<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> S1_1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> c_in_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> sgn2 <span class="main">(</span>c_in <span class="bound">x</span> <span class="skolem">u</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> ce_finite<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="free">A</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"chf <span class="free">A</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> chf_lm_5<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> chf_lm_4<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Computably enumerable relations›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">ce_set_to_rel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat set <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">*</span> nat<span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ce_set_to_rel</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">A</span><span class="main">.</span> <span class="main">{</span> <span class="main">(</span>c_fst <span class="bound">x</span><span class="main">,</span> c_snd <span class="bound">x</span><span class="main">)</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="bound">A</span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">ce_rel_to_set</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">*</span> nat<span class="main">)</span> set <span class="main">⇒</span> nat set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ce_rel_to_set</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">R</span><span class="main">.</span> <span class="main">{</span> c_pair <span class="bound">x</span> <span class="bound">y</span> <span class="main">|</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="bound">R</span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">ce_rels</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>nat <span class="main">*</span> nat<span class="main">)</span> set<span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ce_rels</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">R</span> <span class="main">|</span> <span class="bound">R</span><span class="main">.</span> ce_rel_to_set <span class="bound">R</span> <span class="main">∈</span> ce_sets <span class="main">}</span>"</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_1"><span class="command">lemma</span></span> ce_rel_lm_1 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"ce_set_to_rel <span class="main">(</span>ce_rel_to_set <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">" ce_set_to_rel <span class="main">(</span>ce_rel_to_set <span class="free">r</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> ce_set_to_rel <span class="main">(</span>ce_rel_to_set <span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="main">(</span>ce_rel_to_set <span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> <span class="main">(</span>c_fst <span class="skolem">u</span><span class="main">,</span> c_snd <span class="skolem">u</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> ce_set_to_rel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> L1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> L4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">=</span> c_pair <span class="skolem">x</span> <span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> ce_rel_to_set_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> L4 <span class="keyword1"><span class="command">have</span></span> L5<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="skolem">u</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> L4 <span class="keyword1"><span class="command">have</span></span> L6<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="skolem">u</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> L5 L6 L2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> L3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">⊆</span> ce_set_to_rel <span class="main">(</span>ce_rel_to_set <span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">⟹</span> <span class="skolem">z</span> <span class="main">∈</span> ce_set_to_rel <span class="main">(</span>ce_rel_to_set <span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> fst <span class="skolem">z</span>"</span></span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> snd <span class="skolem">z</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> x_def y_def <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">=</span> c_pair <span class="skolem">x</span> <span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> A L1 u_def <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_rel_to_set_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> L1 u_def <span class="keyword1"><span class="command">have</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> <span class="main">(</span>c_fst <span class="skolem">u</span><span class="main">,</span> c_snd <span class="skolem">u</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> L2 L3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> ce_set_to_rel <span class="main">(</span>ce_rel_to_set <span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_set_to_rel_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_2"><span class="command">lemma</span></span> ce_rel_lm_2 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="main">(</span>ce_set_to_rel <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="main">(</span>ce_set_to_rel <span class="free">A</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> ce_rel_to_set <span class="main">(</span>ce_set_to_rel <span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="skolem">z</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> ce_rel_to_set <span class="main">(</span>ce_set_to_rel <span class="free">A</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> c_pair <span class="skolem">x</span> <span class="skolem">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="free">A</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> ce_rel_to_set_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> L2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>c_fst <span class="skolem">u</span><span class="main">,</span> c_snd <span class="skolem">u</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> L4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> ce_set_to_rel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> L3 L1 <span class="keyword1"><span class="command">have</span></span> L5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> L4 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> ce_rel_to_set <span class="main">(</span>ce_set_to_rel <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">⟹</span> <span class="skolem">z</span> <span class="main">∈</span> ce_rel_to_set <span class="main">(</span>ce_set_to_rel <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">,</span> c_snd <span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_set_to_rel_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> c_fst <span class="skolem">z</span>"</span></span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> c_snd <span class="skolem">z</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> L1 x_def y_def <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">∈</span> ce_rel_to_set <span class="main">(</span>ce_set_to_rel <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_rel_to_set_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> x_def y_def <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> ce_rel_to_set <span class="main">(</span>ce_set_to_rel <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rels_def1"><span class="command">lemma</span></span> ce_rels_def1<span class="main">:</span> <span class="quoted"><span class="quoted">"ce_rels <span class="main">=</span> <span class="main">{</span> ce_set_to_rel <span class="bound">A</span> <span class="main">|</span> <span class="bound">A</span><span class="main">.</span> <span class="bound">A</span> <span class="main">∈</span> ce_sets<span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"ce_rels <span class="main">⊆</span> <span class="main">{</span>ce_set_to_rel <span class="bound">A</span> <span class="main">|</span><span class="bound">A</span><span class="main">.</span> <span class="bound">A</span> <span class="main">∈</span> ce_sets<span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">r</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">" <span class="skolem">r</span> <span class="main">∈</span> ce_rels <span class="main">⟹</span> <span class="skolem">r</span> <span class="main">∈</span> <span class="main">{</span>ce_set_to_rel <span class="bound">A</span> <span class="main">|</span><span class="bound">A</span><span class="main">.</span> <span class="bound">A</span> <span class="main">∈</span> ce_sets<span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> ce_rels"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="skolem">r</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_rels_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> ce_rel_to_set <span class="skolem">r</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> A_def L1 <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> A_def <span class="keyword1"><span class="command">have</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"ce_set_to_rel <span class="skolem">A</span> <span class="main">=</span> <span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> L2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> <span class="main">{</span>ce_set_to_rel <span class="bound">A</span> <span class="main">|</span><span class="bound">A</span><span class="main">.</span> <span class="bound">A</span> <span class="main">∈</span> ce_sets<span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span>ce_set_to_rel <span class="bound">A</span> <span class="main">|</span><span class="bound">A</span><span class="main">.</span> <span class="bound">A</span> <span class="main">∈</span> ce_sets<span class="main">}</span> <span class="main">⊆</span> ce_rels"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">r</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> <span class="main">{</span>ce_set_to_rel <span class="bound">A</span> <span class="main">|</span><span class="bound">A</span><span class="main">.</span> <span class="bound">A</span> <span class="main">∈</span> ce_sets<span class="main">}</span> <span class="main">⟹</span> <span class="skolem">r</span> <span class="main">∈</span> ce_rels"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> <span class="main">{</span>ce_set_to_rel <span class="bound">A</span> <span class="main">|</span><span class="bound">A</span><span class="main">.</span> <span class="bound">A</span> <span class="main">∈</span> ce_sets<span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">=</span> ce_set_to_rel <span class="skolem">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> L1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="skolem">r</span> <span class="main">=</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> L2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> ce_rels"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> ce_rels_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_to_set_inj"><span class="command">lemma</span></span> ce_rel_to_set_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"inj ce_rel_to_set"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> inj_on_inverseI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">::</span><span class="main">(</span>nat<span class="main">×</span>nat<span class="main">)</span> set<span class="main">)</span> <span class="main">∈</span> UNIV"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"ce_set_to_rel <span class="main">(</span>ce_rel_to_set <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_to_set_srj"><span class="command">lemma</span></span> ce_rel_to_set_srj<span class="main">:</span> <span class="quoted"><span class="quoted">"surj ce_rel_to_set"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> surjI <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?f</span><span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted">ce_set_to_rel</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="main">(</span>ce_set_to_rel <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_2<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_to_set_bij"><span class="command">lemma</span></span> ce_rel_to_set_bij<span class="main">:</span> <span class="quoted"><span class="quoted">"bij ce_rel_to_set"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> bijI<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"inj ce_rel_to_set"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_to_set_inj<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"surj ce_rel_to_set"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_to_set_srj<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_set_to_rel_inj"><span class="command">lemma</span></span> ce_set_to_rel_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"inj ce_set_to_rel"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> inj_on_inverseI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">::</span>nat set<span class="main">)</span> <span class="main">∈</span> UNIV"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="main">(</span>ce_set_to_rel <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_2<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_set_to_rel_srj"><span class="command">lemma</span></span> ce_set_to_rel_srj<span class="main">:</span> <span class="quoted"><span class="quoted">"surj ce_set_to_rel"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> surjI <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?f</span><span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted">ce_rel_to_set</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"ce_set_to_rel <span class="main">(</span>ce_rel_to_set <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_set_to_rel_bij"><span class="command">lemma</span></span> ce_set_to_rel_bij<span class="main">:</span> <span class="quoted"><span class="quoted">"bij ce_set_to_rel"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> bijI<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"inj ce_set_to_rel"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_to_rel_inj<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"surj ce_set_to_rel"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_to_rel_srj<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_3"><span class="command">lemma</span></span> ce_rel_lm_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets <span class="main">⟹</span> ce_set_to_rel <span class="free">A</span> <span class="main">∈</span> ce_rels"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A ce_rels_def1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_4"><span class="command">lemma</span></span> ce_rel_lm_4<span class="main">:</span> <span class="quoted"><span class="quoted">"ce_set_to_rel <span class="free">A</span> <span class="main">∈</span> ce_rels <span class="main">⟹</span> <span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"ce_set_to_rel <span class="free">A</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_rels_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_5"><span class="command">lemma</span></span> ce_rel_lm_5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="main">∈</span> ce_sets<span class="main">)</span> <span class="main">=</span> <span class="main">(</span>ce_set_to_rel <span class="free">A</span> <span class="main">∈</span> ce_rels<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"ce_set_to_rel <span class="free">A</span> <span class="main">∈</span> ce_rels"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_3<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"ce_set_to_rel <span class="free">A</span> <span class="main">∈</span> ce_rels"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_4<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_6"><span class="command">lemma</span></span> ce_rel_lm_6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels <span class="main">⟹</span> ce_rel_to_set <span class="free">r</span> <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_rels_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_7"><span class="command">lemma</span></span> ce_rel_lm_7<span class="main">:</span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="free">r</span> <span class="main">∈</span> ce_sets <span class="main">⟹</span> <span class="free">r</span> <span class="main">∈</span> ce_rels"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="free">r</span> <span class="main">∈</span> ce_sets"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_rels_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_8"><span class="command">lemma</span></span> ce_rel_lm_8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">r</span> <span class="main">∈</span> ce_rels<span class="main">)</span> <span class="main">=</span> <span class="main">(</span>ce_rel_to_set <span class="free">r</span> <span class="main">∈</span> ce_sets<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_rels_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_9"><span class="command">lemma</span></span> ce_rel_lm_9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">⟹</span> c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_rel_to_set_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_10"><span class="command">lemma</span></span> ce_rel_lm_10<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">⟹</span> <span class="main">(</span>c_fst <span class="free">x</span><span class="main">,</span> c_snd <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_set_to_rel_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_11"><span class="command">lemma</span></span> ce_rel_lm_11<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="var">?z</span><span class="main">,</span> c_snd <span class="var">?z</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="main">(</span>ce_rel_to_set <span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_10<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_12"><span class="command">lemma</span></span> ce_rel_lm_12<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="main">,</span> <span class="free">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_11<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="main">,</span> <span class="free">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_9<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_13"><span class="command">lemma</span></span> ce_rel_lm_13<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="free">A</span> <span class="main">⟹</span> c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> ce_rel_to_set <span class="main">(</span>ce_set_to_rel <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_9<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_14"><span class="command">lemma</span></span> ce_rel_lm_14<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> ce_rel_to_set <span class="main">(</span>ce_set_to_rel <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_11<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_15"><span class="command">lemma</span></span> ce_rel_lm_15<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="main">,</span> <span class="free">y</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_13<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="main">,</span> <span class="free">y</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_14<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_16"><span class="command">lemma</span></span> ce_rel_lm_16<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span> <span class="main">⟹</span> <span class="main">(</span>c_fst <span class="free">x</span><span class="main">,</span> c_snd <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">x</span><span class="main">,</span> c_snd <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="main">(</span>ce_rel_to_set <span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_10<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_17"><span class="command">lemma</span></span> ce_rel_lm_17<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">x</span><span class="main">,</span> c_snd <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="free">A</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">x</span><span class="main">,</span> c_snd <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="main">(</span>c_fst <span class="free">x</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_13<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_18"><span class="command">lemma</span></span> ce_rel_lm_18<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>c_fst <span class="free">x</span><span class="main">,</span> c_snd <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">x</span><span class="main">,</span> c_snd <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_17<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">x</span><span class="main">,</span> c_snd <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_10<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_19"><span class="command">lemma</span></span> ce_rel_lm_19<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">x</span><span class="main">,</span> c_snd <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">x</span><span class="main">,</span> c_snd <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">x</span><span class="main">,</span> c_snd <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> ce_set_to_rel <span class="main">(</span>ce_rel_to_set <span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_17<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_20"><span class="command">lemma</span></span> ce_rel_lm_20<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>c_fst <span class="free">x</span><span class="main">,</span> c_snd <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">x</span><span class="main">,</span> c_snd <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_19<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="free">x</span><span class="main">,</span> c_snd <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_16<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_21"><span class="command">lemma</span></span> ce_rel_lm_21<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels <span class="main">⟹</span> <span class="main">∃</span> <span class="bound">p</span> <span class="main">∈</span> PrimRec3<span class="main">.</span> <span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="bound">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> r_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> ce_rel_to_set <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> r_ce <span class="keyword1"><span class="command">have</span></span> A_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> A_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ce_rel_lm_6<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">p</span> <span class="main">∈</span> PrimRec2<span class="main">.</span> <span class="skolem">A</span> <span class="main">=</span> fn_to_set <span class="bound">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_lm_3<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> q_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A_def1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> fn_to_set <span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">from</span></span> A_def1 <span class="keyword1"><span class="command">have</span></span> A_def2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">q</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> fn_to_set_def<span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">u</span> <span class="main">=</span> <span class="skolem">q</span> <span class="main">(</span>c_pair <span class="skolem">x</span> <span class="skolem">y</span><span class="main">)</span> <span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">u</span>
  <span class="keyword1"><span class="command">from</span></span> q_is_pr <span class="keyword1"><span class="command">have</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> p_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="skolem">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="skolem">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> c_pair <span class="skolem">x</span> <span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> A_def A <span class="keyword1"><span class="command">have</span></span> z_in_A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_rel_to_set_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> A_def2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="main">{</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">q</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">z</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> z_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> z_def p_def<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="skolem">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="skolem">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> c_pair <span class="skolem">x</span> <span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> A <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> q_z<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">z</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> z_def p_def<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> A_def2 <span class="keyword1"><span class="command">have</span></span> z_in_A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> z_def<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> A_def<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_11<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> p_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_22"><span class="command">lemma</span></span> ce_rel_lm_22<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels <span class="main">⟹</span> <span class="main">∃</span> <span class="bound">p</span> <span class="main">∈</span> PrimRec3<span class="main">.</span> <span class="free">r</span> <span class="main">=</span> <span class="main">{</span> <span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="bound">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span> <span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> r_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">p</span> <span class="main">∈</span> PrimRec3<span class="main">.</span> <span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="bound">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_21<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword2"><span class="keyword">and</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="skolem">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> p_is_pr L1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_23"><span class="command">lemma</span></span> ce_rel_lm_23<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">p</span> <span class="main">∈</span> PrimRec3<span class="main">;</span> <span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="free">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">r</span> <span class="main">∈</span> ce_rels"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">∈</span> PrimRec3"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="free">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">z</span> <span class="skolem">u</span> <span class="main">=</span> <span class="free">p</span> <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">z</span> <span class="skolem">u</span>
  <span class="keyword1"><span class="command">from</span></span> p_is_pr <span class="keyword1"><span class="command">have</span></span> q_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> q_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">q</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> A_def1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> fn_to_set <span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> fn_to_set_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> q_is_pr A_def1 <span class="keyword1"><span class="command">have</span></span> A_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ce_set_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> main<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> ce_rel_to_set <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">⊆</span> ce_rel_to_set <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span> <span class="keyword3"><span class="command">assume</span></span> z_in_A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> c_fst <span class="skolem">z</span>"</span></span>
        <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> c_snd <span class="skolem">z</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> z_in_A A_def <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">z</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> x_def y_def q_def <span class="keyword1"><span class="command">have</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">u</span><span class="main">.</span> <span class="free">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_9<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> x_def y_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="free">r</span> <span class="main">⊆</span> <span class="skolem">A</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span> <span class="keyword3"><span class="command">assume</span></span> z_in_r<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> c_fst <span class="skolem">z</span>"</span></span>
        <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> c_snd <span class="skolem">z</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> z_in_r <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">,</span> c_snd <span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_16<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> x_def y_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> A <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> x_def y_def q_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">z</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">with</span></span> A_def <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> A_ce <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="free">r</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_7<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_24"><span class="command">lemma</span></span> ce_rel_lm_24<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">r</span> <span class="main">∈</span> ce_rels<span class="main">;</span> <span class="free">s</span> <span class="main">∈</span> ce_rels <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">s</span> <span class="keyword1">O</span> <span class="free">r</span> <span class="main">∈</span> ce_rels"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> r_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> s_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword1"><span class="command">from</span></span> r_ce <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">p</span> <span class="main">∈</span> PrimRec3<span class="main">.</span> <span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">)</span><span class="main">=</span><span class="main">(</span><span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="bound">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_21<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p_r</span></span> <span class="keyword2"><span class="keyword">where</span></span> p_r_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p_r</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword2"><span class="keyword">and</span></span> R1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">)</span><span class="main">=</span><span class="main">(</span><span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="skolem">p_r</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> s_ce <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">p</span> <span class="main">∈</span> PrimRec3<span class="main">.</span> <span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">s</span><span class="main">)</span><span class="main">=</span><span class="main">(</span><span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="bound">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_21<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p_s</span></span> <span class="keyword2"><span class="keyword">where</span></span> p_s_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p_s</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword2"><span class="keyword">and</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">s</span><span class="main">)</span><span class="main">=</span><span class="main">(</span><span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="skolem">p_s</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">x</span> <span class="skolem">z</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p_s</span> <span class="skolem">x</span> <span class="main">(</span>c_fst <span class="skolem">u</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="skolem">u</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">p_r</span> <span class="main">(</span>c_fst <span class="skolem">u</span><span class="main">)</span> <span class="skolem">z</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="skolem">u</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">z</span> <span class="skolem">u</span>
  <span class="keyword1"><span class="command">from</span></span> p_r_is_pr p_s_is_pr <span class="keyword1"><span class="command">have</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> p_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">sr</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">sr</span> <span class="main">=</span> <span class="free">s</span> <span class="keyword1">O</span> <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> main<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">z</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">sr</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="skolem">p</span> <span class="bound">x</span> <span class="bound">z</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">z</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">sr</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span><span class="bound">u</span><span class="main">.</span> <span class="skolem">p</span> <span class="skolem">x</span> <span class="skolem">z</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">sr</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">u</span><span class="main">.</span> <span class="skolem">p</span> <span class="skolem">x</span> <span class="skolem">z</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">from</span></span> A sr_def <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">s</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> L1 S1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u_s</span></span> <span class="keyword2"><span class="keyword">where</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p_s</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">u_s</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> L2 R1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u_r</span></span> <span class="keyword2"><span class="keyword">where</span></span> L4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p_r</span> <span class="skolem">y</span> <span class="skolem">z</span> <span class="skolem">u_r</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">=</span> c_pair <span class="skolem">y</span> <span class="main">(</span>c_pair <span class="skolem">u_s</span> <span class="skolem">u_r</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> L3 L4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">x</span> <span class="skolem">z</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> p_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> u_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">u</span><span class="main">.</span> <span class="skolem">p</span> <span class="skolem">x</span> <span class="skolem">z</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">sr</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">from</span></span> A <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">x</span> <span class="skolem">z</span> <span class="skolem">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p_s</span> <span class="skolem">x</span> <span class="main">(</span>c_fst <span class="skolem">u</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="skolem">u</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">p_r</span> <span class="main">(</span>c_fst <span class="skolem">u</span><span class="main">)</span> <span class="skolem">z</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="skolem">u</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> p_def<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> L2 <span class="keyword1"><span class="command">have</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p_s</span> <span class="skolem">x</span> <span class="main">(</span>c_fst <span class="skolem">u</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="main">(</span>c_snd <span class="skolem">u</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> L2 <span class="keyword1"><span class="command">have</span></span> L4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p_r</span> <span class="main">(</span>c_fst <span class="skolem">u</span><span class="main">)</span> <span class="skolem">z</span> <span class="main">(</span>c_snd <span class="main">(</span>c_snd <span class="skolem">u</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> L3 S1 <span class="keyword1"><span class="command">have</span></span> L5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="main">(</span>c_fst <span class="skolem">u</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> L4 R1 <span class="keyword1"><span class="command">have</span></span> L6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>c_fst <span class="skolem">u</span><span class="main">)</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> L5 L6 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> <span class="free">s</span> <span class="keyword1">O</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> sr_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> p_is_pr main <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">sr</span> <span class="main">∈</span> ce_rels"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_23<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> sr_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_25"><span class="command">lemma</span></span> ce_rel_lm_25<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels <span class="main">⟹</span> <span class="free">r</span><span class="main">^-1</span> <span class="main">∈</span> ce_rels"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> r_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">^-1</span> <span class="main">=</span> <span class="main">{</span><span class="main">(</span><span class="bound">y</span><span class="main">,</span><span class="bound">x</span><span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="bound">y</span><span class="main">,</span><span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">^-1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> r_ce <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">p</span> <span class="main">∈</span> PrimRec3<span class="main">.</span> <span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="bound">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_21<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword2"><span class="keyword">and</span></span> R1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="skolem">p</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">u</span> <span class="main">=</span> <span class="skolem">p</span> <span class="skolem">y</span> <span class="skolem">x</span> <span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">u</span>
  <span class="keyword1"><span class="command">from</span></span> p_is_pr <span class="keyword1"><span class="command">have</span></span> q_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∈</span> PrimRec3"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> q_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">from</span></span> L1 R1 <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">^-1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="skolem">p</span> <span class="bound">y</span> <span class="bound">x</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> q_def <span class="keyword1"><span class="command">have</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">^-1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span><span class="main">.</span> <span class="skolem">q</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">u</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> q_is_pr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_23<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_26"><span class="command">lemma</span></span> ce_rel_lm_26<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels <span class="main">⟹</span> Domain <span class="free">r</span> <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> r_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> Domain <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> ce_rel_to_set <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> r_ce <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="free">r</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_6<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> A_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> A_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="bound">x</span> <span class="bound">y</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ce_rel_lm_12<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="bound">x</span> <span class="bound">y</span> <span class="main">∈</span> <span class="skolem">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> A_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A_ce c_fst_is_pr <span class="keyword1"><span class="command">have</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> c_fst <span class="bound">z</span> <span class="main">|</span><span class="bound">z</span><span class="main">.</span>  <span class="bound">z</span> <span class="main">∈</span> <span class="skolem">A</span> <span class="main">}</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_lm_7<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> L4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">{</span> c_fst <span class="bound">z</span> <span class="main">|</span><span class="bound">z</span><span class="main">.</span>  <span class="bound">z</span> <span class="main">∈</span> <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span> <span class="main">=</span><span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> c_pair <span class="bound">x</span> <span class="bound">y</span> <span class="main">∈</span> <span class="skolem">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span> c_fst <span class="bound">z</span> <span class="main">|</span><span class="bound">z</span><span class="main">.</span>  <span class="bound">z</span> <span class="main">∈</span> <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span> <span class="main">=</span><span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> c_pair <span class="skolem">x</span> <span class="bound">y</span> <span class="main">∈</span> <span class="skolem">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span>c_fst <span class="bound">z</span> <span class="main">|</span><span class="bound">z</span><span class="main">.</span> <span class="bound">z</span> <span class="main">∈</span> <span class="skolem">A</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> z_in_A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x_z<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> c_fst <span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> x_z <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> c_pair <span class="skolem">x</span> <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> z_in_A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="skolem">x</span> <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">y</span><span class="main">.</span> c_pair <span class="skolem">x</span> <span class="bound">y</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">y</span><span class="main">.</span> c_pair <span class="skolem">x</span> <span class="bound">y</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> y_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> c_pair <span class="skolem">x</span> <span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> y_1 <span class="keyword1"><span class="command">have</span></span> z_in_A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> z_def<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> z_def <span class="keyword1"><span class="command">have</span></span> x_z<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> c_fst <span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> z_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> z_in_A x_z <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span>c_fst <span class="bound">z</span> <span class="main">|</span><span class="bound">z</span><span class="main">.</span> <span class="bound">z</span> <span class="main">∈</span> <span class="skolem">A</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> L1 L2 <span class="keyword1"><span class="command">have</span></span> L5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> Domain <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> c_pair <span class="bound">x</span> <span class="bound">y</span> <span class="main">∈</span> <span class="skolem">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> L4 L5 <span class="keyword1"><span class="command">have</span></span> L6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> Domain <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">{</span> c_fst <span class="bound">z</span> <span class="main">|</span><span class="bound">z</span><span class="main">.</span>  <span class="bound">z</span> <span class="main">∈</span> <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Domain <span class="free">r</span> <span class="main">=</span> <span class="main">{</span> c_fst <span class="bound">z</span> <span class="main">|</span><span class="bound">z</span><span class="main">.</span>  <span class="bound">z</span> <span class="main">∈</span> <span class="skolem">A</span> <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>  
  <span class="keyword1"><span class="command">with</span></span> L3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Domain <span class="free">r</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_27"><span class="command">lemma</span></span> ce_rel_lm_27<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels <span class="main">⟹</span> Range <span class="free">r</span> <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> r_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">^-1</span> <span class="main">∈</span> ce_rels"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_25<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Domain <span class="main">(</span><span class="free">r</span><span class="main">^-1</span><span class="main">)</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_26<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> Domain_converse <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_28"><span class="command">lemma</span></span> ce_rel_lm_28<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels <span class="main">⟹</span> Field <span class="free">r</span> <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> r_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword1"><span class="command">from</span></span> r_ce <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"Domain <span class="free">r</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_26<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> r_ce <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"Range <span class="free">r</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_27<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> L1 L2 <span class="keyword1"><span class="command">have</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"Domain <span class="free">r</span> <span class="main">∪</span> Range <span class="free">r</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_union<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> Field_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_29"><span class="command">lemma</span></span> ce_rel_lm_29<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">A</span> <span class="main">∈</span> ce_sets<span class="main">;</span> <span class="free">B</span> <span class="main">∈</span> ce_sets <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">×</span> <span class="free">B</span> <span class="main">∈</span> ce_rels"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> B_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> ce_sets"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">r_a</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r_a</span> <span class="main">=</span> <span class="main">{</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="main">(</span><span class="main">0</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">}</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">r_b</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r_b</span> <span class="main">=</span> <span class="main">{</span><span class="main">(</span><span class="main">(</span><span class="main">0</span><span class="main">::</span>nat<span class="main">)</span><span class="main">,</span><span class="bound">z</span><span class="main">)</span> <span class="main">|</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">z</span> <span class="main">∈</span> <span class="free">B</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r_a</span> <span class="keyword1">O</span> <span class="skolem">r_b</span> <span class="main">=</span> <span class="free">A</span> <span class="main">×</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> r_a_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> r_b_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> r_a_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r_a</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> loc1<span class="main">:</span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="skolem">r_a</span> <span class="main">=</span> <span class="main">{</span> c_pair <span class="bound">x</span> <span class="main">0</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> r_a_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> ce_rel_to_set_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">x</span> <span class="main">=</span> c_pair <span class="skolem">x</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">have</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> p_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
    <span class="keyword1"><span class="command">from</span></span> A_ce p_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span> c_pair <span class="bound">x</span> <span class="main">0</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">}</span> <span class="main">∈</span> ce_sets"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> p_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ce_set_lm_7<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> loc1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="skolem">r_a</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_7<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> r_b_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r_b</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> loc1<span class="main">:</span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="skolem">r_b</span> <span class="main">=</span> <span class="main">{</span> c_pair <span class="main">0</span> <span class="bound">z</span> <span class="main">|</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">z</span> <span class="main">∈</span> <span class="free">B</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> r_b_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> ce_rel_to_set_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
    <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">z</span> <span class="main">=</span> c_pair <span class="main">0</span> <span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">z</span>
    <span class="keyword1"><span class="command">have</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> p_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
    <span class="keyword1"><span class="command">from</span></span> B_ce p_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span> c_pair <span class="main">0</span> <span class="bound">z</span> <span class="main">|</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">z</span> <span class="main">∈</span> <span class="free">B</span><span class="main">}</span> <span class="main">∈</span> ce_sets"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> p_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ce_set_lm_7<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> loc1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="skolem">r_b</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_7<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> r_b_ce r_a_ce <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r_a</span> <span class="keyword1">O</span> <span class="skolem">r_b</span> <span class="main">∈</span> ce_rels"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_24<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> L1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_30"><span class="command">lemma</span></span> ce_rel_lm_30<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∈</span> ce_rels"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="main">{}</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_rel_to_set_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> ce_empty <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="main">{}</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_7<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_31"><span class="command">lemma</span></span> ce_rel_lm_31<span class="main">:</span> <span class="quoted"><span class="quoted">"UNIV <span class="main">∈</span> ce_rels"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> ce_univ ce_univ <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"UNIV <span class="main">×</span> UNIV <span class="main">∈</span> ce_rels"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_29<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_32"><span class="command">lemma</span></span> ce_rel_lm_32<span class="main">:</span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="main">(</span><span class="free">r</span> <span class="main">∪</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>ce_rel_to_set <span class="free">r</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span>ce_rel_to_set <span class="free">s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_rel_to_set_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_33"><span class="command">lemma</span></span> ce_rel_lm_33<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">r</span> <span class="main">∈</span> ce_rels<span class="main">;</span> <span class="free">s</span> <span class="main">∈</span> ce_rels <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">r</span> <span class="main">∪</span> <span class="free">s</span> <span class="main">∈</span> ce_rels"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> r_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="free">r</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_6<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> s_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="free">s</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_6<span class="main">)</span>  
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="main">(</span><span class="free">r</span> <span class="main">∪</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>ce_rel_to_set <span class="free">r</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span>ce_rel_to_set <span class="free">s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_rel_to_set_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> r_ce s_ce <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ce_rel_to_set <span class="free">r</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span>ce_rel_to_set <span class="free">s</span><span class="main">)</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_union<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="main">(</span><span class="free">r</span> <span class="main">∪</span> <span class="free">s</span><span class="main">)</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_7<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_34"><span class="command">lemma</span></span> ce_rel_lm_34<span class="main">:</span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="main">(</span><span class="free">r</span> <span class="main">∩</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>ce_rel_to_set <span class="free">r</span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span>ce_rel_to_set <span class="free">s</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="main">(</span><span class="free">r</span> <span class="main">∩</span> <span class="free">s</span><span class="main">)</span> <span class="main">⊆</span> ce_rel_to_set <span class="free">r</span> <span class="main">∩</span> ce_rel_to_set <span class="free">s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_rel_to_set_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="free">r</span> <span class="main">∩</span> ce_rel_to_set <span class="free">s</span> <span class="main">⊆</span> ce_rel_to_set <span class="main">(</span><span class="free">r</span> <span class="main">∩</span> <span class="free">s</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span> <span class="main">∩</span> ce_rel_to_set <span class="free">s</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ce_rel_to_set <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ce_rel_to_set <span class="free">s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> L1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">u</span><span class="main">,</span><span class="skolem">v</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> L4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> c_pair <span class="skolem">u</span> <span class="skolem">v</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> ce_rel_to_set_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> L2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u1</span></span> <span class="skolem"><span class="skolem">v1</span></span> <span class="keyword2"><span class="keyword">where</span></span> L5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">u1</span><span class="main">,</span><span class="skolem">v1</span><span class="main">)</span> <span class="main">∈</span> <span class="free">s</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> L6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> c_pair <span class="skolem">u1</span> <span class="skolem">v1</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> ce_rel_to_set_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> L4 L6 <span class="keyword1"><span class="command">have</span></span> L7<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="skolem">u1</span> <span class="skolem">v1</span> <span class="main">=</span> c_pair <span class="skolem">u</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u1</span><span class="main">=</span><span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_inj1<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> L7 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v1</span><span class="main">=</span><span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_inj2<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">u</span><span class="main">,</span><span class="skolem">v</span><span class="main">)</span><span class="main">=</span><span class="main">(</span><span class="skolem">u1</span><span class="main">,</span><span class="skolem">v1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> L3 L5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">u</span><span class="main">,</span><span class="skolem">v</span><span class="main">)</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">∩</span> <span class="free">s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> L4 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> ce_rel_to_set <span class="main">(</span><span class="free">r</span> <span class="main">∩</span> <span class="free">s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_rel_to_set_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_35"><span class="command">lemma</span></span> ce_rel_lm_35<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">r</span> <span class="main">∈</span> ce_rels<span class="main">;</span> <span class="free">s</span> <span class="main">∈</span> ce_rels <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">r</span> <span class="main">∩</span> <span class="free">s</span> <span class="main">∈</span> ce_rels"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> r_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="free">r</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_6<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> s_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="free">s</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_6<span class="main">)</span>  
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="main">(</span><span class="free">r</span> <span class="main">∩</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>ce_rel_to_set <span class="free">r</span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span>ce_rel_to_set <span class="free">s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_34<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> r_ce s_ce <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ce_rel_to_set <span class="free">r</span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span>ce_rel_to_set <span class="free">s</span><span class="main">)</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_intersect<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="main">(</span><span class="free">r</span> <span class="main">∩</span> <span class="free">s</span><span class="main">)</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_7<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_36"><span class="command">lemma</span></span> ce_rel_lm_36<span class="main">:</span> <span class="quoted"><span class="quoted">"ce_set_to_rel <span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>ce_set_to_rel <span class="free">A</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span>ce_set_to_rel <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> ce_set_to_rel_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_37"><span class="command">lemma</span></span> ce_rel_lm_37<span class="main">:</span> <span class="quoted"><span class="quoted">"ce_set_to_rel <span class="main">(</span><span class="free">A</span> <span class="main">∩</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>ce_set_to_rel <span class="free">A</span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span>ce_set_to_rel <span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">,</span> c_snd <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">have</span></span> f_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"inj <span class="skolem">f</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> f_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> inj_on_inverseI <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?g</span><span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">λ</span></span> <span class="main"><span class="main">(</span></span><span class="bound"><span class="bound">u</span></span><span class="main"><span class="main">,</span></span><span class="bound"><span class="bound">v</span></span><span class="main"><span class="main">)</span></span><span class="main"><span class="main">.</span></span> c_pair <span class="bound"><span class="bound">u</span></span> <span class="bound"><span class="bound">v</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="quoted">nat</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> UNIV"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"case_prod c_pair <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">,</span> c_snd <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> f_inj <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">`</span> <span class="main">(</span><span class="free">A</span> <span class="main">∩</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">f</span> <span class="main">`</span> <span class="free">A</span> <span class="main">∩</span> <span class="skolem">f</span> <span class="main">`</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> image_Int<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> f_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> ce_set_to_rel_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-ce_rel_lm_38"><span class="command">lemma</span></span> ce_rel_lm_38<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">r</span> <span class="main">∈</span> ce_rels<span class="main">;</span> <span class="free">A</span> <span class="main">∈</span> ce_sets <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">r</span><span class="main">``</span><span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> r_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span>
  <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="free">A</span> <span class="main">=</span> Range <span class="main">(</span><span class="free">r</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">×</span> UNIV<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"Range <span class="main">(</span><span class="free">r</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">×</span> UNIV<span class="main">)</span> <span class="main">∈</span> ce_sets"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_27<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">×</span> UNIV <span class="main">∈</span> ce_rels"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_35<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> ce_rels"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> r_ce<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">×</span> UNIV <span class="main">∈</span> ce_rels"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_29<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> A_ce<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"UNIV <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_univ<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> L1 L2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Total computable functions›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">graph</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">×</span> nat<span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">graph</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span><span class="main">.</span> <span class="main">{</span> <span class="main">(</span><span class="bound">x</span><span class="main">,</span> <span class="bound">f</span> <span class="bound">x</span><span class="main">)</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> UNIV<span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="RecEnSet-graph_lm_1"><span class="command">lemma</span></span> graph_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">)</span> <span class="main">∈</span> graph <span class="free">f</span> <span class="main">⟹</span> <span class="free">y</span> <span class="main">=</span> <span class="free">f</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> graph_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="RecEnSet-graph_lm_2"><span class="command">lemma</span></span> graph_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">=</span> <span class="free">f</span> <span class="free">x</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">)</span> <span class="main">∈</span> graph <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> graph_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="RecEnSet-graph_lm_3"><span class="command">lemma</span></span> graph_lm_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">)</span> <span class="main">∈</span> graph <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">y</span> <span class="main">=</span> <span class="free">f</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> graph_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="RecEnSet-graph_lm_4"><span class="command">lemma</span></span> graph_lm_4<span class="main">:</span> <span class="quoted"><span class="quoted">"graph <span class="main">(</span><span class="free">f</span> <span class="keyword1">o</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>graph <span class="free">g</span><span class="main">)</span> <span class="keyword1">O</span> <span class="main">(</span>graph <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> graph_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">c_graph</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> nat set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c_graph</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span><span class="main">.</span> <span class="main">{</span> c_pair <span class="bound">x</span> <span class="main">(</span><span class="bound">f</span> <span class="bound">x</span><span class="main">)</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> UNIV<span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="RecEnSet-c_graph_lm_1"><span class="command">lemma</span></span> c_graph_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> c_graph <span class="free">f</span> <span class="main">⟹</span> <span class="free">y</span> <span class="main">=</span> <span class="free">f</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> c_graph <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_graph <span class="free">f</span> <span class="main">=</span> <span class="main">{</span>c_pair <span class="bound">x</span> <span class="main">(</span><span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> UNIV<span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_graph_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A S1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">=</span> c_pair <span class="skolem">z</span> <span class="main">(</span><span class="free">f</span> <span class="skolem">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_inj1<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">=</span> <span class="free">f</span> <span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_inj2<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-c_graph_lm_2"><span class="command">lemma</span></span> c_graph_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">=</span> <span class="free">f</span> <span class="free">x</span> <span class="main">⟹</span> c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> c_graph <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> c_graph_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="RecEnSet-c_graph_lm_3"><span class="command">lemma</span></span> c_graph_lm_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> c_graph <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">y</span> <span class="main">=</span> <span class="free">f</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> c_graph <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">=</span> <span class="free">f</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_graph_lm_1<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">=</span> <span class="free">f</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> c_graph <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_graph_lm_2<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-c_graph_lm_4"><span class="command">lemma</span></span> c_graph_lm_4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_graph <span class="free">f</span> <span class="main">=</span> ce_rel_to_set <span class="main">(</span>graph <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> c_graph_def ce_rel_to_set_def graph_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="RecEnSet-c_graph_lm_5"><span class="command">lemma</span></span> c_graph_lm_5<span class="main">:</span> <span class="quoted"><span class="quoted">"graph <span class="free">f</span> <span class="main">=</span> ce_set_to_rel <span class="main">(</span>c_graph <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_graph_lm_4<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">total_recursive</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">total_recursive</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span><span class="main">.</span> graph <span class="bound">f</span> <span class="main">∈</span> ce_rels<span class="main">)</span>"</span></span>

<span class="keyword1" id="RecEnSet-total_recursive_def1"><span class="command">lemma</span></span> total_recursive_def1<span class="main">:</span> <span class="quoted"><span class="quoted">"total_recursive <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span><span class="main">.</span> c_graph <span class="bound">f</span> <span class="main">∈</span> ce_sets<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ext<span class="main">)</span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">" total_recursive <span class="skolem">f</span> <span class="main">=</span> <span class="main">(</span>c_graph <span class="skolem">f</span> <span class="main">∈</span> ce_sets<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"total_recursive <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"graph <span class="skolem">f</span> <span class="main">∈</span> ce_rels"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> total_recursive_def<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="main">(</span>graph <span class="skolem">f</span><span class="main">)</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_6<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_graph <span class="skolem">f</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_graph_lm_4<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"c_graph <span class="skolem">f</span> <span class="main">∈</span> ce_sets"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ce_rel_to_set <span class="main">(</span>graph <span class="skolem">f</span><span class="main">)</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_graph_lm_4<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"graph <span class="skolem">f</span> <span class="main">∈</span> ce_rels"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_7<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"total_recursive <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> total_recursive_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> pr_is_total_rec<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec1 <span class="main">⟹</span> total_recursive <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> PrimRec1"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">x</span> <span class="main">=</span> c_pair <span class="skolem">x</span> <span class="main">(</span><span class="free">f</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> p_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?U</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="skolem">p</span> <span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> UNIV <span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> ce_univ p_is_pr <span class="keyword1"><span class="command">have</span></span> U_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?U</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_lm_7<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> U_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?U</span> <span class="main">=</span> <span class="main">{</span> c_pair <span class="bound">x</span> <span class="main">(</span><span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> UNIV<span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> p_def<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> U_ce <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> c_pair <span class="bound">x</span> <span class="main">(</span><span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> UNIV<span class="main">}</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> c_graph_def <span class="keyword1"><span class="command">have</span></span> c_graph_f_is_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"c_graph <span class="free">f</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> c_graph_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> total_recursive_def1<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> comp_tot_rec<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> total_recursive <span class="free">f</span><span class="main">;</span> total_recursive <span class="free">g</span> <span class="main">⟧</span> <span class="main">⟹</span> total_recursive <span class="main">(</span><span class="free">f</span> <span class="keyword1">o</span> <span class="free">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"total_recursive <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> f_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"graph <span class="free">f</span> <span class="main">∈</span> ce_rels"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> total_recursive_def<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"total_recursive <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> g_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"graph <span class="free">g</span> <span class="main">∈</span> ce_rels"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> total_recursive_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> f_ce g_ce <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"graph <span class="free">g</span> <span class="keyword1">O</span> graph <span class="free">f</span> <span class="main">∈</span> ce_rels"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_rel_lm_24<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"graph <span class="main">(</span><span class="free">f</span> <span class="keyword1">o</span> <span class="free">g</span><span class="main">)</span> <span class="main">∈</span> ce_rels"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> graph_lm_4<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> total_recursive_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-univ_for_pr_tot_rec_lm"><span class="command">lemma</span></span> univ_for_pr_tot_rec_lm<span class="main">:</span> <span class="quoted"><span class="quoted">"c_graph univ_for_pr <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> c_graph univ_for_pr"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A_def <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">{</span> c_pair <span class="bound">x</span> <span class="main">(</span>univ_for_pr <span class="bound">x</span><span class="main">)</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> UNIV <span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_graph_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">z</span> <span class="main">.</span> <span class="main">∃</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">z</span> <span class="main">=</span> c_pair <span class="bound">x</span> <span class="main">(</span>univ_for_pr <span class="bound">x</span><span class="main">)</span> <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">z</span> <span class="main">=</span> c_pair <span class="bound">x</span> <span class="main">(</span>univ_for_pr <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>univ_for_pr <span class="main">(</span>c_fst <span class="bound">z</span><span class="main">)</span> <span class="main">=</span> c_snd <span class="bound">z</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">=</span> c_pair <span class="bound">x</span> <span class="main">(</span>univ_for_pr <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>univ_for_pr <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> c_snd <span class="skolem">z</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">x</span><span class="main">.</span> <span class="skolem">z</span> <span class="main">=</span> c_pair <span class="bound">x</span> <span class="main">(</span>univ_for_pr <span class="bound">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> S3_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> c_pair <span class="skolem">x</span> <span class="main">(</span>univ_for_pr <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> c_snd <span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> c_snd <span class="skolem">z</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> c_pair <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>univ_for_pr <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">x</span><span class="main">.</span> <span class="skolem">z</span> <span class="main">=</span> c_pair <span class="bound">x</span> <span class="main">(</span>univ_for_pr <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">z</span> <span class="main">.</span> univ_for_pr <span class="main">(</span>c_fst <span class="bound">z</span><span class="main">)</span> <span class="main">=</span> c_snd <span class="bound">z</span> <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">=</span>
    <span class="main">(</span><span class="keyword1">if</span> c_assoc_have_key <span class="main">(</span>pr_gr <span class="skolem">y</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span>
      <span class="main">(</span><span class="keyword1">if</span> c_assoc_value <span class="main">(</span>pr_gr <span class="skolem">y</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> c_snd <span class="skolem">x</span> <span class="keyword1">then</span> <span class="main">(</span><span class="main">0</span><span class="main">::</span>nat<span class="main">)</span> <span class="keyword1">else</span> <span class="main">1</span><span class="main">)</span>
    <span class="keyword1">else</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span>
  <span class="keyword1"><span class="command">from</span></span> c_assoc_have_key_is_pr c_assoc_value_is_pr pr_gr_is_pr <span class="keyword1"><span class="command">have</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> PrimRec2"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> p_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> S5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span>univ_for_pr <span class="main">(</span>c_fst <span class="bound">z</span><span class="main">)</span> <span class="main">=</span> c_snd <span class="bound">z</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">p</span> <span class="bound">z</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>univ_for_pr <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> c_snd <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">p</span> <span class="skolem">z</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> c_snd <span class="skolem">z</span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_fst <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"loc_upb <span class="var">?n</span> <span class="var">?x</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> S5_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="var">?y</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?n</span> <span class="var">?x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_upb_main<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> S5_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="main">(</span>pr_gr <span class="var">?y</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="var">?n</span> <span class="var">?x</span><span class="main">)</span> <span class="main">=</span> univ_for_pr <span class="main">(</span>c_pair <span class="var">?n</span> <span class="var">?x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_gr_value<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> S5_1 <span class="keyword1"><span class="command">have</span></span> S5_3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="var">?y</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> S5_2 A <span class="keyword1"><span class="command">have</span></span> S5_4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="main">(</span>pr_gr <span class="var">?y</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> c_snd <span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> S5_3 S5_4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">z</span> <span class="var">?y</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> p_def<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">p</span> <span class="skolem">z</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="skolem">p</span> <span class="skolem">z</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> S5_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">z</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
      <span class="keyword1"><span class="command">have</span></span> S5_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="skolem">y</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> A_1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_have_key <span class="main">(</span>pr_gr <span class="skolem">y</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">z</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> p_def<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> S5_1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S5_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">z</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> c_assoc_value <span class="main">(</span>pr_gr <span class="skolem">y</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> c_snd <span class="skolem">z</span> <span class="keyword1">then</span> <span class="main">(</span><span class="main">0</span><span class="main">::</span>nat<span class="main">)</span> <span class="keyword1">else</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> p_def<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> S5_4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="main">(</span>pr_gr <span class="skolem">y</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> c_snd <span class="skolem">z</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> A_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="main">(</span>pr_gr <span class="skolem">y</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">≠</span> c_snd <span class="skolem">z</span>"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">z</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> p_def<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> S5_1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">have</span></span> S5_5<span class="main">:</span> <span class="quoted"><span class="quoted">"c_is_sub_fun <span class="main">(</span>pr_gr <span class="skolem">y</span><span class="main">)</span> univ_for_pr"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_gr_1<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> S5_5 S5_2 <span class="keyword1"><span class="command">have</span></span> S5_6<span class="main">:</span> <span class="quoted"><span class="quoted">"c_assoc_value <span class="main">(</span>pr_gr <span class="skolem">y</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> univ_for_pr <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_is_sub_fun_lm_1<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> S5_4 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> c_snd <span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> S5 S4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">{</span><span class="bound">z</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">p</span> <span class="bound">z</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> fn_to_set <span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> p_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"fn_to_set <span class="skolem">p</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A_def <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> univ_for_pr_tot_rec<span class="main">:</span> <span class="quoted"><span class="quoted">"total_recursive univ_for_pr"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_graph univ_for_pr <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> univ_for_pr_tot_rec_lm<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> total_recursive_def1<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Computable sets, Post's theorem›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">computable</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat set <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">computable</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">A</span><span class="main">.</span> <span class="bound">A</span> <span class="main">∈</span> ce_sets <span class="main">∧</span> <span class="main">-</span><span class="bound">A</span> <span class="main">∈</span> ce_sets<span class="main">)</span>"</span></span>

<span class="keyword1" id="RecEnSet-computable_complement_1"><span class="command">lemma</span></span> computable_complement_1<span class="main">:</span> <span class="quoted"><span class="quoted">"computable <span class="free">A</span> <span class="main">⟹</span> computable <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"computable <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> computable_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-computable_complement_2"><span class="command">lemma</span></span> computable_complement_2<span class="main">:</span> <span class="quoted"><span class="quoted">"computable <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> computable <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"computable <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> computable_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-computable_complement_3"><span class="command">lemma</span></span> computable_complement_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>computable <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>computable <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> computable_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> comp_impl_tot_rec<span class="main">:</span> <span class="quoted"><span class="quoted">"computable <span class="free">A</span> <span class="main">⟹</span> total_recursive <span class="main">(</span>chf <span class="free">A</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"computable <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> computable_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> computable_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">x</span> <span class="main">=</span> c_pair <span class="skolem">x</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">x</span> <span class="main">=</span> c_pair <span class="skolem">x</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">from</span></span> p_def <span class="keyword1"><span class="command">have</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> p_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">from</span></span> q_def <span class="keyword1"><span class="command">have</span></span> q_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> q_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">U0</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U0</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">p</span> <span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">}</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">U1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U1</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">q</span> <span class="bound">x</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">-</span> <span class="free">A</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 p_is_pr <span class="keyword1"><span class="command">have</span></span> U0_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">U0</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold</span> U0_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ce_set_lm_7<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A2 q_is_pr <span class="keyword1"><span class="command">have</span></span> U1_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">U1</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold</span> U1_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ce_set_lm_7<span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">U</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">=</span> <span class="skolem">U0</span> <span class="main">∪</span> <span class="skolem">U1</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> U0_ce U1_ce <span class="keyword1"><span class="command">have</span></span> U_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> U_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ce_union<span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">V</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">=</span> c_graph <span class="main">(</span>chf <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> V_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">=</span> <span class="main">{</span> c_pair <span class="bound">x</span> <span class="main">(</span>chf <span class="free">A</span> <span class="bound">x</span><span class="main">)</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> UNIV<span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> V_def c_graph_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> U0_def p_def <span class="keyword1"><span class="command">have</span></span> U0_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">U0</span> <span class="main">=</span> <span class="main">{</span> c_pair <span class="bound">x</span> <span class="bound">y</span> <span class="main">|</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y</span><span class="main">=</span><span class="main">0</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> U1_def q_def <span class="keyword1"><span class="command">have</span></span> U1_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">U1</span> <span class="main">=</span> <span class="main">{</span> c_pair <span class="bound">x</span> <span class="bound">y</span> <span class="main">|</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∉</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y</span><span class="main">=</span><span class="main">1</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> U0_1 U1_1 U_def <span class="keyword1"><span class="command">have</span></span> U_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">=</span> <span class="main">{</span> c_pair <span class="bound">x</span> <span class="bound">y</span> <span class="main">|</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y</span><span class="main">=</span><span class="main">0</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∉</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y</span><span class="main">=</span><span class="main">1</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> V_1 <span class="keyword1"><span class="command">have</span></span> V_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">=</span> <span class="main">{</span> c_pair <span class="bound">x</span> <span class="bound">y</span> <span class="main">|</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">=</span> chf <span class="free">A</span> <span class="bound">x</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y</span><span class="main">=</span><span class="main">0</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∉</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y</span><span class="main">=</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="bound">y</span> <span class="main">=</span> chf <span class="free">A</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="skolem">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="skolem">y</span><span class="main">=</span><span class="main">0</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">∉</span> <span class="free">A</span> <span class="main">∧</span> <span class="skolem">y</span><span class="main">=</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">=</span> chf <span class="free">A</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold</span> chf_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> V_2 U_1 L1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">=</span><span class="skolem">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> U_ce <span class="keyword1"><span class="command">have</span></span> V_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> V_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_graph <span class="main">(</span>chf <span class="free">A</span><span class="main">)</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> total_recursive_def1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> tot_rec_impl_comp<span class="main">:</span> <span class="quoted"><span class="quoted">"total_recursive <span class="main">(</span>chf <span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> computable <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"total_recursive <span class="main">(</span>chf <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_graph <span class="main">(</span>chf <span class="free">A</span><span class="main">)</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> total_recursive_def1<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?U</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_graph <span class="main">(</span>chf <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?U</span> <span class="main">=</span> <span class="main">{</span> c_pair <span class="bound">x</span> <span class="main">(</span>chf <span class="free">A</span> <span class="bound">x</span><span class="main">)</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> UNIV<span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_graph_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y</span><span class="main">=</span><span class="main">0</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∉</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y</span><span class="main">=</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="bound">y</span> <span class="main">=</span> chf <span class="free">A</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="skolem">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="skolem">y</span><span class="main">=</span><span class="main">0</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">∉</span> <span class="free">A</span> <span class="main">∧</span> <span class="skolem">y</span><span class="main">=</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">=</span> chf <span class="free">A</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold</span> chf_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> L1 L2 <span class="keyword1"><span class="command">have</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?U</span> <span class="main">=</span> <span class="main">{</span> c_pair <span class="bound">x</span> <span class="bound">y</span> <span class="main">|</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y</span><span class="main">=</span><span class="main">0</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∉</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y</span><span class="main">=</span><span class="main">1</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">x</span> <span class="main">=</span> c_pair <span class="skolem">x</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">x</span> <span class="main">=</span> c_pair <span class="skolem">x</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">have</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> p_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> q_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> q_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">V</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">=</span> <span class="main">{</span> c_pair <span class="bound">x</span> <span class="bound">y</span> <span class="main">|</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y</span><span class="main">=</span><span class="main">0</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∉</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y</span><span class="main">=</span><span class="main">1</span><span class="main">)</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> V_def L3 A1 <span class="keyword1"><span class="command">have</span></span> V_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> V_def <span class="keyword1"><span class="command">have</span></span> L4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span><span class="bound">z</span> <span class="main">∈</span> <span class="skolem">V</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">z</span> <span class="main">=</span> c_pair <span class="bound">x</span> <span class="bound">y</span> <span class="main">∧</span>  <span class="main">(</span><span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y</span><span class="main">=</span><span class="main">0</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∉</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y</span><span class="main">=</span><span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> L5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="skolem">p</span> <span class="bound">x</span> <span class="main">∈</span> <span class="skolem">V</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">p</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">V</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">V</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="skolem">x</span> <span class="main">0</span> <span class="main">∈</span> <span class="skolem">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> p_def<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> V_def <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x1</span></span> <span class="skolem"><span class="skolem">y1</span></span> <span class="keyword2"><span class="keyword">where</span></span> L5_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="skolem">x</span> <span class="main">0</span> <span class="main">=</span> c_pair <span class="skolem">x1</span> <span class="skolem">y1</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> L5_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="skolem">x1</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="skolem">y1</span><span class="main">=</span><span class="main">0</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="skolem">x1</span> <span class="main">∉</span> <span class="free">A</span> <span class="main">∧</span> <span class="skolem">y1</span><span class="main">=</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> L5_2 <span class="keyword1"><span class="command">have</span></span> X_eq_X1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="skolem">x1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_inj1<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> L5_2 <span class="keyword1"><span class="command">have</span></span> Y1_eq_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">=</span><span class="skolem">y1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_inj2<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> L5_3 X_eq_X1 Y1_eq_0 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_pair <span class="skolem">x</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> L5_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">x1</span> <span class="bound">y1</span><span class="main">.</span> c_pair <span class="skolem">x</span> <span class="main">0</span> <span class="main">=</span> c_pair <span class="bound">x1</span> <span class="bound">y1</span> <span class="main">∧</span>  <span class="main">(</span><span class="main">(</span><span class="bound">x1</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y1</span><span class="main">=</span><span class="main">0</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">x1</span> <span class="main">∉</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y1</span><span class="main">=</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> V_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="skolem">x</span> <span class="main">0</span> <span class="main">∈</span> <span class="skolem">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> p_def <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> A_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">p</span> <span class="bound">x</span> <span class="main">∈</span> <span class="skolem">V</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> V_ce p_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">p</span> <span class="bound">x</span> <span class="main">∈</span> <span class="skolem">V</span><span class="main">}</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_lm_5<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A_eq <span class="keyword1"><span class="command">have</span></span> A_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> CA_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="free">A</span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="skolem">q</span> <span class="bound">x</span> <span class="main">∈</span> <span class="skolem">V</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="skolem">q</span> <span class="bound">x</span> <span class="main">∈</span> <span class="skolem">V</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∉</span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">q</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">V</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">∉</span> <span class="free">A</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span>
        <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">V</span>"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="skolem">x</span> <span class="main">1</span> <span class="main">∈</span> <span class="skolem">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> q_def<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> V_def <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x1</span></span> <span class="skolem"><span class="skolem">y1</span></span> <span class="keyword2"><span class="keyword">where</span></span> L5_2<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="skolem">x</span> <span class="main">1</span> <span class="main">=</span> c_pair <span class="skolem">x1</span> <span class="skolem">y1</span>"</span></span>
          <span class="keyword2"><span class="keyword">and</span></span> L5_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="skolem">x1</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="skolem">y1</span><span class="main">=</span><span class="main">0</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="skolem">x1</span> <span class="main">∉</span> <span class="free">A</span> <span class="main">∧</span> <span class="skolem">y1</span><span class="main">=</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> L5_2 <span class="keyword1"><span class="command">have</span></span> X_eq_X1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="skolem">x1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_inj1<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> L5_2 <span class="keyword1"><span class="command">have</span></span> Y1_eq_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">=</span><span class="skolem">y1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_inj2<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> L5_3 X_eq_X1 Y1_eq_1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∉</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∉</span> <span class="free">A</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> L5_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">x1</span> <span class="bound">y1</span><span class="main">.</span> c_pair <span class="skolem">x</span> <span class="main">1</span> <span class="main">=</span> c_pair <span class="bound">x1</span> <span class="bound">y1</span> <span class="main">∧</span>  <span class="main">(</span><span class="main">(</span><span class="bound">x1</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y1</span><span class="main">=</span><span class="main">0</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">x1</span> <span class="main">∉</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y1</span><span class="main">=</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> V_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="skolem">x</span> <span class="main">1</span> <span class="main">∈</span> <span class="skolem">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> q_def <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> V_ce q_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">q</span> <span class="bound">x</span> <span class="main">∈</span> <span class="skolem">V</span><span class="main">}</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_lm_5<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> CA_eq <span class="keyword1"><span class="command">have</span></span> CA_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A_ce CA_ce <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> computable_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> post_th_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>computable <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>total_recursive <span class="main">(</span>chf <span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"computable <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"total_recursive <span class="main">(</span>chf <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> comp_impl_tot_rec<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"total_recursive <span class="main">(</span>chf <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"computable <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> tot_rec_impl_comp<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Universal computably enumerable set›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">univ_ce</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">univ_ce</span> <span class="main">=</span> <span class="main">{</span> c_pair <span class="bound">n</span> <span class="bound">x</span> <span class="main">|</span> <span class="bound">n</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> nat_to_ce_set <span class="bound">n</span> <span class="main">}</span>"</span></span>

<span class="keyword1" id="RecEnSet-univ_for_pr_lm"><span class="command">lemma</span></span> univ_for_pr_lm<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>nat_to_pr <span class="free">n</span><span class="main">)</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_def pr_conv_2_to_1_def<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> univ_is_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_ce <span class="main">∈</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> c_graph univ_for_pr"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_tot_rec_lm<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">pA</span> <span class="main">∈</span> PrimRec2<span class="main">.</span> <span class="skolem">A</span> <span class="main">=</span> fn_to_set <span class="bound">pA</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_lm_3<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">pA</span></span> <span class="keyword2"><span class="keyword">where</span></span> pA_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">pA</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword2"><span class="keyword">and</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> fn_to_set <span class="skolem">pA</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> S1 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">pA</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span> <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">z</span> <span class="skolem">y</span> <span class="main">=</span> <span class="skolem">pA</span> <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="skolem">y</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">z</span> <span class="skolem">y</span>
  <span class="keyword1"><span class="command">from</span></span> pA_is_pr <span class="keyword1"><span class="command">have</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> PrimRec2"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> p_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">n</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">z</span> <span class="main">=</span> c_pair <span class="bound">n</span> <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">∈</span> nat_to_ce_set <span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>c_snd <span class="bound">z</span> <span class="main">∈</span> nat_to_ce_set <span class="main">(</span>c_fst <span class="bound">z</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span> <span class="bound">n</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">z</span> <span class="main">=</span> c_pair <span class="bound">n</span> <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">∈</span> nat_to_ce_set <span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>c_snd <span class="skolem">z</span> <span class="main">∈</span> nat_to_ce_set <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">z</span> <span class="main">=</span> c_pair <span class="bound">n</span> <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">∈</span> nat_to_ce_set <span class="bound">n</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> c_pair <span class="skolem">n</span> <span class="skolem">x</span> <span class="main">∧</span> <span class="skolem">x</span> <span class="main">∈</span> nat_to_ce_set <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> L1 <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> c_pair <span class="skolem">n</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> L1 <span class="keyword1"><span class="command">have</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> nat_to_ce_set <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> L1 <span class="keyword1"><span class="command">have</span></span> L4<span class="main">:</span> <span class="quoted"><span class="quoted">"c_fst <span class="skolem">z</span> <span class="main">=</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> L1 <span class="keyword1"><span class="command">have</span></span> L5<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="skolem">z</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> L3 L4 L5 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_snd <span class="skolem">z</span> <span class="main">∈</span> nat_to_ce_set <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="skolem">z</span> <span class="main">∈</span> nat_to_ce_set <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_fst <span class="skolem">z</span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"c_snd <span class="skolem">z</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> c_pair <span class="var">?n</span> <span class="var">?x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> L1 A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> c_pair <span class="var">?n</span> <span class="var">?x</span> <span class="main">∧</span> <span class="var">?x</span> <span class="main">∈</span> nat_to_ce_set <span class="var">?n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">z</span> <span class="main">=</span> c_pair <span class="bound">n</span> <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">∈</span> nat_to_ce_set <span class="bound">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span> c_pair <span class="bound">n</span> <span class="bound">x</span> <span class="main">|</span> <span class="bound">n</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> nat_to_ce_set <span class="bound">n</span> <span class="main">}</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">z</span><span class="main">.</span> c_snd <span class="bound">z</span> <span class="main">∈</span> nat_to_ce_set <span class="main">(</span>c_fst <span class="bound">z</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_ce  <span class="main">=</span> <span class="main">{</span> <span class="bound">z</span><span class="main">.</span> c_snd <span class="bound">z</span> <span class="main">∈</span> nat_to_ce_set <span class="main">(</span>c_fst <span class="bound">z</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_ce_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> S4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span>c_snd <span class="bound">z</span> <span class="main">∈</span> nat_to_ce_set <span class="main">(</span>c_fst <span class="bound">z</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">p</span> <span class="bound">z</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_snd <span class="skolem">z</span> <span class="main">∈</span> nat_to_ce_set <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">p</span> <span class="skolem">z</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="skolem">z</span> <span class="main">∈</span> nat_to_ce_set <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span>nat_to_pr <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_ce_set_lm_1<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> A <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> S4_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat_to_pr <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="skolem">u</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S4_2<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="skolem">u</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_lm<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> A_def <span class="keyword1"><span class="command">have</span></span> S4_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">{</span> c_pair <span class="bound">x</span> <span class="main">(</span>univ_for_pr <span class="bound">x</span><span class="main">)</span> <span class="main">|</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> UNIV <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> c_graph_def<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S4_4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> c_pair <span class="bound">x</span> <span class="main">(</span>univ_for_pr <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="skolem">u</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>univ_for_pr <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="skolem">u</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> S4_2 <span class="keyword1"><span class="command">have</span></span> S4_5<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="skolem">u</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> S4_6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">pA</span> <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="skolem">u</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span><span class="main">)</span> <span class="skolem">v</span> <span class="main">=</span> <span class="main">0</span>"</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> c_pair <span class="skolem">u</span> <span class="skolem">v</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> y_def <span class="keyword1"><span class="command">have</span></span> S4_7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">=</span> c_fst <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> y_def <span class="keyword1"><span class="command">have</span></span> S4_8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">=</span> c_snd <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> S4_6 S4_7 S4_8 p_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">z</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">p</span> <span class="skolem">z</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="skolem">p</span> <span class="skolem">z</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> S4_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">z</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
      <span class="keyword1"><span class="command">from</span></span> S4_1 p_def <span class="keyword1"><span class="command">have</span></span> S4_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">pA</span> <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span><span class="main">)</span> <span class="main">(</span>c_snd <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword1"><span class="command">have</span></span> S4_3<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> A_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span> <span class="main">∈</span> c_graph univ_for_pr"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S4_4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">=</span> univ_for_pr <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_graph_lm_1<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S4_5<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_for_pr <span class="main">(</span>c_pair <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S4_6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat_to_pr <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="main">(</span>c_fst <span class="skolem">y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_for_pr_lm<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S4_7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span>nat_to_pr <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_snd <span class="skolem">z</span><span class="main">)</span> <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
      <span class="keyword1"><span class="command">have</span></span> S4_8<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span>nat_to_pr <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_ce_set_lm_1<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> S4_7 <span class="keyword1"><span class="command">have</span></span> S4_9<span class="main">:</span> <span class="quoted"><span class="quoted">"c_snd <span class="skolem">z</span> <span class="main">∈</span> <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span>nat_to_pr <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> S4_8 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_snd <span class="skolem">z</span> <span class="main">∈</span> nat_to_ce_set <span class="main">(</span>c_fst <span class="skolem">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> S3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"univ_ce <span class="main">=</span> <span class="main">{</span><span class="bound">z</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span><span class="main">.</span> <span class="skolem">p</span> <span class="bound">z</span> <span class="bound">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"univ_ce <span class="main">=</span> fn_to_set <span class="skolem">p</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fn_to_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> p_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"fn_to_set <span class="skolem">p</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"univ_ce <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-univ_ce_lm_1"><span class="command">lemma</span></span> univ_ce_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_pair <span class="free">n</span> <span class="free">x</span> <span class="main">∈</span> univ_ce<span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">∈</span> nat_to_ce_set <span class="free">n</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> univ_ce_def <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"univ_ce <span class="main">=</span> <span class="main">{</span><span class="bound">z</span> <span class="main">.</span> <span class="main">∃</span> <span class="bound">n</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">z</span> <span class="main">=</span> c_pair <span class="bound">n</span> <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">∈</span> nat_to_ce_set <span class="bound">n</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span> <span class="bound">n1</span> <span class="bound">x1</span><span class="main">.</span> c_pair <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> c_pair <span class="bound">n1</span> <span class="bound">x1</span> <span class="main">∧</span> <span class="bound">x1</span> <span class="main">∈</span> nat_to_ce_set <span class="bound">n1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">∈</span> nat_to_ce_set <span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n1</span> <span class="bound">x1</span><span class="main">.</span> c_pair <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> c_pair <span class="bound">n1</span> <span class="bound">x1</span> <span class="main">∧</span> <span class="bound">x1</span> <span class="main">∈</span> nat_to_ce_set <span class="bound">n1</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n1</span></span> <span class="skolem"><span class="skolem">x1</span></span> <span class="keyword2"><span class="keyword">where</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> c_pair <span class="skolem">n1</span> <span class="skolem">x1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x1</span> <span class="main">∈</span> nat_to_ce_set <span class="skolem">n1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> L1 <span class="keyword1"><span class="command">have</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">=</span> <span class="skolem">n1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_inj1<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> L1 <span class="keyword1"><span class="command">have</span></span> L4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="skolem">x1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_inj2<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> L2 L3 L4 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> nat_to_ce_set <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> nat_to_ce_set <span class="free">n</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> c_pair <span class="free">n</span> <span class="free">x</span> <span class="main">∧</span> <span class="free">x</span> <span class="main">∈</span> nat_to_ce_set <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">n1</span> <span class="bound">x1</span><span class="main">.</span> c_pair <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> c_pair <span class="bound">n1</span> <span class="bound">x1</span> <span class="main">∧</span> <span class="bound">x1</span> <span class="main">∈</span> nat_to_ce_set <span class="bound">n1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> univ_ce_is_not_comp1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span> univ_ce <span class="main">∉</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">-</span> univ_ce <span class="main">∉</span> ce_sets"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span> univ_ce <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="skolem">x</span> <span class="main">=</span> c_pair <span class="skolem">x</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">have</span></span> p_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> p_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">p</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">-</span> univ_ce <span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A p_is_pr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">p</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">-</span> univ_ce <span class="main">}</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ce_set_lm_5<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A_def <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">n</span><span class="main">.</span> <span class="skolem">A</span> <span class="main">=</span> nat_to_ce_set <span class="bound">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_ce_set_srj<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> nat_to_ce_set <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">from</span></span> A_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">n</span> <span class="main">∈</span> <span class="skolem">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span> <span class="skolem">n</span> <span class="main">∈</span> <span class="main">-</span> univ_ce<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> p_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">n</span> <span class="main">∈</span> <span class="skolem">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="skolem">n</span> <span class="skolem">n</span> <span class="main">∉</span> univ_ce<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> univ_ce_def univ_ce_lm_1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">n</span> <span class="main">∈</span> <span class="skolem">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">∉</span> nat_to_ce_set <span class="skolem">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> S2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">n</span> <span class="main">∈</span> <span class="skolem">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">∉</span> <span class="skolem">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> univ_ce_is_not_comp2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> total_recursive <span class="main">(</span>chf univ_ce<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"total_recursive <span class="main">(</span>chf univ_ce<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"computable univ_ce"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> tot_rec_impl_comp<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span> univ_ce <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> computable_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> univ_ce_is_not_comp1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> univ_ce_is_not_comp3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> computable univ_ce"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">¬</span> computable univ_ce"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"computable univ_ce"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"total_recursive <span class="main">(</span>chf univ_ce<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> comp_impl_tot_rec<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> univ_ce_is_not_comp2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹s-1-1 theorem, one-one and many-one reducibilities›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">index_of_r_to_l</span> <span class="main">::</span> <span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">index_of_r_to_l</span> <span class="main">=</span>
  pair_by_index
    <span class="main">(</span>pair_by_index index_of_c_fst <span class="main">(</span>comp_by_index index_of_c_fst index_of_c_snd<span class="main">)</span><span class="main">)</span>
    <span class="main">(</span>comp_by_index index_of_c_snd index_of_c_snd<span class="main">)</span>"</span></span>

<span class="keyword1" id="RecEnSet-index_of_r_to_l_lm"><span class="command">lemma</span></span> index_of_r_to_l_lm<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_pr index_of_r_to_l <span class="main">(</span>c_pair <span class="free">x</span> <span class="main">(</span>c_pair <span class="free">y</span> <span class="free">z</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> c_pair <span class="main">(</span>c_pair <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="free">z</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">unfold</span> index_of_r_to_l_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pair_by_index_main<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">unfold</span> c_f_pair_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_c_fst_main<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_by_index_main<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_c_fst_main<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_c_snd_main<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">s_ce</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">s_ce</span> <span class="main">==</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">e</span> <span class="bound">x</span><span class="main">.</span> s1_1 <span class="main">(</span>comp_by_index <span class="bound">e</span> index_of_r_to_l<span class="main">)</span> <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="RecEnSet-s_ce_is_pr"><span class="command">lemma</span></span> s_ce_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"s_ce <span class="main">∈</span> PrimRec2"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> s_ce_def <span class="keyword1"><span class="command">using</span></span> comp_by_index_is_pr s1_1_is_pr <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>

<span class="keyword1" id="RecEnSet-s_ce_inj"><span class="command">lemma</span></span> s_ce_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"s_ce <span class="free">e1</span> <span class="free">x1</span> <span class="main">=</span> s_ce <span class="free">e2</span> <span class="free">x2</span> <span class="main">⟹</span> <span class="free">e1</span><span class="main">=</span><span class="free">e2</span> <span class="main">∧</span> <span class="free">x1</span><span class="main">=</span><span class="free">x2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"index_of_r_to_l"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"s_ce <span class="free">e1</span> <span class="free">x1</span> <span class="main">=</span> s_ce <span class="free">e2</span> <span class="free">x2</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"s1_1 <span class="main">(</span>comp_by_index <span class="free">e1</span> <span class="var">?n1</span><span class="main">)</span> <span class="free">x1</span> <span class="main">=</span> s1_1 <span class="main">(</span>comp_by_index <span class="free">e2</span> <span class="var">?n1</span><span class="main">)</span> <span class="free">x2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> s_ce_def<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"comp_by_index <span class="free">e1</span> <span class="var">?n1</span> <span class="main">=</span> comp_by_index <span class="free">e2</span> <span class="var">?n1</span> <span class="main">∧</span> <span class="free">x1</span><span class="main">=</span><span class="free">x2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> s1_1_inj<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> L1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"comp_by_index <span class="free">e1</span> <span class="var">?n1</span> <span class="main">=</span> comp_by_index <span class="free">e2</span> <span class="var">?n1</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">e1</span><span class="main">=</span><span class="free">e2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> comp_by_index_inj1<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> L1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x1</span><span class="main">=</span><span class="free">x2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-s_ce_inj1"><span class="command">lemma</span></span> s_ce_inj1<span class="main">:</span> <span class="quoted"><span class="quoted">"s_ce <span class="free">e1</span> <span class="free">x</span> <span class="main">=</span> s_ce <span class="free">e2</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">e1</span><span class="main">=</span><span class="free">e2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"s_ce <span class="free">e1</span> <span class="free">x</span> <span class="main">=</span> s_ce <span class="free">e2</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">e1</span><span class="main">=</span><span class="free">e2</span> <span class="main">∧</span> <span class="free">x</span><span class="main">=</span><span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> s_ce_inj<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">e1</span><span class="main">=</span><span class="free">e2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-s_ce_inj2"><span class="command">lemma</span></span> s_ce_inj2<span class="main">:</span> <span class="quoted"><span class="quoted">"s_ce <span class="free">e</span> <span class="free">x1</span> <span class="main">=</span> s_ce <span class="free">e</span> <span class="free">x2</span> <span class="main">⟹</span> <span class="free">x1</span><span class="main">=</span><span class="free">x2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"s_ce <span class="free">e</span> <span class="free">x1</span> <span class="main">=</span> s_ce <span class="free">e</span> <span class="free">x2</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span><span class="main">=</span><span class="free">e</span> <span class="main">∧</span> <span class="free">x1</span><span class="main">=</span><span class="free">x2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> s_ce_inj<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x1</span><span class="main">=</span><span class="free">x2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> s1_1_th1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">n</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span>nat_to_pr <span class="bound">n</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>nat_to_pr <span class="main">(</span>s1_1 <span class="bound">n</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="bound">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"nat_to_pr <span class="skolem">n</span> <span class="main">(</span>c_pair <span class="skolem">x</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>s1_1 <span class="skolem">n</span> <span class="skolem">x</span><span class="main">)</span> <span class="skolem">y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span>nat_to_pr <span class="skolem">n</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="skolem">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>s1_1 <span class="skolem">n</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> s1_1_th<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fun_eq_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-s_lm"><span class="command">lemma</span></span> s_lm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat_to_pr <span class="main">(</span>s_ce <span class="free">e</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">y</span> <span class="free">z</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>nat_to_pr <span class="free">e</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="free">z</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"index_of_r_to_l"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat_to_pr <span class="main">(</span>s_ce <span class="free">e</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">y</span> <span class="free">z</span><span class="main">)</span> <span class="main">=</span> nat_to_pr <span class="main">(</span>s1_1 <span class="main">(</span>comp_by_index <span class="free">e</span> <span class="var">?n1</span><span class="main">)</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">y</span> <span class="free">z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> s_ce_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span>nat_to_pr <span class="main">(</span>comp_by_index <span class="free">e</span> <span class="var">?n1</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">x</span> <span class="main">(</span>c_pair <span class="free">y</span> <span class="free">z</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> s1_1_th1<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span>nat_to_pr <span class="free">e</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span>nat_to_pr <span class="var">?n1</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">x</span> <span class="main">(</span>c_pair <span class="free">y</span> <span class="free">z</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_by_index_main<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> index_of_r_to_l_lm<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> s_ce_1_1_th<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> nat_to_ce_set <span class="free">e</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">y</span> <span class="main">∈</span> nat_to_ce_set <span class="main">(</span>s_ce <span class="free">e</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> nat_to_ce_set <span class="free">e</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat_to_pr <span class="free">e</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_ce_set_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat_to_pr <span class="main">(</span>s_ce <span class="free">e</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">y</span> <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> s_lm L1<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> nat_to_ce_set_lm_1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">∈</span> nat_to_ce_set <span class="main">(</span>s_ce <span class="free">e</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">∈</span> nat_to_ce_set <span class="main">(</span>s_ce <span class="free">e</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat_to_pr <span class="main">(</span>s_ce <span class="free">e</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="free">y</span> <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nat_to_ce_set_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat_to_pr <span class="free">e</span><span class="main">)</span> <span class="main">(</span>c_pair <span class="main">(</span>c_pair <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="skolem">z</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> s_lm<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> nat_to_ce_set_lm_1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">x</span> <span class="free">y</span> <span class="main">∈</span> nat_to_ce_set <span class="free">e</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">one_reducible_to_via</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat set<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat set<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">one_reducible_to_via</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">A</span> <span class="bound">B</span> <span class="bound">f</span><span class="main">.</span> total_recursive <span class="bound">f</span> <span class="main">∧</span> inj <span class="bound">f</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="bound">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="bound">f</span> <span class="bound">x</span> <span class="main">∈</span> <span class="bound">B</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">one_reducible_to</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat set<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat set<span class="main">)</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">one_reducible_to</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">A</span> <span class="bound">B</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">f</span><span class="main">.</span> one_reducible_to_via <span class="bound">A</span> <span class="bound">B</span> <span class="bound">f</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">many_reducible_to_via</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat set<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat set<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">many_reducible_to_via</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">A</span> <span class="bound">B</span> <span class="bound">f</span><span class="main">.</span> total_recursive <span class="bound">f</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="bound">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="bound">f</span> <span class="bound">x</span> <span class="main">∈</span> <span class="bound">B</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">many_reducible_to</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat set<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat set<span class="main">)</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">many_reducible_to</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">A</span> <span class="bound">B</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">f</span><span class="main">.</span> many_reducible_to_via <span class="bound">A</span> <span class="bound">B</span> <span class="bound">f</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="RecEnSet-one_reducible_to_via_trans"><span class="command">lemma</span></span> one_reducible_to_via_trans<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> one_reducible_to_via <span class="free">A</span> <span class="free">B</span> <span class="free">f</span><span class="main">;</span> one_reducible_to_via <span class="free">B</span> <span class="free">C</span> <span class="free">g</span> <span class="main">⟧</span> <span class="main">⟹</span> one_reducible_to_via <span class="free">A</span> <span class="free">C</span> <span class="main">(</span><span class="free">g</span> <span class="keyword1">o</span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"one_reducible_to_via <span class="free">A</span> <span class="free">B</span> <span class="free">f</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"one_reducible_to_via <span class="free">B</span> <span class="free">C</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> f_tr<span class="main">:</span> <span class="quoted"><span class="quoted">"total_recursive <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> one_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> f_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"inj <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> one_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> one_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> g_tr<span class="main">:</span> <span class="quoted"><span class="quoted">"total_recursive <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> one_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> g_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"inj <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> one_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> one_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> g_tr f_tr <span class="keyword1"><span class="command">have</span></span> fg_tr<span class="main">:</span> <span class="quoted"><span class="quoted">"total_recursive <span class="main">(</span><span class="free">g</span> <span class="keyword1">o</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> comp_tot_rec<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> g_inj f_inj <span class="keyword1"><span class="command">have</span></span> fg_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"inj <span class="main">(</span><span class="free">g</span> <span class="keyword1">o</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> inj_compose<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> L1 L2 <span class="keyword1"><span class="command">have</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">g</span> <span class="keyword1">o</span> <span class="free">f</span><span class="main">)</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> fg_tr fg_inj <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> one_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-one_reducible_to_trans"><span class="command">lemma</span></span> one_reducible_to_trans<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> one_reducible_to <span class="free">A</span> <span class="free">B</span><span class="main">;</span> one_reducible_to <span class="free">B</span> <span class="free">C</span> <span class="main">⟧</span> <span class="main">⟹</span> one_reducible_to <span class="free">A</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"one_reducible_to <span class="free">A</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"one_reducible_to_via <span class="free">A</span> <span class="free">B</span> <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> one_reducible_to_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"one_reducible_to <span class="free">B</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"one_reducible_to_via <span class="free">B</span> <span class="free">C</span> <span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> one_reducible_to_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"one_reducible_to_via <span class="free">A</span> <span class="free">C</span> <span class="main">(</span><span class="skolem">g</span> <span class="keyword1">o</span> <span class="skolem">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> one_reducible_to_via_trans<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> one_reducible_to_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-one_reducible_to_via_refl"><span class="command">lemma</span></span> one_reducible_to_via_refl<span class="main">:</span> <span class="quoted"><span class="quoted">"one_reducible_to_via <span class="free">A</span> <span class="free">A</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_id1_1<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> is_tr<span class="main">:</span> <span class="quoted"><span class="quoted">"total_recursive <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_is_total_rec<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> is_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"inj <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> is_tr is_inj <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> one_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-one_reducible_to_refl"><span class="command">lemma</span></span> one_reducible_to_refl<span class="main">:</span> <span class="quoted"><span class="quoted">"one_reducible_to <span class="free">A</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"one_reducible_to_via <span class="free">A</span> <span class="free">A</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> one_reducible_to_via_refl<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> one_reducible_to_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-many_reducible_to_via_trans"><span class="command">lemma</span></span> many_reducible_to_via_trans<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> many_reducible_to_via <span class="free">A</span> <span class="free">B</span> <span class="free">f</span><span class="main">;</span> many_reducible_to_via <span class="free">B</span> <span class="free">C</span> <span class="free">g</span> <span class="main">⟧</span> <span class="main">⟹</span> many_reducible_to_via <span class="free">A</span> <span class="free">C</span> <span class="main">(</span><span class="free">g</span> <span class="keyword1">o</span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"many_reducible_to_via <span class="free">A</span> <span class="free">B</span> <span class="free">f</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"many_reducible_to_via <span class="free">B</span> <span class="free">C</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> f_tr<span class="main">:</span> <span class="quoted"><span class="quoted">"total_recursive <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> many_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> many_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> g_tr<span class="main">:</span> <span class="quoted"><span class="quoted">"total_recursive <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> many_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">g</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> many_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> g_tr f_tr <span class="keyword1"><span class="command">have</span></span> fg_tr<span class="main">:</span> <span class="quoted"><span class="quoted">"total_recursive <span class="main">(</span><span class="free">g</span> <span class="keyword1">o</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> comp_tot_rec<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> L1 L2 <span class="keyword1"><span class="command">have</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">g</span> <span class="keyword1">o</span> <span class="free">f</span><span class="main">)</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> fg_tr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> many_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-many_reducible_to_trans"><span class="command">lemma</span></span> many_reducible_to_trans<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> many_reducible_to <span class="free">A</span> <span class="free">B</span><span class="main">;</span> many_reducible_to <span class="free">B</span> <span class="free">C</span> <span class="main">⟧</span> <span class="main">⟹</span> many_reducible_to <span class="free">A</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"many_reducible_to <span class="free">A</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"many_reducible_to_via <span class="free">A</span> <span class="free">B</span> <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> many_reducible_to_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"many_reducible_to <span class="free">B</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"many_reducible_to_via <span class="free">B</span> <span class="free">C</span> <span class="skolem">g</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> many_reducible_to_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"many_reducible_to_via <span class="free">A</span> <span class="free">C</span> <span class="main">(</span><span class="skolem">g</span> <span class="keyword1">o</span> <span class="skolem">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> many_reducible_to_via_trans<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> many_reducible_to_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-one_reducibility_via_is_many"><span class="command">lemma</span></span> one_reducibility_via_is_many<span class="main">:</span> <span class="quoted"><span class="quoted">"one_reducible_to_via <span class="free">A</span> <span class="free">B</span> <span class="free">f</span> <span class="main">⟹</span> many_reducible_to_via <span class="free">A</span> <span class="free">B</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"one_reducible_to_via <span class="free">A</span> <span class="free">B</span> <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> f_tr<span class="main">:</span> <span class="quoted"><span class="quoted">"total_recursive <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> one_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> one_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> f_tr <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> many_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-one_reducibility_is_many"><span class="command">lemma</span></span> one_reducibility_is_many<span class="main">:</span> <span class="quoted"><span class="quoted">"one_reducible_to <span class="free">A</span> <span class="free">B</span> <span class="main">⟹</span> many_reducible_to <span class="free">A</span> <span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"one_reducible_to <span class="free">A</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"one_reducible_to_via <span class="free">A</span> <span class="free">B</span> <span class="skolem">f</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> one_reducible_to_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"many_reducible_to_via <span class="free">A</span> <span class="free">B</span> <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> one_reducibility_via_is_many<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> many_reducible_to_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-many_reducible_to_via_refl"><span class="command">lemma</span></span> many_reducible_to_via_refl<span class="main">:</span> <span class="quoted"><span class="quoted">"many_reducible_to_via <span class="free">A</span> <span class="free">A</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"one_reducible_to_via <span class="free">A</span> <span class="free">A</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> one_reducible_to_via_refl<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> one_reducibility_via_is_many<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-many_reducible_to_refl"><span class="command">lemma</span></span> many_reducible_to_refl<span class="main">:</span> <span class="quoted"><span class="quoted">"many_reducible_to <span class="free">A</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"one_reducible_to <span class="free">A</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> one_reducible_to_refl<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> one_reducibility_is_many<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> m_red_to_comp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> many_reducible_to <span class="free">A</span> <span class="free">B</span><span class="main">;</span> computable <span class="free">B</span> <span class="main">⟧</span> <span class="main">⟹</span> computable <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"many_reducible_to <span class="free">A</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"many_reducible_to_via <span class="free">A</span> <span class="free">B</span> <span class="skolem">f</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> many_reducible_to_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> f_tr<span class="main">:</span> <span class="quoted"><span class="quoted">"total_recursive <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> many_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">f</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> many_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"computable <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"total_recursive <span class="main">(</span>chf <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> comp_impl_tot_rec<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> L3<span class="main">:</span> <span class="quoted"><span class="quoted">"chf <span class="free">A</span> <span class="main">=</span> <span class="main">(</span>chf <span class="free">B</span><span class="main">)</span> <span class="keyword1">o</span> <span class="skolem">f</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"chf <span class="free">A</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span>chf <span class="free">B</span><span class="main">)</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> L3_1<span class="main">:</span> <span class="quoted"><span class="quoted">"chf <span class="free">A</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> chf_lm_2<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> A L1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> L3_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>chf <span class="free">B</span><span class="main">)</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> chf_lm_2<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> L3_1 L3_2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"chf <span class="free">A</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span>chf <span class="free">B</span><span class="main">)</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∉</span> <span class="free">A</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> L3_1<span class="main">:</span> <span class="quoted"><span class="quoted">"chf <span class="free">A</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> chf_lm_3<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> A L1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="main">∉</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> L3_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>chf <span class="free">B</span><span class="main">)</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> chf_lm_3<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> L3_1 L3_2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"chf <span class="free">A</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span>chf <span class="free">B</span><span class="main">)</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"chf <span class="free">A</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span>chf <span class="free">B</span> <span class="main">∘</span> <span class="skolem">f</span><span class="main">)</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> L2 f_tr <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"total_recursive <span class="main">(</span>chf <span class="free">B</span> <span class="main">∘</span> <span class="skolem">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> comp_tot_rec<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> L3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"total_recursive <span class="main">(</span>chf <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> tot_rec_impl_comp<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-many_reducible_lm_1"><span class="command">lemma</span></span> many_reducible_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"many_reducible_to univ_ce <span class="free">A</span> <span class="main">⟹</span> <span class="main">¬</span> computable <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"many_reducible_to univ_ce <span class="free">A</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">¬</span> computable <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"computable <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"computable univ_ce"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> m_red_to_comp<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> univ_ce_is_not_comp3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-one_reducible_lm_1"><span class="command">lemma</span></span> one_reducible_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"one_reducible_to univ_ce <span class="free">A</span> <span class="main">⟹</span> <span class="main">¬</span> computable <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"one_reducible_to univ_ce <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"many_reducible_to univ_ce <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> one_reducibility_is_many<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> many_reducible_lm_1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-one_reducible_lm_2"><span class="command">lemma</span></span> one_reducible_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"one_reducible_to_via <span class="main">(</span>nat_to_ce_set <span class="free">n</span><span class="main">)</span> univ_ce <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> c_pair <span class="free">n</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="main">=</span> c_pair <span class="free">n</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">have</span></span> f_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> f_tr<span class="main">:</span> <span class="quoted"><span class="quoted">"total_recursive <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_is_total_rec<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> f_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"inj <span class="skolem">f</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> injI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">f</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"c_pair <span class="free">n</span> <span class="skolem">x</span> <span class="main">=</span> c_pair <span class="free">n</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> f_def<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> c_pair_inj2<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">(</span>nat_to_ce_set <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">f</span> <span class="bound">x</span> <span class="main">∈</span> univ_ce<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span> <span class="main">∈</span> nat_to_ce_set <span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">x</span> <span class="main">∈</span> univ_ce<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> f_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> univ_ce_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> f_tr f_inj <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> f_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> one_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-one_reducible_lm_3"><span class="command">lemma</span></span> one_reducible_lm_3<span class="main">:</span> <span class="quoted"><span class="quoted">"one_reducible_to <span class="main">(</span>nat_to_ce_set <span class="free">n</span><span class="main">)</span> univ_ce"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"one_reducible_to_via <span class="main">(</span>nat_to_ce_set <span class="free">n</span><span class="main">)</span> univ_ce <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span><span class="main">.</span> c_pair <span class="free">n</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> one_reducible_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> one_reducible_to_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-one_reducible_lm_4"><span class="command">lemma</span></span> one_reducible_lm_4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets <span class="main">⟹</span> one_reducible_to <span class="free">A</span> univ_ce"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> ce_sets"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">n</span><span class="main">.</span> <span class="free">A</span> <span class="main">=</span> nat_to_ce_set <span class="bound">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_ce_set_srj<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> nat_to_ce_set <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> one_reducible_lm_3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹One-complete sets›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">one_complete</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat set <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">one_complete</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">A</span><span class="main">.</span> <span class="bound">A</span> <span class="main">∈</span> ce_sets <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">B</span><span class="main">.</span> <span class="bound">B</span> <span class="main">∈</span> ce_sets <span class="main">⟶</span> one_reducible_to <span class="bound">B</span> <span class="bound">A</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">theorem</span></span> univ_is_complete<span class="main">:</span> <span class="quoted"><span class="quoted">"one_complete univ_ce"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> one_complete_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"univ_ce <span class="main">∈</span> ce_sets <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">B</span><span class="main">.</span> <span class="bound">B</span> <span class="main">∈</span> ce_sets <span class="main">⟶</span> one_reducible_to <span class="bound">B</span> univ_ce<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"univ_ce <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> univ_is_ce<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">B</span><span class="main">.</span> <span class="bound">B</span> <span class="main">∈</span> ce_sets <span class="main">⟶</span> one_reducible_to <span class="bound">B</span> univ_ce"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"one_reducible_to <span class="skolem">B</span> univ_ce"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> one_reducible_lm_4<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Index sets, Rice's theorem›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">index_set</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat set <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">index_set</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">A</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">n</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">n</span> <span class="main">∈</span> <span class="bound">A</span> <span class="main">∧</span> <span class="main">(</span>nat_to_ce_set <span class="bound">n</span> <span class="main">=</span> nat_to_ce_set <span class="bound">m</span><span class="main">)</span> <span class="main">⟶</span> <span class="bound">m</span> <span class="main">∈</span> <span class="bound">A</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="RecEnSet-index_set_lm_1"><span class="command">lemma</span></span> index_set_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> index_set <span class="free">A</span><span class="main">;</span> <span class="free">n</span><span class="main">∈</span> <span class="free">A</span><span class="main">;</span> nat_to_ce_set <span class="free">n</span> <span class="main">=</span> nat_to_ce_set <span class="free">m</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">m</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"index_set <span class="free">A</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="free">n</span> <span class="main">=</span> nat_to_ce_set <span class="free">m</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 A3 <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="main">(</span>nat_to_ce_set <span class="free">n</span> <span class="main">=</span> nat_to_ce_set <span class="free">m</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">n</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="main">(</span>nat_to_ce_set <span class="bound">n</span> <span class="main">=</span> nat_to_ce_set <span class="bound">m</span><span class="main">)</span> <span class="main">⟶</span> <span class="bound">m</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> index_set_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> L1 L2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-index_set_lm_2"><span class="command">lemma</span></span> index_set_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"index_set <span class="free">A</span> <span class="main">⟹</span> index_set <span class="main">(</span><span class="main">-</span><span class="free">A</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"index_set <span class="free">A</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"index_set <span class="main">(</span><span class="main">-</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> index_set_def<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">n</span> <span class="main">∈</span> <span class="main">-</span> <span class="free">A</span> <span class="main">∧</span> nat_to_ce_set <span class="bound">n</span> <span class="main">=</span> nat_to_ce_set <span class="bound">m</span> <span class="main">⟶</span> <span class="bound">m</span> <span class="main">∈</span> <span class="main">-</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">m</span> <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> <span class="main">-</span> <span class="free">A</span> <span class="main">∧</span> nat_to_ce_set <span class="skolem">n</span> <span class="main">=</span> nat_to_ce_set <span class="skolem">m</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> <span class="main">-</span><span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="skolem">m</span> <span class="main">=</span> nat_to_ce_set <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∈</span> <span class="main">-</span> <span class="free">A</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> A this A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> index_set_lm_1<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-Rice_lm_1"><span class="command">lemma</span></span> Rice_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> index_set <span class="free">A</span><span class="main">;</span> <span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span><span class="main">;</span> <span class="free">A</span> <span class="main">≠</span> UNIV<span class="main">;</span> <span class="main">∃</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">A</span><span class="main">.</span> nat_to_ce_set <span class="bound">n</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟧</span> <span class="main">⟹</span> one_reducible_to univ_ce <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"index_set <span class="free">A</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> UNIV"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">A</span><span class="main">.</span> nat_to_ce_set <span class="bound">n</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">e_0</span></span> <span class="keyword2"><span class="keyword">where</span></span> e_0_in_A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">e_0</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> e_0_empty<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="skolem">e_0</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> e_0_in_A A3 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">e_1</span></span> <span class="keyword2"><span class="keyword">where</span></span> e_1_not_in_A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">e_1</span> <span class="main">∈</span> <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> e_0_in_A <span class="keyword1"><span class="command">have</span></span> e_0_neq_e_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">e_0</span> <span class="main">≠</span> <span class="skolem">e_1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="skolem">e_0</span> <span class="main">≠</span> nat_to_ce_set <span class="skolem">e_1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="skolem">e_0</span> <span class="main">=</span> nat_to_ce_set <span class="skolem">e_1</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 e_0_in_A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">e_1</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> index_set_lm_1<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> e_1_not_in_A <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> e_0_empty <span class="keyword1"><span class="command">have</span></span> e1_not_empty<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="skolem">e_1</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">we_1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">we_1</span> <span class="main">=</span> nat_to_ce_set <span class="skolem">e_1</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> e1_not_empty <span class="keyword1"><span class="command">have</span></span> we_1_not_empty<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">we_1</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> we_1_def<span class="main">)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">=</span> univ_ce <span class="main">×</span> <span class="skolem">we_1</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> loc_lm_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> univ_ce <span class="main">⟹</span> <span class="main">∀</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">y</span> <span class="main">∈</span> <span class="skolem">we_1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> r_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> loc_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∉</span> univ_ce <span class="main">⟹</span> <span class="main">∀</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">y</span> <span class="main">∈</span> <span class="main">{}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> r_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> r_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> ce_rels"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> r_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ce_rel_lm_29<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"univ_ce <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> univ_is_ce<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">we_1</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> we_1_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> nat_to_ce_set_into_ce<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">we_n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">we_n</span> <span class="main">=</span> ce_rel_to_set <span class="skolem">r</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> r_ce <span class="keyword1"><span class="command">have</span></span> we_n_ce<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">we_n</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> we_n_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ce_rel_lm_6<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">n</span><span class="main">.</span> <span class="skolem">we_n</span> <span class="main">=</span> nat_to_ce_set <span class="bound">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_ce_set_srj<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> we_n_df1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">we_n</span> <span class="main">=</span> nat_to_ce_set <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="main">=</span> s_ce <span class="skolem">n</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">from</span></span> s_ce_is_pr <span class="keyword1"><span class="command">have</span></span> f_is_pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> PrimRec1"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> f_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">prec</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> f_tr<span class="main">:</span> <span class="quoted"><span class="quoted">"total_recursive <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pr_is_total_rec<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> f_inj<span class="main">:</span> <span class="quoted"><span class="quoted">"inj <span class="skolem">f</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> injI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">f</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"s_ce <span class="skolem">n</span> <span class="skolem">x</span> <span class="main">=</span> s_ce <span class="skolem">n</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> f_def<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> s_ce_inj2<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> loc_lm_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span>c_pair <span class="bound">x</span> <span class="bound">y</span> <span class="main">∈</span> <span class="skolem">we_n</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="bound">y</span> <span class="main">∈</span> nat_to_ce_set <span class="main">(</span><span class="skolem">f</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>c_pair <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">∈</span> <span class="skolem">we_n</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">∈</span> nat_to_ce_set <span class="main">(</span><span class="skolem">f</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> f_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> we_n_df1<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> s_ce_1_1_th<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> loc_lm_4<span class="main">:</span> <span class="quoted"><span class="quoted">"index_set <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> index_set_lm_2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> loc_lm_5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∈</span> univ_ce<span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">f</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">-</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">x</span> <span class="main">∈</span> univ_ce<span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">f</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="main">-</span><span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> univ_ce"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">y</span> <span class="main">∈</span> <span class="skolem">we_1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_lm_1<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> ce_rel_lm_12 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span>c_pair <span class="skolem">x</span> <span class="bound">y</span> <span class="main">∈</span> ce_rel_to_set <span class="skolem">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="skolem">x</span> <span class="bound">y</span> <span class="main">∈</span> <span class="skolem">we_n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> we_n_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">y</span> <span class="main">∈</span> <span class="skolem">we_1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="skolem">x</span> <span class="bound">y</span> <span class="main">∈</span> <span class="skolem">we_n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> loc_lm_3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">y</span> <span class="main">∈</span> <span class="skolem">we_1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="bound">y</span> <span class="main">∈</span> nat_to_ce_set <span class="main">(</span><span class="skolem">f</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">we_1</span> <span class="main">=</span> nat_to_ce_set <span class="main">(</span><span class="skolem">f</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="skolem">e_1</span> <span class="main">=</span> nat_to_ce_set <span class="main">(</span><span class="skolem">f</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> we_1_def<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> loc_lm_4 e_1_not_in_A <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="main">-</span><span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> index_set_lm_1<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">" <span class="skolem">f</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="main">-</span> <span class="free">A</span> <span class="main">⟹</span> <span class="skolem">x</span> <span class="main">∈</span> univ_ce"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> fx_in_A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="main">-</span> <span class="free">A</span>"</span></span>
        <span class="keyword3"><span class="command">assume</span></span> x_not_in_univ<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∉</span> univ_ce"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">y</span> <span class="main">∈</span> <span class="main">{}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> loc_lm_2<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> ce_rel_lm_12 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span>c_pair <span class="skolem">x</span> <span class="bound">y</span> <span class="main">∈</span> ce_rel_to_set <span class="skolem">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="skolem">x</span> <span class="bound">y</span> <span class="main">∈</span> <span class="skolem">we_n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> we_n_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">y</span> <span class="main">∈</span> <span class="main">{}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>c_pair <span class="skolem">x</span> <span class="bound">y</span> <span class="main">∈</span> <span class="skolem">we_n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> loc_lm_3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">y</span> <span class="main">∈</span> <span class="main">{}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="bound">y</span> <span class="main">∈</span> nat_to_ce_set <span class="main">(</span><span class="skolem">f</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">=</span> nat_to_ce_set <span class="main">(</span><span class="skolem">f</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="skolem">e_0</span> <span class="main">=</span> nat_to_ce_set <span class="main">(</span><span class="skolem">f</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> e_0_empty<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> A1 e_0_in_A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> index_set_lm_1<span class="main">)</span>
        <span class="keyword1"><span class="command">with</span></span> fx_in_A <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> f_tr f_inj <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"one_reducible_to_via univ_ce <span class="main">(</span><span class="main">-</span><span class="free">A</span><span class="main">)</span> <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> one_reducible_to_via_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> one_reducible_to_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RecEnSet-Rice_lm_2"><span class="command">lemma</span></span> Rice_lm_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> index_set <span class="free">A</span><span class="main">;</span> <span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span><span class="main">;</span> <span class="free">A</span> <span class="main">≠</span> UNIV<span class="main">;</span> <span class="free">n</span> <span class="main">∈</span> <span class="free">A</span><span class="main">;</span>  nat_to_ce_set <span class="free">n</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟧</span> <span class="main">⟹</span> one_reducible_to univ_ce <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"index_set <span class="free">A</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> UNIV"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A5<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="free">n</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A4 A5 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">n</span> <span class="main">∈</span> <span class="free">A</span><span class="main">.</span> nat_to_ce_set <span class="bound">n</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 S1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Rice_lm_1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> Rice_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> index_set <span class="free">A</span><span class="main">;</span> <span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span><span class="main">;</span> <span class="free">A</span> <span class="main">≠</span> UNIV <span class="main">⟧</span> <span class="main">⟹</span> one_reducible_to univ_ce <span class="free">A</span> <span class="main">∨</span> one_reducible_to univ_ce <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"index_set <span class="free">A</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> UNIV"</span></span>
  <span class="keyword1"><span class="command">from</span></span> ce_empty <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">n</span><span class="main">.</span> <span class="main">{}</span> <span class="main">=</span> nat_to_ce_set <span class="bound">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_ce_set_srj<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> n_empty<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="skolem">n</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 A n_empty <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"one_reducible_to univ_ce <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Rice_lm_2<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∉</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> <span class="main">-</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"index_set <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> index_set_lm_2<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="free">A</span> <span class="main">≠</span> UNIV"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> S1 S2 S3 A n_empty <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"one_reducible_to univ_ce <span class="main">(</span><span class="main">-</span> <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Rice_lm_2<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"one_reducible_to univ_ce <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> Rice_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> index_set <span class="free">A</span><span class="main">;</span> <span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span><span class="main">;</span> <span class="free">A</span> <span class="main">≠</span> UNIV <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">¬</span> computable <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"index_set <span class="free">A</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> UNIV"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"one_reducible_to univ_ce <span class="free">A</span> <span class="main">∨</span> one_reducible_to univ_ce <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Rice_1<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> one_reducible_to univ_ce <span class="free">A</span> <span class="main">⟶</span> one_reducible_to univ_ce <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"one_reducible_to univ_ce <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> computable <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> one_reducible_lm_1<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> one_reducible_to univ_ce <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> S1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"one_reducible_to univ_ce <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> computable <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> one_reducible_lm_1<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> computable_complement_3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> computable <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> Rice_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">C</span> <span class="main">⊆</span> ce_sets<span class="main">;</span> computable <span class="main">{</span> <span class="bound">n</span><span class="main">.</span> nat_to_ce_set <span class="bound">n</span> <span class="main">∈</span> <span class="free">C</span><span class="main">}</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">C</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">∨</span> <span class="free">C</span> <span class="main">=</span> ce_sets"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">⊆</span> ce_sets"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"computable <span class="main">{</span> <span class="bound">n</span><span class="main">.</span> nat_to_ce_set <span class="bound">n</span> <span class="main">∈</span> <span class="free">C</span><span class="main">}</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">C</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">∨</span> <span class="free">C</span> <span class="main">=</span> ce_sets<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">≠</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">n</span><span class="main">.</span> nat_to_ce_set <span class="bound">n</span> <span class="main">∈</span> <span class="free">C</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> S1<span class="main">:</span> <span class="quoted"><span class="quoted">"index_set <span class="skolem">A</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> index_set_def<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span> <span class="bound">m</span><span class="main">.</span> <span class="bound">n</span> <span class="main">∈</span> <span class="skolem">A</span> <span class="main">∧</span> nat_to_ce_set <span class="bound">n</span> <span class="main">=</span> nat_to_ce_set <span class="bound">m</span> <span class="main">⟶</span> <span class="bound">m</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">m</span> <span class="keyword3"><span class="command">assume</span></span> A1_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> <span class="skolem">A</span> <span class="main">∧</span> nat_to_ce_set <span class="skolem">n</span> <span class="main">=</span> nat_to_ce_set <span class="skolem">m</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> A1_1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> S1_1<span class="main">:</span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="skolem">n</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> A_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> A1_1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="skolem">n</span> <span class="main">=</span> nat_to_ce_set <span class="skolem">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> S1_1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="skolem">m</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> A_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> A4 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> S2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">n</span><span class="main">.</span> <span class="skolem">B</span> <span class="main">=</span> nat_to_ce_set <span class="bound">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_ce_set_srj<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">=</span> nat_to_ce_set <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">with</span></span> S2_1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="skolem">n</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> A_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> S3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">≠</span> UNIV"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> A1 A5 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> S2_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∉</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> S2_2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> ce_sets"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> S2_2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">n</span><span class="main">.</span> <span class="skolem">B</span> <span class="main">=</span> nat_to_ce_set <span class="bound">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> nat_to_ce_set_srj<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">=</span> nat_to_ce_set <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">with</span></span> S2_1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat_to_ce_set <span class="skolem">n</span> <span class="main">∉</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> A_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> S1 S2 S3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> computable <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Rice_2<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">unfolding</span></span> A_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div>
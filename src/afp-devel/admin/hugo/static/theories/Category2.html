<div id="Category">
<div class="head">
<h1>Theory Category</h1>
</div>
<pre class="source"><span class="comment1">(*
Author: Alexander Katovsky
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Category"</span></span>

<span class="keyword1"><span class="command">theory</span></span> Category
<span class="keyword2"><span class="keyword">imports</span></span> <span class="quoted">"<a href="../../HOL/HOL-Library/FuncSet.html">HOL-Library.FuncSet</a>"</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">record</span></span> <span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">)</span> Category <span class="main">=</span> 
  Obj <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'o</span> set"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">obj</span>ı"</span> 70<span class="main">)</span> 
  Mor <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'m</span> set"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">mor</span>ı"</span> 70<span class="main">)</span>
  Dom <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'m</span> <span class="main">⇒</span> <span class="tfree">'o</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">dom</span>ı _"</span> <span class="main">[</span>80<span class="main">]</span> 70<span class="main">)</span>
  Cod <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'m</span> <span class="main">⇒</span> <span class="tfree">'o</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">cod</span>ı _"</span> <span class="main">[</span>80<span class="main">]</span> 70<span class="main">)</span>
  Id  <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'o</span> <span class="main">⇒</span> <span class="tfree">'m</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">id</span>ı _"</span> <span class="main">[</span>80<span class="main">]</span> 75<span class="main">)</span>
  Comp <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'m</span> <span class="main">⇒</span> <span class="tfree">'m</span> <span class="main">⇒</span> <span class="tfree">'m</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">;;</span>ı"</span> 70<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">MapsTo</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> Category_scheme <span class="main">⇒</span> <span class="tfree">'m</span> <span class="main">⇒</span> <span class="tfree">'o</span> <span class="main">⇒</span> <span class="tfree">'o</span> <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="quoted">"_ <span class="keyword1">maps</span>ı _ <span class="keyword1">to</span> _"</span> <span class="main">[</span>60<span class="main">,</span> 60<span class="main">,</span> 60<span class="main">]</span> 65<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">MapsTo</span> <span class="free"><span class="bound"><span class="entity">CC</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="free"><span class="bound"><span class="entity">Y</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> Mor <span class="free"><span class="bound"><span class="entity">CC</span></span></span> <span class="main">∧</span> Dom <span class="free"><span class="bound"><span class="entity">CC</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">∧</span> Cod <span class="free"><span class="bound"><span class="entity">CC</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">Y</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">CompDefined</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> Category_scheme <span class="main">⇒</span> <span class="tfree">'m</span> <span class="main">⇒</span> <span class="tfree">'m</span> <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">≈&gt;</span>ı"</span> 65<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">CompDefined</span> <span class="free"><span class="bound"><span class="entity">CC</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> Mor <span class="free"><span class="bound"><span class="entity">CC</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∈</span> Mor <span class="free"><span class="bound"><span class="entity">CC</span></span></span> <span class="main">∧</span> Cod <span class="free"><span class="bound"><span class="entity">CC</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">=</span> Dom <span class="free"><span class="bound"><span class="entity">CC</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> ExtCategory <span class="main">=</span> 
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">C</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> Category_scheme"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> CdomExt<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Dom <span class="free">C</span><span class="main">)</span> <span class="main">∈</span> extensional <span class="main">(</span>Mor <span class="free">C</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     CcodExt<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Cod <span class="free">C</span><span class="main">)</span> <span class="main">∈</span> extensional <span class="main">(</span>Mor <span class="free">C</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     CidExt<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="main">(</span>Id <span class="free">C</span><span class="main">)</span> <span class="main">∈</span> extensional <span class="main">(</span>Obj <span class="free">C</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     CcompExt<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="main">(</span>case_prod <span class="main">(</span>Comp <span class="free">C</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> extensional <span class="main">(</span><span class="main">{</span><span class="main">(</span><span class="bound">f</span><span class="main">,</span><span class="bound">g</span><span class="main">)</span> <span class="main">|</span> <span class="bound">f</span> <span class="bound">g</span> <span class="main">.</span> <span class="bound">f</span> <span class="main">≈&gt;</span> <span class="bound">g</span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> Category <span class="main">=</span> ExtCategory <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Cdom <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">⟹</span> <span class="keyword1">dom</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">obj</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     Ccod <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">⟹</span> <span class="keyword1">cod</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">obj</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     Cidm <span class="main">[</span><span class="operator">dest</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span> <span class="main">⟹</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">maps</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     Cidl <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">⟹</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">;;</span> <span class="free">f</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     Cidr <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">;;</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     Cassoc <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">f</span> <span class="main">≈&gt;</span> <span class="free">g</span> <span class="main">;</span> <span class="free">g</span> <span class="main">≈&gt;</span> <span class="free">h</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="free">h</span> <span class="main">=</span> <span class="free">f</span> <span class="main">;;</span> <span class="main">(</span><span class="free">g</span> <span class="main">;;</span> <span class="free">h</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     Ccompt <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">f</span> <span class="keyword1">maps</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span> <span class="main">;</span> <span class="free">g</span> <span class="keyword1">maps</span> <span class="free">Y</span> <span class="keyword1">to</span> <span class="free">Z</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="keyword1">maps</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Z</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="entity">MakeCat</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> Category_scheme <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> Category_scheme"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">MakeCat</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">≡</span> <span class="main">⦇</span>
      Obj <span class="main">=</span> Obj <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">,</span> 
      Mor <span class="main">=</span> Mor <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">,</span> 
      Dom <span class="main">=</span> restrict <span class="main">(</span>Dom <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">(</span>Mor <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">,</span> 
      Cod <span class="main">=</span> restrict <span class="main">(</span>Cod <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">(</span>Mor <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">,</span> 
      Id  <span class="main">=</span> restrict <span class="main">(</span>Id <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">(</span>Obj <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">,</span> 
      Comp <span class="main">=</span> <span class="main">λ</span> <span class="bound">f</span> <span class="bound">g</span> <span class="main">.</span> <span class="main">(</span>restrict <span class="main">(</span>case_prod <span class="main">(</span>Comp <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main">{</span><span class="main">(</span><span class="bound">f</span><span class="main">,</span><span class="bound">g</span><span class="main">)</span> <span class="main">|</span> <span class="bound">f</span> <span class="bound">g</span> <span class="main">.</span> <span class="bound">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="bound">g</span><span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="bound">f</span><span class="main">,</span><span class="bound">g</span><span class="main">)</span><span class="main">,</span> 
      <span class="main">…</span> <span class="main">=</span> Category.more <span class="free"><span class="bound"><span class="entity">C</span></span></span>
  <span class="main">⦈</span>"</span></span>

<span class="keyword1" id="Category-MakeCatMapsTo"><span class="command">lemma</span></span> MakeCatMapsTo<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span> <span class="main">⟹</span> <span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>MakeCat <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsTo_def MakeCat_def<span class="main">)</span>

<span class="keyword1" id="Category-MakeCatComp"><span class="command">lemma</span></span> MakeCatComp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>MakeCat <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="main">=</span> <span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsTo_def MakeCat_def<span class="main">)</span>

<span class="keyword1" id="Category-MakeCatId"><span class="command">lemma</span></span> MakeCatId<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>MakeCat <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsTo_def MakeCat_def<span class="main">)</span>

<span class="keyword1" id="Category-MakeCatObj"><span class="command">lemma</span></span> MakeCatObj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">obj</span><span class="hidden">⇘</span><sub>MakeCat <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeCat_def<span class="main">)</span>

<span class="keyword1" id="Category-MakeCatMor"><span class="command">lemma</span></span> MakeCatMor<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">mor</span><span class="hidden">⇘</span><sub>MakeCat <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeCat_def<span class="main">)</span>

<span class="keyword1" id="Category-MakeCatDom"><span class="command">lemma</span></span> MakeCatDom<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>MakeCat <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeCat_def<span class="main">)</span>

<span class="keyword1" id="Category-MakeCatCod"><span class="command">lemma</span></span> MakeCatCod<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub>MakeCat <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeCat_def<span class="main">)</span>


<span class="keyword1" id="Category-MakeCatCompDef"><span class="command">lemma</span></span> MakeCatCompDef<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>MakeCat <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="main">=</span> <span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CompDefined_def MakeCat_def<span class="main">)</span>

<span class="keyword1" id="Category-MakeCatComp2"><span class="command">lemma</span></span> MakeCatComp2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>MakeCat <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>MakeCat <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="main">=</span> <span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeCatCompDef MakeCatComp<span class="main">)</span>


<span class="keyword1" id="Category-ExtCategoryMakeCat"><span class="command">lemma</span></span> ExtCategoryMakeCat<span class="main">:</span> <span class="quoted"><span class="quoted">"ExtCategory <span class="main">(</span>MakeCat <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold_locales</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeCat_def extensional_def CompDefined_def<span class="main">)</span>

<span class="keyword1" id="Category-MakeCat"><span class="command">lemma</span></span> MakeCat<span class="main">:</span> <span class="quoted"><span class="quoted">"Category_axioms <span class="free">C</span> <span class="main">⟹</span> Category <span class="main">(</span>MakeCat <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">intro_locales</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ExtCategoryMakeCat<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category_axioms_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeCat_def CompDefined_def MapsTo_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Category-MapsToE"><span class="command">lemma</span></span> MapsToE<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span> <span class="main">;</span> <span class="main">⟦</span><span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">;</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> <span class="free">X</span> <span class="main">;</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> <span class="free">Y</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsTo_def<span class="main">)</span>

<span class="keyword1" id="Category-MapsToI"><span class="command">lemma</span></span> MapsToI<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">;</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> <span class="free">X</span> <span class="main">;</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> <span class="free">Y</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsTo_def<span class="main">)</span>

<span class="keyword1" id="Category-CompDefinedE"><span class="command">lemma</span></span> CompDefinedE<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="main">;</span> <span class="main">⟦</span><span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">;</span> <span class="free">g</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">;</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CompDefined_def<span class="main">)</span>

<span class="keyword1" id="Category-CompDefinedI"><span class="command">lemma</span></span> CompDefinedI<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">;</span> <span class="free">g</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">;</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CompDefined_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> MapsToCompI<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span> <span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="keyword1">maps</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">g</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="keyword1">maps</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">g</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Ccompt<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">f</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span> <span class="free">f</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span> <span class="free">g</span>"</span></span> <span class="quoted"><span class="free">g</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="free">g</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Category-MapsToCompDef"><span class="command">lemma</span></span> MapsToCompDef<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span> <span class="keyword1">to</span> <span class="free">Z</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> <span class="free">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="main">=</span> <span class="free">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> MapsToMorDomCod<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span> <span class="free">g</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">;;</span> <span class="free">g</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">cod</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="keyword1">maps</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsToCompI<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">;;</span> <span class="free">g</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">cod</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> MapsToObj<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span> <span class="free">f</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="free">f</span> <span class="main">=</span> <span class="free">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cdom Ccod<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> IdInj<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span> <span class="free">X</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="free">Y</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">=</span> <span class="free">Y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">Y</span><span class="main">)</span> <span class="main">=</span> <span class="free">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsTo_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> CompDefComp<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span> <span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">≈&gt;</span> <span class="free">h</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span> <span class="main">(</span><span class="free">g</span> <span class="main">;;</span> <span class="free">h</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="main">≈&gt;</span> <span class="free">h</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CompDefined_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span>  1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">;;</span> <span class="free">h</span> <span class="keyword1">maps</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">g</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">h</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">;;</span> <span class="free">g</span> <span class="keyword1">maps</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsToCompI<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">;;</span> <span class="free">h</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">;;</span> <span class="free">g</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="main">(</span><span class="free">g</span> <span class="main">;;</span> <span class="free">h</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="main">(</span><span class="free">g</span> <span class="main">;;</span> <span class="free">h</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span> <span class="free">h</span> <span class="main">=</span> <span class="keyword1">cod</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">cod</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="free">h</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> CatIdInMor<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span> <span class="main">⟹</span> <span class="keyword1">id</span> <span class="free">X</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cidm<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> MapsToId<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span> <span class="free">X</span> <span class="main">≈&gt;</span> <span class="keyword1">id</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span> <span class="free">X</span> <span class="keyword1">maps</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cidm<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span> <span class="free">X</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span> <span class="free">X</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> Simps <span class="main">=</span> Cdom Ccod Cidm Cidl Cidr MapsToCompI IdInj MapsToId

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> LeftRightInvUniq<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">≈&gt;</span> <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  z<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span> <span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">;;</span> <span class="free">g</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span>     2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">;;</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">=</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> mor<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">∧</span> <span class="free">g</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span>  dc <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">cod</span> <span class="free">h</span> <span class="main">∧</span> <span class="keyword1">cod</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 0 z <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">=</span> <span class="free">h</span> <span class="main">;;</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Simps<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">h</span> <span class="main">;;</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">h</span> <span class="main">;;</span> <span class="free">f</span><span class="main">)</span> <span class="main">;;</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 0 z <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cassoc<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> mor dc <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Simps<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> CatIdDomCod<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span> <span class="free">X</span> <span class="keyword1">maps</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Simps<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> CatIdCompId<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="keyword1">id</span> <span class="free">X</span> <span class="main">;;</span> <span class="keyword1">id</span> <span class="free">X</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span> <span class="free">X</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Simps<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span> <span class="free">X</span> <span class="main">;;</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 0 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Simps<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(*lemmas (in Category) simps2 = simps CatIdCompId Cassoc CatIdDomCod*)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> CatIdUniqR<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> iota<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ι</span> <span class="keyword1">maps</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     rid<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">f</span> <span class="main">.</span> <span class="bound">f</span> <span class="main">≈&gt;</span> <span class="free">ι</span> <span class="main">⟶</span> <span class="bound">f</span> <span class="main">;;</span> <span class="free">ι</span> <span class="main">=</span> <span class="bound">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span> <span class="free">X</span> <span class="main">=</span> <span class="free">ι</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> LeftRightInvUniq <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="keyword1"><span class="keyword1">id</span></span> <span class="free"><span class="free">X</span></span>"</span></span></span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="keyword1"><span class="keyword1">id</span></span> <span class="free"><span class="free">X</span></span>"</span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">ι</span></span></span></span> <span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> iota <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Simps<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span> <span class="free">X</span> <span class="keyword1">maps</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cidm<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span> <span class="free">X</span> <span class="main">≈&gt;</span> <span class="free">ι</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> iota <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Simps<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span>    <span class="quoted"><span class="quoted">"<span class="keyword1">id</span> <span class="free">X</span> <span class="main">≈&gt;</span> <span class="keyword1">id</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 0 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Simps<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span>    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span> <span class="main">;;</span> <span class="free">ι</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 0 1 rid <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Simps CompDefined_def MapsTo_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span>    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 0 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatIdCompId CompDefined_def MapsTo_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">inverse_rel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> Category_scheme <span class="main">⇒</span> <span class="tfree">'m</span> <span class="main">⇒</span> <span class="tfree">'m</span> <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">cinv</span>ı _ _"</span> 60<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">inverse_rel</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">≡</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="entity">isomorphism</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> Category_scheme <span class="main">⇒</span> <span class="tfree">'m</span> <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">ciso</span>ı _"</span> <span class="main">[</span>70<span class="main">]</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">isomorphism</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">≡</span> <span class="main">∃</span> <span class="bound">g</span> <span class="main">.</span> inverse_rel <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="bound">g</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> Inverse_relI<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">f</span> <span class="main">≈&gt;</span> <span class="free">g</span> <span class="main">;</span> <span class="free">f</span> <span class="main">;;</span> <span class="free">g</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">;</span> <span class="free">g</span> <span class="main">;;</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">f</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="keyword1">cinv</span> <span class="free">f</span> <span class="free">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inverse_rel_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> Inverse_relE<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="keyword1">cinv</span> <span class="free">f</span> <span class="free">g</span> <span class="main">;</span> <span class="main">⟦</span><span class="free">f</span> <span class="main">≈&gt;</span> <span class="free">g</span> <span class="main">;</span> <span class="free">f</span> <span class="main">;;</span> <span class="free">g</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span> <span class="main">;</span> <span class="free">g</span> <span class="main">;;</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">f</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">P</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inverse_rel_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> Inverse_relSym<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cinv</span> <span class="free">f</span> <span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="keyword1">cinv</span> <span class="free">g</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> Inverse_relI<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">≈&gt;</span> <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">;;</span> <span class="free">g</span> <span class="keyword1">maps</span> <span class="keyword1">dom</span> <span class="free">f</span> <span class="keyword1">to</span> <span class="keyword1">cod</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsToCompI<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="free">g</span> <span class="main">=</span> <span class="keyword1">cod</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">cod</span> <span class="main">(</span><span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inverse_rel_def<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="free">f</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">obj</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 0 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Simps<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">maps</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Simps<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="free">g</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">;;</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inverse_rel_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">;;</span> <span class="free">g</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">g</span><span class="main">)</span>"</span></span><span class="keyword1"><span class="command">using</span></span> assms 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inverse_rel_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> InverseUnique<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">cinv</span> <span class="free">f</span> <span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">cinv</span> <span class="free">f</span> <span class="free">h</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">=</span> <span class="free">h</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> LeftRightInvUniq <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">g</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">f</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">h</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cinv</span> <span class="free">g</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> Inverse_relSym<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">f</span></span> <span class="quoted"><span class="free">g</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">≈&gt;</span> <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">;;</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span> <span class="free">h</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">;;</span> <span class="free">h</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> InvId<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">cinv</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> Inverse_relI<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span> <span class="free">X</span> <span class="main">≈&gt;</span> <span class="keyword1">id</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Simps<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatIdDomCod<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span> <span class="free">X</span> <span class="main">;;</span> <span class="keyword1">id</span> <span class="free">X</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span> <span class="free">X</span> <span class="main">;;</span> <span class="keyword1">id</span> <span class="free">X</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="main">(</span><span class="keyword1">id</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatIdCompId CatIdDomCod<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">inverse</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> Category_scheme <span class="main">⇒</span> <span class="tfree">'m</span> <span class="main">⇒</span> <span class="tfree">'m</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Cinv</span>ı _"</span> <span class="main">[</span>70<span class="main">]</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">inverse</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">≡</span> <span class="keyword1">THE</span> <span class="bound">g</span> <span class="main">.</span> inverse_rel <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="bound">g</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> inv2Inv<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cinv</span> <span class="free">f</span> <span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cinv</span> <span class="free">f</span> <span class="main">=</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> isomorphism_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃!</span> <span class="bound">g</span> <span class="main">.</span> <span class="keyword1">cinv</span> <span class="free">f</span> <span class="bound">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> InverseUnique<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cinv</span> <span class="free">f</span> <span class="main">=</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inverse_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> iso2Inv<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="keyword1">cinv</span> <span class="free">f</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃!</span> <span class="bound">g</span> <span class="main">.</span> <span class="keyword1">cinv</span> <span class="free">f</span> <span class="bound">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> InverseUnique isomorphism_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  inverse_def <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>theI'<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> InvInv<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="free">f</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Cinv</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cinv</span> <span class="free">f</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> iso2Inv<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cinv</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Inverse_relSym<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">f</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span>  <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cinv</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inv2Inv<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> InvIsMor<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">cinv</span> <span class="free">f</span> <span class="free">g</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">∧</span> <span class="free">g</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inverse_rel_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> IsoIsMor<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="free">f</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> InvIsMor <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> iso2Inv<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> InvDomCod<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">cod</span> <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cinv</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">cinv</span> <span class="free">f</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> iso2Inv<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">cod</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inverse_rel_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cinv</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Inverse_relSym<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">f</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span>  <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inverse_rel_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cinv</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inverse_rel_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> IsoCompInv<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="free">f</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">≈&gt;</span> <span class="keyword1">Cinv</span> <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IsoIsMor InvDomCod<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> InvCompIso<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="free">f</span> <span class="main">⟹</span> <span class="keyword1">Cinv</span> <span class="free">f</span> <span class="main">≈&gt;</span> <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IsoIsMor InvDomCod<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> IsoInvId1 <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="free">f</span> <span class="main">⟹</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span> <span class="main">;;</span> <span class="free">f</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> iso2Inv<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> IsoInvId2 <span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="free">f</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> iso2Inv<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> IsoCompDef<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span> <span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">≈&gt;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cinv</span> <span class="free">g</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cinv</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> InvDomCod<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> InvDomCod<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">cod</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> InvDomCod<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Category<span class="main">)</span> IsoCompose<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span> <span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cinv</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span>  a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">≈&gt;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IsoCompDef<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">maps</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsToCompI<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">maps</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">g</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 2 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> InvDomCod<span class="main">)</span> 
  <span class="keyword1"><span class="command">have</span></span>  d<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">;;</span> <span class="free">g</span> <span class="keyword1">maps</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Simps<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cinv</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inverse_rel_def<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">;;</span> <span class="free">g</span> <span class="main">≈&gt;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">;;</span> <span class="free">g</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> c <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">cod</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> InvDomCod<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">;;</span> <span class="free">g</span> <span class="main">;;</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> e<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">≈&gt;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IsoCompInv<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="main">(</span><span class="free">g</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> 1 e a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cassoc CompDefComp<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">f</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IsoInvId2<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">f</span> <span class="main">;;</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">f</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Simps<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">f</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cidr<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IsoInvId2<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> e<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span> <span class="main">≈&gt;</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> InvCompIso<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span> <span class="main">;;</span> <span class="free">f</span><span class="main">)</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 e a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cassoc CompDefComp<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IsoInvId1<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">dom</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Simps<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cidl<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IsoInvId1<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">id</span> <span class="main">(</span><span class="keyword1">cod</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Cinv</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">g</span><span class="main">)</span> <span class="main">;;</span> <span class="main">(</span><span class="keyword1">Cinv</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inv2Inv<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">ObjIso</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">≡</span> <span class="main">∃</span> <span class="bound">k</span> <span class="main">.</span> <span class="main">(</span><span class="bound">k</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">to</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="keyword1">ciso</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span> </sub><span class="hidden">⇙</span><span class="bound">k</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="entity">UnitCategory</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>unit<span class="main">,</span> unit<span class="main">)</span> Category"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">UnitCategory</span> <span class="main">=</span> MakeCat <span class="main">⦇</span>
      Obj <span class="main">=</span> <span class="main">{</span><span class="main">()</span><span class="main">}</span> <span class="main">,</span> 
      Mor <span class="main">=</span> <span class="main">{</span><span class="main">()</span><span class="main">}</span> <span class="main">,</span> 
      Dom <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">.</span><span class="main">()</span><span class="main">)</span> <span class="main">,</span> 
      Cod <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">.</span><span class="main">()</span><span class="main">)</span> <span class="main">,</span> 
      Id <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">.</span><span class="main">()</span><span class="main">)</span> <span class="main">,</span> 
      Comp <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span> <span class="bound">g</span><span class="main">.</span> <span class="main">()</span><span class="main">)</span>
  <span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"Category<span class="main">(</span>UnitCategory<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> UnitCategory_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> MakeCat<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold_locales</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> UnitCategory_def<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="entity">OppositeCategory</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> Category_scheme <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> Category_scheme"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Op</span> _"</span> <span class="main">[</span>65<span class="main">]</span> 65<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">OppositeCategory</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">≡</span> <span class="main">⦇</span>
      Obj <span class="main">=</span> Obj <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">,</span> 
      Mor <span class="main">=</span> Mor <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">,</span> 
      Dom <span class="main">=</span> Cod <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">,</span> 
      Cod <span class="main">=</span> Dom <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">,</span> 
      Id  <span class="main">=</span> Id <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">,</span> 
      Comp <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span> <span class="bound">g</span><span class="main">.</span> <span class="bound">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="bound">f</span><span class="main">)</span><span class="main">,</span> 
      <span class="main">…</span> <span class="main">=</span> Category.more <span class="free"><span class="bound"><span class="entity">C</span></span></span>
  <span class="main">⦈</span>"</span></span>

<span class="keyword1" id="Category-OpCatOpCat"><span class="command">lemma</span></span> OpCatOpCat<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Op</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">=</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>


<span class="keyword1" id="Category-OpCatCatAx"><span class="command">lemma</span></span> OpCatCatAx<span class="main">:</span> <span class="quoted"><span class="quoted">"Category_axioms <span class="free">C</span> <span class="main">⟹</span> Category_axioms <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def Category_axioms_def MapsTo_def CompDefined_def<span class="main">)</span>

<span class="keyword1" id="Category-OpCatCatExt"><span class="command">lemma</span></span> OpCatCatExt<span class="main">:</span> <span class="quoted"><span class="quoted">"ExtCategory <span class="free">C</span> <span class="main">⟹</span> ExtCategory <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def ExtCategory_def MapsTo_def CompDefined_def extensional_def<span class="main">)</span>

<span class="keyword1" id="Category-OpCatCat"><span class="command">lemma</span></span> OpCatCat<span class="main">:</span> <span class="quoted"><span class="quoted">"Category <span class="free">C</span> <span class="main">⟹</span> Category <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro_locales</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category_def OpCatCatAx OpCatCatExt<span class="main">)</span>


<span class="keyword1" id="Category-MapsToOp"><span class="command">lemma</span></span> MapsToOp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span> <span class="main">⟹</span> <span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">Y</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsTo_def OppositeCategory_def<span class="main">)</span>

<span class="keyword1" id="Category-MapsToOpOp"><span class="command">lemma</span></span> MapsToOpOp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span> <span class="main">⟹</span> <span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">Y</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsTo_def OppositeCategory_def<span class="main">)</span>

<span class="keyword1" id="Category-CompDefOp"><span class="command">lemma</span></span> CompDefOp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="main">⟹</span> <span class="free">g</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CompDefined_def OppositeCategory_def<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="Universe">
<div class="head">
<h1>Theory Universe</h1>
</div>
<pre class="source"><span class="comment1">(*
Author: Alexander Katovsky
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Universe"</span></span>

<span class="keyword1"><span class="command">theory</span></span> Universe
<span class="keyword2"><span class="keyword">imports</span></span> <span class="quoted">"<a href="../../HOL/HOL-ZF/MainZF.html">HOL-ZF.MainZF</a>"</span>
<span class="keyword2"><span class="keyword">begin</span></span>


<span class="keyword1"><span class="command">locale</span></span> Universe <span class="main">=</span> 
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">U</span> <span class="main">::</span> <span class="quoted">ZF</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Uempty  <span class="main">:</span> <span class="quoted"><span class="quoted">"Elem Empty <span class="free">U</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     Usubset <span class="main">:</span> <span class="quoted"><span class="quoted">"Elem <span class="free">u</span> <span class="free">U</span> <span class="main">⟹</span> subset <span class="free">u</span> <span class="free">U</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     Usingle <span class="main">:</span> <span class="quoted"><span class="quoted">"Elem <span class="free">u</span> <span class="free">U</span> <span class="main">⟹</span> Elem <span class="main">(</span>Singleton <span class="free">u</span><span class="main">)</span> <span class="free">U</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     Upow    <span class="main">:</span> <span class="quoted"><span class="quoted">"Elem <span class="free">u</span> <span class="free">U</span> <span class="main">⟹</span> Elem <span class="main">(</span>Power <span class="free">u</span><span class="main">)</span> <span class="free">U</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     Uim     <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>Elem <span class="free">I</span> <span class="free">U</span> <span class="main">;</span> Elem <span class="free">u</span> <span class="main">(</span>Fun <span class="free">I</span> <span class="free">U</span><span class="main">)</span> <span class="main">⟧</span> <span class="main">⟹</span> Elem <span class="main">(</span>Sum <span class="main">(</span>Range <span class="free">u</span><span class="main">)</span><span class="main">)</span> <span class="free">U</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     Unat    <span class="main">:</span> <span class="quoted"><span class="quoted">"Elem Nat <span class="free">U</span>"</span></span>
<span class="comment1">(*
axiomatization where
  Grothendieck: "∀ x . ∃ uni . (Universe uni) ∧ Elem x uni"
*)</span>
<span class="keyword1" id="Universe-ElemLambdaFun"><span class="command">lemma</span></span> ElemLambdaFun <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span> <span class="bound">x</span> <span class="main">.</span>Elem <span class="bound">x</span> <span class="free">u</span> <span class="main">⟹</span> Elem <span class="main">(</span><span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="free">U</span><span class="main">)</span> <span class="main">⟹</span> Elem <span class="main">(</span>Lambda <span class="free">u</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span>Fun <span class="free">u</span> <span class="free">U</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Elem_Lambda_Fun<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Universe-RangeRepl"><span class="command">lemma</span></span> RangeRepl<span class="main">:</span> <span class="quoted"><span class="quoted">"Range <span class="main">(</span>Lambda <span class="free">A</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> Repl <span class="free">A</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Ext<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Range<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Repl Opair Lambda_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Universe<span class="main">)</span> Utrans<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>Elem <span class="free">a</span> <span class="free">U</span> <span class="main">;</span> Elem <span class="free">b</span> <span class="free">a</span><span class="main">⟧</span> <span class="main">⟹</span> Elem <span class="free">b</span> <span class="free">U</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">drule</span> Usubset<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">insert</span> HOLZF.subset_def <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">U</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Usubset<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Universe-ReplId"><span class="command">lemma</span></span> ReplId<span class="main">:</span> <span class="quoted"><span class="quoted">"Repl <span class="free">A</span> id <span class="main">=</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> Ext<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Repl<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Universe<span class="main">)</span> UniverseSum <span class="main">:</span> <span class="quoted"><span class="quoted">"Elem <span class="free">u</span> <span class="free">U</span> <span class="main">⟹</span> Elem <span class="main">(</span>Sum <span class="free">u</span><span class="main">)</span> <span class="free">U</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">frule_tac</span> u <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Lambda <span class="free">u</span> id"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Uim<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Elem_Lambda_Fun<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">frule</span> Usubset<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> subset_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> RangeRepl ReplId<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Universe<span class="main">)</span> UniverseUnion<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Elem <span class="free">u</span> <span class="free">U</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Elem <span class="free">v</span> <span class="free">U</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Elem <span class="main">(</span>union <span class="free">u</span> <span class="free">v</span><span class="main">)</span> <span class="free">U</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">%</span> <span class="bound">x</span><span class="main">.</span> <span class="keyword1">if</span> <span class="bound">x</span> <span class="main">=</span> Empty <span class="keyword1">then</span> <span class="free">u</span> <span class="keyword1">else</span> <span class="free">v</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="var"><span class="quoted"><span class="var">?S</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Power <span class="main">(</span>Power Empty<span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Upair <span class="free">u</span> <span class="free">v</span><span class="main">)</span> <span class="main">=</span> Range <span class="main">(</span>Lambda <span class="var">?S</span> <span class="var">?f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> RangeRepl<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Upair_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>Elem <span class="free">u</span> <span class="free">U</span><span class="main">;</span> Elem <span class="free">v</span> <span class="free">U</span><span class="main">⟧</span> <span class="main">⟹</span> Elem <span class="main">(</span>Lambda <span class="var">?S</span> <span class="var">?f</span><span class="main">)</span> <span class="main">(</span>Fun <span class="var">?S</span> <span class="free">U</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ElemLambdaFun<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> HOLZF.union_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> 1<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> I<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="var">?S</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Uim<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Upow<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Uempty<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> 2<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Universe-UPairSingleton"><span class="command">lemma</span></span> UPairSingleton<span class="main">:</span> <span class="quoted"><span class="quoted">"Upair <span class="free">u</span> <span class="free">v</span> <span class="main">=</span> union <span class="main">(</span>Singleton <span class="free">u</span><span class="main">)</span> <span class="main">(</span>Singleton <span class="free">v</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Ext<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Upair<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> union<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Singleton<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Universe<span class="main">)</span> UniverseUPair<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>Elem <span class="free">u</span> <span class="free">U</span> <span class="main">;</span> Elem <span class="free">v</span> <span class="free">U</span><span class="main">⟧</span> <span class="main">⟹</span> Elem <span class="main">(</span>Upair <span class="free">u</span> <span class="free">v</span><span class="main">)</span> <span class="free">U</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> UPairSingleton<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> UniverseUnion<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Usingle<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Universe<span class="main">)</span> UniversePair<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>Elem <span class="free">u</span> <span class="free">U</span> <span class="main">;</span> Elem <span class="free">v</span> <span class="free">U</span><span class="main">⟧</span> <span class="main">⟹</span> Elem <span class="main">(</span>Opair <span class="free">u</span> <span class="free">v</span><span class="main">)</span> <span class="free">U</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Opair_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="main">(</span><span class="operator">rule</span> UniverseUPair<span class="main">)</span><span class="main"><span class="keyword3">+</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Universe<span class="main">)</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>Elem <span class="free">u</span> <span class="free">U</span> <span class="main">;</span> Elem <span class="free">v</span> <span class="free">U</span><span class="main">⟧</span> <span class="main">⟹</span> Elem <span class="main">(</span>Sum <span class="main">(</span>Repl <span class="free">u</span> <span class="main">(</span><span class="main">%</span><span class="bound">x</span> <span class="main">.</span> Singleton <span class="main">(</span>Opair <span class="bound">x</span> <span class="free">v</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">U</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> RangeRepl <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> subst<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Uim <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">u</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> ElemLambdaFun<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Usingle<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> UniversePair<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Utrans<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Universe-SumRepl"><span class="command">lemma</span></span> SumRepl<span class="main">:</span> <span class="quoted"><span class="quoted">"Sum <span class="main">(</span>Repl <span class="free">A</span> <span class="main">(</span>Singleton <span class="keyword1">o</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Repl <span class="free">A</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Ext<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Sum<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Repl<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Singleton<span class="main">)</span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Elem <span class="skolem">a</span> <span class="free">A</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">y</span><span class="main">.</span> Elem <span class="main">(</span><span class="free">f</span> <span class="skolem">a</span><span class="main">)</span> <span class="bound">y</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">a</span><span class="main">.</span> Elem <span class="bound">a</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">y</span> <span class="main">=</span> Singleton <span class="main">(</span><span class="free">f</span> <span class="bound">a</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> exI <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted"><span class="quoted">"Singleton <span class="main"><span class="main">(</span></span><span class="free"><span class="free">f</span></span> <span class="skolem"><span class="skolem">a</span></span><span class="main"><span class="main">)</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Singleton<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> exI <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="skolem"><span class="skolem">a</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Universe<span class="main">)</span> UniverseProd<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Elem <span class="free">u</span> <span class="free">U</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Elem <span class="free">v</span> <span class="free">U</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"Elem <span class="main">(</span>CartProd <span class="free">u</span> <span class="free">v</span><span class="main">)</span> <span class="free">U</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> CartProd_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> RangeRepl <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">u</span></span></span></span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">%</span></span> <span class="bound"><span class="bound">x</span></span> <span class="main"><span class="main">.</span></span> <span class="main"><span class="main">(</span></span>Repl <span class="free"><span class="free">v</span></span> <span class="main"><span class="main">(</span></span>Opair <span class="bound"><span class="bound">x</span></span><span class="main"><span class="main">)</span></span><span class="main"><span class="main">)</span></span>"</span></span></span><span class="main"><span class="main">,</span></span> <span class="operator">THEN</span> subst<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Uim <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">u</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> ElemLambdaFun<span class="main">)</span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>Elem <span class="free">u</span> <span class="free">U</span><span class="main">;</span> Elem <span class="free">v</span> <span class="free">U</span><span class="main">;</span> Elem <span class="skolem">x</span> <span class="free">u</span><span class="main">⟧</span> <span class="main">⟹</span> Elem <span class="main">(</span>Repl <span class="free">v</span> <span class="main">(</span>Opair <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="free">U</span>"</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">drule</span> Utrans <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">u</span></span></span></span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">x</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> SumRepl <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> subst<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> RangeRepl <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> subst<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Uim <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">v</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> ElemLambdaFun<span class="main"><span class="keyword3">,</span></span><span class="operator">simp</span><span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Usingle<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> UniversePair<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">drule</span> Usubset<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
        <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
          <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">xa</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>Elem <span class="free">v</span> <span class="free">U</span><span class="main">;</span> Elem <span class="skolem">x</span> <span class="free">u</span><span class="main">;</span> Elem <span class="skolem">x</span> <span class="free">U</span><span class="main">;</span> Elem <span class="skolem">xa</span> <span class="free">v</span><span class="main">⟧</span> <span class="main">⟹</span> Elem <span class="skolem">xa</span> <span class="free">U</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Utrans<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
          
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Universe<span class="main">)</span> UniverseSubset<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>subset <span class="free">u</span> <span class="free">v</span> <span class="main">;</span> Elem <span class="free">v</span> <span class="free">U</span><span class="main">⟧</span> <span class="main">⟹</span> Elem <span class="free">u</span> <span class="free">U</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">drule_tac</span> HOLZF.Power <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">u</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">v</span></span></span></span><span class="main"><span class="main">,</span></span> <span class="operator">THEN</span> ssubst<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">drule</span> Upow<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Utrans<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">Product</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"ZF <span class="main">⇒</span> ZF"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">Product</span> <span class="free"><span class="bound"><span class="entity">U</span></span></span> <span class="main">=</span> Sep <span class="main">(</span>Fun <span class="free"><span class="bound"><span class="entity">U</span></span></span> <span class="main">(</span>Sum <span class="free"><span class="bound"><span class="entity">U</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main">%</span><span class="bound">f</span> <span class="main">.</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">u</span> <span class="main">.</span> Elem <span class="bound">u</span> <span class="free"><span class="bound"><span class="entity">U</span></span></span> <span class="main">⟶</span> Elem <span class="main">(</span>app <span class="bound">f</span> <span class="bound">u</span><span class="main">)</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Universe-SepSubset"><span class="command">lemma</span></span> SepSubset<span class="main">:</span> <span class="quoted"><span class="quoted">"subset <span class="main">(</span>Sep <span class="free">A</span> <span class="free">p</span><span class="main">)</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> subset_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Sep<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Universe-SubsetSmall"><span class="command">lemma</span></span> SubsetSmall<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subset <span class="free">A'</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subset <span class="free">A</span> <span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"subset <span class="free">A'</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>subset <span class="free">A'</span> <span class="free">A</span> <span class="main">∧</span> subset <span class="free">A</span> <span class="free">B</span><span class="main">)</span> <span class="main">⟶</span> subset <span class="free">A'</span> <span class="free">B</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">subst</span> subset_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Universe-SubsetTrans"><span class="command">lemma</span></span> SubsetTrans<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>subset <span class="free">a</span> <span class="free">b</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>subset <span class="free">b</span> <span class="free">c</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>subset <span class="free">a</span> <span class="free">c</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>subset <span class="free">a</span> <span class="free">b</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>subset <span class="free">b</span> <span class="free">c</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span>subset <span class="free">a</span> <span class="free">c</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">subst</span> subset_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Universe-SubsetSepTrans"><span class="command">lemma</span></span> SubsetSepTrans<span class="main">:</span> <span class="quoted"><span class="quoted">"subset <span class="free">A</span> <span class="free">B</span> <span class="main">⟹</span> subset <span class="main">(</span>Sep <span class="free">A</span> <span class="free">p</span><span class="main">)</span> <span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> SubsetSmall <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"Sep <span class="free"><span class="free">A</span></span> <span class="free"><span class="free">p</span></span>"</span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">A</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">B</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> SepSubset<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Universe-ProductSubset"><span class="command">lemma</span></span> ProductSubset<span class="main">:</span> <span class="quoted"><span class="quoted">"subset <span class="main">(</span>Product <span class="free">u</span><span class="main">)</span> <span class="main">(</span>Power <span class="main">(</span>CartProd <span class="free">u</span> <span class="main">(</span>Sum <span class="free">u</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Product_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Fun_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> PFun_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> SubsetSepTrans<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> subset_def<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Universe<span class="main">)</span> UniverseProduct<span class="main">:</span> <span class="quoted"><span class="quoted">"Elem <span class="free">u</span> <span class="free">U</span> <span class="main">⟹</span> Elem <span class="main">(</span>Product <span class="free">u</span><span class="main">)</span> <span class="free">U</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> u<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">(</span>Product <span class="free">u</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> v<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"Power <span class="main">(</span>CartProd <span class="free">u</span> <span class="main">(</span>Sum <span class="free">u</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> UniverseSubset<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> ProductSubset<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Upow<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> UniverseProd<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> UniverseSum<span class="main"><span class="keyword3">,</span></span><span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Universe-ZFImageRangeExplode"><span class="command">lemma</span></span> ZFImageRangeExplode<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> range explode <span class="main">⟹</span> <span class="free">f</span> <span class="main">`</span> <span class="free">x</span> <span class="main">∈</span> range explode"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> range explode"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> explode <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> range_ex1_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">`</span> <span class="free">x</span> <span class="main">=</span> explode <span class="main">(</span>Repl <span class="skolem">y</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> explode_Repl_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">`</span> <span class="free">x</span> <span class="main">∈</span> range explode"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">subsetFn</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="free"><span class="bound"><span class="entity">Y</span></span></span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">(</span><span class="keyword1">if</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">Y</span></span></span> <span class="keyword1">then</span> <span class="bound">x</span> <span class="keyword1">else</span> <span class="keyword1">SOME</span> <span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">Y</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Universe-subsetFn"><span class="command">lemma</span></span> subsetFn<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">Y</span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">;</span> <span class="free">Y</span> <span class="main">⊆</span> <span class="free">X</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span>subsetFn <span class="free">X</span> <span class="free">Y</span><span class="main">)</span> <span class="main">`</span> <span class="free">X</span> <span class="main">=</span> <span class="free">Y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> subsetFn_def<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">Y</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">∈</span> <span class="free">Y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> someI_ex<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">Y</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Universe-ZFSubsetRangeExplode"><span class="command">lemma</span></span> ZFSubsetRangeExplode<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">X</span> <span class="main">∈</span> range explode <span class="main">;</span> <span class="free">Y</span> <span class="main">⊆</span> <span class="free">X</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">Y</span> <span class="main">∈</span> range explode"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">=</span> <span class="main">{}</span>"</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"explode Empty <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> explode_Empty <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∈</span> range explode"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> explode_def<span class="main">)</span> 
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">⊆</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> range explode"</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> range explode"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> ZFImageRangeExplode<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">X</span></span> <span class="quoted"><span class="quoted">"subsetFn <span class="free">X</span> <span class="free">Y</span>"</span></span><span class="main">]</span> subsetFn<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">Y</span></span> <span class="quoted"><span class="free">X</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Universe-ZFUnionRangeExplode"><span class="command">lemma</span></span> ZFUnionRangeExplode<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">∈</span> range explode"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> range explode"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋃</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">.</span> <span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> range explode"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?S</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Sep <span class="main">(</span>Sum <span class="main">(</span>Repl <span class="main">(</span>implode <span class="free">A</span><span class="main">)</span> <span class="main">(</span>implode <span class="keyword1">o</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">y</span> <span class="main">.</span> <span class="main">∃</span> <span class="bound">x</span>  <span class="main">.</span> <span class="main">(</span>Elem <span class="bound">x</span> <span class="main">(</span>implode <span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>Elem <span class="bound">y</span> <span class="main">(</span>implode <span class="main">(</span><span class="free">f</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"explode <span class="var">?S</span> <span class="main">=</span> <span class="main">(</span><span class="main">⋃</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">.</span> <span class="free">f</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> UNION_eq explode_def Sep Sum Repl assms Elem_implode <span class="quasi_keyword">cong</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> image_cong_simp<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">f</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">z</span><span class="main">.</span> Elem <span class="skolem">x</span> <span class="bound">z</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="bound">a</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">z</span> <span class="main">=</span> implode <span class="main">(</span><span class="free">f</span> <span class="bound">a</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> exI <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?x</span> <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="quoted"><span class="quoted"><span class="quoted">"implode <span class="main"><span class="main">(</span></span><span class="free"><span class="free">f</span></span> <span class="skolem"><span class="skolem">y</span></span><span class="main"><span class="main">)</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> explode_def Sep Sum Repl assms Elem_implode a b <span class="quasi_keyword">cong</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> image_cong_simp<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> exI <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?x</span> <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">y</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> a<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1" id="Universe-ZFUnionNatInRangeExplode"><span class="command">lemma</span></span> ZFUnionNatInRangeExplode<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span> <span class="main">(</span><span class="bound">n</span> <span class="main">::</span> nat<span class="main">)</span> <span class="main">.</span> <span class="free">f</span> <span class="bound">n</span> <span class="main">∈</span> range explode<span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">⋃</span> <span class="bound">n</span> <span class="main">.</span> <span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">∈</span> range explode"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span> <span class="main">(</span><span class="bound">n</span> <span class="main">::</span> nat<span class="main">)</span> <span class="main">.</span> <span class="free">f</span> <span class="bound">n</span> <span class="main">∈</span> range explode<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"explode Nat <span class="main">∈</span> range explode"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n</span> <span class="main">.</span> <span class="bound">n</span> <span class="main">∈</span> <span class="main">(</span>explode Nat<span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">f</span> <span class="keyword1">o</span> Nat2nat<span class="main">)</span> <span class="bound">n</span> <span class="main">∈</span> range explode"</span></span> <span class="keyword1"><span class="command">using</span></span> a
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> explode_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋃</span> <span class="bound">n</span> <span class="main">.</span> <span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">⋃</span> <span class="bound">n</span> <span class="main">∈</span> <span class="main">(</span>explode Nat<span class="main">)</span> <span class="main">.</span> <span class="main">(</span><span class="free">f</span> <span class="keyword1">o</span> Nat2nat<span class="main">)</span> <span class="bound">n</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Nat2nat_def<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">f</span> <span class="skolem">n</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">n</span> <span class="main">∈</span> <span class="main">(</span>explode Nat<span class="main">)</span> <span class="main">.</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="free">f</span> <span class="main">(</span>inv nat2Nat <span class="bound">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> bexI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?x</span> <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="quoted"><span class="quoted"><span class="quoted">"nat2Nat <span class="skolem"><span class="skolem">n</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> aa inj_nat2Nat explode_Elem<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋃</span> <span class="bound">n</span> <span class="main">.</span> <span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">∈</span> range explode"</span></span> <span class="keyword1"><span class="command">using</span></span> ZFUnionRangeExplode <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Universe-ZFProdFnInRangeExplode"><span class="command">lemma</span></span> ZFProdFnInRangeExplode<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">A</span> <span class="main">∈</span> range explode <span class="main">;</span> <span class="free">B</span> <span class="main">∈</span> range explode<span class="main">⟧</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">`</span> <span class="main">(</span><span class="free">A</span> <span class="main">×</span> <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> range explode"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> range explode"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> range explode"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?X</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>explode <span class="main">(</span>CartProd <span class="main">(</span>implode <span class="free">A</span><span class="main">)</span> <span class="main">(</span>implode <span class="free">B</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">`</span> <span class="main">(</span><span class="free">A</span> <span class="main">×</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span>  <span class="keyword1">o</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">z</span> <span class="main">.</span> <span class="main">(</span>Fst <span class="bound">z</span><span class="main">,</span> Snd <span class="bound">z</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="var">?X</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> explode_def CartProd image_def Fst Snd<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> z<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> y<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="free">B</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">a</span><span class="main">.</span> Elem <span class="bound">a</span> <span class="main">(</span>implode <span class="free">A</span><span class="main">)</span> <span class="main">∧</span>
        <span class="main">(</span><span class="main">∃</span><span class="bound">b</span><span class="main">.</span> Elem <span class="bound">b</span> <span class="main">(</span>implode <span class="free">B</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">=</span> Opair <span class="bound">a</span> <span class="bound">b</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="free">f</span> <span class="main">(</span><span class="skolem">z</span><span class="main">,</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span> <span class="main">(</span>Fst <span class="bound">x</span><span class="main">,</span> Snd <span class="bound">x</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">insert</span> z y a b<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?x</span> <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="quoted"><span class="quoted"><span class="quoted">"Opair <span class="skolem"><span class="skolem">z</span></span> <span class="skolem"><span class="skolem">y</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Opair explode_Elem Fst Snd<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"Elem <span class="skolem">a</span> <span class="main">(</span>implode <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> bb<span class="main">:</span> <span class="quoted"><span class="quoted">"Elem <span class="skolem">b</span> <span class="main">(</span>implode <span class="free">B</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span> <span class="main">∈</span> <span class="free">B</span> <span class="main">.</span> <span class="free">f</span> <span class="main">(</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span> <span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> bexI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?x</span> <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">a</span></span></span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> bexI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?x</span> <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">b</span></span></span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">insert</span> a b aa bb<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> explode_Elem<span class="main">)</span>
    <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?X</span> <span class="main">∈</span> range explode"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">`</span> <span class="main">(</span><span class="free">A</span> <span class="main">×</span> <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> range explode"</span></span> <span class="keyword1"><span class="command">using</span></span> ZFImageRangeExplode <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Universe-ZFUnionInRangeExplode"><span class="command">lemma</span></span> ZFUnionInRangeExplode<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">A</span> <span class="main">∈</span> range explode <span class="main">;</span> <span class="free">B</span> <span class="main">∈</span> range explode<span class="main">⟧</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">∪</span> <span class="free">B</span> <span class="main">∈</span> range explode"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> range explode"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> range explode"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A'</span></span> <span class="skolem"><span class="skolem">B'</span></span> <span class="keyword2"><span class="keyword">where</span></span> A'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> explode <span class="skolem">A'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> B'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">=</span> explode <span class="skolem">B'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∪</span> <span class="free">B</span> <span class="main">=</span> explode <span class="main">(</span>union <span class="main">(</span>implode <span class="free">A</span><span class="main">)</span> <span class="main">(</span>implode <span class="free">B</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> explode_union  union explode_Elem A' B'<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∪</span> <span class="free">B</span> <span class="main">∈</span> range explode"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Universe-SingletonInRangeExplode"><span class="command">lemma</span></span> SingletonInRangeExplode<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">∈</span> range explode"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"explode <span class="main">(</span>Singleton <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> explode_def Singleton<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ZFTriple</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span>ZF<span class="main">,</span>ZF<span class="main">,</span>ZF<span class="main">]</span> <span class="main">⇒</span> ZF"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ZFTriple</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="free"><span class="bound"><span class="entity">b</span></span></span> <span class="free"><span class="bound"><span class="entity">c</span></span></span> <span class="main">=</span> Opair <span class="main">(</span>Opair <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="free"><span class="bound"><span class="entity">b</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">c</span></span></span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">ZFTFst</span> <span class="main">=</span> Fst <span class="keyword1">o</span> Fst"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">ZFTSnd</span> <span class="main">=</span> Snd <span class="keyword1">o</span> Fst"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">ZFTThd</span> <span class="main">=</span> Snd"</span></span>

<span class="keyword1" id="Universe-ZFTFst"><span class="command">lemma</span></span> ZFTFst<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFTFst <span class="main">(</span>ZFTriple <span class="free">a</span> <span class="free">b</span> <span class="free">c</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span>"</span></span> 
  <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFTriple_def ZFTFst_def Fst<span class="main">)</span>
<span class="keyword1" id="Universe-ZFTSnd"><span class="command">lemma</span></span> ZFTSnd<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFTSnd <span class="main">(</span>ZFTriple <span class="free">a</span> <span class="free">b</span> <span class="free">c</span><span class="main">)</span> <span class="main">=</span> <span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFTriple_def ZFTSnd_def Snd Fst<span class="main">)</span>
<span class="keyword1" id="Universe-ZFTThd"><span class="command">lemma</span></span> ZFTThd<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFTThd <span class="main">(</span>ZFTriple <span class="free">a</span> <span class="free">b</span> <span class="free">c</span><span class="main">)</span> <span class="main">=</span> <span class="free">c</span>"</span></span> 
  <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFTriple_def ZFTThd_def Snd Fst<span class="main">)</span>

<span class="keyword1" id="Universe-ZFTriple"><span class="command">lemma</span></span> ZFTriple<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFTriple <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">=</span> ZFTriple <span class="free">a'</span> <span class="free">b'</span> <span class="free">c'</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">a</span> <span class="main">=</span> <span class="free">a'</span> <span class="main">∧</span> <span class="free">b</span> <span class="main">=</span> <span class="free">b'</span> <span class="main">∧</span> <span class="free">c</span> <span class="main">=</span> <span class="free">c'</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFTriple_def Opair<span class="main">)</span>

<span class="keyword1" id="Universe-ZFSucZero"><span class="command">lemma</span></span> ZFSucZero<span class="main">:</span> <span class="quoted"><span class="quoted">"Nat2nat <span class="main">(</span>SucNat Empty<span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat2Nat <span class="main">0</span> <span class="main">=</span> Empty"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>SucNat Empty<span class="main">)</span> <span class="main">=</span> nat2Nat <span class="main">(</span>Suc <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"Nat2nat <span class="main">(</span>SucNat Empty<span class="main">)</span> <span class="main">=</span> Nat2nat <span class="main">(</span>nat2Nat <span class="main">(</span>Suc <span class="main">0</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> Suc <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Nat2nat_nat2Nat<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"Suc <span class="main">0</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Universe-ZFZero"><span class="command">lemma</span></span> ZFZero<span class="main">:</span> <span class="quoted"><span class="quoted">"Nat2nat Empty <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat2Nat <span class="main">0</span> <span class="main">=</span> Empty"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"Nat2nat Empty <span class="main">=</span> Nat2nat <span class="main">(</span>nat2Nat <span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Nat2nat_nat2Nat<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">0</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Universe-ZFSucNeq0"><span class="command">lemma</span></span> ZFSucNeq0<span class="main">:</span> <span class="quoted"><span class="quoted">"Elem <span class="free">x</span> Nat <span class="main">⟹</span> Nat2nat <span class="main">(</span>SucNat <span class="free">x</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Nat2nat_SucNat<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="MonadicEquationalTheory">
<div class="head">
<h1>Theory MonadicEquationalTheory</h1>
</div>
<pre class="source"><span class="comment1">(*
Author: Alexander Katovsky
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Monadic Equational Theory"</span></span>

<span class="keyword1"><span class="command">theory</span></span> MonadicEquationalTheory
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Category.html">Category</a> <a href="Universe.html">Universe</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">record</span></span> <span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Signature <span class="main">=</span> 
  BaseTypes <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'t</span> set"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Ty</span>ı"</span><span class="main">)</span>
  BaseFunctions <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'f</span> set"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Fn</span>ı"</span><span class="main">)</span>
  SigDom <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'f</span> <span class="main">⇒</span> <span class="tfree">'t</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">sDom</span>ı"</span><span class="main">)</span>
  SigCod <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'f</span> <span class="main">⇒</span> <span class="tfree">'t</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">sCod</span>ı"</span><span class="main">)</span>

<span class="keyword1"><span class="command">locale</span></span> Signature <span class="main">=</span> 
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Signature"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Domt<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Fn</span> <span class="main">⟹</span> <span class="keyword1">sDom</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ty</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     Codt<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Fn</span> <span class="main">⟹</span> <span class="keyword1">sCod</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Ty</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">funsignature_abbrev</span> <span class="main">(</span><span class="quoted">"_ <span class="keyword1">∈</span> <span class="keyword1">Sig</span> _ <span class="keyword1">:</span> _ <span class="keyword1">→</span> _"</span> <span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main"><span class="free">∈</span></span> <span class="keyword1"><span class="free">Sig</span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main"><span class="free">:</span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main"><span class="free">→</span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> <span class="main">(</span>BaseFunctions <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∈</span> <span class="main">(</span>BaseTypes <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">∈</span> <span class="main">(</span>BaseTypes <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span> <span class="main">∧</span> 
                        <span class="main">(</span>SigDom <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∧</span> <span class="main">(</span>SigCod <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">∧</span> Signature <span class="free"><span class="bound"><span class="entity">S</span></span></span>"</span></span>

<span class="keyword1" id="MonadicEquationalTheory-funsignature_abbrevE"><span class="command">lemma</span></span> funsignature_abbrevE<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span> 
<span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">:</span> <span class="free">A</span> <span class="main">→</span> <span class="free">B</span> <span class="main">;</span> <span class="main">⟦</span><span class="free">f</span> <span class="main">∈</span> <span class="main">(</span>BaseFunctions <span class="free">S</span><span class="main">)</span> <span class="main">;</span> <span class="free">A</span> <span class="main">∈</span> <span class="main">(</span>BaseTypes <span class="free">S</span><span class="main">)</span> <span class="main">;</span> <span class="free">B</span> <span class="main">∈</span> <span class="main">(</span>BaseTypes <span class="free">S</span><span class="main">)</span> <span class="main">;</span> 
                        <span class="main">(</span>SigDom <span class="free">S</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span> <span class="main">;</span> <span class="main">(</span>SigCod <span class="free">S</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">B</span> <span class="main">;</span> Signature <span class="free">S</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> funsignature_abbrev_def<span class="main">)</span>

<span class="keyword1"><span class="command">datatype</span></span> <span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Expression <span class="main">=</span> ExprVar <span class="main">(</span><span class="quoted">"<span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1">Vx</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>"</span><span class="main">)</span> <span class="main">|</span> ExprApp <span class="tfree"><span class="quoted"><span class="tfree">'f</span></span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Expression"</span></span> <span class="main">(</span><span class="quoted">"_ <span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1">E@</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> _"</span><span class="main">)</span>
<span class="keyword1"><span class="command">datatype</span></span> <span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Language <span class="main">=</span> Type <span class="tfree"><span class="quoted"><span class="tfree">'t</span></span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1">⊢</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> _ <span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1">Type</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>"</span><span class="main">)</span> <span class="main">|</span> Term <span class="tfree"><span class="quoted"><span class="tfree">'t</span></span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Expression"</span></span> <span class="tfree"><span class="quoted"><span class="tfree">'t</span></span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1">Vx</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1">:</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> _ <span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1">⊢</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> _ <span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1">:</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> _"</span><span class="main">)</span> <span class="main">|</span> 
                            Equation <span class="tfree"><span class="quoted"><span class="tfree">'t</span></span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Expression"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Expression"</span></span> <span class="tfree"><span class="quoted"><span class="tfree">'t</span></span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1">Vx</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1">:</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> _ <span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1">⊢</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> _<span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1">≡</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>_ <span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1">:</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> _"</span><span class="main">)</span>

<span class="keyword1"><span class="command">inductive</span></span>
  <span class="entity">WellDefined</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Signature <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Language <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Sig</span> _ <span class="keyword1">▹</span> _"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
    WellDefinedTy<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∈</span> BaseTypes <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">⟹</span> <span class="keyword1"><span class="free">Sig</span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main"><span class="free">▹</span></span> <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">Type</span>"</span></span>
  <span class="main">|</span> WellDefinedVar<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Sig</span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main"><span class="free">▹</span></span> <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">Type</span> <span class="main">⟹</span> <span class="keyword1"><span class="free">Sig</span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main"><span class="free">▹</span></span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>  <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span>"</span></span> 
  <span class="main">|</span> WellDefinedFn<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="keyword1"><span class="free">Sig</span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main"><span class="free">▹</span></span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>  <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span>  <span class="main">;</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> <span class="keyword1">Sig</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">→</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">⟧</span> <span class="main">⟹</span> <span class="keyword1"><span class="free">Sig</span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main"><span class="free">▹</span></span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>  <span class="main">⊢</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="keyword1">E@</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span>"</span></span>
  <span class="main">|</span> WellDefinedEq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="keyword1"><span class="free">Sig</span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main"><span class="free">▹</span></span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>  <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">;</span> <span class="keyword1"><span class="free">Sig</span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main"><span class="free">▹</span></span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>  <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="keyword1"><span class="free">Sig</span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main"><span class="free">▹</span></span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> WellDefined.intros <span class="main">[</span><span class="operator">intro</span><span class="main">]</span>
<span class="keyword1"><span class="command">inductive_cases</span></span> WellDefinedTyE <span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">Type</span>"</span></span>
<span class="keyword1"><span class="command">inductive_cases</span></span> WellDefinedVarE <span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">inductive_cases</span></span> WellDefinedFnE <span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="main">(</span><span class="free">f</span> <span class="keyword1">E@</span> <span class="free">e</span><span class="main">)</span> <span class="main">:</span> <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">inductive_cases</span></span> WellDefinedEqE <span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e1</span> <span class="main">≡</span> <span class="free">e2</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="MonadicEquationalTheory-SigId"><span class="command">lemma</span></span> SigId<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">=</span> <span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> WellDefined.cases<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1" id="MonadicEquationalTheory-SigTyId"><span class="command">lemma</span></span> SigTyId<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">∈</span> BaseTypes <span class="free">S</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> WellDefined.cases<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Signature<span class="main">)</span> SigTy<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">B</span> <span class="main">.</span> <span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="bound">B</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">A</span> <span class="main">∈</span> BaseTypes <span class="free">S</span> <span class="main">∧</span> <span class="bound">B</span> <span class="main">∈</span> BaseTypes <span class="free">S</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">e</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a SigId<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">S</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ty</span> <span class="main">∧</span> <span class="skolem">B</span> <span class="main">∈</span> <span class="keyword1">Ty</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span> <span class="skolem">f</span> <span class="skolem">e</span> <span class="keyword3"><span class="command">assume</span></span> ih<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">B'</span><span class="main">.</span> <span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="bound">B'</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ty</span> <span class="main">∧</span> <span class="bound">B'</span> <span class="main">∈</span> <span class="keyword1">Ty</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> a <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B'</span></span> <span class="keyword2"><span class="keyword">where</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">:</span> <span class="skolem">B'</span> <span class="main">→</span> <span class="skolem">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ty</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ih <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> <span class="keyword1">Ty</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> funsignature_abbrev_def Codt<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="keyword1">Ty</span> <span class="main">∧</span> <span class="skolem">B</span> <span class="main">∈</span> <span class="keyword1">Ty</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(*An interpretation is an object, a morphism or a boolean*)</span>
<span class="keyword1"><span class="command">datatype</span></span> <span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">)</span> IType <span class="main">=</span> IObj <span class="tfree"><span class="quoted"><span class="tfree">'o</span></span></span> <span class="main">|</span> IMor <span class="tfree"><span class="quoted"><span class="tfree">'m</span></span></span> <span class="main">|</span> IBool <span class="quoted">bool</span>

<span class="keyword1"><span class="command">record</span></span> <span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">,</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">)</span> Interpretation <span class="main">=</span> 
  ISignature <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Signature"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">iS</span>ı"</span><span class="main">)</span>
  ICategory  <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">)</span> Category"</span></span>  <span class="main">(</span><span class="quoted">"<span class="keyword1">iC</span>ı"</span><span class="main">)</span>
  ITypes     <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'t</span> <span class="main">⇒</span> <span class="tfree">'o</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Ty⟦</span>_<span class="keyword1">⟧</span>ı"</span><span class="main">)</span>
  IFunctions <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'f</span> <span class="main">⇒</span> <span class="tfree">'m</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Fn⟦</span>_<span class="keyword1">⟧</span>ı"</span><span class="main">)</span>

<span class="keyword1"><span class="command">locale</span></span> Interpretation <span class="main">=</span> 
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">I</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">,</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">)</span> Interpretation"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> ICat<span class="main">:</span> <span class="quoted"><span class="quoted">"Category  <span class="keyword1">iC</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     ISig<span class="main">:</span> <span class="quoted"><span class="quoted">"Signature <span class="keyword1">iS</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span>     It  <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> BaseTypes <span class="keyword1">iS</span> <span class="main">⟹</span> <span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span> <span class="main">∈</span> Obj <span class="keyword1">iC</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     If  <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">∈</span> <span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">:</span> <span class="free">A</span> <span class="main">→</span> <span class="free">B</span><span class="main">)</span> <span class="main">⟹</span> <span class="keyword1">Fn⟦</span><span class="free">f</span><span class="main">⟧</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span> <span class="keyword1">to</span> <span class="keyword1">Ty⟦</span><span class="free">B</span><span class="main">⟧</span>"</span></span>

<span class="keyword1"><span class="command">inductive</span></span> <span class="entity">Interp</span>  <span class="main">(</span><span class="quoted">"<span class="keyword1">L⟦</span>_<span class="keyword1">⟧</span>ı <span class="keyword1">→</span> _"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
    InterpTy<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">iS</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">I</span></span></span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">Type</span> <span class="main">⟹</span> 
                       <span class="keyword1"><span class="free">L⟦</span></span><span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">Type</span><span class="main"><span class="free">⟧</span></span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">I</span></span></span></sub><span class="hidden">⇙</span> <span class="main"><span class="free">→</span></span> <span class="main">(</span>IObj <span class="keyword1">Ty⟦</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">⟧</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">I</span></span></span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
  <span class="main">|</span> InterpVar<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">L⟦</span></span><span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">Type</span><span class="main"><span class="free">⟧</span></span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">I</span></span></span></sub><span class="hidden">⇙</span> <span class="main"><span class="free">→</span></span> <span class="main">(</span>IObj <span class="free"><span class="bound"><span class="entity">c</span></span></span><span class="main">)</span> <span class="main">⟹</span> 
                       <span class="keyword1"><span class="free">L⟦</span></span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>  <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main"><span class="free">⟧</span></span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">I</span></span></span></sub><span class="hidden">⇙</span> <span class="main"><span class="free">→</span></span> <span class="main">(</span>IMor <span class="main">(</span>Id <span class="keyword1">iC</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">I</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">c</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span> 
  <span class="main">|</span> InterpFn<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="keyword1">Sig</span> <span class="keyword1">iS</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">I</span></span></span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>  <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">;</span> 
               <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> <span class="keyword1">Sig</span> <span class="keyword1">iS</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">I</span></span></span></sub><span class="hidden">⇙</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">→</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">;</span> 
               <span class="keyword1"><span class="free">L⟦</span></span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>  <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main"><span class="free">⟧</span></span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">I</span></span></span></sub><span class="hidden">⇙</span> <span class="main"><span class="free">→</span></span> <span class="main">(</span>IMor <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> 
               <span class="keyword1"><span class="free">L⟦</span></span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>  <span class="main">⊢</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="keyword1">E@</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main"><span class="free">⟧</span></span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">I</span></span></span></sub><span class="hidden">⇙</span> <span class="main"><span class="free">→</span></span> <span class="main">(</span>IMor <span class="main">(</span><span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">;;</span><span class="hidden">⇘</span><sub>ICategory <span class="free"><span class="bound"><span class="entity">I</span></span></span></sub><span class="hidden">⇙</span> <span class="keyword1">Fn⟦</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">⟧</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">I</span></span></span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="main">|</span> InterpEq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="keyword1"><span class="free">L⟦</span></span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>  <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main"><span class="free">⟧</span></span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">I</span></span></span></sub><span class="hidden">⇙</span> <span class="main"><span class="free">→</span></span> <span class="main">(</span>IMor <span class="free"><span class="bound"><span class="entity">g1</span></span></span><span class="main">)</span> <span class="main">;</span> 
                <span class="keyword1"><span class="free">L⟦</span></span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>  <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main"><span class="free">⟧</span></span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">I</span></span></span></sub><span class="hidden">⇙</span> <span class="main"><span class="free">→</span></span> <span class="main">(</span>IMor <span class="free"><span class="bound"><span class="entity">g2</span></span></span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> 
                <span class="keyword1"><span class="free">L⟦</span></span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>  <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main"><span class="free">⟧</span></span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">I</span></span></span></sub><span class="hidden">⇙</span> <span class="main"><span class="free">→</span></span> <span class="main">(</span>IBool <span class="main">(</span><span class="free"><span class="bound"><span class="entity">g1</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">g2</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemmas</span></span>  Interp.intros <span class="main">[</span><span class="operator">intro</span><span class="main">]</span>
<span class="keyword1"><span class="command">inductive_cases</span></span>  InterpTyE <span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="main">⊢</span> <span class="free">A</span> <span class="keyword1">Type</span><span class="main">⟧</span><span class="hidden">⇘</span><sub><span class="free">I</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command">inductive_cases</span></span>  InterpVarE <span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span><span class="main">⟧</span><span class="hidden">⇘</span><sub><span class="free">I</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command">inductive_cases</span></span>  InterpFnE <span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="main">(</span><span class="free">f</span> <span class="keyword1">E@</span> <span class="free">e</span><span class="main">)</span> <span class="main">:</span> <span class="free">C</span><span class="main">⟧</span><span class="hidden">⇘</span><sub><span class="free">I</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command">inductive_cases</span></span>  InterpEqE <span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="free">e1</span> <span class="main">≡</span> <span class="free">e2</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span><span class="hidden">⇘</span><sub><span class="free">I</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="free">i</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Interpretation<span class="main">)</span> InterpEqEq<span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="free">e1</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="free">g</span><span class="main">)</span> <span class="main">;</span> <span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="free">e2</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="free">g</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="free">e1</span> <span class="main">≡</span> <span class="free">e2</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IBool True<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="free">e1</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="free">e2</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="free">g</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> InterpEq<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">I</span></span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">e1</span></span> <span class="quoted"><span class="free">B</span></span> <span class="quoted"><span class="free">g</span></span> <span class="quoted"><span class="free">e2</span></span> <span class="quoted"><span class="free">g</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Interpretation<span class="main">)</span> InterpExprWellDefined<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="free">i</span> <span class="main">⟹</span> <span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Interp.cases<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Interpretation<span class="main">)</span> WellDefined<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="free">φ</span><span class="main">⟧</span> <span class="main">→</span> <span class="free">i</span> <span class="main">⟹</span> <span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">▹</span> <span class="free">φ</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> Interp.cases<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> InterpExprWellDefined<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Interpretation<span class="main">)</span> Bool<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="free">φ</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IBool <span class="free">i</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">∃</span> <span class="bound">A</span> <span class="bound">B</span> <span class="bound">e</span> <span class="bound">d</span> <span class="main">.</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="bound">A</span> <span class="main">⊢</span> <span class="bound">e</span> <span class="main">≡</span> <span class="bound">d</span> <span class="main">:</span> <span class="bound">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> Interp.cases<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Interpretation<span class="main">)</span> FunctionalExpr<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">i</span> <span class="bound">j</span> <span class="bound">A</span> <span class="bound">B</span><span class="main">.</span><span class="main">⟦</span><span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="bound">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="bound">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="bound">i</span><span class="main">;</span> <span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="bound">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="bound">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="bound">j</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="bound">i</span> <span class="main">=</span> <span class="bound">j</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">e</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Interp.cases<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> funsignature_abbrev_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Interpretation<span class="main">)</span> Functional<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="keyword1">L⟦</span><span class="free">φ</span><span class="main">⟧</span> <span class="main">→</span> <span class="free">i1</span> <span class="main">;</span> <span class="keyword1">L⟦</span><span class="free">φ</span><span class="main">⟧</span> <span class="main">→</span> <span class="free">i2</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">i1</span> <span class="main">=</span> <span class="free">i2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">φ</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">t</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="keyword1">L⟦</span><span class="main">⊢</span> <span class="skolem">t</span> <span class="keyword1">Type</span><span class="main">⟧</span> <span class="main">→</span> <span class="free">i1</span> <span class="main">;</span> <span class="keyword1">L⟦</span><span class="main">⊢</span> <span class="skolem">t</span> <span class="keyword1">Type</span><span class="main">⟧</span> <span class="main">→</span> <span class="free">i2</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">i1</span> <span class="main">=</span> <span class="free">i2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">t1</span> <span class="skolem">t2</span> <span class="skolem">e</span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">t1</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">t2</span><span class="main">⟧</span> <span class="main">→</span> <span class="free">i1</span><span class="main">;</span> <span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">t1</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">t2</span><span class="main">⟧</span> <span class="main">→</span> <span class="free">i2</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">i1</span> <span class="main">=</span> <span class="free">i2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctionalExpr<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">t1</span> <span class="skolem">t2</span> <span class="skolem">e1</span> <span class="skolem">e2</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">t1</span> <span class="main">⊢</span> <span class="skolem">e1</span> <span class="main">≡</span> <span class="skolem">e2</span> <span class="main">:</span> <span class="skolem">t2</span><span class="main">⟧</span> <span class="main">→</span> <span class="free">i1</span><span class="main">;</span> <span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">t1</span> <span class="main">⊢</span> <span class="skolem">e1</span> <span class="main">≡</span> <span class="skolem">e2</span> <span class="main">:</span> <span class="skolem">t2</span><span class="main">⟧</span> <span class="main">→</span> <span class="free">i2</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">i1</span> <span class="main">=</span> <span class="free">i2</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">g</span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> f1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">t1</span> <span class="main">⊢</span> <span class="skolem">e1</span> <span class="main">:</span> <span class="skolem">t2</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">f</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> f2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">t1</span> <span class="main">⊢</span> <span class="skolem">e2</span> <span class="main">:</span> <span class="skolem">t2</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">f</span><span class="main">)</span>"</span></span>
          <span class="keyword2"><span class="keyword">and</span></span> g1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">t1</span> <span class="main">⊢</span> <span class="skolem">e1</span> <span class="main">:</span> <span class="skolem">t2</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> g2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">t1</span> <span class="main">⊢</span> <span class="skolem">e2</span> <span class="main">:</span> <span class="skolem">t2</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">h</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f1 g1 FunctionalExpr<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">t1</span></span> <span class="quoted"><span class="skolem">e1</span></span> <span class="quoted"><span class="skolem">t2</span></span> <span class="quoted"><span class="quoted">"IMor <span class="skolem">f</span>"</span></span> <span class="quoted"><span class="quoted">"IMor <span class="skolem">g</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="skolem">h</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f2 g2 FunctionalExpr<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">t1</span></span> <span class="quoted"><span class="skolem">e2</span></span> <span class="quoted"><span class="skolem">t2</span></span> <span class="quoted"><span class="quoted">"IMor <span class="skolem">f</span>"</span></span> <span class="quoted"><span class="quoted">"IMor <span class="skolem">h</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> <span class="skolem">h</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> 
      <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">g</span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> f1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">t1</span> <span class="main">⊢</span> <span class="skolem">e1</span> <span class="main">:</span> <span class="skolem">t2</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">f</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> f2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">t1</span> <span class="main">⊢</span> <span class="skolem">e2</span> <span class="main">:</span> <span class="skolem">t2</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g</span><span class="main">)</span>"</span></span>
          <span class="keyword2"><span class="keyword">and</span></span> g1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">t1</span> <span class="main">⊢</span> <span class="skolem">e1</span> <span class="main">:</span> <span class="skolem">t2</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">h</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> g2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">t1</span> <span class="main">⊢</span> <span class="skolem">e2</span> <span class="main">:</span> <span class="skolem">t2</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">h</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="skolem">h</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f1 g1 FunctionalExpr<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">t1</span></span> <span class="quoted"><span class="skolem">e1</span></span> <span class="quoted"><span class="skolem">t2</span></span> <span class="quoted"><span class="quoted">"IMor <span class="skolem">f</span>"</span></span> <span class="quoted"><span class="quoted">"IMor <span class="skolem">h</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> <span class="skolem">h</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f2 g2 FunctionalExpr<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">t1</span></span> <span class="quoted"><span class="skolem">e2</span></span> <span class="quoted"><span class="skolem">t2</span></span> <span class="quoted"><span class="quoted">"IMor <span class="skolem">g</span>"</span></span> <span class="quoted"><span class="quoted">"IMor <span class="skolem">h</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">qed</span></span> 
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Interpretation<span class="main">)</span> MorphismsPreserved<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">B</span> <span class="bound">i</span> <span class="main">.</span> <span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="bound">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="bound">i</span> <span class="main">⟹</span> <span class="main">∃</span> <span class="bound">g</span> <span class="main">.</span> <span class="bound">i</span> <span class="main">=</span> <span class="main">(</span>IMor <span class="bound">g</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span> </sub><span class="hidden">⇙</span><span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span> <span class="keyword1">to</span> <span class="keyword1">Ty⟦</span><span class="bound">B</span><span class="main">⟧</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">e</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span> <span class="skolem">i</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="skolem">i</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">g</span><span class="main">.</span> <span class="skolem">i</span> <span class="main">=</span> IMor <span class="bound">g</span> <span class="main">∧</span> <span class="bound">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span> <span class="keyword1">to</span> <span class="keyword1">Ty⟦</span><span class="skolem">B</span><span class="main">⟧</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?x</span><span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">"Id <span class="keyword1"><span class="keyword1">iC</span></span> <span class="keyword1"><span class="keyword1">Ty⟦</span></span><span class="free"><span class="free">A</span></span><span class="main"><span class="main">⟧</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> conjI<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> sig<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> InterpExprWellDefined<span class="main">)</span> 
      <span class="keyword1"><span class="command">hence</span></span> aEqb<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SigId<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> ty<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> BaseTypes <span class="keyword1">iS</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aEqb sig SigTyId <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">(</span>Id <span class="keyword1">iC</span> <span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">=</span> IMor <span class="main">(</span>Category.Id <span class="keyword1">iC</span> <span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a aEqb Functional <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Id <span class="keyword1">iC</span> <span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span> <span class="keyword1">to</span> <span class="keyword1">Ty⟦</span><span class="skolem">B</span><span class="main">⟧</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aEqb ICat It<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">A</span></span><span class="main">]</span> Category.Cidm<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="keyword1">iC</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span>"</span></span><span class="main">]</span> ty <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">e</span> <span class="skolem">B</span> <span class="skolem">i</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">B</span> <span class="bound">i</span> <span class="main">.</span> <span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="bound">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="bound">i</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">g</span><span class="main">.</span> <span class="bound">i</span> <span class="main">=</span> IMor <span class="bound">g</span> <span class="main">∧</span> <span class="bound">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span> <span class="keyword1">to</span> <span class="keyword1">Ty⟦</span><span class="bound">B</span><span class="main">⟧</span>"</span></span>
               <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="skolem">i</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">g</span><span class="main">.</span> <span class="skolem">i</span> <span class="main">=</span> IMor <span class="bound">g</span> <span class="main">∧</span> <span class="bound">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span> <span class="keyword1">to</span> <span class="keyword1">Ty⟦</span><span class="skolem">B</span><span class="main">⟧</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a b 
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> b <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="skolem"><span class="skolem">B'</span></span> <span class="keyword2"><span class="keyword">where</span></span> g<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B'</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">:</span> <span class="skolem">B'</span> <span class="main">→</span> <span class="skolem">B</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B'</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> a <span class="keyword1"><span class="command">have</span></span> gmaps<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span> <span class="keyword1">to</span> <span class="keyword1">Ty⟦</span><span class="skolem">B'</span><span class="main">⟧</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> g <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> fmaps<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Fn⟦</span><span class="skolem">f</span><span class="main">⟧</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Ty⟦</span><span class="skolem">B'</span><span class="main">⟧</span> <span class="keyword1">to</span> <span class="keyword1">Ty⟦</span><span class="skolem">B</span><span class="main">⟧</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> g If <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Fn⟦</span><span class="skolem">f</span><span class="main">⟧</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span> <span class="keyword1">to</span> <span class="keyword1">Ty⟦</span><span class="skolem">B</span><span class="main">⟧</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ICat fmaps gmaps Category.Ccompt<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="keyword1">iC</span>"</span></span> <span class="quoted"><span class="skolem">g</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">(</span><span class="skolem">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Fn⟦</span><span class="skolem">f</span><span class="main">⟧</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> g <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> b Functional exI<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?x</span> <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Fn⟦</span><span class="skolem">f</span><span class="main">⟧</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Interpretation<span class="main">)</span> Expr2Mor<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="free">g</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span> </sub><span class="hidden">⇙</span><span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span> <span class="keyword1">to</span> <span class="keyword1">Ty⟦</span><span class="free">B</span><span class="main">⟧</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="free">g</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> MorphismsPreserved<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">e</span></span> <span class="quoted"><span class="free">B</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>IMor <span class="free">g</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>IMor <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>IMor <span class="skolem">g'</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="skolem">g'</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span> </sub><span class="hidden">⇙</span><span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span> <span class="keyword1">to</span> <span class="keyword1">Ty⟦</span><span class="free">B</span><span class="main">⟧</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Interpretation<span class="main">)</span> WellDefinedExprInterp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">B</span> <span class="main">.</span> <span class="main">(</span><span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="bound">B</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">i</span> <span class="main">.</span> <span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="bound">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="bound">i</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">e</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span> <span class="keyword3"><span class="command">assume</span></span> sig<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">)</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">.</span> <span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="bound">i</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> aEqb<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> sig <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SigId<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> ty<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> BaseTypes <span class="keyword1">iS</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> sig SigTyId <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">(</span>Id <span class="keyword1">iC</span> <span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> aEqb <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">e</span> <span class="skolem">B</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">B</span> <span class="main">.</span> <span class="main">(</span><span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="bound">B</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">i</span> <span class="main">.</span> <span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="bound">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="bound">i</span><span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">i</span> <span class="main">.</span> <span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="bound">i</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> b <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B'</span></span> <span class="keyword2"><span class="keyword">where</span></span> B'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B'</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">:</span> <span class="skolem">B'</span> <span class="main">→</span> <span class="skolem">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> B' a <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> i<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B'</span><span class="main">⟧</span> <span class="main">→</span> <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> MorphismsPreserved<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="skolem">e</span></span> <span class="quoted"><span class="skolem">B'</span></span> <span class="quoted"><span class="skolem">i</span></span><span class="main">]</span> i <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> g<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">=</span> <span class="main">(</span>IMor <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> B' i <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Interpretation<span class="main">)</span> Sig2Mor<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">g</span> <span class="main">.</span> <span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="bound">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> WellDefinedExprInterp<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">e</span></span> <span class="quoted"><span class="free">B</span></span><span class="main">]</span> assms <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> i<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span>  <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="skolem">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> MorphismsPreserved<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">e</span></span> <span class="quoted"><span class="free">B</span></span> <span class="quoted"><span class="skolem">i</span></span><span class="main">]</span> i <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">record</span></span> <span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Axioms <span class="main">=</span> 
  aAxioms <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Language set"</span></span> 
  aSignature <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Signature"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">aS</span>ı"</span><span class="main">)</span>

<span class="keyword1"><span class="command">locale</span></span> Axioms <span class="main">=</span> 
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">Ax</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Axioms"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AxT<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>aAxioms <span class="free">Ax</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">{</span><span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="bound">A</span> <span class="main">⊢</span> <span class="bound">e1</span> <span class="main">≡</span> <span class="bound">e2</span> <span class="main">:</span> <span class="bound">B</span><span class="main">)</span> <span class="main">|</span> <span class="bound">A</span> <span class="bound">B</span> <span class="bound">e1</span> <span class="bound">e2</span> <span class="main">.</span> <span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">Ax</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="bound">A</span> <span class="main">⊢</span> <span class="bound">e1</span> <span class="main">≡</span> <span class="bound">e2</span> <span class="main">:</span> <span class="bound">B</span><span class="main">)</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AxSig<span class="main">:</span> <span class="quoted"><span class="quoted">"Signature <span class="main">(</span>aSignature <span class="free">Ax</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">Subst</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Expression <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Expression <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Expression"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">sub</span> _ <span class="keyword1">in</span> _"</span> <span class="main">[</span>81<span class="main">,</span>81<span class="main">]</span> 81<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1"><span class="free">sub</span></span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="keyword1"><span class="free">in</span></span> <span class="keyword1">Vx</span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span>"</span></span> <span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">sub</span></span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="keyword1"><span class="free">in</span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="keyword1">E@</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="keyword1">E@</span> <span class="main">(</span><span class="keyword1"><span class="free">sub</span></span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="keyword1"><span class="free">in</span></span> <span class="free"><span class="bound"><span class="entity">d</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="MonadicEquationalTheory-SubstXinE"><span class="command">lemma</span></span> SubstXinE<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">sub</span> <span class="keyword1">Vx</span> <span class="keyword1">in</span> <span class="free">e</span><span class="main">)</span> <span class="main">=</span> <span class="free">e</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">e</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Subst_def<span class="main">)</span>

<span class="keyword1" id="MonadicEquationalTheory-SubstAssoc"><span class="command">lemma</span></span> SubstAssoc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">sub</span> <span class="free">a</span> <span class="keyword1">in</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">b</span> <span class="keyword1">in</span> <span class="free">c</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">sub</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">a</span> <span class="keyword1">in</span> <span class="free">b</span><span class="main">)</span> <span class="keyword1">in</span> <span class="free">c</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">c</span></span><span class="main"><span class="keyword3">,</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Subst_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>

<span class="keyword1" id="MonadicEquationalTheory-SubstWellDefined"><span class="command">lemma</span></span> SubstWellDefined<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">C</span> <span class="main">.</span> <span class="main">⟦</span><span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span><span class="main">;</span> <span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="free">d</span> <span class="main">:</span> <span class="bound">C</span><span class="main">)</span><span class="main">⟧</span>
       <span class="main">⟹</span> <span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e</span> <span class="keyword1">in</span> <span class="free">d</span><span class="main">)</span> <span class="main">:</span> <span class="bound">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">d</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">C</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">C</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> BCeq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">=</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b SigId<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">S</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="keyword1">sub</span> <span class="free">e</span> <span class="keyword1">in</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">d</span> <span class="skolem">C</span> <span class="keyword3"><span class="command">assume</span></span> ih<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">B'</span><span class="main">.</span> <span class="main">⟦</span><span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">;</span> <span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="skolem">d</span> <span class="main">:</span> <span class="bound">B'</span><span class="main">⟧</span>
            <span class="main">⟹</span> <span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="keyword1">sub</span> <span class="free">e</span> <span class="keyword1">in</span> <span class="skolem">d</span> <span class="main">:</span> <span class="bound">B'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">d</span> <span class="main">:</span> <span class="skolem">C</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> b <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B'</span></span> <span class="keyword2"><span class="keyword">where</span></span> B'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">:</span> <span class="skolem">B'</span> <span class="main">→</span> <span class="skolem">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="skolem">d</span> <span class="main">:</span> <span class="skolem">B'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="keyword1">sub</span> <span class="free">e</span> <span class="keyword1">in</span> <span class="skolem">d</span> <span class="main">:</span> <span class="skolem">B'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ih a <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e</span> <span class="keyword1">in</span> <span class="skolem">d</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> B' <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e</span> <span class="keyword1">in</span> <span class="main">(</span><span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">d</span><span class="main">)</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">inductive_set</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Axioms<span class="main">)</span> <span class="entity">Theory</span> <span class="keyword2"><span class="keyword">where</span></span>
  Ax<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∈</span> <span class="main">(</span>aAxioms <span class="free">Ax</span><span class="main">)</span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∈</span> <span class="free">Theory</span>"</span></span>
<span class="main">|</span> Refl<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">Ax</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">Theory</span>"</span></span>
<span class="main">|</span> Symm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">Theory</span> <span class="main">⟹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">Theory</span>"</span></span> 
<span class="main">|</span> Trans<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">Theory</span> <span class="main">;</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">e3</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">Theory</span><span class="main">⟧</span> <span class="main">⟹</span>
           <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">e3</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">Theory</span>"</span></span>
<span class="main">|</span> Congr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">Theory</span> <span class="main">;</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∈</span> <span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">Ax</span><span class="main">)</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">→</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">⟧</span> <span class="main">⟹</span> 
           <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">⊢</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="keyword1">E@</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="keyword1">E@</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span><span class="main">)</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">Theory</span>"</span></span>
<span class="main">|</span> Subst<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">Ax</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">;</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">e3</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">Theory</span><span class="main">⟧</span> <span class="main">⟹</span>
           <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="keyword1">in</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="keyword1">in</span> <span class="free"><span class="bound"><span class="entity">e3</span></span></span><span class="main">)</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">Theory</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Axioms<span class="main">)</span> Equiv2WellDefined<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> Theory <span class="main">⟹</span> <span class="keyword1">Sig</span> <span class="keyword1">aS</span> <span class="main">▹</span> <span class="free">φ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> Theory.induct<span class="main"><span class="keyword3">,</span></span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SubstWellDefined<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">φ</span> <span class="keyword3"><span class="command">assume</span></span> ax<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">φ</span> <span class="main">∈</span> aAxioms <span class="free">Ax</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> AxT <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="skolem"><span class="skolem">e1</span></span> <span class="skolem"><span class="skolem">e2</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e1</span> <span class="main">≡</span> <span class="skolem">e2</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">φ</span> <span class="main">=</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e1</span> <span class="main">≡</span> <span class="skolem">e2</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ax <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span> <span class="main">▹</span> <span class="skolem">φ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>    
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Axioms<span class="main">)</span> Subst'<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">C</span> <span class="main">.</span> <span class="main">⟦</span><span class="keyword1">Sig</span> <span class="keyword1">aS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="free">d</span> <span class="main">:</span> <span class="bound">C</span> <span class="main">;</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e1</span> <span class="main">≡</span> <span class="free">e2</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> Theory<span class="main">⟧</span> <span class="main">⟹</span> 
  <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e1</span> <span class="keyword1">in</span> <span class="free">d</span><span class="main">)</span> <span class="main">≡</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e2</span> <span class="keyword1">in</span> <span class="free">d</span><span class="main">)</span> <span class="main">:</span> <span class="bound">C</span><span class="main">)</span> <span class="main">∈</span> Theory"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">d</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">C</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e1</span><span class="main">≡</span><span class="free">e2</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> Theory"</span></span>
    <span class="keyword1"><span class="command">have</span></span> BCeq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">=</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a SigId<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="keyword1">aS</span></span> <span class="quoted"><span class="free">B</span></span> <span class="quoted"><span class="skolem">C</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e1</span> <span class="keyword1">in</span> <span class="keyword1">Vx</span><span class="main">)</span> <span class="main">≡</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e2</span> <span class="keyword1">in</span> <span class="keyword1">Vx</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">C</span><span class="main">)</span> <span class="main">∈</span> Theory"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Subst_def<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">C</span> <span class="skolem">f</span> <span class="skolem">d</span> <span class="keyword3"><span class="command">assume</span></span> ih<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">B'</span> <span class="main">.</span> <span class="main">⟦</span><span class="keyword1">Sig</span> <span class="keyword1">aS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="skolem">d</span> <span class="main">:</span> <span class="bound">B'</span><span class="main">;</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e1</span><span class="main">≡</span><span class="free">e2</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> Theory<span class="main">⟧</span>
      <span class="main">⟹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e1</span> <span class="keyword1">in</span> <span class="skolem">d</span><span class="main">)</span> <span class="main">≡</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e2</span> <span class="keyword1">in</span> <span class="skolem">d</span><span class="main">)</span> <span class="main">:</span> <span class="bound">B'</span><span class="main">)</span> <span class="main">∈</span> Theory"</span></span> <span class="keyword2"><span class="keyword">and</span></span> wd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">d</span> <span class="main">:</span> <span class="skolem">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e1</span> <span class="main">≡</span> <span class="free">e2</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> Theory"</span></span>
    <span class="keyword1"><span class="command">from</span></span> wd <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B'</span></span> <span class="keyword2"><span class="keyword">where</span></span> B'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Sig</span> <span class="keyword1">aS</span> <span class="main">:</span> <span class="skolem">B'</span> <span class="main">→</span> <span class="skolem">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="skolem">d</span> <span class="main">:</span> <span class="skolem">B'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e1</span> <span class="keyword1">in</span> <span class="skolem">d</span><span class="main">)</span> <span class="main">≡</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e2</span> <span class="keyword1">in</span> <span class="skolem">d</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">B'</span><span class="main">)</span> <span class="main">∈</span> Theory"</span></span> <span class="keyword1"><span class="command">using</span></span> ih eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e1</span> <span class="keyword1">in</span> <span class="skolem">d</span><span class="main">)</span> <span class="main">≡</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e2</span> <span class="keyword1">in</span> <span class="skolem">d</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">C</span><span class="main">)</span> <span class="main">∈</span> Theory"</span></span> <span class="keyword1"><span class="command">using</span></span> B' <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Congr<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e1</span> <span class="keyword1">in</span> <span class="main">(</span><span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">d</span><span class="main">)</span><span class="main">)</span> <span class="main">≡</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e2</span> <span class="keyword1">in</span> <span class="main">(</span><span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">d</span><span class="main">)</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">C</span><span class="main">)</span> <span class="main">∈</span> Theory"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Subst_def<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(*This is the diamond problem in multiple inheritance -- both Interpretation and Axioms share a Signature*)</span>
<span class="keyword1"><span class="command">locale</span></span> Model <span class="main">=</span> Interpretation <span class="quoted"><span class="free">I</span></span> <span class="main">+</span> Axioms <span class="quoted"><span class="free">Ax</span></span>
  <span class="keyword2"><span class="keyword">for</span></span> <span class="free">I</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">,</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">)</span> Interpretation"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Ax</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Axioms"</span></span> <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AxSound<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> <span class="main">(</span>aAxioms <span class="free">Ax</span><span class="main">)</span> <span class="main">⟹</span> <span class="keyword1">L⟦</span><span class="free">φ</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IBool True<span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Seq<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>aSignature <span class="free">Ax</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">iS</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Interpretation<span class="main">)</span> Equiv<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e1</span> <span class="main">≡</span> <span class="free">e2</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IBool True<span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">g</span> <span class="main">.</span> <span class="main">(</span><span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e1</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="bound">g</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e2</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="bound">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms Sig2Mor<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">e1</span></span> <span class="quoted"><span class="free">B</span></span><span class="main">]</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g1</span></span> <span class="keyword2"><span class="keyword">where</span></span> g1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e1</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> assms Sig2Mor<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">e2</span></span> <span class="quoted"><span class="free">B</span></span><span class="main">]</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g2</span></span> <span class="keyword2"><span class="keyword">where</span></span> g2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e2</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e1</span><span class="main">≡</span><span class="free">e2</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IBool <span class="main">(</span><span class="skolem">g1</span> <span class="main">=</span> <span class="skolem">g2</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> g1 g2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g1</span> <span class="main">=</span> <span class="skolem">g2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms Functional<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e1</span><span class="main">≡</span><span class="free">e2</span> <span class="main">:</span> <span class="free">B</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>IBool True<span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"IBool <span class="main">(</span><span class="skolem">g1</span><span class="main">=</span><span class="skolem">g2</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> g1 g2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Interpretation<span class="main">)</span> SubstComp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">h</span> <span class="bound">C</span> <span class="main">.</span> <span class="main">⟦</span><span class="main">(</span><span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">;</span> <span class="main">(</span><span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="free">d</span> <span class="main">:</span> <span class="bound">C</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="bound">h</span><span class="main">)</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span>
  <span class="main">(</span><span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e</span> <span class="keyword1">in</span> <span class="free">d</span><span class="main">)</span> <span class="main">:</span> <span class="bound">C</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">(</span><span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="bound">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">d</span></span><span class="main"><span class="keyword3">,</span></span><span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h</span> <span class="skolem">C</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> IMor <span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">C</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">h</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="skolem">C</span><span class="main">⟧</span> <span class="main">→</span> IMor <span class="main">(</span><span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> beqc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">=</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b SigId<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="keyword1">iS</span></span> <span class="quoted"><span class="free">B</span></span> <span class="quoted"><span class="skolem">C</span></span><span class="main">]</span> InterpExprWellDefined <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">(</span>Id <span class="keyword1">iC</span> <span class="keyword1">Ty⟦</span><span class="free">B</span><span class="main">⟧</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> beqc b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> h<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">=</span> Id <span class="keyword1">iC</span> <span class="keyword1">Ty⟦</span><span class="free">B</span><span class="main">⟧</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b beqc <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Functional<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span> </sub><span class="hidden">⇙</span><span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span> <span class="keyword1">to</span> <span class="keyword1">Ty⟦</span><span class="free">B</span><span class="main">⟧</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a MorphismsPreserved <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> Mor <span class="keyword1">iC</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="main">=</span> <span class="keyword1">Ty⟦</span><span class="free">B</span><span class="main">⟧</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> h ICat Category.Cidr<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="keyword1">iC</span></span> <span class="quoted"><span class="free">g</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> beqc a <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">d</span> <span class="skolem">C'</span> <span class="skolem">h</span> <span class="skolem">C</span> <span class="keyword3"><span class="command">assume</span></span> 
      i<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">h</span> <span class="bound">C'</span> <span class="main">.</span> <span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="skolem">d</span> <span class="main">:</span> <span class="bound">C'</span><span class="main">⟧</span> <span class="main">→</span> IMor <span class="bound">h</span> <span class="main">⟹</span> <span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e</span> <span class="keyword1">in</span> <span class="skolem">d</span><span class="main">)</span> <span class="main">:</span> <span class="bound">C'</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">(</span><span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="bound">h</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">⟧</span> <span class="main">→</span> IMor <span class="free">g</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">:</span> <span class="skolem">C'</span> <span class="main">→</span> <span class="skolem">C</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="skolem">d</span> <span class="main">:</span> <span class="skolem">C'</span><span class="main">⟧</span> <span class="main">→</span> IMor <span class="skolem">h</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e</span> <span class="keyword1">in</span> <span class="skolem">d</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">C</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">(</span><span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="skolem">h</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Fn⟦</span><span class="skolem">f</span><span class="main">⟧</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e</span> <span class="keyword1">in</span> <span class="skolem">d</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">C'</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">(</span><span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> i a <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">hence</span></span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e</span> <span class="keyword1">in</span> <span class="skolem">d</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">C'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> InterpExprWellDefined <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">e</span> <span class="keyword1">in</span> <span class="skolem">d</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">C</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">(</span><span class="main">(</span><span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Fn⟦</span><span class="skolem">f</span><span class="main">⟧</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span> <span class="keyword1">to</span> <span class="keyword1">Ty⟦</span><span class="free">B</span><span class="main">⟧</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Ty⟦</span><span class="free">B</span><span class="main">⟧</span> <span class="keyword1">to</span> <span class="keyword1">Ty⟦</span><span class="skolem">C'</span><span class="main">⟧</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Fn⟦</span><span class="skolem">f</span><span class="main">⟧</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Ty⟦</span><span class="skolem">C'</span><span class="main">⟧</span> <span class="keyword1">to</span> <span class="keyword1">Ty⟦</span><span class="skolem">C</span><span class="main">⟧</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> a If Expr2Mor <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Fn⟦</span><span class="skolem">f</span><span class="main">⟧</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> MapsToCompDef<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="keyword1">iC</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Fn⟦</span><span class="skolem">f</span><span class="main">⟧</span> <span class="main">=</span> <span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="skolem">h</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Fn⟦</span><span class="skolem">f</span><span class="main">⟧</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ICat Category.Cassoc<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="keyword1">iC</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Model<span class="main">)</span> Sound<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> Theory <span class="main">⟹</span>  <span class="keyword1">L⟦</span><span class="free">φ</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IBool True<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> Theory.induct<span class="main"><span class="keyword3">,</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AxSound<span class="main">)</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="skolem">e</span> <span class="skolem">B</span> <span class="keyword3"><span class="command">assume</span></span> sig<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e</span><span class="main">≡</span><span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IBool True<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> sig Sig2Mor<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">A</span></span> <span class="quoted"><span class="skolem">e</span></span> <span class="quoted"><span class="skolem">B</span></span><span class="main">]</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> g<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> InterpEq<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">I</span></span> <span class="quoted"><span class="skolem">A</span></span> <span class="quoted"><span class="skolem">e</span></span> <span class="quoted"><span class="skolem">B</span></span> <span class="quoted"><span class="skolem">g</span></span> <span class="quoted"><span class="skolem">e</span></span> <span class="quoted"><span class="skolem">g</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="skolem">e1</span> <span class="skolem">e2</span> <span class="skolem">B</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e1</span><span class="main">≡</span><span class="skolem">e2</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IBool True<span class="main">)</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e2</span><span class="main">≡</span><span class="skolem">e1</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IBool True<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> a <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> g1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e1</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> g2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e2</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> Equiv <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="skolem">e1</span> <span class="skolem">e2</span> <span class="skolem">B</span> <span class="skolem">e3</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e1</span><span class="main">≡</span><span class="skolem">e2</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IBool True<span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e2</span><span class="main">≡</span><span class="skolem">e3</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IBool True<span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e1</span><span class="main">≡</span><span class="skolem">e3</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IBool True<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> a <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> g1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e1</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> g2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e2</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> Equiv <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> b <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g'</span></span> <span class="keyword2"><span class="keyword">where</span></span> g1'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e2</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g'</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> g2'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e3</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g'</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> Equiv <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> <span class="skolem">g'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> g2 g1' <span class="keyword1"><span class="command">using</span></span> Functional <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eq g1 g2' <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="skolem">e1</span> <span class="skolem">e2</span> <span class="skolem">B</span> <span class="skolem">f</span> <span class="skolem">C</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e1</span><span class="main">≡</span><span class="skolem">e2</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IBool True<span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">:</span> <span class="skolem">B</span> <span class="main">→</span> <span class="skolem">C</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e1</span><span class="main">)</span> <span class="main">≡</span> <span class="main">(</span><span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e2</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">C</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IBool True<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> a <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> g1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e1</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> g2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e2</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> Equiv <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>      
      <span class="keyword1"><span class="command">have</span></span> s1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span>  <span class="main">⊢</span> <span class="skolem">e1</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> s2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span>  <span class="main">⊢</span> <span class="skolem">e2</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> g1 g2 InterpExprWellDefined <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span>  <span class="main">⊢</span> <span class="main">(</span><span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e1</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">C</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">(</span><span class="skolem">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Fn⟦</span><span class="skolem">f</span><span class="main">⟧</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span>  <span class="main">⊢</span> <span class="main">(</span><span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e2</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">C</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">(</span><span class="skolem">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Fn⟦</span><span class="skolem">f</span><span class="main">⟧</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b g1 s1 g2 s2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> InterpEqEq<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">A</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e1</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="skolem">C</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="keyword1">Fn⟦</span><span class="skolem">f</span><span class="main">⟧</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="skolem">e1</span> <span class="skolem">B</span> <span class="skolem">e2</span> <span class="skolem">e3</span> <span class="skolem">C</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">iS</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e1</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B</span> <span class="main">⊢</span> <span class="skolem">e2</span><span class="main">≡</span><span class="skolem">e3</span> <span class="main">:</span> <span class="skolem">C</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IBool True<span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="skolem">e1</span> <span class="keyword1">in</span> <span class="skolem">e2</span><span class="main">)</span> <span class="main">≡</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="skolem">e1</span> <span class="keyword1">in</span> <span class="skolem">e3</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">C</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IBool True<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> b <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> g1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B</span> <span class="main">⊢</span> <span class="skolem">e2</span> <span class="main">:</span> <span class="skolem">C</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> g2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B</span> <span class="main">⊢</span> <span class="skolem">e3</span> <span class="main">:</span> <span class="skolem">C</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> Equiv <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> a Sig2Mor<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">A</span></span> <span class="quoted"><span class="skolem">e1</span></span> <span class="quoted"><span class="skolem">B</span></span><span class="main">]</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e1</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="skolem">e1</span> <span class="keyword1">in</span> <span class="skolem">e2</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">C</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> SubstComp g1 f <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="skolem">e1</span> <span class="keyword1">in</span> <span class="skolem">e3</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">C</span><span class="main">⟧</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">iC</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> SubstComp g2 f <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> InterpEqEq <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">record</span></span> <span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> TermEquivClT <span class="main">=</span> 
  TDomain <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'t</span></span></span>
  TExprSet <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'t</span><span class="main">,</span><span class="tfree">'f</span><span class="main">)</span> Expression set"</span></span>
  TCodomain <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'t</span></span></span>

<span class="keyword1"><span class="command">locale</span></span> ZFAxioms <span class="main">=</span> Ax <span class="main">:</span> Axioms <span class="quoted"><span class="free">Ax</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">Ax</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ZF<span class="main">,</span>ZF<span class="main">)</span> Axioms"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span>     fnzf<span class="main">:</span> <span class="quoted"><span class="quoted">"BaseFunctions <span class="main">(</span>aSignature <span class="free">Ax</span><span class="main">)</span> <span class="main">∈</span> range explode"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span> <span class="main">⟹</span> Axioms <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFAxioms_def<span class="main">)</span>

<span class="comment1">(*(tree depth, rule number, components)*)</span>
<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">Expr2ZF</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ZF<span class="main">,</span>ZF<span class="main">)</span> Expression <span class="main">⇒</span> ZF"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    Expr2ZFVx<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Expr2ZF</span> <span class="keyword1">Vx</span> <span class="main">=</span> ZFTriple <span class="main">(</span>nat2Nat <span class="main">0</span><span class="main">)</span> <span class="main">(</span>nat2Nat <span class="main">0</span><span class="main">)</span> Empty"</span></span> 
  <span class="main">|</span> Expr2ZFfe<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Expr2ZF</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="keyword1">E@</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span> <span class="main">=</span> ZFTriple <span class="main">(</span>SucNat <span class="main">(</span>ZFTFst <span class="main">(</span><span class="free">Expr2ZF</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
                                 <span class="main">(</span>nat2Nat <span class="main">1</span><span class="main">)</span>
                                 <span class="main">(</span>Opair <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span><span class="free">Expr2ZF</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ZF2Expr</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"ZF <span class="main">⇒</span> <span class="main">(</span>ZF<span class="main">,</span>ZF<span class="main">)</span> Expression"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ZF2Expr</span> <span class="main">=</span> inv Expr2ZF"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">ZFDepth</span> <span class="main">=</span> Nat2nat <span class="keyword1">o</span> ZFTFst"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">ZFType</span> <span class="main">=</span> Nat2nat <span class="keyword1">o</span> ZFTSnd"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">ZFData</span> <span class="main">=</span> ZFTThd"</span></span>

<span class="keyword1" id="MonadicEquationalTheory-Expr2ZFType0"><span class="command">lemma</span></span> Expr2ZFType0<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFType <span class="main">(</span>Expr2ZF <span class="free">e</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">e</span> <span class="main">=</span> <span class="keyword1">Vx</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">e</span></span><span class="main"><span class="keyword3">,</span></span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFType_def ZFTSnd Elem_Empty_Nat Elem_SucNat_Nat ZFSucNeq0<span class="main">)</span>

<span class="keyword1" id="MonadicEquationalTheory-ZFDepthInNat"><span class="command">lemma</span></span> ZFDepthInNat<span class="main">:</span> <span class="quoted"><span class="quoted">"Elem <span class="main">(</span>ZFTFst <span class="main">(</span>Expr2ZF <span class="free">e</span><span class="main">)</span><span class="main">)</span> Nat"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">e</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  ZFTFst HOLZF.Elem_Empty_Nat Elem_SucNat_Nat<span class="main">)</span>

<span class="keyword1" id="MonadicEquationalTheory-Expr2ZFType1"><span class="command">lemma</span></span> Expr2ZFType1<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFType <span class="main">(</span>Expr2ZF <span class="free">e</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⟹</span> 
  <span class="main">∃</span> <span class="bound">f</span> <span class="bound">e'</span> <span class="main">.</span> <span class="free">e</span> <span class="main">=</span> <span class="main">(</span><span class="bound">f</span> <span class="keyword1">E@</span> <span class="bound">e'</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>Suc <span class="main">(</span>ZFDepth <span class="main">(</span>Expr2ZF <span class="bound">e'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>ZFDepth <span class="main">(</span>Expr2ZF <span class="free">e</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">e</span></span><span class="main"><span class="keyword3">,</span></span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFType_def ZFTSnd ZFDepth_def ZFTFst ZFZero ZFDepthInNat Nat2nat_SucNat<span class="main">)</span>

<span class="keyword1" id="MonadicEquationalTheory-Expr2ZFDepth0"><span class="command">lemma</span></span> Expr2ZFDepth0<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFDepth <span class="main">(</span>Expr2ZF <span class="free">e</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span> ZFType <span class="main">(</span>Expr2ZF <span class="free">e</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">e</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFDepth_def ZFTFst ZFType_def ZFTSnd ZFSucNeq0 ZFDepthInNat<span class="main">)</span>

<span class="keyword1" id="MonadicEquationalTheory-Expr2ZFDepthSuc"><span class="command">lemma</span></span> Expr2ZFDepthSuc<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFDepth <span class="main">(</span>Expr2ZF <span class="free">e</span><span class="main">)</span> <span class="main">=</span> Suc <span class="free">n</span> <span class="main">⟹</span> ZFType <span class="main">(</span>Expr2ZF <span class="free">e</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">e</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFDepth_def ZFTFst ZFType_def ZFTSnd ZFSucZero ZFSucNeq0 ZFZero<span class="main">)</span>

<span class="keyword1" id="MonadicEquationalTheory-Expr2Data"><span class="command">lemma</span></span> Expr2Data<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFData <span class="main">(</span>Expr2ZF <span class="main">(</span><span class="free">f</span> <span class="keyword1">E@</span> <span class="free">e</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Opair <span class="free">f</span> <span class="main">(</span>Expr2ZF <span class="free">e</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFData_def ZFTThd<span class="main">)</span>

<span class="keyword1" id="MonadicEquationalTheory-Expr2ZFinj"><span class="command">lemma</span></span> Expr2ZFinj<span class="main">:</span> <span class="quoted"><span class="quoted">"inj Expr2ZF"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inj_on_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">n</span> <span class="bound">e</span> <span class="bound">d</span> <span class="main">.</span> <span class="main">⟦</span><span class="bound">n</span> <span class="main">=</span> ZFDepth <span class="main">(</span>Expr2ZF <span class="bound">e</span><span class="main">)</span> <span class="main">;</span> Expr2ZF <span class="bound">e</span> <span class="main">=</span> Expr2ZF <span class="bound">d</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="bound">e</span> <span class="main">=</span> <span class="bound">d</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">e</span> <span class="bound">d</span> <span class="main">.</span> <span class="main">⟦</span><span class="skolem">n</span> <span class="main">=</span> ZFDepth <span class="main">(</span>Expr2ZF <span class="bound">e</span><span class="main">)</span> <span class="main">;</span> Expr2ZF <span class="bound">e</span> <span class="main">=</span> Expr2ZF <span class="bound">d</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="bound">e</span> <span class="main">=</span> <span class="bound">d</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">e</span> <span class="skolem">d</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">=</span> ZFDepth <span class="main">(</span>Expr2ZF <span class="skolem">e</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"Expr2ZF <span class="skolem">e</span> <span class="main">=</span> Expr2ZF <span class="skolem">d</span>"</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">=</span> ZFDepth <span class="main">(</span>Expr2ZF <span class="skolem">d</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a b <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">e</span> <span class="main">=</span> <span class="keyword1">Vx</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">d</span> <span class="main">=</span> <span class="keyword1">Vx</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Expr2ZFDepth0 Expr2ZFType0<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">e</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">e</span> <span class="skolem">d</span> <span class="keyword3"><span class="command">assume</span></span> ih<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">e'</span> <span class="bound">d'</span> <span class="main">.</span> <span class="main">⟦</span><span class="skolem">n</span> <span class="main">=</span> ZFDepth <span class="main">(</span>Expr2ZF <span class="bound">e'</span><span class="main">)</span> <span class="main">;</span> Expr2ZF <span class="bound">e'</span> <span class="main">=</span> Expr2ZF <span class="bound">d'</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="bound">e'</span> <span class="main">=</span> <span class="bound">d'</span>"</span></span>
          <span class="keyword2"><span class="keyword">and</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">n</span> <span class="main">=</span> ZFDepth <span class="main">(</span>Expr2ZF <span class="skolem">e</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"Expr2ZF <span class="skolem">e</span> <span class="main">=</span> Expr2ZF <span class="skolem">d</span>"</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ZFType <span class="main">(</span>Expr2ZF <span class="skolem">e</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ZFType <span class="main">(</span>Expr2ZF <span class="skolem">d</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a b Expr2ZFDepthSuc<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">e</span></span> <span class="quoted"><span class="skolem">n</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span>
        <span class="keyword1"><span class="command">from</span></span> this Expr2ZFType1<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">e</span></span><span class="main">]</span> Expr2ZFType1<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">d</span></span><span class="main">]</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">fe</span></span> <span class="skolem"><span class="skolem">fd</span></span> <span class="skolem"><span class="skolem">e'</span></span> <span class="skolem"><span class="skolem">d'</span></span> 
          <span class="keyword2"><span class="keyword">where</span></span> e<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">e</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">fe</span> <span class="keyword1">E@</span> <span class="skolem">e'</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>Suc <span class="main">(</span>ZFDepth <span class="main">(</span>Expr2ZF <span class="skolem">e'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>ZFDepth <span class="main">(</span>Expr2ZF <span class="skolem">e</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
          d<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">d</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">fd</span> <span class="keyword1">E@</span> <span class="skolem">d'</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>Suc <span class="main">(</span>ZFDepth <span class="main">(</span>Expr2ZF <span class="skolem">d'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>ZFDepth <span class="main">(</span>Expr2ZF <span class="skolem">d</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"Suc <span class="main">(</span>ZFDepth <span class="main">(</span>Expr2ZF <span class="skolem">e'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Suc <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">hence</span></span> ne<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ZFDepth <span class="main">(</span>Expr2ZF <span class="skolem">e'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Suc_inject<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> edat<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFData <span class="main">(</span>Expr2ZF <span class="skolem">e</span><span class="main">)</span> <span class="main">=</span> Opair <span class="skolem">fe</span> <span class="main">(</span>Expr2ZF <span class="skolem">e'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> e Expr2Data <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">have</span></span> ddat<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFData <span class="main">(</span>Expr2ZF <span class="skolem">d</span><span class="main">)</span> <span class="main">=</span> Opair <span class="skolem">fd</span> <span class="main">(</span>Expr2ZF <span class="skolem">d'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d Expr2Data <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">have</span></span> fd_eq_fe<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">fe</span> <span class="main">=</span> <span class="skolem">fd</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Expr2ZF <span class="skolem">e'</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Expr2ZF <span class="skolem">d'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> edat ddat Opair b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">e'</span> <span class="main">=</span> <span class="skolem">d'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ne ih <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">e</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> e d fd_eq_fe <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">e</span> <span class="skolem">d</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Expr2ZF <span class="skolem">e</span> <span class="main">=</span> Expr2ZF <span class="skolem">d</span> <span class="main">⟹</span> <span class="skolem">e</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">TermEquivClGen</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">≡</span> <span class="main">{</span><span class="bound">e'</span> <span class="main">.</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">⊢</span> <span class="bound">e'</span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">∈</span> Axioms.Theory <span class="free"><span class="bound"><span class="entity">T</span></span></span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">TermEquivCl'</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">≡</span> <span class="main">⦇</span> TDomain <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">,</span> TExprSet <span class="main">=</span> TermEquivClGen <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">,</span> TCodomain <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">m2ZF</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ZF<span class="main">,</span>ZF<span class="main">)</span> TermEquivClT <span class="main">⇒</span> ZF"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">m2ZF</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">≡</span> ZFTriple <span class="main">(</span>TDomain <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">)</span> <span class="main">(</span>implode <span class="main">(</span>Expr2ZF <span class="main">`</span> <span class="main">(</span>TExprSet <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>TCodomain <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ZF2m</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ZF<span class="main">,</span>ZF<span class="main">)</span> Axioms <span class="main">⇒</span> ZF <span class="main">⇒</span> <span class="main">(</span>ZF<span class="main">,</span>ZF<span class="main">)</span> TermEquivClT"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ZF2m</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">≡</span> inv_into <span class="main">{</span>TermEquivCl' <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="bound">A</span> <span class="bound">e</span> <span class="bound">B</span> <span class="main">|</span> <span class="bound">A</span> <span class="bound">e</span> <span class="bound">B</span> <span class="main">.</span> True<span class="main">}</span> m2ZF"</span></span>

<span class="keyword1" id="MonadicEquationalTheory-TDomain"><span class="command">lemma</span></span> TDomain<span class="main">:</span> <span class="quoted"><span class="quoted">"TDomain <span class="main">(</span>TermEquivCl' <span class="free">T</span> <span class="free">A</span> <span class="free">e</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> TermEquivCl'_def<span class="main">)</span>
<span class="keyword1" id="MonadicEquationalTheory-TCodomain"><span class="command">lemma</span></span> TCodomain<span class="main">:</span> <span class="quoted"><span class="quoted">"TCodomain <span class="main">(</span>TermEquivCl' <span class="free">T</span> <span class="free">A</span> <span class="free">e</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> TermEquivCl'_def<span class="main">)</span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">WellFormedToSet</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ZF<span class="main">,</span>ZF<span class="main">)</span> Signature <span class="main">⇒</span> nat <span class="main">⇒</span> <span class="main">(</span>ZF<span class="main">,</span>ZF<span class="main">)</span> Expression set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  WFS0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">WellFormedToSet</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">0</span> <span class="main">=</span> <span class="main">{</span><span class="keyword1">Vx</span><span class="main">}</span>"</span></span>
<span class="main">|</span> WFSS<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">WellFormedToSet</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">(</span>Suc <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">WellFormedToSet</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="main">∪</span>
                <span class="main">{</span> <span class="bound">f</span> <span class="keyword1">E@</span> <span class="bound">e</span> <span class="main">|</span> <span class="bound">f</span> <span class="bound">e</span> <span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> BaseFunctions <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∧</span> <span class="bound">e</span> <span class="main">∈</span> <span class="main">(</span><span class="free">WellFormedToSet</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span><span class="main">}</span>"</span></span>

<span class="keyword1" id="MonadicEquationalTheory-WellFormedToSetInRangeExplode"><span class="command">lemma</span></span> WellFormedToSetInRangeExplode<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span> <span class="main">⟹</span> <span class="main">(</span>Expr2ZF <span class="main">`</span> <span class="main">(</span>WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> range explode"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span><span class="main"><span class="keyword3">,</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> WellFormedToSet_def SingletonInRangeExplode<span class="main">)</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span> zfx<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ih<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span> <span class="main">⟹</span> Expr2ZF <span class="main">`</span> WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">n</span> <span class="main">∈</span> range explode"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"Expr2ZF <span class="main">`</span> WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">n</span> <span class="main">∈</span> range explode"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Expr2ZF <span class="main">`</span> <span class="main">{</span> <span class="bound">f</span> <span class="keyword1">E@</span> <span class="bound">e</span> <span class="main">|</span> <span class="bound">f</span> <span class="bound">e</span> <span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> BaseFunctions <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="bound">e</span> <span class="main">∈</span> <span class="main">(</span>WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">n</span><span class="main">)</span><span class="main">}</span>
    <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="main">(</span><span class="bound">f</span><span class="main">,</span> <span class="bound">ze</span><span class="main">)</span> <span class="main">.</span> Expr2ZF <span class="main">(</span><span class="bound">f</span> <span class="keyword1">E@</span> <span class="main">(</span>ZF2Expr <span class="bound">ze</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span><span class="main">(</span>BaseFunctions <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">×</span> Expr2ZF <span class="main">`</span> <span class="main">(</span>WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> image_Collect image_def ZF2Expr_def Expr2ZFinj<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">e</span>
    <span class="keyword3"><span class="command">assume</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> BaseFunctions <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> e<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">e</span> <span class="main">∈</span> WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">n</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">x</span> <span class="main">∈</span> BaseFunctions <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">.</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">x</span> <span class="main">∈</span> WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">n</span><span class="main">.</span> <span class="bound">y</span> <span class="main">=</span> Expr2ZF <span class="bound">x</span><span class="main">)</span> <span class="main">∧</span>
      ZFTriple <span class="main">(</span>SucNat <span class="main">(</span>ZFTFst <span class="main">(</span>Expr2ZF <span class="skolem">e</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>SucNat Empty<span class="main">)</span> <span class="main">(</span>Opair <span class="skolem">f</span> <span class="main">(</span>Expr2ZF <span class="skolem">e</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
      ZFTriple <span class="main">(</span>SucNat <span class="main">(</span>ZFTFst <span class="main">(</span>Expr2ZF <span class="main">(</span>inv Expr2ZF <span class="bound">y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>SucNat Empty<span class="main">)</span> <span class="main">(</span>Opair <span class="bound">x</span> <span class="main">(</span>Expr2ZF <span class="main">(</span>inv Expr2ZF <span class="bound">y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> bexI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?x</span> <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">f</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?x</span> <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="quoted"><span class="quoted"><span class="quoted">"Expr2ZF <span class="skolem"><span class="skolem">e</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Expr2ZFinj f e<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">f</span> <span class="bound">e</span><span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">f</span> <span class="keyword1">E@</span> <span class="bound">e</span> <span class="main">∧</span> <span class="bound">f</span> <span class="main">∈</span> <span class="main">(</span>BaseFunctions <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">e</span> <span class="main">∈</span> WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">∧</span>
              ZFTriple <span class="main">(</span>SucNat <span class="main">(</span>ZFTFst <span class="main">(</span>Expr2ZF <span class="skolem">e</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>SucNat Empty<span class="main">)</span> <span class="main">(</span>Opair <span class="skolem">f</span> <span class="main">(</span>Expr2ZF <span class="skolem">e</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Expr2ZF <span class="bound">x</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?x</span> <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="skolem"><span class="skolem">f</span></span> <span class="keyword1"><span class="keyword1">E@</span></span> <span class="skolem"><span class="skolem">e</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> f e<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>BaseFunctions <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">∈</span> range explode"</span></span> <span class="keyword1"><span class="command">using</span></span> zfx ZFAxioms.fnzf <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Expr2ZF <span class="main">`</span> <span class="main">{</span> <span class="bound">f</span> <span class="keyword1">E@</span> <span class="bound">e</span> <span class="main">|</span> <span class="bound">f</span> <span class="bound">e</span> <span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> BaseFunctions <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="bound">e</span> <span class="main">∈</span> <span class="main">(</span>WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">n</span><span class="main">)</span><span class="main">}</span> <span class="main">∈</span> range explode"</span></span>
    <span class="keyword1"><span class="command">using</span></span> a ZFProdFnInRangeExplode <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Expr2ZF <span class="main">`</span> WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Expr2ZF <span class="main">`</span> <span class="main">(</span>WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">∪</span>
                <span class="main">(</span>Expr2ZF  <span class="main">`</span> <span class="main">{</span> <span class="bound">f</span> <span class="keyword1">E@</span> <span class="bound">e</span> <span class="main">|</span> <span class="bound">f</span> <span class="bound">e</span> <span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> BaseFunctions <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="bound">e</span> <span class="main">∈</span> <span class="main">(</span>WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">n</span><span class="main">)</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Expr2ZF <span class="main">`</span> WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">∈</span> range explode"</span></span> <span class="keyword1"><span class="command">using</span></span> ZFUnionInRangeExplode a <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="MonadicEquationalTheory-WellDefinedToWellFormedSet"><span class="command">lemma</span></span> WellDefinedToWellFormedSet<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">B</span> <span class="main">.</span> <span class="main">(</span><span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="bound">B</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="free">e</span> <span class="main">∈</span> WellFormedToSet <span class="free">S</span> <span class="bound">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">e</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">Vx</span> <span class="main">∈</span> WellFormedToSet <span class="free">S</span> <span class="bound">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="main"><span class="quoted"><span class="main"><span class="quoted"><span class="main">0</span></span></span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">e</span> <span class="skolem">B</span> <span class="keyword3"><span class="command">assume</span></span> ih<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">B'</span><span class="main">.</span> <span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="bound">B'</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="skolem">e</span> <span class="main">∈</span> WellFormedToSet <span class="free">S</span> <span class="bound">n</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e</span><span class="main">)</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B'</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Sig</span> <span class="free">S</span> <span class="main">:</span> <span class="skolem">B'</span> <span class="main">→</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">e</span> <span class="main">∈</span> WellFormedToSet <span class="free">S</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ih <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> ff<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> BaseFunctions <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e</span><span class="main">)</span> <span class="main">∈</span> WellFormedToSet <span class="free">S</span> <span class="bound">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"Suc <span class="skolem"><span class="skolem"><span class="skolem">n</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> a ff<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="MonadicEquationalTheory-TermSetInSet"><span class="command">lemma</span></span> TermSetInSet<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span> <span class="main">⟹</span> Expr2ZF <span class="main">`</span> <span class="main">(</span>TermEquivClGen <span class="free">T</span> <span class="free">A</span> <span class="free">e</span> <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> range explode"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> zfax<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>TermEquivClGen <span class="free">T</span> <span class="free">A</span> <span class="free">e</span> <span class="free">B</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">{</span><span class="bound">e'</span> <span class="main">.</span> <span class="main">(</span><span class="keyword1">Sig</span> <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="bound">e'</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> TermEquivClGen_def<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">x</span><span class="main">≡</span><span class="free">e</span> <span class="main">:</span> <span class="free">B</span> <span class="main">∈</span> Axioms.Theory <span class="free">T</span>"</span></span> 
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">x</span><span class="main">≡</span><span class="free">e</span> <span class="main">:</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Axioms.Equiv2WellDefined zfax<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">x</span> <span class="main">:</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">⊆</span> <span class="main">(</span><span class="main">⋃</span> <span class="bound">n</span> <span class="main">.</span> <span class="main">(</span>WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> WellDefinedToWellFormedSet<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Expr2ZF <span class="main">`</span> <span class="main">(</span>TermEquivClGen <span class="free">T</span> <span class="free">A</span> <span class="free">e</span> <span class="free">B</span><span class="main">)</span> <span class="main">⊆</span> Expr2ZF <span class="main">`</span> <span class="main">(</span><span class="main">⋃</span> <span class="bound">n</span> <span class="main">.</span> <span class="main">(</span>WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">⋃</span> <span class="bound">n</span> <span class="main">.</span> <span class="main">(</span>Expr2ZF <span class="main">`</span> <span class="main">(</span>WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Expr2ZF <span class="main">`</span> <span class="main">(</span>TermEquivClGen <span class="free">T</span> <span class="free">A</span> <span class="free">e</span> <span class="free">B</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span><span class="main">⋃</span> <span class="bound">n</span> <span class="main">.</span> <span class="main">(</span>Expr2ZF <span class="main">`</span> <span class="main">(</span>WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋃</span> <span class="bound">n</span> <span class="main">.</span> <span class="main">(</span>Expr2ZF <span class="main">`</span> <span class="main">(</span>WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> range explode"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> zfax ZFUnionNatInRangeExplode WellFormedToSetInRangeExplode <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  ZFSubsetRangeExplode<span class="main">[</span><span class="operator">of</span> 
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋃</span> <span class="bound">n</span> <span class="main">.</span> <span class="main">(</span>Expr2ZF <span class="main">`</span> <span class="main">(</span>WellFormedToSet <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"Expr2ZF <span class="main">`</span> <span class="main">(</span>TermEquivClGen <span class="free">T</span> <span class="free">A</span> <span class="free">e</span> <span class="free">B</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="MonadicEquationalTheory-m2ZFinj_on"><span class="command">lemma</span></span> m2ZFinj_on<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span> <span class="main">⟹</span> inj_on m2ZF <span class="main">{</span>TermEquivCl' <span class="free">T</span> <span class="bound">A</span> <span class="bound">e</span> <span class="bound">B</span> <span class="main">|</span> <span class="bound">A</span> <span class="bound">e</span> <span class="bound">B</span> <span class="main">.</span> True<span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> inj_on_def m2ZF_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">drule</span> ZFTriple<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> TDomain TCodomain implode_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> TermEquivCl'_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">drule</span> inv_into_injective<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> TermSetInSet inj_image_eq_iff Expr2ZFinj<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="MonadicEquationalTheory-ZF2m"><span class="command">lemma</span></span> ZF2m<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span> <span class="main">⟹</span> ZF2m <span class="free">T</span> <span class="main">(</span>m2ZF <span class="main">(</span>TermEquivCl' <span class="free">T</span> <span class="free">A</span> <span class="free">e</span> <span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>TermEquivCl' <span class="free">T</span> <span class="free">A</span> <span class="free">e</span> <span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> zfax<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span>TermEquivCl' <span class="free">T</span> <span class="bound">A</span> <span class="bound">e</span> <span class="bound">B</span> <span class="main">|</span> <span class="bound">A</span> <span class="bound">e</span> <span class="bound">B</span> <span class="main">.</span> True<span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"TermEquivCl' <span class="free">T</span> <span class="free">A</span> <span class="free">e</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">∈</span> <span class="var">?A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> m2ZFinj_on<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main">]</span> inv_into_f_f zfax <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  ZF2m_def <span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">TermEquivCl</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">[</span>_<span class="keyword1">,</span>_<span class="keyword1">,</span>_<span class="keyword1">]</span>ı"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">[</span></span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main"><span class="free">,</span></span><span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main"><span class="free">,</span></span><span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main"><span class="free">]</span></span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">T</span></span></span></sub><span class="hidden">⇙</span> <span class="main">≡</span> m2ZF <span class="main">(</span>TermEquivCl' <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">CLDomain</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">≡</span> TDomain <span class="keyword1">o</span> ZF2m <span class="free"><span class="bound"><span class="entity">T</span></span></span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">CLCodomain</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">≡</span> TCodomain <span class="keyword1">o</span> ZF2m <span class="free"><span class="bound"><span class="entity">T</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">CanonicalComp</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">≡</span> 
  <span class="keyword1">THE</span> <span class="bound">h</span> <span class="main">.</span> <span class="main">∃</span> <span class="bound">e</span> <span class="bound">e'</span> <span class="main">.</span> <span class="bound">h</span> <span class="main">=</span> <span class="main">[</span>CLDomain <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">,</span><span class="keyword1">sub</span> <span class="bound">e</span> <span class="keyword1">in</span> <span class="bound">e'</span><span class="main">,</span>CLCodomain <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">T</span></span></span></sub><span class="hidden">⇙</span> <span class="main">∧</span>  
  <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">=</span> <span class="main">[</span>CLDomain <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">,</span><span class="bound">e</span><span class="main">,</span>CLCodomain <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">T</span></span></span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">=</span> <span class="main">[</span>CLDomain <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">,</span><span class="bound">e'</span><span class="main">,</span>CLCodomain <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">T</span></span></span></sub><span class="hidden">⇙</span>"</span></span>

<span class="keyword1" id="MonadicEquationalTheory-CLDomain"><span class="command">lemma</span></span> CLDomain<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span> <span class="main">⟹</span> CLDomain <span class="free">T</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="free">A</span>"</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> TermEquivCl_def CLDomain_def ZF2m TDomain<span class="main">)</span>
<span class="keyword1" id="MonadicEquationalTheory-CLCodomain"><span class="command">lemma</span></span> CLCodomain<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span> <span class="main">⟹</span> CLCodomain <span class="free">T</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="free">B</span>"</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> TermEquivCl_def CLCodomain_def ZF2m TCodomain<span class="main">)</span>

<span class="keyword1" id="MonadicEquationalTheory-Equiv2Cl"><span class="command">lemma</span></span> Equiv2Cl<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Axioms <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">≡</span> <span class="free">d</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> Axioms.Theory <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">d</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">e'</span><span class="main">.</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="bound">e'</span><span class="main">≡</span><span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> Axioms.Theory <span class="free">T</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">e'</span><span class="main">.</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="bound">e'</span><span class="main">≡</span><span class="free">d</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> Axioms.Theory <span class="free">T</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> Axioms.Trans Axioms.Symm<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> TermEquivCl_def TermEquivCl'_def TermEquivClGen_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="MonadicEquationalTheory-Cl2Equiv"><span class="command">lemma</span></span> Cl2Equiv<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> axt<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> sa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cl<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">d</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">≡</span> <span class="free">d</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> Axioms.Theory <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ZF2m <span class="free">T</span> <span class="main">(</span>m2ZF <span class="main">(</span>TermEquivCl' <span class="free">T</span> <span class="free">A</span> <span class="free">e</span> <span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> ZF2m <span class="free">T</span> <span class="main">(</span>m2ZF <span class="main">(</span>TermEquivCl' <span class="free">T</span> <span class="free">A</span> <span class="free">d</span> <span class="free">B</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cl <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> TermEquivCl_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"TermEquivCl' <span class="free">T</span> <span class="free">A</span> <span class="free">e</span> <span class="free">B</span> <span class="main">=</span> TermEquivCl' <span class="free">T</span> <span class="free">A</span> <span class="free">d</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZF2m<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">≡</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> Axioms.Theory <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> axt sa Axioms.Refl<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">∈</span> TermEquivClGen <span class="free">T</span> <span class="free">A</span> <span class="free">e</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> TermEquivClGen_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">∈</span> TermEquivClGen <span class="free">T</span> <span class="free">A</span> <span class="free">d</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> TermEquivCl'_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> TermEquivClGen_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> 

<span class="keyword1" id="MonadicEquationalTheory-CanonicalCompWellDefined"><span class="command">lemma</span></span> CanonicalCompWellDefined<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> zaxt<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">d</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="free">d'</span> <span class="main">:</span> <span class="free">C</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"CanonicalComp <span class="free">T</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">d</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">[</span><span class="free">B</span><span class="main">,</span><span class="free">d'</span><span class="main">,</span><span class="free">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="keyword1">sub</span> <span class="free">d</span> <span class="keyword1">in</span> <span class="free">d'</span><span class="main">,</span><span class="free">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> zaxt CanonicalComp_def CLDomain CLCodomain<span class="main">)</span><span class="main"><span class="keyword3">,</span></span><span class="main">(</span><span class="operator">rule</span> the_equality<span class="main">)</span><span class="main"><span class="keyword3">,</span></span>
    <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">d</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">d'</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">e</span> <span class="skolem">e'</span> <span class="keyword3"><span class="command">assume</span></span> de<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">d</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="skolem">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> de'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">B</span><span class="main">,</span><span class="free">d'</span><span class="main">,</span><span class="free">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="main">[</span><span class="free">B</span><span class="main">,</span><span class="skolem">e'</span><span class="main">,</span><span class="free">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> axt<span class="main">:</span> <span class="quoted"><span class="quoted">"Axioms <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">d</span> <span class="main">≡</span> <span class="skolem">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> Axioms.Theory <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms de Cl2Equiv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> sa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">d</span> <span class="keyword1">in</span> <span class="free">d'</span><span class="main">)</span> <span class="main">≡</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="skolem">e</span> <span class="keyword1">in</span> <span class="free">d'</span><span class="main">)</span> <span class="main">:</span> <span class="free">C</span><span class="main">)</span> <span class="main">∈</span> Axioms.Theory <span class="free">T</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> assms Axioms.Subst'<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="free">d'</span><span class="main">≡</span> <span class="skolem">e'</span> <span class="main">:</span> <span class="free">C</span><span class="main">)</span> <span class="main">∈</span> Axioms.Theory <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms de' Cl2Equiv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">d</span> <span class="main">≡</span> <span class="skolem">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a axt Axioms.Equiv2WellDefined<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="skolem">e</span> <span class="keyword1">in</span> <span class="free">d'</span><span class="main">)</span> <span class="main">≡</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="skolem">e</span> <span class="keyword1">in</span> <span class="skolem">e'</span><span class="main">)</span> <span class="main">:</span> <span class="free">C</span><span class="main">)</span> <span class="main">∈</span> Axioms.Theory <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b Axioms.Subst<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main">]</span> axt <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="skolem">e</span> <span class="keyword1">in</span> <span class="skolem">e'</span><span class="main">)</span> <span class="main">≡</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="free">d</span> <span class="keyword1">in</span> <span class="free">d'</span><span class="main">)</span> <span class="main">:</span> <span class="free">C</span><span class="main">)</span> <span class="main">∈</span> Axioms.Theory <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> sa axt
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> Axioms.Symm<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main"><span class="main">]</span></span> Axioms.Trans<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="keyword1">sub</span> <span class="skolem">e</span> <span class="keyword1">in</span> <span class="skolem">e'</span><span class="main">,</span><span class="free">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="keyword1">sub</span> <span class="free">d</span> <span class="keyword1">in</span> <span class="free">d'</span><span class="main">,</span><span class="free">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> zaxt Equiv2Cl <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">CanonicalCat'</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">≡</span> <span class="main">⦇</span>
  Obj <span class="main">=</span> BaseTypes <span class="main">(</span><span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">T</span></span></span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">,</span> 
  Mor <span class="main">=</span> <span class="main">{</span><span class="main">[</span><span class="bound">A</span><span class="main">,</span><span class="bound">e</span><span class="main">,</span><span class="bound">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">T</span></span></span></sub><span class="hidden">⇙</span> <span class="main">|</span> <span class="bound">A</span> <span class="bound">e</span> <span class="bound">B</span> <span class="main">.</span> <span class="keyword1">Sig</span> <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">T</span></span></span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="bound">A</span> <span class="main">⊢</span> <span class="bound">e</span> <span class="main">:</span> <span class="bound">B</span><span class="main">)</span><span class="main">}</span><span class="main">,</span> 
  Dom <span class="main">=</span> CLDomain <span class="free"><span class="bound"><span class="entity">T</span></span></span><span class="main">,</span> 
  Cod <span class="main">=</span> CLCodomain <span class="free"><span class="bound"><span class="entity">T</span></span></span><span class="main">,</span> 
  Id  <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">A</span> <span class="main">.</span> <span class="main">[</span><span class="bound">A</span><span class="main">,</span><span class="keyword1">Vx</span><span class="main">,</span><span class="bound">A</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">T</span></span></span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">,</span> 
  Comp <span class="main">=</span> CanonicalComp <span class="free"><span class="bound"><span class="entity">T</span></span></span>
  <span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">CanonicalCat</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">≡</span> MakeCat <span class="main">(</span>CanonicalCat' <span class="free"><span class="bound"><span class="entity">T</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="MonadicEquationalTheory-CanonicalCat'MapsTo"><span class="command">lemma</span></span> CanonicalCat'MapsTo<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zx<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">ef</span> <span class="main">.</span> <span class="free">f</span> <span class="main">=</span> <span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="bound">ef</span><span class="main">,</span><span class="free">Y</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">X</span> <span class="main">⊢</span> <span class="bound">ef</span> <span class="main">:</span> <span class="free">Y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> fm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> fd<span class="main">:</span> <span class="quoted"><span class="quoted">"Dom <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span> <span class="free">f</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> fc<span class="main">:</span> <span class="quoted"><span class="quoted">"Cod <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span> <span class="free">f</span> <span class="main">=</span> <span class="free">Y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> fm <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ef</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> ef<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">A</span><span class="main">,</span><span class="skolem">ef</span><span class="main">,</span><span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> efsig<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">ef</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">=</span> <span class="free">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fd fc ef zx CLDomain<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main">]</span> CLCodomain<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main">]</span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> ef efsig <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="MonadicEquationalTheory-CanonicalCatCat'"><span class="command">lemma</span></span> CanonicalCatCat'<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span> <span class="main">⟹</span> Category_axioms <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> Category_axioms_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> obj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> BaseTypes <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> zx<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> axt<span class="main">:</span> <span class="quoted"><span class="quoted">"Axioms <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> 
    <span class="keyword1"><span class="command">from</span></span> a <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="skolem"><span class="skolem">e</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">A</span><span class="main">,</span><span class="skolem">e</span><span class="main">,</span><span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> fwd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> domf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span> <span class="main">=</span> CLDomain <span class="free">T</span> <span class="skolem">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> codf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span> <span class="main">=</span> CLCodomain <span class="free">T</span> <span class="skolem">f</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command">have</span></span> absig<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="keyword1">Ty</span><span class="hidden">⇘</span><sub>aSignature <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="skolem">B</span> <span class="main">∈</span> <span class="keyword1">Ty</span><span class="hidden">⇘</span><sub>aSignature <span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fwd Signature.SigTy<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span>"</span></span><span class="main">]</span> Axioms.AxSig axt
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> Awd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> Bwd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B</span> <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> absig <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> domf f obj CLDomain<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="skolem">A</span></span> <span class="quoted"><span class="skolem">e</span></span> <span class="quoted"><span class="skolem">B</span></span><span class="main">]</span> absig zx
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> codf f obj CLCodomain<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="skolem">A</span></span> <span class="quoted"><span class="skolem">e</span></span> <span class="quoted"><span class="skolem">B</span></span><span class="main">]</span> absig zx
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> idA<span class="main">:</span> <span class="quoted"><span class="quoted">"Id <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span> <span class="skolem">A</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">A</span><span class="main">,</span><span class="keyword1">Vx</span><span class="main">,</span><span class="skolem">A</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> idB<span class="main">:</span> <span class="quoted"><span class="quoted">"Id <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span> <span class="skolem">B</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">B</span><span class="main">,</span><span class="keyword1">Vx</span><span class="main">,</span><span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Id <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">A</span><span class="main">,</span> <span class="keyword1">sub</span> <span class="keyword1">Vx</span> <span class="keyword1">in</span> <span class="skolem">e</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> f domf CLDomain<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="skolem">A</span></span> <span class="quoted"><span class="skolem">e</span></span> <span class="quoted"><span class="skolem">B</span></span><span class="main">]</span> idA axt CanonicalCompWellDefined<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main">]</span> Awd fwd zx
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Id <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span> <span class="main">=</span> <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f SubstXinE<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">e</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">(</span>Id <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">A</span><span class="main">,</span> <span class="keyword1">sub</span> <span class="skolem">e</span> <span class="keyword1">in</span> <span class="keyword1">Vx</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> f codf CLCodomain<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="skolem">A</span></span> <span class="quoted"><span class="skolem">e</span></span> <span class="quoted"><span class="skolem">B</span></span><span class="main">]</span> idB axt CanonicalCompWellDefined<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main">]</span> Bwd fwd zx
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">(</span>Id <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f Subst_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">X</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> BaseTypes <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">X</span> <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Id <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span> <span class="skolem">X</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">X</span> <span class="keyword1">to</span> <span class="skolem">X</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> MapsToI<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def CLDomain CLCodomain zx<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> exI<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> b<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">g</span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> a b <span class="keyword1"><span class="command">have</span></span> fm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> Mor <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> gm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> Mor <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> hm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> Mor <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> fg<span class="main">:</span> <span class="quoted"><span class="quoted">"Cod <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span> <span class="skolem">f</span> <span class="main">=</span> Dom <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span> <span class="skolem">g</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> gh<span class="main">:</span> <span class="quoted"><span class="quoted">"Cod <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span> <span class="skolem">g</span> <span class="main">=</span> Dom <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span> <span class="skolem">h</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> fm <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="skolem"><span class="skolem">ef</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">A</span><span class="main">,</span><span class="skolem">ef</span><span class="main">,</span><span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> fwd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">ef</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> gm <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B'</span></span> <span class="skolem"><span class="skolem">eg</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> g<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">B'</span><span class="main">,</span><span class="skolem">eg</span><span class="main">,</span><span class="skolem">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> gwd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B'</span> <span class="main">⊢</span> <span class="skolem">eg</span> <span class="main">:</span> <span class="skolem">C</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> hm <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C'</span></span> <span class="skolem"><span class="skolem">eh</span></span> <span class="skolem"><span class="skolem">D</span></span> <span class="keyword2"><span class="keyword">where</span></span> h<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">C'</span><span class="main">,</span><span class="skolem">eh</span><span class="main">,</span><span class="skolem">D</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> hwd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">C'</span> <span class="main">⊢</span> <span class="skolem">eh</span> <span class="main">:</span> <span class="skolem">D</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> fg <span class="keyword1"><span class="command">have</span></span> Beq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">=</span> <span class="skolem">B'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f g zx CLCodomain<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="skolem">A</span></span> <span class="quoted"><span class="skolem">ef</span></span> <span class="quoted"><span class="skolem">B</span></span><span class="main">]</span> CLDomain<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="skolem">B'</span></span> <span class="quoted"><span class="skolem">eg</span></span> <span class="quoted"><span class="skolem">C</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> gh <span class="keyword1"><span class="command">have</span></span> Ceq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> <span class="skolem">C'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> g h zx CLCodomain<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="skolem">B'</span></span> <span class="quoted"><span class="skolem">eg</span></span> <span class="quoted"><span class="skolem">C</span></span><span class="main">]</span> CLDomain<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="skolem">C'</span></span> <span class="quoted"><span class="skolem">eh</span></span> <span class="quoted"><span class="skolem">D</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CanonicalComp <span class="free">T</span> <span class="main">(</span>CanonicalComp <span class="free">T</span> <span class="skolem">f</span> <span class="skolem">g</span><span class="main">)</span> <span class="skolem">h</span> <span class="main">=</span> CanonicalComp <span class="free">T</span> <span class="skolem">f</span> <span class="main">(</span>CanonicalComp <span class="free">T</span> <span class="skolem">g</span> <span class="skolem">h</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>CanonicalComp <span class="free">T</span> <span class="skolem">f</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">A</span><span class="main">,</span><span class="keyword1">sub</span> <span class="skolem">ef</span> <span class="keyword1">in</span> <span class="skolem">eg</span><span class="main">,</span><span class="skolem">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> axt fwd gwd Beq zx CanonicalCompWellDefined<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="skolem">A</span></span> <span class="quoted"><span class="skolem">ef</span></span> <span class="quoted"><span class="skolem">B</span></span> <span class="quoted"><span class="skolem">eg</span></span> <span class="quoted"><span class="skolem">C</span></span><span class="main">]</span> f g <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="keyword1">sub</span> <span class="skolem">ef</span> <span class="keyword1">in</span> <span class="skolem">eg</span> <span class="main">:</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fwd gwd SubstWellDefined Beq <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"CanonicalComp <span class="free">T</span> <span class="main">(</span>CanonicalComp <span class="free">T</span> <span class="skolem">f</span> <span class="skolem">g</span><span class="main">)</span> <span class="skolem">h</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">A</span><span class="main">,</span><span class="main">(</span><span class="keyword1">sub</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="skolem">ef</span> <span class="keyword1">in</span> <span class="skolem">eg</span><span class="main">)</span> <span class="keyword1">in</span> <span class="skolem">eh</span><span class="main">)</span><span class="main">,</span><span class="skolem">D</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> CanonicalCompWellDefined<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="skolem">A</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">sub</span> <span class="skolem">ef</span> <span class="keyword1">in</span> <span class="skolem">eg</span>"</span></span> <span class="quoted"><span class="skolem">C</span></span> <span class="quoted"><span class="skolem">eh</span></span> <span class="quoted"><span class="skolem">D</span></span><span class="main">]</span> axt hwd h Beq Ceq zx <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>CanonicalComp <span class="free">T</span> <span class="skolem">g</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">B</span><span class="main">,</span><span class="keyword1">sub</span> <span class="skolem">eg</span> <span class="keyword1">in</span> <span class="skolem">eh</span><span class="main">,</span><span class="skolem">D</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> axt gwd hwd Ceq Beq CanonicalCompWellDefined<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="skolem">B</span></span> <span class="quoted"><span class="skolem">eg</span></span> <span class="quoted"><span class="skolem">C</span></span> <span class="quoted"><span class="skolem">eh</span></span> <span class="quoted"><span class="skolem">D</span></span><span class="main">]</span> g h zx <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B</span> <span class="main">⊢</span> <span class="keyword1">sub</span> <span class="skolem">eg</span> <span class="keyword1">in</span> <span class="skolem">eh</span> <span class="main">:</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> gwd hwd SubstWellDefined Beq Ceq <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"CanonicalComp <span class="free">T</span> <span class="skolem">f</span> <span class="main">(</span>CanonicalComp <span class="free">T</span> <span class="skolem">g</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">A</span><span class="main">,</span><span class="main">(</span><span class="keyword1">sub</span> <span class="skolem">ef</span> <span class="keyword1">in</span> <span class="main">(</span><span class="keyword1">sub</span> <span class="skolem">eg</span> <span class="keyword1">in</span> <span class="skolem">eh</span><span class="main">)</span><span class="main">)</span><span class="main">,</span><span class="skolem">D</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> CanonicalCompWellDefined<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="skolem">A</span></span> <span class="quoted"><span class="skolem">ef</span></span> <span class="quoted"><span class="skolem">B</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">sub</span> <span class="skolem">eg</span> <span class="keyword1">in</span> <span class="skolem">eh</span>"</span></span> <span class="quoted"><span class="skolem">D</span></span><span class="main">]</span> axt fwd f zx <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> a b <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SubstAssoc<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span> <span class="main">=</span> <span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">X</span> <span class="skolem">Y</span> <span class="skolem">g</span> <span class="skolem">Z</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">X</span> <span class="keyword1">to</span> <span class="skolem">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="keyword1">to</span> <span class="skolem">Z</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> a CanonicalCat'MapsTo<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="skolem">f</span></span> <span class="quoted"><span class="skolem">X</span></span> <span class="quoted"><span class="skolem">Y</span></span><span class="main">]</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ef</span></span> 
      <span class="keyword2"><span class="keyword">where</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">X</span><span class="main">,</span><span class="skolem">ef</span><span class="main">,</span><span class="skolem">Y</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> fwd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">X</span> <span class="main">⊢</span> <span class="skolem">ef</span> <span class="main">:</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> zx <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> b CanonicalCat'MapsTo<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="skolem">g</span></span> <span class="quoted"><span class="skolem">Y</span></span> <span class="quoted"><span class="skolem">Z</span></span><span class="main">]</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">eg</span></span>
      <span class="keyword2"><span class="keyword">where</span></span> g<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">Y</span><span class="main">,</span><span class="skolem">eg</span><span class="main">,</span><span class="skolem">Z</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> gwd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">Y</span> <span class="main">⊢</span> <span class="skolem">eg</span> <span class="main">:</span> <span class="skolem">Z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> zx <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> fg<span class="main">:</span> <span class="quoted"><span class="quoted">"CanonicalComp <span class="free">T</span> <span class="skolem">f</span> <span class="skolem">g</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">X</span><span class="main">,</span><span class="keyword1">sub</span> <span class="skolem">ef</span> <span class="keyword1">in</span> <span class="skolem">eg</span><span class="main">,</span><span class="skolem">Z</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> CanonicalCompWellDefined<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="skolem">X</span></span> <span class="quoted"><span class="skolem">ef</span></span> <span class="quoted"><span class="skolem">Y</span></span> <span class="quoted"><span class="skolem">eg</span></span> <span class="quoted"><span class="skolem">Z</span></span><span class="main">]</span> f g fwd gwd zx <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> fgwd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">X</span> <span class="main">⊢</span> <span class="keyword1">sub</span> <span class="skolem">ef</span> <span class="keyword1">in</span> <span class="skolem">eg</span> <span class="main">:</span> <span class="skolem">Z</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> fwd gwd SubstWellDefined<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>CanonicalComp <span class="free">T</span> <span class="skolem">f</span> <span class="skolem">g</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">X</span> <span class="keyword1">to</span> <span class="skolem">Z</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> MapsToI<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Dom <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span> <span class="main">(</span>CanonicalComp <span class="free">T</span> <span class="skolem">f</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">X</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> fg CLDomain<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main">]</span> zx <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"CanonicalComp <span class="free">T</span> <span class="skolem">f</span> <span class="skolem">g</span> <span class="main">∈</span> Mor <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fg fgwd <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Cod <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span> <span class="main">(</span>CanonicalComp <span class="free">T</span> <span class="skolem">f</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">Z</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> fg CLCodomain<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main">]</span> zx <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="skolem">X</span> <span class="keyword1">to</span> <span class="skolem">Z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="MonadicEquationalTheory-CanonicalCatCat"><span class="command">lemma</span></span> CanonicalCatCat<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span> <span class="main">⟹</span> Category <span class="main">(</span>CanonicalCat <span class="free">T</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat_def CanonicalCatCat' MakeCat<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">CanonicalInterpretation</span> <span class="keyword2"><span class="keyword">where</span></span> 
<span class="quoted"><span class="quoted">"<span class="free">CanonicalInterpretation</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">≡</span> <span class="main">⦇</span>
  ISignature <span class="main">=</span> aSignature <span class="free"><span class="bound"><span class="entity">T</span></span></span><span class="main">,</span>
  ICategory  <span class="main">=</span> CanonicalCat <span class="free"><span class="bound"><span class="entity">T</span></span></span><span class="main">,</span>
  ITypes     <span class="main">=</span> <span class="main">λ</span> <span class="bound">A</span> <span class="main">.</span> <span class="bound">A</span><span class="main">,</span>
  IFunctions <span class="main">=</span> <span class="main">λ</span> <span class="bound">f</span> <span class="main">.</span> <span class="main">[</span>SigDom <span class="main">(</span>aSignature <span class="free"><span class="bound"><span class="entity">T</span></span></span><span class="main">)</span> <span class="bound">f</span><span class="main">,</span> <span class="bound">f</span> <span class="keyword1">E@</span> <span class="keyword1">Vx</span><span class="main">,</span> SigCod <span class="main">(</span>aSignature <span class="free"><span class="bound"><span class="entity">T</span></span></span><span class="main">)</span> <span class="bound">f</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">T</span></span></span></sub><span class="hidden">⇙</span>
<span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">CI</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">≡</span> CanonicalInterpretation <span class="free"><span class="bound"><span class="entity">T</span></span></span>"</span></span>

<span class="keyword1" id="MonadicEquationalTheory-CIObj"><span class="command">lemma</span></span> CIObj<span class="main">:</span> <span class="quoted"><span class="quoted">"Obj <span class="main">(</span>CanonicalCat <span class="free">T</span><span class="main">)</span> <span class="main">=</span> BaseTypes <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeCat_def CanonicalCat_def CanonicalCat'_def<span class="main">)</span>

<span class="keyword1" id="MonadicEquationalTheory-CIMor"><span class="command">lemma</span></span> CIMor<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span> <span class="main">⟹</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∈</span> Mor <span class="main">(</span>CanonicalCat <span class="free">T</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeCat_def CanonicalCat_def CanonicalCat'_def<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A'</span> <span class="skolem">e'</span> <span class="skolem">B'</span> <span class="keyword3"><span class="command">assume</span></span> zx<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">A'</span><span class="main">,</span><span class="skolem">e'</span><span class="main">,</span><span class="skolem">B'</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A'</span> <span class="main">⊢</span> <span class="skolem">e'</span> <span class="main">:</span> <span class="skolem">B'</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CLDomain <span class="free">T</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> CLDomain <span class="free">T</span> <span class="main">[</span><span class="skolem">A'</span><span class="main">,</span><span class="skolem">e'</span><span class="main">,</span><span class="skolem">B'</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"CLCodomain <span class="free">T</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> CLCodomain <span class="free">T</span> <span class="main">[</span><span class="skolem">A'</span><span class="main">,</span><span class="skolem">e'</span><span class="main">,</span><span class="skolem">B'</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="skolem">A'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">=</span> <span class="skolem">B'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CLDomain CLCodomain zx<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">e'</span> <span class="main">≡</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> Axioms.Theory <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> zx b c Cl2Equiv<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="skolem">e'</span></span> <span class="quoted"><span class="free">B</span></span> <span class="quoted"><span class="free">e</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">e'</span> <span class="main">≡</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Axioms.Equiv2WellDefined<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main">]</span> zx <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="MonadicEquationalTheory-CIDom"><span class="command">lemma</span></span> CIDom<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>ZFAxioms <span class="free">T</span> <span class="main">;</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∈</span> Mor<span class="main">(</span>CanonicalCat <span class="free">T</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span>  Dom <span class="main">(</span>CanonicalCat <span class="free">T</span><span class="main">)</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∈</span> Mor<span class="main">(</span>CanonicalCat <span class="free">T</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"Dom <span class="main">(</span>CanonicalCat <span class="free">T</span><span class="main">)</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="free">A</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CLDomain MakeCatMor CanonicalCat_def MakeCat_def CanonicalCat'_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="MonadicEquationalTheory-CICod"><span class="command">lemma</span></span> CICod<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>ZFAxioms <span class="free">T</span> <span class="main">;</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∈</span> Mor<span class="main">(</span>CanonicalCat <span class="free">T</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> Cod <span class="main">(</span>CanonicalCat <span class="free">T</span><span class="main">)</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∈</span> Mor<span class="main">(</span>CanonicalCat <span class="free">T</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"Cod <span class="main">(</span>CanonicalCat <span class="free">T</span><span class="main">)</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="free">B</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CLCodomain MakeCatMor CanonicalCat_def MakeCat_def CanonicalCat'_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="MonadicEquationalTheory-CIId"><span class="command">lemma</span></span> CIId<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">A</span> <span class="main">∈</span> BaseTypes <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> Id <span class="main">(</span>CanonicalCat <span class="free">T</span><span class="main">)</span> <span class="free">A</span> <span class="main">=</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="keyword1">Vx</span><span class="main">,</span><span class="free">A</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeCat_def CanonicalCat_def CanonicalCat'_def<span class="main">)</span>

<span class="keyword1" id="MonadicEquationalTheory-CIComp"><span class="command">lemma</span></span> CIComp<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="main">(</span>aSignature <span class="free">T</span><span class="main">)</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">B</span> <span class="main">⊢</span> <span class="free">d</span> <span class="main">:</span> <span class="free">C</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CanonicalCat <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">[</span><span class="free">B</span><span class="main">,</span><span class="free">d</span><span class="main">,</span><span class="free">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="keyword1">sub</span> <span class="free">e</span> <span class="keyword1">in</span> <span class="free">d</span><span class="main">,</span><span class="free">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">[</span><span class="free">B</span><span class="main">,</span><span class="free">d</span><span class="main">,</span><span class="free">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∈</span> Mor <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">B</span><span class="main">,</span><span class="free">d</span><span class="main">,</span><span class="free">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∈</span> Mor <span class="main">(</span>CanonicalCat' <span class="free">T</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  CanonicalCat'_def<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def CLCodomain<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">[</span><span class="free">B</span><span class="main">,</span><span class="free">d</span><span class="main">,</span><span class="free">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def CLDomain<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">[</span><span class="free">B</span><span class="main">,</span><span class="free">d</span><span class="main">,</span><span class="free">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CanonicalCat <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">[</span><span class="free">B</span><span class="main">,</span><span class="free">d</span><span class="main">,</span><span class="free">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CanonicalCat' <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">[</span><span class="free">B</span><span class="main">,</span><span class="free">d</span><span class="main">,</span><span class="free">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeCatComp CanonicalCat_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="free">e</span><span class="main">,</span><span class="free">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CanonicalCat <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">[</span><span class="free">B</span><span class="main">,</span><span class="free">d</span><span class="main">,</span><span class="free">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span> <span class="keyword1">sub</span> <span class="free">e</span> <span class="keyword1">in</span> <span class="free">d</span><span class="main">,</span> <span class="free">C</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> CanonicalCompWellDefined<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main">]</span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalCat'_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span> <span class="main">⟹</span> Category <span class="keyword1">iC</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalInterpretation_def CanonicalCatCat<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span> <span class="main">⟹</span> Signature <span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalInterpretation_def Axioms.AxSig<span class="main">)</span>

<span class="keyword1" id="MonadicEquationalTheory-CIInterpretation"><span class="command">lemma</span></span> CIInterpretation<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span> <span class="main">⟹</span> Interpretation <span class="main">(</span>CI <span class="free">T</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> Interpretation_def<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> xt<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Category <span class="keyword1">iC</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Signature <span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> xt <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> BaseTypes <span class="main">(</span><span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ty⟦</span><span class="skolem">A</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∈</span> Obj <span class="main">(</span><span class="keyword1">iC</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalInterpretation_def CIObj<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">A</span> <span class="skolem">B</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Sig</span> <span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">→</span> <span class="skolem">B</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="keyword1">sDom</span><span class="hidden">⇘</span><sub>ISignature <span class="main">(</span>CI <span class="free">T</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span><span class="main">,</span><span class="skolem">f</span> <span class="keyword1">E@</span> <span class="keyword1">Vx</span><span class="main">,</span><span class="keyword1">sCod</span><span class="hidden">⇘</span><sub>ISignature <span class="main">(</span>CI <span class="free">T</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CanonicalCat <span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> xt <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalInterpretation_def CIMor<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Fn⟦</span><span class="skolem">f</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>ICategory <span class="main">(</span>CI <span class="free">T</span><span class="main">)</span> </sub><span class="hidden">⇙</span><span class="keyword1">Ty⟦</span><span class="skolem">A</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="keyword1">to</span> <span class="keyword1">Ty⟦</span><span class="skolem">B</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a xt
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalInterpretation_def MapsTo_def funsignature_abbrev_def CIDom CICod<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="MonadicEquationalTheory-CIInterp2Mor"><span class="command">lemma</span></span> CIInterp2Mor<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">⋀</span> <span class="bound">B</span> <span class="main">.</span> <span class="keyword1">Sig</span> <span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="bound">B</span><span class="main">)</span> <span class="main">⟹</span>  <span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="free">e</span> <span class="main">:</span> <span class="bound">B</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">[</span><span class="free">A</span><span class="main">,</span> <span class="free">e</span><span class="main">,</span> <span class="bound">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">e</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> xt<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span> 
    <span class="keyword1"><span class="command">have</span></span> aeqb<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a SigId<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="skolem">B</span></span><span class="main">]</span> Interpretation.InterpExprWellDefined<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"CI <span class="free">T</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> bt<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> BaseTypes <span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a SigTyId aeqb <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">(</span>Id <span class="keyword1">iC</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalInterpretation_def<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Id <span class="keyword1">iC</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="keyword1">Ty⟦</span><span class="free">A</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">)</span> <span class="main">=</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="keyword1">Vx</span><span class="main">,</span><span class="free">A</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> bt CIId <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalInterpretation_def<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="keyword1">Vx</span><span class="main">,</span><span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aeqb b <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">e</span> <span class="skolem">B</span> <span class="keyword3"><span class="command">assume</span></span> ih<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">B'</span><span class="main">.</span> <span class="main">⟦</span>ZFAxioms <span class="free">T</span> <span class="main">;</span> <span class="keyword1">Sig</span> <span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="bound">B'</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="bound">B'</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="skolem">e</span><span class="main">,</span><span class="bound">B'</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> a <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B'</span></span> <span class="keyword2"><span class="keyword">where</span></span> sig<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B'</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">Sig</span> <span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">:</span> <span class="skolem">B'</span> <span class="main">→</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B'</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="skolem">e</span><span class="main">,</span><span class="skolem">B'</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ih xt <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">(</span><span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="skolem">e</span><span class="main">,</span><span class="skolem">B'</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>ICategory <span class="main">(</span>CI <span class="free">T</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="keyword1">Fn⟦</span><span class="skolem">f</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> sig f <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="skolem">e</span><span class="main">,</span><span class="skolem">B'</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>ICategory <span class="main">(</span>CI <span class="free">T</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="keyword1">Fn⟦</span><span class="skolem">f</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e</span><span class="main">,</span><span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Fn⟦</span><span class="skolem">f</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">B'</span><span class="main">,</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="keyword1">Vx</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalInterpretation_def funsignature_abbrev_def<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B'</span> <span class="main">⊢</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> sig f <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="skolem">e</span><span class="main">,</span><span class="skolem">B'</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>ICategory <span class="main">(</span>CI <span class="free">T</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="main">[</span><span class="skolem">B'</span><span class="main">,</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="keyword1">Vx</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="main">[</span><span class="free">A</span><span class="main">,</span> <span class="keyword1">sub</span> <span class="skolem">e</span> <span class="keyword1">in</span> <span class="main">(</span><span class="skolem">f</span> <span class="keyword1">E@</span> <span class="keyword1">Vx</span><span class="main">)</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> CIComp<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span><span class="main">]</span> xt <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalInterpretation_def<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">sub</span> <span class="skolem">e</span> <span class="keyword1">in</span> <span class="main">(</span><span class="skolem">f</span> <span class="keyword1">E@</span> <span class="keyword1">Vx</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Subst_def<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> aa <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⊢</span> <span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">[</span><span class="free">A</span><span class="main">,</span><span class="skolem">f</span> <span class="keyword1">E@</span> <span class="skolem">e</span><span class="main">,</span><span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="MonadicEquationalTheory-CIModel"><span class="command">lemma</span></span> CIModel<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span> <span class="main">⟹</span> Model <span class="main">(</span>CI <span class="free">T</span><span class="main">)</span> <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Model_def Model_axioms_def <span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> xt<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> axt<span class="main">:</span> <span class="quoted"><span class="quoted">"Axioms <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> xt <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> ii<span class="main">:</span> <span class="quoted"><span class="quoted">"Interpretation <span class="main">(</span>CI <span class="free">T</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> xt <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CIInterpretation<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> aeq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalInterpretation_def<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">φ</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">φ</span> <span class="main">∈</span> aAxioms <span class="free">T</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> a Axioms.AxT <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="skolem"><span class="skolem">e</span></span> <span class="skolem"><span class="skolem">d</span></span> <span class="keyword2"><span class="keyword">where</span></span> φ<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">φ</span> <span class="main">=</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">≡</span> <span class="skolem">d</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> sig<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">≡</span> <span class="skolem">d</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> axt <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> sig <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> e<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">[</span><span class="skolem">A</span><span class="main">,</span> <span class="skolem">e</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aeq CIInterp2Mor xt <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">d</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> sig <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> d<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">d</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">[</span><span class="skolem">A</span><span class="main">,</span> <span class="skolem">d</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aeq CIInterp2Mor xt <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">φ</span> <span class="main">∈</span> Axioms.Theory <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a axt <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Axioms.Theory.Ax<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="skolem">A</span><span class="main">,</span> <span class="skolem">e</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">A</span><span class="main">,</span> <span class="skolem">d</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> φ Equiv2Cl axt <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="skolem">φ</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="main">(</span>IBool True<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> e d φ ii InterpEq<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"CI <span class="free">T</span>"</span></span> <span class="quoted"><span class="skolem">A</span></span> <span class="quoted"><span class="skolem">e</span></span> <span class="quoted"><span class="skolem">B</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="skolem">A</span><span class="main">,</span> <span class="skolem">e</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="quoted"><span class="skolem">d</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="skolem">A</span><span class="main">,</span> <span class="skolem">d</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="MonadicEquationalTheory-CIComplete"><span class="command">lemma</span></span> CIComplete<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="free">φ</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="main">(</span>IBool True<span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> Axioms.Theory <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> ii<span class="main">:</span> <span class="quoted"><span class="quoted">"Interpretation <span class="main">(</span>CI <span class="free">T</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CIInterpretation<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> aeq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">aS</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CanonicalInterpretation_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> Interpretation.Bool<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"CI <span class="free">T</span>"</span></span> <span class="quoted"><span class="free">φ</span></span> <span class="quoted">True</span><span class="main">]</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="skolem"><span class="skolem">e</span></span> <span class="skolem"><span class="skolem">d</span></span> <span class="keyword2"><span class="keyword">where</span></span> φ<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">≡</span> <span class="skolem">d</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ii assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> Interpretation.Equiv<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"CI <span class="free">T</span>"</span></span> <span class="quoted"><span class="skolem">A</span></span> <span class="quoted"><span class="skolem">e</span></span> <span class="quoted"><span class="skolem">d</span></span> <span class="quoted"><span class="skolem">B</span></span><span class="main">]</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> 
    <span class="keyword2"><span class="keyword">where</span></span> g1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span>   g2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">d</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ii φ assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> ewd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> dwd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Sig</span> <span class="keyword1">iS</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">▹</span> <span class="main">(</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">d</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> g1 g2 Interpretation.InterpExprWellDefined<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"CI <span class="free">T</span>"</span></span><span class="main">]</span> ii <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">have</span></span> ie<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">[</span><span class="skolem">A</span><span class="main">,</span> <span class="skolem">e</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ewd CIInterp2Mor assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> id<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">L⟦</span><span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">d</span> <span class="main">:</span> <span class="skolem">B</span><span class="main">⟧</span><span class="hidden">⇘</span><sub>CI <span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="main">(</span>IMor <span class="main">[</span><span class="skolem">A</span><span class="main">,</span> <span class="skolem">d</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> dwd CIInterp2Mor assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="skolem">A</span><span class="main">,</span> <span class="skolem">e</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="skolem">g</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> g1 ie ii Interpretation.Functional<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"CI <span class="free">T</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">e</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span> <span class="quoted"><span class="quoted">"IMor <span class="main">[</span><span class="skolem">A</span><span class="main">,</span> <span class="skolem">e</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="quoted"><span class="quoted">"IMor <span class="skolem">g</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="skolem">A</span><span class="main">,</span> <span class="skolem">d</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="skolem">g</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> g2 id ii Interpretation.Functional<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"CI <span class="free">T</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Vx</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">⊢</span> <span class="skolem">d</span> <span class="main">:</span> <span class="skolem">B</span>"</span></span> <span class="quoted"><span class="quoted">"IMor <span class="main">[</span><span class="skolem">A</span><span class="main">,</span> <span class="skolem">d</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="quoted"><span class="quoted">"IMor <span class="skolem">g</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="skolem">A</span><span class="main">,</span> <span class="skolem">e</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="main">[</span><span class="skolem">A</span><span class="main">,</span> <span class="skolem">d</span><span class="main">,</span> <span class="skolem">B</span><span class="main">]</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> φ ewd Cl2Equiv aeq assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="MonadicEquationalTheory-Complete"><span class="command">lemma</span></span> Complete<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ZFAxioms <span class="free">T</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="main">(</span><span class="bound">I</span> <span class="main">::</span> <span class="main">(</span>ZF<span class="main">,</span>ZF<span class="main">,</span>ZF<span class="main">,</span>ZF<span class="main">)</span> Interpretation<span class="main">)</span> <span class="main">.</span> Model <span class="bound">I</span> <span class="free">T</span> <span class="main">⟹</span> <span class="main">(</span><span class="keyword1">L⟦</span><span class="free">φ</span><span class="main">⟧</span><span class="hidden">⇘</span><sub><span class="bound">I</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="main">(</span>IBool True<span class="main">)</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">∈</span> Axioms.Theory <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Model <span class="main">(</span>CI <span class="free">T</span><span class="main">)</span> <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms CIModel <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> CIComplete<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="free">φ</span></span><span class="main">]</span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="Functors">
<div class="head">
<h1>Theory Functors</h1>
</div>
<pre class="source"><span class="comment1">(*
Author: Alexander Katovsky
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Functor"</span></span>

<span class="keyword1"><span class="command">theory</span></span> Functors
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Category.html">Category</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">record</span></span> <span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">)</span> Functor <span class="main">=</span> 
  CatDom <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span><span class="tfree">'m1</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span>Category_scheme"</span></span> 
  CatCod <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o2</span><span class="main">,</span><span class="tfree">'m2</span><span class="main">,</span><span class="tfree">'b</span><span class="main">)</span>Category_scheme"</span></span> 
  MapM <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'m1</span> <span class="main">⇒</span> <span class="tfree">'m2</span>"</span></span> 

<span class="keyword1"><span class="command">abbreviation</span></span>
  <span class="entity">FunctorMorApp</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a1</span><span class="main">,</span> <span class="tfree">'a2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">)</span> Functor_scheme <span class="main">⇒</span> <span class="tfree">'m1</span> <span class="main">⇒</span> <span class="tfree">'m2</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1">##</span>"</span> 70<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">FunctorMorApp</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="free"><span class="bound"><span class="entity">m</span></span></span> <span class="main">≡</span> <span class="main">(</span>MapM <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">m</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">MapO</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a1</span><span class="main">,</span> <span class="tfree">'a2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">)</span> Functor_scheme <span class="main">⇒</span> <span class="tfree">'o1</span> <span class="main">⇒</span> <span class="tfree">'o2</span>"</span></span>  <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">MapO</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">≡</span> <span class="keyword1">THE</span> <span class="bound">Y</span> <span class="main">.</span> <span class="bound">Y</span> <span class="main">∈</span> Obj<span class="main">(</span>CatCod <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span> <span class="main">∧</span>  <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">##</span> <span class="main">(</span>Id <span class="main">(</span>CatDom <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span> <span class="main">=</span> Id <span class="main">(</span>CatCod <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span> <span class="bound">Y</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span>
  <span class="entity">FunctorObjApp</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a1</span><span class="main">,</span> <span class="tfree">'a2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">)</span> Functor_scheme <span class="main">⇒</span> <span class="tfree">'o1</span> <span class="main">⇒</span> <span class="tfree">'o2</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1">@@</span>"</span> 70<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">FunctorObjApp</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">≡</span> <span class="main">(</span>MapO <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> PreFunctor <span class="main">=</span> 
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">F</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a1</span><span class="main">,</span> <span class="tfree">'a2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">)</span> Functor_scheme"</span></span>  <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> FunctorComp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="main">⟹</span> <span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">g</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     FunctorId<span class="main">:</span>   <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="main">∃</span> <span class="bound">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">.</span> <span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="bound">Y</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     CatDom<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>      <span class="quoted"><span class="quoted">"Category<span class="main">(</span>CatDom <span class="free">F</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     CatCod<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>      <span class="quoted"><span class="quoted">"Category<span class="main">(</span>CatCod <span class="free">F</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> FunctorM <span class="main">=</span> PreFunctor <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span>     FunctorCompM<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> FunctorExt <span class="main">=</span> 
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">F</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a1</span><span class="main">,</span> <span class="tfree">'a2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">)</span> Functor_scheme"</span></span>  <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> FunctorMapExt<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>MapM <span class="free">F</span><span class="main">)</span> <span class="main">∈</span> extensional <span class="main">(</span>Mor <span class="main">(</span>CatDom <span class="free">F</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> Functor <span class="main">=</span> FunctorM <span class="main">+</span> FunctorExt

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="entity">MakeFtor</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">,</span><span class="tfree">'r</span><span class="main">)</span> Functor_scheme <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">,</span><span class="tfree">'r</span><span class="main">)</span> Functor_scheme"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">MakeFtor</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">≡</span> <span class="main">⦇</span>
      CatDom <span class="main">=</span> CatDom <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">,</span> 
      CatCod <span class="main">=</span> CatCod <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">,</span> 
      MapM <span class="main">=</span> restrict <span class="main">(</span>MapM <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span> <span class="main">(</span>Mor <span class="main">(</span>CatDom <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">,</span> 
      <span class="main">…</span> <span class="main">=</span> Functor.more <span class="free"><span class="bound"><span class="entity">F</span></span></span>
  <span class="main">⦈</span>"</span></span>

<span class="keyword1" id="Functors-PreFunctorFunctor"><span class="command">lemma</span></span> PreFunctorFunctor<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"Functor <span class="free">F</span> <span class="main">⟹</span> PreFunctor <span class="free">F</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Functor_def FunctorM_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> functor_simps <span class="main">=</span> PreFunctor.FunctorComp PreFunctor.FunctorId

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="entity">functor_abbrev</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Ftor</span> _ <span class="keyword1">:</span> _ <span class="keyword1">⟶</span> _"</span> <span class="main">[</span>81<span class="main">]</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Ftor</span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main"><span class="free">:</span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main"><span class="free">⟶</span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">≡</span> <span class="main">(</span>Functor <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>CatDom <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>CatCod <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Functors-functor_abbrevE"><span class="command">lemma</span></span> functor_abbrevE<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="keyword1">Ftor</span> <span class="free">F</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⟶</span> <span class="free">B</span> <span class="main">;</span> <span class="main">⟦</span><span class="main">(</span>Functor <span class="free">F</span><span class="main">)</span> <span class="main">;</span> <span class="main">(</span>CatDom <span class="free">F</span> <span class="main">=</span> <span class="free">A</span><span class="main">)</span> <span class="main">;</span> <span class="main">(</span>CatCod <span class="free">F</span> <span class="main">=</span> <span class="free">B</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> functor_abbrev_def<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">functor_comp_def</span> <span class="main">(</span><span class="quoted">"_ <span class="keyword1">≈&gt;;;;</span> _"</span> <span class="main">[</span>81<span class="main">]</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">functor_comp_def</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="main">≡</span> <span class="main">(</span>Functor <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>Functor <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>CatDom <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="main">=</span> CatCod <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Functors-functor_comp_def"><span class="command">lemma</span></span> functor_comp_def<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">F</span> <span class="main">≈&gt;;;;</span> <span class="free">G</span> <span class="main">;</span> <span class="main">⟦</span>Functor <span class="free">F</span> <span class="main">;</span> Functor <span class="free">G</span> <span class="main">;</span> CatDom <span class="free">G</span> <span class="main">=</span> CatCod <span class="free">F</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> functor_comp_def_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Functor<span class="main">)</span> FunctorMapsTo<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">##</span> <span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorCompM<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">f</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Functor<span class="main">)</span> FunctorCodDom<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">##</span> <span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorMapsTo<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Functor<span class="main">)</span> FunctorCompPreserved<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="free">F</span> <span class="main">##</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span>FunctorMapsTo<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Functor<span class="main">)</span> FunctorCompDef<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CompDefined_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">##</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">##</span> <span class="free">g</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorCompPreserved<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorCodDom<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms a <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Functors-FunctorComp"><span class="command">lemma</span></span> FunctorComp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="keyword1">Ftor</span> <span class="free">F</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⟶</span> <span class="free">B</span> <span class="main">;</span> <span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">A</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">A</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">B</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor.FunctorComp<span class="main">)</span>

<span class="keyword1" id="Functors-FunctorCompDef"><span class="command">lemma</span></span> FunctorCompDef<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="keyword1">Ftor</span> <span class="free">F</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⟶</span> <span class="free">B</span> <span class="main">;</span> <span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">A</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">B</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Functor.FunctorCompDef<span class="main">)</span>

<span class="keyword1" id="Functors-FunctorMapsTo"><span class="command">lemma</span></span> FunctorMapsTo<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="free">F</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⟶</span> <span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">A</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">B</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"CatCod <span class="free">F</span> <span class="main">=</span> <span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"CatDom <span class="free">F</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ff<span class="main">:</span> <span class="quoted"><span class="quoted">"Functor <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> df<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">##</span> <span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ff
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Functor.FunctorMapsTo<span class="main">)</span> 
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> df cf b <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> PreFunctor<span class="main">)</span> FunctorId2<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">@@</span> <span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?Q</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span> <span class="bound">E</span> <span class="bound">Y</span> <span class="main">.</span> <span class="bound">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="bound">E</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="bound">Y</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="var">?Q</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms FunctorId <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Y</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="skolem">Y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span>  <span class="keyword1"><span class="command">{</span></span> 
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="skolem">e</span> <span class="skolem">z</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="var">?Q</span> <span class="skolem">e</span> <span class="skolem">y</span> <span class="main">;</span> <span class="var">?Q</span> <span class="skolem">e</span> <span class="skolem">z</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="skolem">y</span> <span class="main">=</span> <span class="skolem">z</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> Category.IdInj<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted">"CatCod <span class="free">F</span>"</span></span> <span class="quoted"><span class="skolem">y</span></span> <span class="quoted"><span class="skolem">z</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃!</span> <span class="bound">Z</span> <span class="main">.</span> <span class="var">?P</span> <span class="bound">Z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">(</span><span class="keyword1">THE</span> <span class="bound">Y</span> <span class="main">.</span> <span class="var">?P</span> <span class="bound">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> theI'<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapO_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Functors-FunctorId"><span class="command">lemma</span></span> FunctorId<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="free">F</span> <span class="main">:</span> <span class="free">C</span> <span class="main">⟶</span> <span class="free">D</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">##</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> Id <span class="free">D</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CatDom <span class="free">F</span> <span class="main">=</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"CatCod <span class="free">F</span> <span class="main">=</span> <span class="free">D</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"PreFunctor <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms PreFunctor.FunctorId2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="free">X</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Functor<span class="main">)</span> DomFunctor<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorCodDom<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Functor<span class="main">)</span> CodFunctor<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorCodDom<span class="main">)</span> 

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Functor<span class="main">)</span> FunctorId3Dom<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cdom<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorId2<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> DomFunctor<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Functor<span class="main">)</span> FunctorId3Cod<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Ccod<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorId2<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CodFunctor<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> PreFunctor<span class="main">)</span> FmToFo<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">;</span> <span class="free">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">;</span> <span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">F</span> <span class="main">@@</span> <span class="free">X</span> <span class="main">=</span> <span class="free">Y</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorId2 <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> Category.IdInj<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted">"CatCod <span class="free">F</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">@@</span> <span class="free">X</span>"</span></span> <span class="quoted"><span class="free">Y</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1" id="Functors-MakeFtorPreFtor"><span class="command">lemma</span></span> MakeFtorPreFtor<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"PreFunctor <span class="free">F</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">X</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span> </sub><span class="hidden">⇙</span><span class="skolem">X</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Category <span class="main">(</span>CatDom <span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor_def<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span> </sub><span class="hidden">⇙</span><span class="skolem">X</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="skolem">X</span> <span class="keyword1">to</span> <span class="skolem">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cidm<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor_def MakeFtor_def Category.MapsToMorDomCod<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Functors-MakeFtorMor"><span class="command">lemma</span></span> MakeFtorMor<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> MakeFtor <span class="free">F</span> <span class="main">##</span> <span class="free">f</span> <span class="main">=</span> <span class="free">F</span> <span class="main">##</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeFtor_def<span class="main">)</span>

<span class="keyword1" id="Functors-MakeFtorObj"><span class="command">lemma</span></span> MakeFtorObj<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"PreFunctor <span class="free">F</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"MakeFtor <span class="free">F</span> <span class="main">@@</span> <span class="free">X</span> <span class="main">=</span> <span class="free">F</span> <span class="main">@@</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeFtor_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatCod <span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor.FunctorId2 MakeFtor_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"MakeFtor <span class="free">F</span> <span class="main">##</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Category <span class="main">(</span>CatDom <span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor_def<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span> </sub><span class="hidden">⇙</span><span class="free">X</span>  <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cidm<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"MakeFtor <span class="free">F</span> <span class="main">##</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">=</span> <span class="free">F</span> <span class="main">##</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span> </sub><span class="hidden">⇙</span><span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeFtor_def<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor.FunctorId2<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeFtor_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeFtorPreFtor<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor.FmToFo<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Functors-MakeFtor"><span class="command">lemma</span></span> MakeFtor<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"FunctorM <span class="free">F</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Functor <span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">intro_locales</span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeFtorPreFtor FunctorM_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"FunctorM_axioms <span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorM_axioms_def<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">X</span> <span class="skolem">Y</span> <span class="keyword3"><span class="command">assume</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="skolem">X</span> <span class="keyword1">to</span> <span class="skolem">Y</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aa <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeFtor_def<span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">@@</span> <span class="skolem">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Category <span class="main">(</span>CatDom <span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorM_def PreFunctor_def<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span> 
            <span class="keyword1"><span class="command">using</span></span> aa <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToObj MakeFtor_def<span class="main">)</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"PreFunctor <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorM_def<span class="main">)</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">@@</span> <span class="skolem">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeFtorObj<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> aa 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorM.FunctorCompM MakeFtor_def<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeFtor_def<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"FunctorExt <span class="main">(</span>MakeFtor <span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorExt_def MakeFtor_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="entity">IdentityFunctor'</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> Category_scheme <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'a</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> Functor"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">FId''</span> _"</span> <span class="main">[</span>70<span class="main">]</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">IdentityFunctor'</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">≡</span> <span class="main">⦇</span>CatDom <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">,</span> CatCod <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">,</span> MapM <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span> <span class="main">.</span> <span class="bound">f</span><span class="main">)</span> <span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="entity">IdentityFunctor</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">FId</span> _"</span> <span class="main">[</span>70<span class="main">]</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">IdentityFunctor</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">≡</span> MakeFtor<span class="main">(</span>IdentityFunctor' <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Functors-IdFtor'PreFunctor"><span class="command">lemma</span></span> IdFtor'PreFunctor<span class="main">:</span> <span class="quoted"><span class="quoted">"Category <span class="free">C</span> <span class="main">⟹</span> PreFunctor <span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor_def IdentityFunctor'_def<span class="main">)</span>

<span class="keyword1" id="Functors-IdFtor'Obj"><span class="command">lemma</span></span> IdFtor'Obj<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Category <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span> <span class="main">=</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span> <span class="main">##</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdentityFunctor'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatCod <span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdentityFunctor'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor.FmToFo IdFtor'PreFunctor<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Functors-IdFtor'FtorM"><span class="command">lemma</span></span> IdFtor'FtorM<span class="main">:</span>  
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Category <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"FunctorM <span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorM_def IdFtor'PreFunctor assms FunctorM_axioms_def<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">X</span> <span class="skolem">Y</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="skolem">X</span> <span class="keyword1">to</span> <span class="skolem">Y</span>"</span></span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> a assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToObj IdentityFunctor'_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span> <span class="main">=</span> <span class="skolem">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"CatDom <span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span> <span class="main">=</span> CatCod <span class="main">(</span><span class="keyword1">FId'</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdentityFunctor'_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms a <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdFtor'Obj<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Functors-IdFtorFtor"><span class="command">lemma</span></span> IdFtorFtor<span class="main">:</span>  <span class="quoted"><span class="quoted">"Category <span class="free">C</span> <span class="main">⟹</span> Functor <span class="main">(</span><span class="keyword1">FId</span> <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdentityFunctor_def IdFtor'FtorM <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> MakeFtor<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="entity">ConstFunctor'</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span><span class="tfree">'m1</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> Category_scheme <span class="main">⇒</span> 
                  <span class="main">(</span><span class="tfree">'o2</span><span class="main">,</span><span class="tfree">'m2</span><span class="main">,</span><span class="tfree">'b</span><span class="main">)</span> Category_scheme <span class="main">⇒</span> <span class="tfree">'o2</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span><span class="tfree">'o2</span><span class="main">,</span><span class="tfree">'m1</span><span class="main">,</span><span class="tfree">'m2</span><span class="main">,</span><span class="tfree">'a</span><span class="main">,</span><span class="tfree">'b</span><span class="main">)</span> Functor"</span></span>  <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ConstFunctor'</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="free"><span class="bound"><span class="entity">b</span></span></span> <span class="main">≡</span> <span class="main">⦇</span>
         CatDom <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">,</span> 
         CatCod <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">,</span> 
         MapM <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span> <span class="main">.</span> <span class="main">(</span>Id <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">b</span></span></span><span class="main">)</span>
  <span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">ConstFunctor</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="free"><span class="bound"><span class="entity">b</span></span></span> <span class="main">≡</span> MakeFtor<span class="main">(</span>ConstFunctor' <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="free"><span class="bound"><span class="entity">b</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Functors-ConstFtor'"><span class="command">lemma</span></span> ConstFtor' <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Category <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"Category <span class="free">B</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="main">(</span>Obj <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span>ConstFunctor' <span class="free">A</span> <span class="free">B</span> <span class="free">b</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     <span class="quoted"><span class="quoted">"FunctorM <span class="main">(</span>ConstFunctor' <span class="free">A</span> <span class="free">B</span> <span class="free">b</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span>ConstFunctor' <span class="free">A</span> <span class="free">B</span> <span class="free">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> PreFunctor_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> conjI<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ConstFunctor'_def Category.Simps Category.CatIdCompId<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> 
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">X</span>  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">A</span></sub><span class="hidden">⇙</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">B</span></sub><span class="hidden">⇙</span>"</span></span> <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span>ConstFunctor' <span class="free">A</span> <span class="free">B</span> <span class="free">b</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ConstFunctor' <span class="free">A</span> <span class="free">B</span> <span class="free">b</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span> <span class="main">=</span> <span class="free">b</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ConstFunctor'_def PreFunctor.FmToFo Category.Simps<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"FunctorM <span class="main">(</span>ConstFunctor' <span class="free">A</span> <span class="free">B</span> <span class="free">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro_locales</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ConstFunctor'_def Category.Simps FunctorM_axioms_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Functors-ConstFtor"><span class="command">lemma</span></span> ConstFtor<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Category <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"Category <span class="free">B</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="main">(</span>Obj <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Functor <span class="main">(</span>ConstFunctor <span class="free">A</span> <span class="free">B</span> <span class="free">b</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms ConstFtor' ConstFunctor_def MakeFtor<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="entity">UnitFunctor</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> Category_scheme <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'o</span><span class="main">,</span>unit<span class="main">,</span><span class="tfree">'m</span><span class="main">,</span>unit<span class="main">,</span><span class="tfree">'a</span><span class="main">,</span>unit<span class="main">)</span> Functor"</span></span>  <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">UnitFunctor</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">≡</span> ConstFunctor <span class="free"><span class="bound"><span class="entity">C</span></span></span> UnitCategory <span class="main">()</span>"</span></span>

<span class="keyword1" id="Functors-UnitFtor"><span class="command">lemma</span></span> UnitFtor<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Category <span class="free">C</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Functor<span class="main">(</span>UnitFunctor <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">()</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>UnitCategory</sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> UnitCategory_def MakeCatObj<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"Functor<span class="main">(</span>ConstFunctor <span class="free">C</span> UnitCategory <span class="main">()</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ConstFtor<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> UnitFunctor_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">FunctorComp'</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span><span class="tfree">'o2</span><span class="main">,</span><span class="tfree">'m1</span><span class="main">,</span><span class="tfree">'m2</span><span class="main">,</span><span class="tfree">'a1</span><span class="main">,</span><span class="tfree">'a2</span><span class="main">)</span> Functor <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'o2</span><span class="main">,</span><span class="tfree">'o3</span><span class="main">,</span><span class="tfree">'m2</span><span class="main">,</span><span class="tfree">'m3</span><span class="main">,</span><span class="tfree">'b1</span><span class="main">,</span><span class="tfree">'b2</span><span class="main">)</span> Functor
                    <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span><span class="tfree">'o3</span><span class="main">,</span><span class="tfree">'m1</span><span class="main">,</span><span class="tfree">'m3</span><span class="main">,</span><span class="tfree">'a1</span><span class="main">,</span><span class="tfree">'b2</span><span class="main">)</span> Functor"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">;;:</span>"</span> 71<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">FunctorComp'</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="main">≡</span> <span class="main">⦇</span>
        CatDom <span class="main">=</span> CatDom <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">,</span> 
        CatCod <span class="main">=</span> CatCod <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="main">,</span>
        MapM   <span class="main">=</span> <span class="main">λ</span> <span class="bound">f</span> <span class="main">.</span> <span class="main">(</span>MapM <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">)</span><span class="main">(</span><span class="main">(</span>MapM <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span> <span class="bound">f</span><span class="main">)</span>
  <span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">FunctorComp</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">;;;</span>"</span> 71<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">FunctorComp</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="main">≡</span> MakeFtor <span class="main">(</span>FunctorComp' <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Functors-FtorCompComp'"><span class="command">lemma</span></span> FtorCompComp'<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">≈&gt;;;;</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">##</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">G</span> <span class="main">##</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">G</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">G</span> <span class="main">##</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"PreFunctor <span class="free">G</span> <span class="main">∧</span> PreFunctor <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CatDom <span class="free">G</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Functor.FunctorCompDef<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="free">f</span></span> <span class="quoted"><span class="free">g</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor.FunctorComp<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">##</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">G</span> <span class="main">##</span> <span class="main">(</span><span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">G</span> <span class="main">##</span> <span class="main">(</span><span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatDom <span class="free">G</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">G</span> <span class="main">##</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">G</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">G</span> <span class="main">##</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor.FunctorComp<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">G</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">g</span><span class="main">)</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Functors-FtorCompId"><span class="command">lemma</span></span> FtorCompId<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="main">(</span>Obj <span class="main">(</span>CatDom <span class="free">F</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">≈&gt;;;;</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">##</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span> </sub><span class="hidden">⇙</span><span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">G</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">G</span> <span class="main">@@</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="free">G</span> <span class="main">@@</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">∈</span> <span class="main">(</span>Obj <span class="main">(</span>CatCod <span class="free">G</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"PreFunctor <span class="free">G</span> <span class="main">∧</span> PreFunctor <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="free">G</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor.FunctorId2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">##</span> <span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span> </sub><span class="hidden">⇙</span><span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="free">G</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b a
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor.FunctorId2<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">G</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">G</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">G</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">G</span> <span class="main">@@</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="free">G</span> <span class="main">@@</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">∈</span> <span class="main">(</span>Obj <span class="main">(</span>CatCod <span class="free">G</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor.FunctorId2<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">G</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Functors-FtorCompIdDef"><span class="command">lemma</span></span> FtorCompIdDef<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="main">(</span>Obj <span class="main">(</span>CatDom <span class="free">F</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">≈&gt;;;;</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span> <span class="main">=</span> <span class="main">(</span><span class="free">G</span> <span class="main">@@</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">G</span> <span class="main">##</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorComp'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">G</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">G</span> <span class="main">@@</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms a
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FtorCompId<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="free">G</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">G</span> <span class="main">@@</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorComp'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">@@</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="main">(</span>Obj <span class="main">(</span>CatCod <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms a
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FtorCompId<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="free">G</span></span><span class="main"><span class="main">]</span></span> FunctorComp'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorComp'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> b 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor.FmToFo<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span>"</span></span> <span class="quoted"><span class="free">X</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">@@</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Functors-FunctorCompMapsTo"><span class="command">lemma</span></span> FunctorCompMapsTo<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">≈&gt;;;;</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">G</span> <span class="main">##</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="free">G</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">G</span> <span class="main">@@</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">G</span> <span class="main">@@</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span> </sub><span class="hidden">⇙</span><span class="main">∧</span> Functor <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorComp'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatDom <span class="free">G</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Functor.FunctorMapsTo<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="free">f</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"FunctorM <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorComp_def Functor_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorM.FunctorCompM<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">G</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">##</span> <span class="free">f</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Functors-FunctorCompMapsTo2"><span class="command">lemma</span></span> FunctorCompMapsTo2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">≈&gt;;;;</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">to</span> 
                                               <span class="main">(</span><span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Category <span class="main">(</span>CatDom <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor_def<span class="main">)</span> 
  <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span> </sub><span class="hidden">⇙</span><span class="main">∧</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Simps FunctorComp'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">G</span> <span class="main">##</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="free">G</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">G</span> <span class="main">@@</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">G</span> <span class="main">@@</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorCompMapsTo<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">f</span></span> <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="free">G</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CatDom <span class="free">F</span> <span class="main">=</span> CatDom<span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span> <span class="main">∧</span> CatCod <span class="free">G</span> <span class="main">=</span> CatCod<span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="free">G</span> <span class="main">##</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorComp'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">G</span> <span class="main">@@</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom<span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span>
        <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">G</span> <span class="main">@@</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom<span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FtorCompIdDef<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="free">G</span></span><span class="main"><span class="main">]</span></span> 1 assms<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Functors-FunctorCompMapsTo3"><span class="command">lemma</span></span> FunctorCompMapsTo3<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">≈&gt;;;;</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span> <span class="main">##</span> <span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span> <span class="main">@@</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span> <span class="main">@@</span> <span class="free">Y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> <span class="free">X</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> <span class="free">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> FunctorCompMapsTo2<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Functors-FtorCompPreFtor"><span class="command">lemma</span></span> FtorCompPreFtor<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">≈&gt;;;;</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"PreFunctor <span class="free">G</span> <span class="main">∧</span> PreFunctor <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor_def FunctorComp'_def Category.Simps
       FtorCompId<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="free">G</span></span><span class="main"><span class="main">]</span></span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>FtorCompComp'<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Category <span class="main">(</span>CatDom <span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Category <span class="main">(</span>CatCod <span class="free">G</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Functors-FtorCompM"><span class="command">lemma</span></span> FtorCompM <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">≈&gt;;;;</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"FunctorM <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> FunctorM_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> FtorCompPreFtor<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">X</span> <span class="skolem">Y</span> <span class="skolem">f</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="skolem">X</span> <span class="keyword1">to</span> <span class="skolem">Y</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span> <span class="main">##</span> <span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span> <span class="main">@@</span> <span class="skolem">X</span> <span class="keyword1">to</span> <span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span> <span class="main">@@</span> <span class="skolem">Y</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> a assms 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> FunctorCompMapsTo3<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"FunctorM_axioms <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 1 FunctorM_axioms_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Functors-FtorComp"><span class="command">lemma</span></span> FtorComp<span class="main">:</span>   
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">≈&gt;;;;</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"Functor <span class="main">(</span><span class="free">F</span> <span class="main">;;;</span> <span class="free">G</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"FunctorM <span class="main">(</span><span class="free">F</span> <span class="main">;;:</span> <span class="free">G</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> FtorCompM<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorComp_def MakeFtor<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Functor<span class="main">)</span> FunctorPreservesIso<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span>     <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">k</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>       <span class="quoted"><span class="quoted">"<span class="keyword1">ciso</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">k</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.IsoIsMor<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cinv</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">k</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">Cinv</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">k</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> Category.Inverse_relI<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Category <span class="main">(</span>CatCod <span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">k</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">Cinv</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">k</span><span class="main">)</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> FunctorCompDef<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.IsoCompInv assms<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">k</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">Cinv</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">k</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">k</span><span class="main">)</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span>      <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">k</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">Cinv</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">k</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="free">k</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Cinv</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">k</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorComp Category.IsoCompInv<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">k</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.IsoInvId2<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">k</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorId3Dom<span class="main">)</span> 
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span> 
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">Cinv</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">k</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">k</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">k</span><span class="main">)</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span>      <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">Cinv</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">k</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">k</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">Cinv</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">k</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span>  <span class="free">k</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorComp Category.InvCompIso<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">k</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.IsoInvId1<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="free">k</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorId3Cod<span class="main">)</span> 
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>   
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> isomorphism_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">declare</span></span> PreFunctor.CatDom<span class="main">[</span><span class="operator">simp</span><span class="main">]</span> PreFunctor.CatCod <span class="main">[</span><span class="operator">simp</span><span class="main">]</span>

<span class="keyword1" id="Functors-FunctorMFunctor"><span class="command">lemma</span></span> FunctorMFunctor<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"Functor <span class="free">F</span> <span class="main">⟹</span> FunctorM <span class="free">F</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Functor_def<span class="main">)</span>

<span class="keyword1"><span class="command">locale</span></span> Equivalence <span class="main">=</span> Functor <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Full<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">A</span> <span class="main">∈</span> Obj <span class="main">(</span>CatDom <span class="free">F</span><span class="main">)</span> <span class="main">;</span> <span class="free">B</span> <span class="main">∈</span> Obj <span class="main">(</span>CatDom <span class="free">F</span><span class="main">)</span> <span class="main">;</span> 
                  <span class="free">h</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">B</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span>
                 <span class="main">∃</span> <span class="bound">f</span> <span class="main">.</span> <span class="main">(</span><span class="bound">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">A</span> <span class="keyword1">to</span> <span class="free">B</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="bound">f</span> <span class="main">=</span> <span class="free">h</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Faithful<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">A</span> <span class="keyword1">to</span> <span class="free">B</span> <span class="main">;</span> <span class="free">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="free">A</span> <span class="keyword1">to</span> <span class="free">B</span> <span class="main">;</span> <span class="free">F</span> <span class="main">##</span> <span class="free">f</span> <span class="main">=</span> <span class="free">F</span> <span class="main">##</span> <span class="free">g</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">=</span> <span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> IsoDense<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">∈</span> Obj <span class="main">(</span>CatCod <span class="free">F</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">∃</span> <span class="bound">A</span> <span class="main">∈</span> Obj <span class="main">(</span>CatDom <span class="free">F</span><span class="main">)</span> <span class="main">.</span> ObjIso <span class="main">(</span>CatCod <span class="free">F</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="bound">A</span><span class="main">)</span> <span class="free">C</span>"</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="NatTrans">
<div class="head">
<h1>Theory NatTrans</h1>
</div>
<pre class="source"><span class="comment1">(*
Author: Alexander Katovsky
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Natural Transformation"</span></span>

<span class="keyword1"><span class="command">theory</span></span> NatTrans
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Functors.html">Functors</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">record</span></span> <span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">)</span> NatTrans <span class="main">=</span> 
  NTDom <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">)</span> Functor"</span></span> 
  NTCod <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">)</span> Functor"</span></span> 
  NatTransMap <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'o1</span> <span class="main">⇒</span> <span class="tfree">'m2</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span>
  <span class="entity">NatTransApp</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">)</span> NatTrans <span class="main">⇒</span> <span class="tfree">'o1</span> <span class="main">⇒</span> <span class="tfree">'m2</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1">$$</span>"</span> 70<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">NatTransApp</span> <span class="free"><span class="bound"><span class="entity">η</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">≡</span> <span class="main">(</span>NatTransMap <span class="free"><span class="bound"><span class="entity">η</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>  <span class="quoted"><span class="quoted">"<span class="free">NTCatDom</span> <span class="free"><span class="bound"><span class="entity">η</span></span></span> <span class="main">≡</span> CatDom <span class="main">(</span>NTDom <span class="free"><span class="bound"><span class="entity">η</span></span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span>  <span class="quoted"><span class="quoted">"<span class="free">NTCatCod</span> <span class="free"><span class="bound"><span class="entity">η</span></span></span> <span class="main">≡</span> CatCod <span class="main">(</span>NTCod <span class="free"><span class="bound"><span class="entity">η</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> NatTransExt <span class="main">=</span> 
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">η</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">)</span> NatTrans"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span>  NTExt <span class="main">:</span> <span class="quoted"><span class="quoted">"NatTransMap <span class="free">η</span> <span class="main">∈</span> extensional <span class="main">(</span>Obj <span class="main">(</span>NTCatDom <span class="free">η</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> NatTransP <span class="main">=</span> 
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">η</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">)</span> NatTrans"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> NatTransFtor<span class="main">:</span>   <span class="quoted"><span class="quoted">"Functor <span class="main">(</span>NTDom <span class="free">η</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     NatTransFtor2<span class="main">:</span>  <span class="quoted"><span class="quoted">"Functor <span class="main">(</span>NTCod <span class="free">η</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     NatTransFtorDom<span class="main">:</span>   <span class="quoted"><span class="quoted">"NTCatDom <span class="free">η</span> <span class="main">=</span> CatDom <span class="main">(</span>NTCod <span class="free">η</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     NatTransFtorCod<span class="main">:</span>   <span class="quoted"><span class="quoted">"NTCatCod <span class="free">η</span> <span class="main">=</span> CatCod <span class="main">(</span>NTDom <span class="free">η</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>    NatTransMapsTo<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>NTCatDom <span class="free">η</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> 
                           <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>NTDom <span class="free">η</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="main">(</span>NTCod <span class="free">η</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>    NatTrans<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatDom <span class="free">η</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span> <span class="main">⟹</span> 
                     <span class="main">(</span><span class="main">(</span>NTDom <span class="free">η</span><span class="main">)</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">Y</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>NTCod <span class="free">η</span><span class="main">)</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> NatTrans <span class="main">=</span> NatTransP <span class="main">+</span> NatTransExt

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">η</span> <span class="main">⟹</span> NatTransP <span class="free">η</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTrans_def<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">MakeNT</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">)</span> NatTrans <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">)</span> NatTrans"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
<span class="quoted"><span class="quoted">"<span class="free">MakeNT</span> <span class="free"><span class="bound"><span class="entity">η</span></span></span> <span class="main">≡</span> <span class="main">⦇</span>
      NTDom <span class="main">=</span> NTDom <span class="free"><span class="bound"><span class="entity">η</span></span></span> <span class="main">,</span> 
      NTCod <span class="main">=</span> NTCod <span class="free"><span class="bound"><span class="entity">η</span></span></span> <span class="main">,</span> 
      NatTransMap <span class="main">=</span> restrict <span class="main">(</span>NatTransMap <span class="free"><span class="bound"><span class="entity">η</span></span></span><span class="main">)</span> <span class="main">(</span>Obj <span class="main">(</span>NTCatDom <span class="free"><span class="bound"><span class="entity">η</span></span></span><span class="main">)</span><span class="main">)</span>
  <span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="entity">nt_abbrev</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">NT</span> _ <span class="keyword1">:</span> _ <span class="keyword1">⟹</span> _"</span> <span class="main">[</span>81<span class="main">]</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">NT</span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main"><span class="free">:</span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main"><span class="free">⟹</span></span> <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="main">≡</span> <span class="main">(</span>NatTrans <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>NTDom <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>NTCod <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="NatTrans-nt_abbrevE"><span class="command">lemma</span></span> nt_abbrevE<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="keyword1">NT</span> <span class="free">f</span> <span class="main">:</span> <span class="free">F</span> <span class="main">⟹</span> <span class="free">G</span> <span class="main">;</span> <span class="main">⟦</span><span class="main">(</span>NatTrans <span class="free">f</span><span class="main">)</span> <span class="main">;</span> <span class="main">(</span>NTDom <span class="free">f</span> <span class="main">=</span> <span class="free">F</span><span class="main">)</span> <span class="main">;</span> <span class="main">(</span>NTCod <span class="free">f</span> <span class="main">=</span> <span class="free">G</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nt_abbrev_def<span class="main">)</span>

<span class="keyword1" id="NatTrans-MakeNT"><span class="command">lemma</span></span> MakeNT<span class="main">:</span> <span class="quoted"><span class="quoted">"NatTransP <span class="free">η</span> <span class="main">⟹</span> NatTrans <span class="main">(</span>MakeNT <span class="free">η</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP_def NatTrans_def MakeNT_def NTCatDom_def NTCatCod_def Category.MapsToObj
    NatTransExt_def<span class="main">)</span>

<span class="keyword1" id="NatTrans-MakeNT_comp"><span class="command">lemma</span></span> MakeNT_comp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="free">f</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span>MakeNT <span class="free">f</span><span class="main">)</span> <span class="main">$$</span> <span class="free">X</span> <span class="main">=</span> <span class="free">f</span> <span class="main">$$</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeNT_def<span class="main">)</span>

<span class="keyword1" id="NatTrans-MakeNT_dom"><span class="command">lemma</span></span> MakeNT_dom<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCatDom <span class="free">f</span> <span class="main">=</span> NTCatDom <span class="main">(</span>MakeNT <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatDom_def MakeNT_def<span class="main">)</span>

<span class="keyword1" id="NatTrans-MakeNT_cod"><span class="command">lemma</span></span> MakeNT_cod<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCatCod <span class="free">f</span> <span class="main">=</span> NTCatCod <span class="main">(</span>MakeNT <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatCod_def MakeNT_def<span class="main">)</span>

<span class="keyword1" id="NatTrans-MakeNTApp"><span class="command">lemma</span></span> MakeNTApp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="main">(</span>MakeNT <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">$$</span> <span class="free">X</span> <span class="main">=</span> <span class="main">(</span>MakeNT <span class="free">f</span><span class="main">)</span> <span class="main">$$</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeNT_def NTCatDom_def<span class="main">)</span>

<span class="keyword1" id="NatTrans-NatTransMapsTo"><span class="command">lemma</span></span> NatTransMapsTo<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">NT</span> <span class="free">η</span> <span class="main">:</span> <span class="free">F</span> <span class="main">⟹</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="main">(</span>CatDom <span class="free">F</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">η</span> <span class="main">$$</span> <span class="free">X</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="free">G</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">G</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> NTP<span class="main">:</span> <span class="quoted"><span class="quoted">"NatTransP <span class="free">η</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> NTC<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCatCod <span class="free">η</span> <span class="main">=</span> CatCod <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatCod_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> NTD<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCatDom <span class="free">η</span> <span class="main">=</span> CatDom <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatDom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> Obj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="free">η</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> DF<span class="main">:</span> <span class="quoted"><span class="quoted">"NTDom <span class="free">η</span> <span class="main">=</span> <span class="free">F</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> CG<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCod <span class="free">η</span> <span class="main">=</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> NTmapsTo<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">η</span> <span class="main">$$</span> <span class="free">X</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span>NTDom <span class="free">η</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="main">(</span>NTCod <span class="free">η</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> NTP Obj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransMapsTo<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> NTC NTD DF CG <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>  
   <span class="entity">NTCompDefined</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">)</span> NatTrans 
                      <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">)</span> NatTrans <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">≈&gt;∙</span>"</span> 65<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">NTCompDefined</span> <span class="free"><span class="bound"><span class="entity">η1</span></span></span> <span class="free"><span class="bound"><span class="entity">η2</span></span></span> <span class="main">≡</span> NatTrans <span class="free"><span class="bound"><span class="entity">η1</span></span></span> <span class="main">∧</span> NatTrans <span class="free"><span class="bound"><span class="entity">η2</span></span></span> <span class="main">∧</span> NTCatDom <span class="free"><span class="bound"><span class="entity">η2</span></span></span> <span class="main">=</span> NTCatDom <span class="free"><span class="bound"><span class="entity">η1</span></span></span> <span class="main">∧</span> 
                         NTCatCod <span class="free"><span class="bound"><span class="entity">η2</span></span></span> <span class="main">=</span> NTCatCod <span class="free"><span class="bound"><span class="entity">η1</span></span></span> <span class="main">∧</span> NTCod <span class="free"><span class="bound"><span class="entity">η1</span></span></span> <span class="main">=</span> NTDom <span class="free"><span class="bound"><span class="entity">η2</span></span></span>"</span></span>

<span class="keyword1" id="NatTrans-NTCompDefinedE"><span class="command">lemma</span></span> NTCompDefinedE<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">η1</span> <span class="main">≈&gt;∙</span> <span class="free">η2</span> <span class="main">;</span> <span class="main">⟦</span>NatTrans <span class="free">η1</span> <span class="main">;</span> NatTrans <span class="free">η2</span> <span class="main">;</span> NTCatDom <span class="free">η2</span> <span class="main">=</span> NTCatDom <span class="free">η1</span> <span class="main">;</span> 
                         NTCatCod <span class="free">η2</span> <span class="main">=</span> NTCatCod <span class="free">η1</span> <span class="main">;</span> NTCod <span class="free">η1</span> <span class="main">=</span> NTDom <span class="free">η2</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCompDefined_def<span class="main">)</span>

<span class="keyword1" id="NatTrans-NTCompDefinedI"><span class="command">lemma</span></span> NTCompDefinedI<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>NatTrans <span class="free">η1</span> <span class="main">;</span> NatTrans <span class="free">η2</span> <span class="main">;</span> NTCatDom <span class="free">η2</span> <span class="main">=</span> NTCatDom <span class="free">η1</span> <span class="main">;</span> 
                         NTCatCod <span class="free">η2</span> <span class="main">=</span> NTCatCod <span class="free">η1</span> <span class="main">;</span> NTCod <span class="free">η1</span> <span class="main">=</span> NTDom <span class="free">η2</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">η1</span> <span class="main">≈&gt;∙</span> <span class="free">η2</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCompDefined_def<span class="main">)</span>

<span class="keyword1" id="NatTrans-NatTransExt0"><span class="command">lemma</span></span> NatTransExt0<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"NTDom <span class="free">η1</span> <span class="main">=</span> NTDom <span class="free">η2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"NTCod <span class="free">η1</span> <span class="main">=</span> NTCod <span class="free">η2</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">X</span> <span class="main">.</span> <span class="bound">X</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="free">η1</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">η1</span> <span class="main">$$</span> <span class="bound">X</span> <span class="main">=</span> <span class="free">η2</span> <span class="main">$$</span> <span class="bound">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     <span class="quoted"><span class="quoted">"NatTransMap <span class="free">η1</span> <span class="main">∈</span> extensional <span class="main">(</span>Obj <span class="main">(</span>NTCatDom <span class="free">η1</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     <span class="quoted"><span class="quoted">"NatTransMap <span class="free">η2</span> <span class="main">∈</span> extensional <span class="main">(</span>Obj <span class="main">(</span>NTCatDom <span class="free">η2</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="free">η1</span> <span class="main">=</span> <span class="free">η2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NatTransMap <span class="free">η1</span> <span class="main">=</span> NatTransMap <span class="free">η2</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> extensionalityI <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"NatTransMap <span class="free"><span class="free">η1</span></span>"</span></span></span> <span class="quoted"><span class="quoted"><span class="quoted">"Obj <span class="main"><span class="main">(</span></span>NTCatDom <span class="free"><span class="free">η1</span></span><span class="main"><span class="main">)</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTransMap <span class="free">η1</span> <span class="main">∈</span> extensional <span class="main">(</span>Obj <span class="main">(</span>NTCatDom <span class="free">η1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NTCatDom <span class="free">η1</span> <span class="main">=</span> NTCatDom <span class="free">η2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatDom_def<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NatTransMap <span class="free">η2</span> <span class="main">∈</span> extensional <span class="main">(</span>Obj <span class="main">(</span>NTCatDom <span class="free">η2</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTransMap <span class="free">η2</span> <span class="main">∈</span> extensional <span class="main">(</span>Obj <span class="main">(</span>NTCatDom <span class="free">η1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">X</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="free">η1</span><span class="main">)</span>"</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">η1</span> <span class="main">$$</span> <span class="skolem">X</span> <span class="main">=</span> <span class="free">η2</span> <span class="main">$$</span> <span class="skolem">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="NatTrans-NatTransExt'"><span class="command">lemma</span></span> NatTransExt'<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"NTDom <span class="free">η1'</span> <span class="main">=</span> NTDom <span class="free">η2'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"NTCod <span class="free">η1'</span> <span class="main">=</span> NTCod <span class="free">η2'</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">X</span> <span class="main">.</span> <span class="bound">X</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="free">η1'</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">η1'</span> <span class="main">$$</span> <span class="bound">X</span> <span class="main">=</span> <span class="free">η2'</span> <span class="main">$$</span> <span class="bound">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"MakeNT <span class="free">η1'</span> <span class="main">=</span> MakeNT <span class="free">η2'</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> NatTransExt0<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTransMap <span class="main">(</span>MakeNT <span class="free">η1'</span><span class="main">)</span> <span class="main">∈</span> extensional <span class="main">(</span>Obj <span class="main">(</span>NTCatDom <span class="main">(</span>MakeNT <span class="free">η1'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="quoted"><span class="quoted">"NatTransMap <span class="main">(</span>MakeNT <span class="free">η2'</span><span class="main">)</span> <span class="main">∈</span> extensional <span class="main">(</span>Obj <span class="main">(</span>NTCatDom <span class="main">(</span>MakeNT <span class="free">η2'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeNT_def NTCatDom_def NTCatCod_def NatTransExt_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTDom <span class="main">(</span>MakeNT <span class="free">η1'</span><span class="main">)</span> <span class="main">=</span> NTDom <span class="main">(</span>MakeNT <span class="free">η2'</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
    <span class="quoted"><span class="quoted">"NTCod <span class="main">(</span>MakeNT <span class="free">η1'</span><span class="main">)</span> <span class="main">=</span> NTCod <span class="main">(</span>MakeNT <span class="free">η2'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeNT_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">X</span> <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="main">(</span>MakeNT <span class="free">η1'</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>MakeNT <span class="free">η1'</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">X</span> <span class="main">=</span> <span class="main">(</span>MakeNT <span class="free">η2'</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">X</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NTCatDom <span class="main">(</span>MakeNT <span class="free">η1'</span><span class="main">)</span> <span class="main">=</span> NTCatDom <span class="main">(</span>MakeNT <span class="free">η2'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatDom_def MakeNT_def<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="main">(</span>MakeNT <span class="free">η2'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>NTCatDom <span class="free">η1'</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>NTCatDom <span class="main">(</span>MakeNT <span class="free">η1'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> MakeNT_dom<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="free">η1'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">η1'</span> <span class="main">$$</span> <span class="skolem">X</span> <span class="main">=</span> <span class="free">η2'</span> <span class="main">$$</span> <span class="skolem">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">η1'</span> <span class="main">$$</span> <span class="skolem">X</span> <span class="main">=</span> <span class="main">(</span>MakeNT <span class="free">η1'</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeNTApp<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">η2'</span> <span class="main">$$</span> <span class="skolem">X</span> <span class="main">=</span> <span class="main">(</span>MakeNT <span class="free">η2'</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 2 assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeNTApp<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>MakeNT <span class="free">η1'</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">X</span> <span class="main">=</span> <span class="main">(</span>MakeNT <span class="free">η2'</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">X</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="NatTrans-NatTransExt"><span class="command">lemma</span></span> NatTransExt<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">η1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">η2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"NTDom <span class="free">η1</span> <span class="main">=</span> NTDom <span class="free">η2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"NTCod <span class="free">η1</span> <span class="main">=</span> NTCod <span class="free">η2</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">X</span> <span class="main">.</span> <span class="bound">X</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="free">η1</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">η1</span> <span class="main">$$</span> <span class="bound">X</span> <span class="main">=</span> <span class="free">η2</span> <span class="main">$$</span> <span class="bound">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="free">η1</span> <span class="main">=</span> <span class="free">η2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NatTransMap <span class="free">η1</span> <span class="main">∈</span> extensional <span class="main">(</span>Obj <span class="main">(</span>NTCatDom <span class="free">η1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
       <span class="quoted"><span class="quoted">"NatTransMap <span class="free">η2</span> <span class="main">∈</span> extensional <span class="main">(</span>Obj <span class="main">(</span>NTCatDom <span class="free">η2</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
  <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> NatTransExt_def NatTrans_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransExt0<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">IdNatTrans'</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a1</span><span class="main">,</span> <span class="tfree">'a2</span><span class="main">)</span> Functor <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a1</span><span class="main">,</span> <span class="tfree">'a2</span><span class="main">)</span> NatTrans"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">IdNatTrans'</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">≡</span> <span class="main">⦇</span>
      NTDom <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">,</span> 
      NTCod <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">,</span> 
      NatTransMap <span class="main">=</span> <span class="main">λ</span> <span class="bound">X</span> <span class="main">.</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free"><span class="bound"><span class="entity">F</span></span></span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">@@</span> <span class="bound">X</span><span class="main">)</span>
  <span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">IdNatTrans</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">≡</span> MakeNT<span class="main">(</span>IdNatTrans' <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="NatTrans-IdNatTrans_map"><span class="command">lemma</span></span> IdNatTrans_map<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="main">(</span>IdNatTrans <span class="free">F</span><span class="main">)</span> <span class="main">$$</span> <span class="free">X</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdNatTrans_def IdNatTrans'_def MakeNT_comp MakeNT_def NTCatDom_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> IdNatTrans_defs <span class="main">=</span> IdNatTrans_def IdNatTrans'_def MakeNT_def IdNatTrans_map NTCatCod_def NTCatDom_def

<span class="keyword1" id="NatTrans-IdNatTransNatTrans'"><span class="command">lemma</span></span> IdNatTransNatTrans'<span class="main">:</span> <span class="quoted"><span class="quoted">"Functor <span class="free">F</span> <span class="main">⟹</span> NatTransP<span class="main">(</span>IdNatTrans' <span class="free">F</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>NatTransP_def IdNatTrans'_def NTCatDom_def NTCatCod_def Category.Simps 
        PreFunctor.FunctorId2 functor_simps Functor.FunctorMapsTo<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">X</span> <span class="skolem">Y</span>
    <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"Functor <span class="free">F</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatDom <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="skolem">X</span> <span class="keyword1">to</span> <span class="skolem">Y</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"Category <span class="main">(</span>CatCod <span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a b <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Functor.FunctorMapsTo<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> 
        <span class="keyword2"><span class="keyword">and</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cidr<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cidl<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="NatTrans-IdNatTransNatTrans"><span class="command">lemma</span></span> IdNatTransNatTrans<span class="main">:</span> <span class="quoted"><span class="quoted">"Functor <span class="free">F</span> <span class="main">⟹</span> NatTrans <span class="main">(</span>IdNatTrans <span class="free">F</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdNatTransNatTrans' IdNatTrans_def MakeNT<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">NatTransComp'</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">)</span> NatTrans <span class="main">⇒</span>
                   <span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">)</span> NatTrans <span class="main">⇒</span>
                   <span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">)</span> NatTrans"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">∙1</span>"</span> 75<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">NatTransComp'</span> <span class="free"><span class="bound"><span class="entity">η1</span></span></span> <span class="free"><span class="bound"><span class="entity">η2</span></span></span> <span class="main">=</span> <span class="main">⦇</span>
      NTDom <span class="main">=</span> NTDom <span class="free"><span class="bound"><span class="entity">η1</span></span></span> <span class="main">,</span> 
      NTCod <span class="main">=</span> NTCod <span class="free"><span class="bound"><span class="entity">η2</span></span></span> <span class="main">,</span> 
      NatTransMap <span class="main">=</span> <span class="main">λ</span> <span class="bound">X</span> <span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">η1</span></span></span> <span class="main">$$</span> <span class="bound">X</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free"><span class="bound"><span class="entity">η1</span></span></span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">η2</span></span></span> <span class="main">$$</span> <span class="bound">X</span><span class="main">)</span>
  <span class="main">⦈</span>"</span></span>


<span class="keyword1"><span class="command">definition</span></span> <span class="entity">NatTransComp</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">∙</span>"</span> 75<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">η1</span></span></span> <span class="main"><span class="free">∙</span></span> <span class="free"><span class="bound"><span class="entity">η2</span></span></span> <span class="main">≡</span> MakeNT<span class="main">(</span><span class="free"><span class="bound"><span class="entity">η1</span></span></span> <span class="main">∙1</span> <span class="free"><span class="bound"><span class="entity">η2</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="NatTrans-NatTransComp_Comp1"><span class="command">lemma</span></span> NatTransComp_Comp1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">x</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="free">f</span><span class="main">)</span> <span class="main">;</span> <span class="free">f</span> <span class="main">≈&gt;∙</span> <span class="free">g</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span> <span class="main">$$</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="free">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">g</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">g</span> <span class="main">$$</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp_def NatTransComp'_def MakeNT_def NTCatCod_def NTCatDom_def<span class="main">)</span>

<span class="keyword1" id="NatTrans-NatTransComp_Comp2"><span class="command">lemma</span></span> NatTransComp_Comp2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">x</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="free">f</span><span class="main">)</span> <span class="main">;</span> <span class="free">f</span> <span class="main">≈&gt;∙</span> <span class="free">g</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span> <span class="main">$$</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="free">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">f</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">g</span> <span class="main">$$</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp_def NatTransComp'_def MakeNT_def NTCatCod_def NTCatDom_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> NatTransComp_defs <span class="main">=</span> NatTransComp_def NatTransComp'_def MakeNT_def 
  NatTransComp_Comp1  NTCatCod_def NTCatDom_def

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">η1</span> <span class="main">≈&gt;∙</span> <span class="free">η2</span> <span class="main">⟹</span> NatTrans <span class="free">η1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">η1</span> <span class="main">≈&gt;∙</span> <span class="free">η2</span> <span class="main">⟹</span> NatTrans <span class="free">η2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1" id="NatTrans-NTCatDom"><span class="command">lemma</span></span> NTCatDom<span class="main">:</span>        <span class="quoted"><span class="quoted">"<span class="free">η1</span> <span class="main">≈&gt;∙</span> <span class="free">η2</span> <span class="main">⟹</span> NTCatDom <span class="free">η1</span> <span class="main">=</span> NTCatDom <span class="free">η2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1" id="NatTrans-NTCatCod"><span class="command">lemma</span></span> NTCatCod<span class="main">:</span>        <span class="quoted"><span class="quoted">"<span class="free">η1</span> <span class="main">≈&gt;∙</span> <span class="free">η2</span> <span class="main">⟹</span> NTCatCod <span class="free">η1</span> <span class="main">=</span> NTCatCod <span class="free">η2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">η1</span> <span class="main">≈&gt;∙</span> <span class="free">η2</span> <span class="main">⟹</span> NTCatDom <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span> <span class="main">=</span> NTCatDom <span class="free">η1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp'_def NTCatDom_def<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">η1</span> <span class="main">≈&gt;∙</span> <span class="free">η2</span> <span class="main">⟹</span> NTCatCod <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span> <span class="main">=</span> NTCatCod <span class="free">η1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp'_def NTCatCod_def<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">η1</span> <span class="main">≈&gt;∙</span> <span class="free">η2</span> <span class="main">⟹</span> NTCatDom <span class="main">(</span><span class="free">η1</span> <span class="main">∙</span> <span class="free">η2</span><span class="main">)</span> <span class="main">=</span> NTCatDom <span class="free">η1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp_defs<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">η1</span> <span class="main">≈&gt;∙</span> <span class="free">η2</span> <span class="main">⟹</span> NTCatCod <span class="main">(</span><span class="free">η1</span> <span class="main">∙</span> <span class="free">η2</span><span class="main">)</span> <span class="main">=</span> NTCatCod <span class="free">η1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp_defs<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">η</span> <span class="main">⟹</span> Category<span class="main">(</span>NTCatDom <span class="free">η</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  NatTransP.NatTransFtor NTCatDom_def<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">η</span> <span class="main">⟹</span> Category<span class="main">(</span>NTCatCod <span class="free">η</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  NatTransP.NatTransFtor2 NTCatCod_def<span class="main">)</span>
<span class="keyword1" id="NatTrans-DDDC"><span class="command">lemma</span></span> DDDC<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"CatDom <span class="main">(</span>NTDom <span class="free">f</span><span class="main">)</span> <span class="main">=</span> CatDom <span class="main">(</span>NTCod <span class="free">f</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CatDom <span class="main">(</span>NTDom <span class="free">f</span><span class="main">)</span> <span class="main">=</span> NTCatDom <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatDom_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransFtorDom<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1" id="NatTrans-CCCD"><span class="command">lemma</span></span> CCCD<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"CatCod <span class="main">(</span>NTCod <span class="free">f</span><span class="main">)</span> <span class="main">=</span> CatCod <span class="main">(</span>NTDom <span class="free">f</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CatCod <span class="main">(</span>NTCod <span class="free">f</span><span class="main">)</span> <span class="main">=</span> NTCatCod <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatCod_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransFtorCod<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="NatTrans-IdNatTransCompDefDom"><span class="command">lemma</span></span> IdNatTransCompDefDom<span class="main">:</span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">f</span> <span class="main">⟹</span> <span class="main">(</span>IdNatTrans <span class="main">(</span>NTDom <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">≈&gt;∙</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> NTCompDefinedI<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdNatTransNatTrans NatTransP.NatTransFtor<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdNatTrans_defs CCCD<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="NatTrans-IdNatTransCompDefCod"><span class="command">lemma</span></span> IdNatTransCompDefCod<span class="main">:</span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">f</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">≈&gt;∙</span> <span class="main">(</span>IdNatTrans <span class="main">(</span>NTCod <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> NTCompDefinedI<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdNatTransNatTrans NatTransP.NatTransFtor2<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdNatTrans_defs DDDC<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="NatTrans-NatTransCompDefCod"><span class="command">lemma</span></span> NatTransCompDefCod<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">η</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatDom <span class="free">η</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span></sub><span class="hidden">⇙</span> <span class="main">(</span>NTCod <span class="free">η</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>NTCatDom <span class="free">η</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>NTCatDom <span class="free">η</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToObj<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> d<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>NTDom <span class="free">η</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="main">(</span>NTCod <span class="free">η</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms b 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransMapsTo<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">η</span> <span class="main">$$</span> <span class="free">X</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span>NTCod <span class="free">η</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransFtorDom<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> e<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCod <span class="free">η</span> <span class="main">##</span> <span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="main">(</span>NTCod <span class="free">η</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="main">(</span>NTCod <span class="free">η</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span>NTCod <span class="free">η</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorM.FunctorCompM NatTransP.NatTransFtor2<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"NTCod <span class="free">η</span> <span class="main">##</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatCod_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>NTCod <span class="free">η</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatCod <span class="main">(</span>NTCod <span class="free">η</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="main">(</span>NTCod <span class="free">η</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span></sub><span class="hidden">⇙</span> <span class="main">(</span>NTCod <span class="free">η</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatCod_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="NatTrans-NatTransCompDefDom"><span class="command">lemma</span></span> NatTransCompDefDom<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">η</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatDom <span class="free">η</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>NTDom <span class="free">η</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span>  <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">Y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>NTCatDom <span class="free">η</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>NTCatDom <span class="free">η</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToObj<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> d<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">Y</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>NTDom <span class="free">η</span><span class="main">)</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="main">(</span>NTCod <span class="free">η</span><span class="main">)</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms c
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransMapsTo<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">η</span> <span class="main">$$</span> <span class="free">Y</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span>NTDom <span class="free">η</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatDom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> e<span class="main">:</span> <span class="quoted"><span class="quoted">"NTDom <span class="free">η</span> <span class="main">##</span> <span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="main">(</span>NTDom <span class="free">η</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="main">(</span>NTDom <span class="free">η</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span>NTDom <span class="free">η</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorM.FunctorCompM NatTransP.NatTransFtor<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"NTDom <span class="free">η</span> <span class="main">##</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransFtorCod<span class="main">)</span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">Y</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>NTDom <span class="free">η</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatCod <span class="main">(</span>NTDom <span class="free">η</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="main">(</span>NTDom <span class="free">η</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span></sub><span class="hidden">⇙</span> <span class="main">(</span>NTDom <span class="free">η</span> <span class="main">##</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">Y</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransFtorCod<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="NatTrans-NatTransCompCompDef"><span class="command">lemma</span></span> NatTransCompCompDef<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">η1</span> <span class="main">≈&gt;∙</span> <span class="free">η2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>NTCatDom <span class="free">η1</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η1</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η2</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η1</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>NTDom <span class="free">η1</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="main">(</span>NTCod <span class="free">η1</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransMapsTo<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NTCatCod <span class="free">η1</span> <span class="main">=</span> NTCatCod <span class="free">η2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η2</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>NTDom <span class="free">η2</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="main">(</span>NTCod <span class="free">η2</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransMapsTo NTCatDom<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">η1</span> <span class="main">$$</span> <span class="free">X</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">η2</span> <span class="main">$$</span> <span class="free">X</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η1</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>NTCod <span class="free">η1</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>NTDom <span class="free">η2</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η1</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η2</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
 
<span class="keyword1" id="NatTrans-NatTransCompNatTrans'"><span class="command">lemma</span></span> NatTransCompNatTrans'<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">η1</span> <span class="main">≈&gt;∙</span> <span class="free">η2</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"NatTransP <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Functor <span class="main">(</span>NTDom <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Functor <span class="main">(</span>NTCod <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp'_def NatTransP.NatTransFtor NatTransP.NatTransFtor2<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTCatDom <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span> <span class="main">=</span> CatDom <span class="main">(</span>NTCod <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
       <span class="quoted"><span class="quoted">"NTCatCod <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span> <span class="main">=</span> CatCod <span class="main">(</span>NTDom <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp'_def NTCatCod_def NTCatDom_def<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CatDom <span class="main">(</span>NTDom <span class="free">η1</span><span class="main">)</span> <span class="main">=</span> NTCatDom <span class="free">η1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatDom_def<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"CatDom <span class="main">(</span>NTDom <span class="free">η1</span><span class="main">)</span> <span class="main">=</span> CatDom <span class="main">(</span>NTCod <span class="free">η2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransFtorDom<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CatCod <span class="main">(</span>NTCod <span class="free">η2</span><span class="main">)</span> <span class="main">=</span> NTCatCod <span class="free">η2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatCod_def<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"CatCod <span class="main">(</span>NTCod <span class="free">η2</span><span class="main">)</span> <span class="main">=</span> CatCod <span class="main">(</span>NTDom <span class="free">η1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransFtorCod<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">X</span> <span class="keyword3"><span class="command">assume</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>NTCatDom <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">X</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatCod <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span></sub><span class="hidden">⇙</span> NTDom <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span> <span class="keyword1">to</span> NTCod <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>NTCatDom <span class="free">η1</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">η1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms aa <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η1</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>NTDom <span class="free">η1</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="main">(</span>NTCod <span class="free">η1</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransMapsTo<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η2</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>NTCod <span class="free">η1</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="main">(</span>NTCod <span class="free">η2</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>NTCatDom <span class="free">η2</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">η2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms aa <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η2</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η2</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>NTDom <span class="free">η2</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="main">(</span>NTCod <span class="free">η2</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransMapsTo<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η1</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η2</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>NTDom <span class="free">η1</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="main">(</span>NTCod <span class="free">η2</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Ccompt<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp'_def NTCatCod_def<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">X</span> <span class="skolem">Y</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="main">(</span>NTCatDom <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="skolem">X</span> <span class="keyword1">to</span> <span class="skolem">Y</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>NTDom <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">=</span>
       <span class="main">(</span><span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="main">(</span>NTCod <span class="main">(</span><span class="free">η1</span> <span class="main">∙1</span> <span class="free">η2</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>NTCatDom <span class="free">η1</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>NTCatDom <span class="free">η1</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToObj<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>NTDom <span class="free">η1</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="free">η1</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η2</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> 
            <span class="main">(</span><span class="main">(</span><span class="main">(</span>NTDom <span class="free">η1</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η1</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η2</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>NTDom <span class="free">η1</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η1</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransCompDefDom<span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η1</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span>  <span class="main">(</span><span class="free">η2</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransCompCompDef c<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cassoc<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">η1</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>NTDom <span class="free">η2</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η2</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTrans<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">η1</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span>NTDom <span class="free">η2</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η2</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η1</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>NTCod <span class="free">η1</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransCompDefCod<span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>NTDom <span class="free">η2</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η2</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms a 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransCompDefDom NTCatDom NTCatCod<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cassoc<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">η1</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="free">η2</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>NTCod <span class="free">η2</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> assms a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTrans NTCatDom NTCatCod<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">η1</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η2</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>NTCod <span class="free">η2</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η1</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η2</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransCompCompDef b<span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η2</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">η1</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>NTCod <span class="free">η2</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms a 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransCompDefCod NTCatCod NTCatDom<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cassoc<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp'_def NTCatCod_def<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="NatTrans-NatTransCompNatTrans"><span class="command">lemma</span></span> NatTransCompNatTrans<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">η1</span> <span class="main">≈&gt;∙</span> <span class="free">η2</span> <span class="main">⟹</span> NatTrans <span class="main">(</span><span class="free">η1</span> <span class="main">∙</span> <span class="free">η2</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransCompNatTrans' NatTransComp_def MakeNT<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">CatExp'</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span><span class="tfree">'m1</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> Category_scheme <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'o2</span><span class="main">,</span><span class="tfree">'m2</span><span class="main">,</span><span class="tfree">'b</span><span class="main">)</span> Category_scheme <span class="main">⇒</span> 
                     <span class="main">(</span><span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">)</span> Functor<span class="main">,</span> 
                      <span class="main">(</span><span class="tfree">'o1</span><span class="main">,</span> <span class="tfree">'o2</span><span class="main">,</span> <span class="tfree">'m1</span><span class="main">,</span> <span class="tfree">'m2</span><span class="main">,</span> <span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span><span class="main">)</span> NatTrans<span class="main">)</span> Category"</span></span>  <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">CatExp'</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">≡</span> <span class="main">⦇</span>
      Category.Obj <span class="main">=</span> <span class="main">{</span><span class="bound">F</span> <span class="main">.</span> <span class="keyword1">Ftor</span> <span class="bound">F</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">⟶</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">}</span> <span class="main">,</span> 
      Category.Mor <span class="main">=</span> <span class="main">{</span><span class="bound">η</span> <span class="main">.</span> NatTrans <span class="bound">η</span> <span class="main">∧</span> NTCatDom <span class="bound">η</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∧</span> NTCatCod <span class="bound">η</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">}</span> <span class="main">,</span> 
      Category.Dom <span class="main">=</span> NTDom <span class="main">,</span> 
      Category.Cod <span class="main">=</span> NTCod <span class="main">,</span> 
      Category.Id  <span class="main">=</span> IdNatTrans <span class="main">,</span> 
      Category.Comp <span class="main">=</span> <span class="main">λ</span><span class="bound">f</span> <span class="bound">g</span><span class="main">.</span> <span class="main">(</span><span class="bound">f</span> <span class="main">∙</span> <span class="bound">g</span><span class="main">)</span>
  <span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">CatExp</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">≡</span> MakeCat<span class="main">(</span>CatExp' <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="NatTrans-IdNatTransMapL"><span class="command">lemma</span></span> IdNatTransMapL<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> NT<span class="main">:</span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IdNatTrans <span class="main">(</span>NTDom <span class="free">f</span><span class="main">)</span> <span class="main">∙</span> <span class="free">f</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> NatTransExt<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="main">(</span>IdNatTrans <span class="main">(</span>NTDom <span class="free">f</span><span class="main">)</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> NT 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransFtor IdNatTransNatTrans IdNatTransCompDefDom NatTransCompNatTrans<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTDom <span class="main">(</span>IdNatTrans <span class="main">(</span>NTDom <span class="free">f</span><span class="main">)</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> NTDom <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="quoted"><span class="quoted">"NTCod <span class="main">(</span>IdNatTrans <span class="main">(</span>NTDom <span class="free">f</span><span class="main">)</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> NTCod <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdNatTrans_defs NatTransComp_defs<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="main">(</span>IdNatTrans <span class="main">(</span>NTDom <span class="free">f</span><span class="main">)</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>IdNatTrans <span class="main">(</span>NTDom <span class="free">f</span><span class="main">)</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> XObj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> Obj<span class="main">(</span>NTCatDom <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aa <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdNatTrans_defs NatTransComp_defs<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> fMap<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">f</span></sub><span class="hidden">⇙</span> NTDom <span class="free">f</span> <span class="main">@@</span> <span class="skolem">x</span> <span class="keyword1">to</span> NTCod <span class="free">f</span> <span class="main">@@</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> NT XObj
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransMapsTo<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>IdNatTrans <span class="main">(</span>NTDom <span class="free">f</span><span class="main">)</span> <span class="main">∙</span> <span class="free">f</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span>IdNatTrans <span class="main">(</span>NTDom <span class="free">f</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">f</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> NatTransComp_Comp1<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>NTCatDom <span class="main">(</span>IdNatTrans <span class="main">(</span>NTDom <span class="free">f</span><span class="main">)</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> XObj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdNatTrans_defs<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IdNatTrans <span class="main">(</span>NTDom <span class="free">f</span><span class="main">)</span> <span class="main">≈&gt;∙</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> NT <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdNatTransCompDefDom<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">f</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">f</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">f</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> XObj NT fMap <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdNatTrans_map NTCatDom_def CCCD NTCatCod_def<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span>"</span></span>  
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">f</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fMap <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> NT <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cidl<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="NatTrans-IdNatTransMapR"><span class="command">lemma</span></span> IdNatTransMapR<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> NT<span class="main">:</span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∙</span> IdNatTrans <span class="main">(</span>NTCod <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> NatTransExt<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> IdNatTrans <span class="main">(</span>NTCod <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> NT 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransFtor IdNatTransNatTrans IdNatTransCompDefCod NatTransCompNatTrans<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTDom <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> IdNatTrans <span class="main">(</span>NTCod <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> NTDom <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="quoted"><span class="quoted">"NTCod <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> IdNatTrans <span class="main">(</span>NTCod <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> NTCod <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdNatTrans_defs NatTransComp_defs<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> IdNatTrans <span class="main">(</span>NTCod <span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">∙</span> IdNatTrans <span class="main">(</span>NTCod <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> XObj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> Obj<span class="main">(</span>NTCatDom <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aa <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  NatTransComp_defs<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> fMap<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">f</span></sub><span class="hidden">⇙</span> NTDom <span class="free">f</span> <span class="main">@@</span> <span class="skolem">x</span> <span class="keyword1">to</span> NTCod <span class="free">f</span> <span class="main">@@</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> NT XObj
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransP.NatTransMapsTo<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">∙</span> IdNatTrans <span class="main">(</span>NTCod <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">f</span></sub><span class="hidden">⇙</span> <span class="main">(</span>IdNatTrans <span class="main">(</span>NTCod <span class="free">f</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> XObj NT <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp_Comp2 IdNatTransCompDefCod<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">f</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">f</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">f</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span>NTCod <span class="free">f</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> XObj NT <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdNatTrans_defs DDDC<span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">f</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>NTCod <span class="free">f</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fMap <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>IdNatTrans <span class="main">(</span>NTCod <span class="free">f</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">f</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">f</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdNatTrans_map NTCatCod_def<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">f</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fMap <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> NT <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cidr<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="NatTrans-NatTransCompDefined"><span class="command">lemma</span></span> NatTransCompDefined<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;∙</span> <span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">≈&gt;∙</span> <span class="free">h</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span> <span class="main">≈&gt;∙</span> <span class="free">h</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;∙</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span> <span class="main">≈&gt;∙</span> <span class="free">h</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> NTCompDefinedI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">h</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransCompNatTrans<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NTCatDom <span class="free">f</span> <span class="main">=</span> NTCatDom <span class="free">h</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatDom<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"NTCatDom <span class="free">h</span> <span class="main">=</span> NTCatDom <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp_defs<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NTCatCod <span class="free">h</span> <span class="main">=</span> NTCatCod <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatCod<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"NTCatCod <span class="free">h</span> <span class="main">=</span> NTCatCod <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp_defs<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTCod <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> NTDom <span class="free">h</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp_defs<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;∙</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> NTCompDefinedI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransCompNatTrans<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NTCatDom <span class="free">f</span> <span class="main">=</span> NTCatDom <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatDom<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"NTCatDom <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span> <span class="main">=</span> NTCatDom <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp_defs<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NTCatCod <span class="free">h</span> <span class="main">=</span> NTCatCod <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatCod<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"NTCatCod <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span> <span class="main">=</span> NTCatCod <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp_defs<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTCod <span class="free">f</span> <span class="main">=</span> NTDom <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp_defs<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="NatTrans-NatTransCompAssoc"><span class="command">lemma</span></span> NatTransCompAssoc<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;∙</span> <span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">≈&gt;∙</span> <span class="free">h</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span> <span class="main">∙</span> <span class="free">h</span> <span class="main">=</span> <span class="free">f</span> <span class="main">∙</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> NatTransExt<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransCompNatTrans NatTransCompDefined<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransCompNatTrans NatTransCompDefined<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTDom <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span> <span class="main">=</span> NTDom <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"NTCod <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span> <span class="main">=</span> NTCod <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp_defs<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>NTCatDom <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> ntd1<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCatDom <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> NTCatDom <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ntd2<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCatDom <span class="free">f</span> <span class="main">=</span> NTCatDom <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransCompDefined<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
      <span class="keyword1"><span class="command">have</span></span> obj1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aa ntd2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span>  1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">h</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">g</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
            2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">g</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">h</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">h</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> obj1
        <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp_Comp1<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">h</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">h</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> NatTransComp_Comp1<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>NTCatDom <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aa ntd1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∙</span> <span class="free">g</span> <span class="main">≈&gt;∙</span> <span class="free">h</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransCompDefined<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">h</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">g</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">h</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">h</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">h</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="free">g</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">h</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">h</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCatCod <span class="free">h</span> <span class="main">=</span> NTCatCod <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCatCod <span class="free">h</span> <span class="main">=</span> NTCatCod <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatCod<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">h</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">g</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> obj1 assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransCompCompDef<span class="main">)</span> 
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">g</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">h</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">h</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> obj1 assms 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransCompCompDef NTCatDom<span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Category <span class="main">(</span>NTCatCod <span class="free">h</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cassoc<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">h</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NTCatCod <span class="free">f</span> <span class="main">=</span> NTCatCod <span class="free">h</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatCod<span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="free">f</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="free">g</span> <span class="main">∙</span> <span class="free">h</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">x</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> NatTransComp_Comp2<span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>NTCatDom <span class="free">f</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> obj1 assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatDom<span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;∙</span> <span class="free">g</span> <span class="main">∙</span> <span class="free">h</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransCompDefined<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="NatTrans-CatExpCatAx"><span class="command">lemma</span></span> CatExpCatAx<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Category <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Category <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Category_axioms <span class="main">(</span>CatExp' <span class="free">A</span> <span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category_axioms_def<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span>"</span></span> 
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
         <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def NatTransP.NatTransFtor 
        NatTransP.NatTransFtor2 NatTransP.NatTransFtorDom NatTransP.NatTransFtorCod DDDC CCCD functor_abbrev_def<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">F</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">F</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span>"</span></span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">F</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">F</span> <span class="keyword1">to</span> <span class="skolem">F</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> MapsToI<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="skolem">F</span> <span class="main">:</span> <span class="free">A</span> <span class="main">⟶</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">F</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span>"</span></span> 
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def NTCatDom_def NTCatCod_def IdNatTransNatTrans functor_abbrev_def<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdNatTrans_defs<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">F</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">F</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def IdNatTrans_defs<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">F</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">F</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def IdNatTrans_defs<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span>"</span></span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span> <span class="main">=</span> <span class="skolem">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
         <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">f</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> NT<span class="main">:</span> <span class="quoted"><span class="quoted">"NatTrans <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IdNatTrans <span class="main">(</span>NTDom <span class="skolem">f</span><span class="main">)</span> <span class="main">∙</span> <span class="skolem">f</span> <span class="main">=</span> <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> NT <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>IdNatTransMapL<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∙</span> IdNatTrans <span class="main">(</span>NTCod <span class="skolem">f</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> NT <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>IdNatTransMapR<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">g</span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> bb<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span>"</span></span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">g</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">≈&gt;∙</span> <span class="skolem">g</span>"</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> NTCompDefined_def<span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  CatExp'_def<span class="main">)</span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">≈&gt;∙</span> <span class="skolem">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">≈&gt;∙</span> <span class="skolem">h</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aa bb <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span> <span class="main">=</span> <span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def NatTransCompAssoc<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">g</span> <span class="skolem">X</span> <span class="skolem">Y</span> <span class="skolem">Z</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">X</span> <span class="keyword1">to</span> <span class="skolem">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="keyword1">to</span> <span class="skolem">Z</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="skolem">X</span> <span class="keyword1">to</span> <span class="skolem">Z</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> MapsToI<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> nt1<span class="main">:</span> <span class="quoted"><span class="quoted">"NatTrans <span class="skolem">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cd1<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCatDom <span class="skolem">f</span> <span class="main">=</span> <span class="free">A</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> cc1<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCatCod <span class="skolem">f</span> <span class="main">=</span> <span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> d1<span class="main">:</span> <span class="quoted"><span class="quoted">"NTDom <span class="skolem">f</span> <span class="main">=</span> <span class="skolem">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c1<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCod <span class="skolem">f</span> <span class="main">=</span> <span class="skolem">Y</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> nt2<span class="main">:</span> <span class="quoted"><span class="quoted">"NatTrans <span class="skolem">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cd2<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCatDom <span class="skolem">g</span> <span class="main">=</span> <span class="free">A</span>"</span></span> 
        <span class="keyword2"><span class="keyword">and</span></span> cc2<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCatCod <span class="skolem">g</span> <span class="main">=</span> <span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> d2<span class="main">:</span> <span class="quoted"><span class="quoted">"NTDom <span class="skolem">g</span> <span class="main">=</span> <span class="skolem">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c2<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCod <span class="skolem">g</span> <span class="main">=</span> <span class="skolem">Z</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> Comp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">≈&gt;∙</span> <span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> NTCompDefinedI<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="main">(</span><span class="skolem">f</span> <span class="main">∙</span> <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransCompNatTrans<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTCatDom <span class="main">(</span><span class="skolem">f</span> <span class="main">∙</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Comp cd1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatDom<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTCatCod <span class="main">(</span><span class="skolem">f</span> <span class="main">∙</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">=</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Comp cc2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatCod<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTDom <span class="main">(</span><span class="skolem">f</span> <span class="main">∙</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp_defs<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTCod <span class="main">(</span><span class="skolem">f</span> <span class="main">∙</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">Z</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> c2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp_defs<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="NatTrans-CatExpCat"><span class="command">lemma</span></span> CatExpCat<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>Category <span class="free">A</span> <span class="main">;</span> Category <span class="free">B</span><span class="main">⟧</span> <span class="main">⟹</span> Category <span class="main">(</span>CatExp <span class="free">A</span> <span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExpCatAx CatExp_def MakeCat<span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> CatExp_defs <span class="main">=</span> CatExp_def CatExp'_def MakeCat_def

<span class="keyword1" id="NatTrans-CatExpDom"><span class="command">lemma</span></span> CatExpDom<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="main">(</span>CatExp <span class="free">A</span> <span class="free">B</span><span class="main">)</span> <span class="main">⟹</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatExp <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> NTDom <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp_defs<span class="main">)</span>

<span class="keyword1" id="NatTrans-CatExpCod"><span class="command">lemma</span></span> CatExpCod<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="main">(</span>CatExp <span class="free">A</span> <span class="free">B</span><span class="main">)</span> <span class="main">⟹</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatExp <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> NTCod <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp_defs<span class="main">)</span>

<span class="keyword1" id="NatTrans-CatExpId"><span class="command">lemma</span></span> CatExpId<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="main">(</span>CatExp <span class="free">A</span> <span class="free">B</span><span class="main">)</span> <span class="main">⟹</span> Id <span class="main">(</span>CatExp <span class="free">A</span> <span class="free">B</span><span class="main">)</span> <span class="free">X</span> <span class="main">=</span> IdNatTrans <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp_defs<span class="main">)</span>

<span class="keyword1" id="NatTrans-CatExpNatTransCompDef"><span class="command">lemma</span></span> CatExpNatTransCompDef<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CatExp <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;∙</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp_def MakeCatCompDef<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;∙</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> NTCompDefinedI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTCatDom <span class="free">g</span> <span class="main">=</span> NTCatDom <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTCatCod <span class="free">g</span> <span class="main">=</span> NTCatCod <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTCod <span class="free">f</span> <span class="main">=</span> NTDom <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="NatTrans-CatExpDist"><span class="command">lemma</span></span> CatExpDist<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CatExp <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatExp <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">$$</span> <span class="free">X</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">B</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">g</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="main">(</span>CatExp' <span class="free">A</span> <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp_def MakeCatMor<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCatDom <span class="free">f</span> <span class="main">=</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCatCod <span class="free">f</span> <span class="main">=</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">hence</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;∙</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExpNatTransCompDef<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatExp <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">$$</span> <span class="free">X</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatExp' <span class="free">A</span> <span class="free">B</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">$$</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp_def MakeCatComp2<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">∙</span> <span class="free">g</span><span class="main">)</span> <span class="main">$$</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">B</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">g</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 4 2 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransComp_Comp2<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">X</span></span> <span class="quoted"><span class="free">f</span></span> <span class="quoted"><span class="free">g</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>    

<span class="keyword1" id="NatTrans-CatExpMorNT"><span class="command">lemma</span></span> CatExpMorNT<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="main">(</span>CatExp <span class="free">A</span> <span class="free">B</span><span class="main">)</span> <span class="main">⟹</span> NatTrans <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp_defs<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>

</pre>
</div><div id="SetCat">
<div class="head">
<h1>Theory SetCat</h1>
</div>
<pre class="source"><span class="comment1">(*
Author: Alexander Katovsky
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"The Category of Sets"</span></span>

<span class="keyword1"><span class="command">theory</span></span> SetCat
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Functors.html">Functors</a> <a href="Universe.html">Universe</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">notation</span></span> Elem <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">|∈|</span>"</span> 70<span class="main">)</span>
<span class="keyword1"><span class="command">notation</span></span> HOLZF.subset <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">|⊆|</span>"</span> 71<span class="main">)</span>
<span class="keyword1"><span class="command">notation</span></span> CartProd <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">|×|</span>"</span> 75<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="entity">ZFfun</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"ZF <span class="main">⇒</span> ZF <span class="main">⇒</span> <span class="main">(</span>ZF <span class="main">⇒</span> ZF<span class="main">)</span> <span class="main">⇒</span> ZF"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ZFfun</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">≡</span> Opair <span class="main">(</span>Opair <span class="free"><span class="bound"><span class="entity">d</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span> <span class="main">(</span>Lambda <span class="free"><span class="bound"><span class="entity">d</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">ZFfunDom</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"ZF <span class="main">⇒</span> ZF"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">|dom|</span>_"</span> <span class="main">[</span>72<span class="main">]</span> 72<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ZFfunDom</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">≡</span> Fst <span class="main">(</span>Fst <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">ZFfunCod</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"ZF <span class="main">⇒</span> ZF"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">|cod|</span>_"</span> <span class="main">[</span>72<span class="main">]</span> 72<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ZFfunCod</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">≡</span> Snd <span class="main">(</span>Fst <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">ZFfunApp</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"ZF <span class="main">⇒</span> ZF <span class="main">⇒</span> ZF"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">|@|</span>"</span> 73<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ZFfunApp</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> app <span class="main">(</span>Snd <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="entity">ZFfunComp</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"ZF <span class="main">⇒</span> ZF <span class="main">⇒</span> ZF"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">|o|</span>"</span> 72<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ZFfunComp</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">≡</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">|@|</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="entity">isZFfun</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"ZF <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">isZFfun</span> <span class="free"><span class="bound"><span class="entity">drf</span></span></span> <span class="main">≡</span> <span class="keyword1">let</span> <span class="bound">f</span> <span class="main">=</span> Snd <span class="free"><span class="bound"><span class="entity">drf</span></span></span> <span class="keyword1">in</span>
                 isOpair <span class="free"><span class="bound"><span class="entity">drf</span></span></span> <span class="main">∧</span> isOpair <span class="main">(</span>Fst <span class="free"><span class="bound"><span class="entity">drf</span></span></span><span class="main">)</span> <span class="main">∧</span> isFun <span class="bound">f</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">f</span> <span class="main">|⊆|</span> <span class="main">(</span>Domain <span class="bound">f</span><span class="main">)</span> <span class="main">|×|</span> <span class="main">(</span>Range <span class="bound">f</span><span class="main">)</span><span class="main">)</span>
                 <span class="main">∧</span> <span class="main">(</span>Domain <span class="bound">f</span> <span class="main">=</span> <span class="keyword1">|dom|</span> <span class="free"><span class="bound"><span class="entity">drf</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>Range <span class="bound">f</span> <span class="main">|⊆|</span> <span class="keyword1">|cod|</span> <span class="free"><span class="bound"><span class="entity">drf</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="SetCat-isZFfunE"><span class="command">lemma</span></span> isZFfunE<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>isZFfun <span class="free">f</span> <span class="main">;</span> 
  <span class="main">⟦</span>isOpair <span class="free">f</span> <span class="main">;</span> isOpair <span class="main">(</span>Fst <span class="free">f</span><span class="main">)</span> <span class="main">;</span> isFun <span class="main">(</span>Snd <span class="free">f</span><span class="main">)</span> <span class="main">;</span> 
  <span class="main">(</span><span class="main">(</span>Snd <span class="free">f</span><span class="main">)</span> <span class="main">|⊆|</span> <span class="main">(</span>Domain <span class="main">(</span>Snd <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">|×|</span> <span class="main">(</span>Range <span class="main">(</span>Snd <span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">;</span> 
  <span class="main">(</span>Domain <span class="main">(</span>Snd <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>Range <span class="main">(</span>Snd <span class="free">f</span><span class="main">)</span> <span class="main">|⊆|</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> isZFfun_def Let_def<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span>  
  <span class="entity">SET'</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ZF<span class="main">,</span> ZF<span class="main">)</span> Category"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">SET'</span> <span class="main">≡</span> <span class="main">⦇</span>
      Category.Obj <span class="main">=</span> <span class="main">{</span><span class="bound">x</span> <span class="main">.</span> True<span class="main">}</span> <span class="main">,</span> 
      Category.Mor <span class="main">=</span> <span class="main">{</span><span class="bound">f</span> <span class="main">.</span> isZFfun <span class="bound">f</span><span class="main">}</span> <span class="main">,</span>
      Category.Dom <span class="main">=</span> ZFfunDom <span class="main">,</span> 
      Category.Cod <span class="main">=</span> ZFfunCod <span class="main">,</span> 
      Category.Id <span class="main">=</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> ZFfun <span class="bound">x</span> <span class="bound">x</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="main">.</span> <span class="bound">x</span><span class="main">)</span> <span class="main">,</span> 
      Category.Comp <span class="main">=</span> ZFfunComp
  <span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">SET</span> <span class="main">≡</span> MakeCat SET'"</span></span>

<span class="keyword1" id="SetCat-ZFfunDom"><span class="command">lemma</span></span> ZFfunDom<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">|dom|</span> <span class="main">(</span>ZFfun <span class="free">A</span> <span class="free">B</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfun_def ZFfunDom_def Fst<span class="main">)</span>

<span class="keyword1" id="SetCat-ZFfunCod"><span class="command">lemma</span></span> ZFfunCod<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">|cod|</span> <span class="main">(</span>ZFfun <span class="free">A</span> <span class="free">B</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfun_def ZFfunCod_def Snd Fst<span class="main">)</span>

<span class="keyword1" id="SetCat-SETfun"><span class="command">lemma</span></span> SETfun<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="free">A</span> <span class="main">⟶</span> <span class="main">(</span><span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="main">|∈|</span> <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"isZFfun <span class="main">(</span>ZFfun <span class="free">A</span> <span class="free">B</span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> isZFfun_def ZFfun_def isOpair Fst Snd 
    ZFfunCod_def ZFfunDom_def isFun_Lambda domain_Lambda Let_def<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">|∈|</span> Range <span class="main">(</span>Lambda <span class="free">A</span> <span class="free">f</span><span class="main">)</span> <span class="main">⟹</span> <span class="skolem">x</span> <span class="main">|∈|</span> <span class="free">B</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">insert</span> isFun_Lambda<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">A</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">f</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">drule</span> fun_range_witness<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"Lambda <span class="free"><span class="free">A</span></span> <span class="free"><span class="free">f</span></span>"</span></span></span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">x</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> domain_Lambda Lambda_app assms<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"subset <span class="main">(</span>Range <span class="main">(</span>Lambda <span class="free">A</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> subset_def<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">|∈|</span> <span class="main">(</span>Lambda <span class="free">A</span> <span class="free">f</span><span class="main">)</span> <span class="main">⟹</span> <span class="skolem">x</span> <span class="main">|∈|</span> <span class="free">A</span> <span class="main">|×|</span> Range <span class="main">(</span>Lambda <span class="free">A</span> <span class="free">f</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CartProd Lambda_def Repl Range<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Lambda <span class="free">A</span> <span class="free">f</span><span class="main">)</span> <span class="main">|⊆|</span> <span class="main">(</span><span class="free">A</span> <span class="main">|×|</span> Range <span class="main">(</span>Lambda <span class="free">A</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HOLZF.subset_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-ZFCartProd"><span class="command">lemma</span></span> ZFCartProd<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">|∈|</span> <span class="free">A</span> <span class="main">|×|</span> <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"Fst <span class="free">x</span> <span class="main">|∈|</span> <span class="free">A</span> <span class="main">∧</span> Snd <span class="free">x</span> <span class="main">|∈|</span> <span class="free">B</span> <span class="main">∧</span> isOpair <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> CartProd <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="skolem"><span class="skolem">b</span></span> 
    <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">|∈|</span> <span class="free">A</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span>   <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">|∈|</span> <span class="free">B</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span>   <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> Opair <span class="skolem">a</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Fst Snd isOpair_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-ZFfunDomainOpair"><span class="command">lemma</span></span> ZFfunDomainOpair<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"isFun <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">|∈|</span> Domain <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"Opair <span class="free">x</span> <span class="main">(</span>app <span class="free">f</span> <span class="free">x</span><span class="main">)</span> <span class="main">|∈|</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃!</span> <span class="bound">y</span> <span class="main">.</span> Opair <span class="free">x</span> <span class="bound">y</span> <span class="main">|∈|</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> unique_fun_value<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"Opair <span class="free">x</span> <span class="main">(</span>app <span class="free">f</span> <span class="free">x</span><span class="main">)</span> <span class="main">|∈|</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> app_def <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> theI'<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="SetCat-ZFFunToLambda"><span class="command">lemma</span></span> ZFFunToLambda<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"isFun <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">|⊆|</span> <span class="main">(</span>Domain <span class="free">f</span><span class="main">)</span> <span class="main">|×|</span> <span class="main">(</span>Range <span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> Lambda <span class="main">(</span>Domain <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> app <span class="free">f</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">subst</span> Ext<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> iffI<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">|∈|</span> <span class="free">f</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">|∈|</span> Lambda <span class="main">(</span>Domain <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> app <span class="free">f</span> <span class="bound">x</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Lambda_def Repl<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">(</span></span>Fst <span class="skolem"><span class="skolem">x</span></span><span class="main"><span class="main">)</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> conjI<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">"isOpair <span class="skolem">x</span> <span class="main">∧</span> Fst <span class="skolem">x</span> <span class="main">|∈|</span> Domain <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 2 a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> subset_def ZFCartProd<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"Fst <span class="skolem">x</span> <span class="main">|∈|</span> Domain <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"Opair <span class="main">(</span>Fst <span class="skolem">x</span><span class="main">)</span> <span class="main">(</span>app <span class="free">f</span> <span class="main">(</span>Fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">|∈|</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunDomainOpair<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Opair <span class="main">(</span>Fst <span class="skolem">x</span><span class="main">)</span> <span class="main">(</span>Snd <span class="skolem">x</span><span class="main">)</span> <span class="main">|∈|</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FstSnd subset_def b<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Snd <span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span>app <span class="free">f</span> <span class="main">(</span>Fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> isFun_def<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"Opair <span class="main">(</span>Fst <span class="skolem">x</span><span class="main">)</span> <span class="main">(</span>app <span class="free">f</span> <span class="main">(</span>Fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Opair <span class="main">(</span>Fst <span class="skolem">x</span><span class="main">)</span> <span class="main">(</span>Snd <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FstSnd<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> Opair <span class="main">(</span>Fst <span class="skolem">x</span><span class="main">)</span> <span class="main">(</span>app <span class="free">f</span> <span class="main">(</span>Fst <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> 
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">|∈|</span> Lambda <span class="main">(</span>Domain <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> app <span class="free">f</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">|∈|</span> <span class="free">f</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">from</span></span> Lambda_def <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">|∈|</span> Domain <span class="free">f</span> <span class="main">∧</span> <span class="skolem">x</span> <span class="main">=</span> Opair <span class="skolem">a</span> <span class="main">(</span>app <span class="free">f</span> <span class="skolem">a</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Repl<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> a 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunDomainOpair<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>   

<span class="keyword1" id="SetCat-ZFfunApp"><span class="command">lemma</span></span> ZFfunApp<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">|∈|</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="main">(</span>ZFfun <span class="free">A</span> <span class="free">B</span> <span class="free">f</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span> <span class="main">=</span> <span class="free">f</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ZFfun <span class="free">A</span> <span class="free">B</span> <span class="free">f</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span> <span class="main">=</span> app <span class="main">(</span>Lambda <span class="free">A</span> <span class="free">f</span><span class="main">)</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfun_def ZFfunApp_def Snd<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">f</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Lambda_app<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-ZFfun"><span class="command">lemma</span></span> ZFfun<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"isZFfun <span class="free">f</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfun_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"isOpair <span class="free">f</span> <span class="main">∧</span> isOpair <span class="main">(</span>Fst <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> isZFfun_def<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">f</span></span><span class="main"><span class="main">]</span></span> Let_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> Opair <span class="main">(</span>Opair <span class="main">(</span>Fst <span class="main">(</span>Fst <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Snd <span class="main">(</span>Fst <span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Snd <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FstSnd<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> Opair <span class="main">(</span>Opair <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Snd <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunDom_def ZFfunCod_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Snd <span class="free">f</span> <span class="main">=</span> Lambda <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">|dom|</span> <span class="free">f</span> <span class="main">=</span> Domain <span class="main">(</span>Snd <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> isZFfun_def<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">f</span></span><span class="main"><span class="main">]</span></span> Let_def<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"isFun <span class="main">(</span>Snd <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> isZFfun_def<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">f</span></span><span class="main"><span class="main">]</span></span> Let_def<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="main">.</span> app <span class="main">(</span>Snd <span class="free">f</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span>"</span></span>  <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunApp_def<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Snd <span class="free">f</span><span class="main">)</span> <span class="main">|⊆|</span> <span class="main">(</span>Domain <span class="main">(</span>Snd <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">|×|</span> <span class="main">(</span>Range <span class="main">(</span>Snd <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> isZFfun_def<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">f</span></span><span class="main"><span class="main">]</span></span> Let_def<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> ZFFunToLambda<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"Snd <span class="free"><span class="free"><span class="free">f</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> Opair <span class="main">(</span>Opair <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Lambda <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-ZFfun_ext"><span class="command">lemma</span></span> ZFfun_ext<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="free">A</span> <span class="main">⟶</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">g</span> <span class="bound">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="main">(</span>ZFfun <span class="free">A</span> <span class="free">B</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>ZFfun <span class="free">A</span> <span class="free">B</span> <span class="free">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Lambda <span class="free">A</span> <span class="free">f</span> <span class="main">=</span> Lambda <span class="free">A</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Lambda_ext<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfun_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-ZFfunExt"><span class="command">lemma</span></span> ZFfunExt<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">|dom|</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">|dom|</span> <span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">|cod|</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">|cod|</span> <span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> funf<span class="main">:</span> <span class="quoted"><span class="quoted">"isZFfun <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> fung<span class="main">:</span> <span class="quoted"><span class="quoted">"isZFfun <span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">g</span> <span class="main">|@|</span> <span class="bound">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> funf <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ZFfun<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">g</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fung <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ZFfun<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">g</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">g</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfun_ext<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>  

<span class="keyword1" id="SetCat-ZFfunDomAppCod"><span class="command">lemma</span></span> ZFfunDomAppCod<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"isZFfun <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">|∈|</span> <span class="keyword1">|dom|</span><span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">|@|</span> <span class="free">x</span> <span class="main">|∈|</span> <span class="keyword1">|cod|</span><span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunApp_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"app <span class="main">(</span>Snd <span class="free">f</span><span class="main">)</span> <span class="free">x</span> <span class="main">|∈|</span> Range <span class="main">(</span>Snd <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fun_value_in_range <span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"app <span class="main">(</span>Snd <span class="free">f</span><span class="main">)</span> <span class="free">x</span> <span class="main">|∈|</span> <span class="keyword1">|cod|</span><span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HOLZF.subset_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-ZFfunComp"><span class="command">lemma</span></span> ZFfunComp<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="free">A</span> <span class="main">⟶</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="main">(</span>ZFfun <span class="free">A</span> <span class="free">B</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">|o|</span> <span class="main">(</span>ZFfun <span class="free">B</span> <span class="free">C</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> ZFfun <span class="free">A</span> <span class="free">C</span> <span class="main">(</span><span class="free">g</span> <span class="keyword1">o</span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunComp_def ZFfunDom ZFfunCod<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">|∈|</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ZFfun <span class="free">B</span> <span class="free">C</span> <span class="free">g</span>  <span class="main">|@|</span> <span class="main">(</span>ZFfun <span class="free">A</span> <span class="free">B</span> <span class="free">f</span> <span class="main">|@|</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">g</span> <span class="keyword1">o</span> <span class="free">f</span><span class="main">)</span> <span class="skolem">x</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ZFfun <span class="free">A</span> <span class="free">B</span> <span class="free">f</span> <span class="main">|@|</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunApp<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"ZFfun <span class="free">B</span> <span class="free">C</span> <span class="free">g</span>  <span class="main">|@|</span> <span class="main">(</span>ZFfun <span class="free">A</span> <span class="free">B</span> <span class="free">f</span> <span class="main">|@|</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">(</span><span class="free">f</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunApp<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"ZFfun <span class="free">A</span> <span class="free">C</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> ZFfun <span class="free">B</span> <span class="free">C</span> <span class="free">g</span> <span class="main">|@|</span> <span class="main">(</span>ZFfun <span class="free">A</span> <span class="free">B</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> ZFfun <span class="free">A</span> <span class="free">C</span> <span class="main">(</span><span class="free">g</span> <span class="main">∘</span> <span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfun_ext<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-ZFfunCompApp"><span class="command">lemma</span></span> ZFfunCompApp<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"isZFfun <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">"isZFfun <span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">|dom|</span><span class="free">g</span> <span class="main">=</span> <span class="keyword1">|cod|</span><span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">|o|</span> <span class="free">g</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">g</span> <span class="main">|@|</span> <span class="main">(</span><span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ZFfun<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">g</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ZFfun<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="keyword1">|dom|</span><span class="free">f</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="keyword1">|cod|</span><span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunDomAppCod<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="keyword1">|dom|</span><span class="free">f</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">g</span> <span class="main">|@|</span> <span class="main">(</span><span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="keyword1">|cod|</span><span class="free">g</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> a b c <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunDomAppCod<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">|o|</span> <span class="free">g</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">|o|</span>
    ZFfun <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">g</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 2 c <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">|o|</span> <span class="free">g</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">g</span> <span class="main">|@|</span> <span class="main">(</span><span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunComp comp_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> 4 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETfun<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>  

<span class="keyword1" id="SetCat-ZFfunCompAppZFfun"><span class="command">lemma</span></span> ZFfunCompAppZFfun<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"isZFfun <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"isZFfun <span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">|dom|</span><span class="free">g</span> <span class="main">=</span> <span class="keyword1">|cod|</span><span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"isZFfun <span class="main">(</span><span class="free">f</span> <span class="keyword1">|o|</span> <span class="free">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">|o|</span> <span class="free">g</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">g</span> <span class="main">|@|</span> <span class="main">(</span><span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunCompApp<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="keyword1">|dom|</span><span class="free">f</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">g</span> <span class="main">|@|</span> <span class="main">(</span><span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="bound">x</span><span class="main">)</span> <span class="main">|∈|</span> <span class="keyword1">|cod|</span><span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunDomAppCod<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETfun<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-ZFfunCompAssoc"><span class="command">lemma</span></span> ZFfunCompAssoc<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"isZFfun <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">"isZFfun <span class="free">h</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">|cod|</span><span class="free">g</span> <span class="main">=</span> <span class="keyword1">|dom|</span><span class="free">h</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">"isZFfun <span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> e<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">|cod|</span><span class="free">f</span> <span class="main">=</span> <span class="keyword1">|dom|</span><span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">|o|</span> <span class="free">g</span> <span class="keyword1">|o|</span> <span class="free">h</span> <span class="main">=</span> <span class="free">f</span> <span class="keyword1">|o|</span> <span class="main">(</span><span class="free">g</span> <span class="keyword1">|o|</span> <span class="free">h</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ZFfun<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">g</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ZFfun<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">h</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">h</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">h</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ZFfun<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="keyword1">|dom|</span><span class="free">f</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="keyword1">|cod|</span><span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunDomAppCod<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="keyword1">|o|</span> <span class="free">g</span><span class="main">)</span> <span class="keyword1">|o|</span> <span class="free">h</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">h</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">h</span> <span class="main">|@|</span> <span class="main">(</span><span class="free">g</span> <span class="main">|@|</span> <span class="main">(</span><span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="keyword1">|dom|</span><span class="free">f</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">g</span> <span class="main">|@|</span> <span class="main">(</span><span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="keyword1">|cod|</span><span class="free">g</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> 4 e d <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunDomAppCod<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="keyword1">|o|</span> <span class="free">g</span><span class="main">)</span> <span class="keyword1">|o|</span> <span class="free">h</span> <span class="main">=</span> <span class="main">(</span>ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">|o|</span>
      ZFfun <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">g</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">|o|</span>
      ZFfun <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">h</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">h</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> 1 2 3 c e <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> 4 5 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunComp comp_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">|o|</span> <span class="main">(</span><span class="free">g</span> <span class="keyword1">|o|</span> <span class="free">h</span><span class="main">)</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">h</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">h</span> <span class="main">|@|</span> <span class="main">(</span><span class="free">g</span> <span class="main">|@|</span> <span class="main">(</span><span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="keyword1">|dom|</span><span class="free">g</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">g</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="keyword1">|cod|</span><span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunDomAppCod<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">|o|</span> <span class="main">(</span><span class="free">g</span> <span class="keyword1">|o|</span> <span class="free">h</span><span class="main">)</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">|o|</span>
      <span class="main">(</span>ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">g</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">|o|</span>
      ZFfun <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">h</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">h</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> 1 2 3 c e <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> 4 e 5 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunComp comp_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="SetCat-ZFfunCompAppDomCod"><span class="command">lemma</span></span> ZFfunCompAppDomCod<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"isZFfun <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"isZFfun <span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">|dom|</span><span class="free">g</span> <span class="main">=</span> <span class="keyword1">|cod|</span><span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="keyword1">|dom|</span> <span class="main">(</span><span class="free">f</span> <span class="keyword1">|o|</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">|dom|</span> <span class="free">f</span> <span class="main">∧</span> <span class="keyword1">|cod|</span> <span class="main">(</span><span class="free">f</span> <span class="keyword1">|o|</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">|cod|</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">|o|</span> <span class="free">g</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">g</span> <span class="main">|@|</span> <span class="main">(</span><span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunCompApp<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunDom ZFfunCod<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-ZFfunIdLeft"><span class="command">lemma</span></span> ZFfunIdLeft<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"isZFfun <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span><span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|dom|</span><span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">|o|</span> <span class="free">f</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span><span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|dom|</span><span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="var">?g</span> <span class="keyword1">|o|</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfun_ext ZFfunApp ZFfunCompApp SETfun ZFfunCod ZFfunDom<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ZFfun<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-ZFfunIdRight"><span class="command">lemma</span></span> ZFfunIdRight<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"isZFfun <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">|o|</span> <span class="main">(</span>ZFfun <span class="main">(</span> <span class="keyword1">|cod|</span><span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span><span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ZFfun <span class="main">(</span> <span class="keyword1">|cod|</span><span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span><span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="keyword1">|dom|</span><span class="free">f</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="keyword1">|cod|</span><span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunDomAppCod<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span> <span class="keyword1">|o|</span> <span class="var">?g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a 1
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfun_ext ZFfunApp ZFfunCompApp SETfun ZFfunCod ZFfunDom<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ZFfun<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-SETCategory"><span class="command">lemma</span></span> SETCategory<span class="main">:</span> <span class="quoted"><span class="quoted">"Category<span class="main">(</span>SET<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Category_axioms SET'"</span></span>  
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category_axioms_def SET'_def ZFfunCompAppDomCod 
      ZFfunCompAppZFfun ZFfunCompAssoc ZFfunIdLeft ZFfunIdRight ZFfunDom ZFfunCod SETfun MapsTo_def CompDefined_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET_def MakeCat<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-SETobj"><span class="command">lemma</span></span> SETobj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="main">(</span>SET<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET_def SET'_def MakeCat_def<span class="main">)</span>

<span class="keyword1" id="SetCat-SETcod"><span class="command">lemma</span></span> SETcod<span class="main">:</span> <span class="quoted"><span class="quoted">"isZFfun <span class="main">(</span>ZFfun <span class="free">A</span> <span class="free">B</span> <span class="free">f</span><span class="main">)</span> <span class="main">⟹</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> ZFfun <span class="free">A</span> <span class="free">B</span> <span class="free">f</span> <span class="main">=</span> <span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET_def MakeCat_def SET'_def ZFfunCod<span class="main">)</span>

<span class="keyword1" id="SetCat-SETmor"><span class="command">lemma</span></span> SETmor<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>isZFfun <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET_def MakeCat_def SET'_def<span class="main">)</span>

<span class="keyword1" id="SetCat-SETdom"><span class="command">lemma</span></span> SETdom<span class="main">:</span> <span class="quoted"><span class="quoted">"isZFfun <span class="main">(</span>ZFfun <span class="free">A</span> <span class="free">B</span> <span class="free">f</span><span class="main">)</span> <span class="main">⟹</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> ZFfun <span class="free">A</span> <span class="free">B</span> <span class="free">f</span> <span class="main">=</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET_def MakeCat_def SET'_def ZFfunDom<span class="main">)</span>

<span class="keyword1" id="SetCat-SETId"><span class="command">lemma</span></span> SETId<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">|∈|</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Id SET <span class="free">X</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj SET"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET_def SET'_def MakeCat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"isZFfun<span class="main">(</span>Id SET <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETCategory Category.CatIdInMor SETmor<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Id SET <span class="free">X</span><span class="main">)</span> <span class="main">=</span> ZFfun <span class="free">X</span> <span class="free">X</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET_def SET'_def MakeCat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunApp<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-SETCompE"><span class="command">lemma</span></span> SETCompE<span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="main">;</span> <span class="main">⟦</span>isZFfun <span class="free">f</span> <span class="main">;</span> isZFfun <span class="free">g</span> <span class="main">;</span> <span class="keyword1">|cod|</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">|dom|</span> <span class="free">g</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET_def SET'_def MakeCat_def<span class="main">)</span>

<span class="keyword1" id="SetCat-SETmapsTo"><span class="command">lemma</span></span> SETmapsTo<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span> <span class="main">⟹</span> isZFfun <span class="free">f</span> <span class="main">∧</span> <span class="keyword1">|dom|</span> <span class="free">f</span> <span class="main">=</span> <span class="free">X</span> <span class="main">∧</span> <span class="keyword1">|cod|</span> <span class="free">f</span> <span class="main">=</span> <span class="free">Y</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsTo_def SET_def SET'_def MakeCat_def<span class="main">)</span>

<span class="keyword1" id="SetCat-SETComp"><span class="command">lemma</span></span> SETComp<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="main">=</span> <span class="free">f</span> <span class="keyword1">|o|</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>MakeCat SET'</sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="main">=</span> <span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>MakeCat SET'</sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span>  <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeCatComp2<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET'_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-SETCompAt"><span class="command">lemma</span></span> SETCompAt<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>SET </sub><span class="hidden">⇙</span><span class="free">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">|∈|</span>  <span class="keyword1">|dom|</span> <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET </sub><span class="hidden">⇙</span><span class="free">g</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span> <span class="main">=</span> <span class="free">g</span> <span class="main">|@|</span> <span class="main">(</span><span class="free">f</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="main">=</span> <span class="free">f</span> <span class="keyword1">|o|</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETComp<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">g</span> <span class="main">|@|</span> <span class="main">(</span><span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunCompApp<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunApp<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-SETZFfun"><span class="command">lemma</span></span> SETZFfun<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> ZFfun <span class="free">X</span> <span class="free">Y</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"isZFfun <span class="free">f</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETmor<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> ZFfun <span class="main">(</span> <span class="keyword1">|dom|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span> <span class="keyword1">|cod|</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="main">|@|</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfun<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">|dom|</span> <span class="free">f</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">|cod|</span> <span class="free">f</span> <span class="main">=</span> <span class="free">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET_def SET'_def MakeCat_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>  

<span class="keyword1" id="SetCat-SETfunDomAppCod"><span class="command">lemma</span></span> SETfunDomAppCod<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">|∈|</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">|@|</span> <span class="free">x</span> <span class="main">|∈|</span> <span class="free">Y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"isZFfun <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">|dom|</span> <span class="free">f</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">|cod|</span> <span class="free">f</span> <span class="main">=</span> <span class="free">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETmapsTo<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">|∈|</span> <span class="keyword1">|dom|</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">|@|</span> <span class="free">x</span> <span class="main">|∈|</span> <span class="keyword1">|cod|</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunDomAppCod<span class="main">)</span>  
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(*Locally Small Category has an injective map from the morphisms to ZF*)</span>
<span class="keyword1"><span class="command">record</span></span> <span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">)</span> LSCategory <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">)</span> Category"</span></span> <span class="main">+</span>
  mor2ZF <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'m</span> <span class="main">⇒</span> ZF"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">m2z</span>ı_"</span> <span class="main">[</span>70<span class="main">]</span> 70<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="entity">ZF2mor</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">z2m</span>ı_"</span> <span class="main">[</span>70<span class="main">]</span> 70<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ZF2mor</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">≡</span> <span class="keyword1">THE</span> <span class="bound">m</span> <span class="main">.</span> <span class="bound">m</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="bound">m</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">HOMCollection</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="free"><span class="bound"><span class="entity">Y</span></span></span> <span class="main">≡</span> <span class="main">{</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="bound">f</span> <span class="main">|</span> <span class="bound">f</span> <span class="main">.</span> <span class="bound">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="keyword1">to</span> <span class="free"><span class="bound"><span class="entity">Y</span></span></span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">HomSet</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Hom</span>ı _ _"</span> <span class="main">[</span>65<span class="main">,</span> 65<span class="main">]</span> 65<span class="main">)</span>  <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">HomSet</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="free"><span class="bound"><span class="entity">Y</span></span></span> <span class="main">≡</span> implode <span class="main">(</span>HOMCollection <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="free"><span class="bound"><span class="entity">Y</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> LSCategory <span class="main">=</span> Category <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> mor2ZFInj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">x</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">;</span> <span class="free">y</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">;</span> <span class="keyword1">m2z</span> <span class="free">x</span> <span class="main">=</span> <span class="keyword1">m2z</span> <span class="free">y</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> HOMSetIsSet<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span> <span class="main">;</span> <span class="free">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="main">⟧</span> <span class="main">⟹</span> HOMCollection <span class="free">C</span> <span class="free">X</span> <span class="free">Y</span> <span class="main">∈</span> range explode"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> m2zExt<span class="main">:</span> <span class="quoted"><span class="quoted">"mor2ZF <span class="free">C</span> <span class="main">∈</span> extensional <span class="main">(</span>Mor <span class="free">C</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>LSCategory <span class="free">C</span> <span class="main">;</span> 
  <span class="main">⟦</span>Category <span class="free">C</span> <span class="main">;</span> <span class="main">⟦</span><span class="free">x</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">;</span> <span class="free">y</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">;</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">x</span> <span class="main">=</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">y</span><span class="main">⟧</span> <span class="main">⟹</span>  <span class="free">x</span> <span class="main">=</span> <span class="free">y</span><span class="main">;</span>
  <span class="main">⟦</span><span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">;</span> <span class="free">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">⟧</span> <span class="main">⟹</span> HOMCollection <span class="free">C</span> <span class="free">X</span> <span class="free">Y</span> <span class="main">∈</span> range explode<span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory_def LSCategory_axioms_def<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">HomFtorMap</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> LSCategory_scheme <span class="main">⇒</span> <span class="tfree">'o</span> <span class="main">⇒</span> <span class="tfree">'m</span> <span class="main">⇒</span> ZF"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Hom</span>ı<span class="keyword1">[</span>_<span class="keyword1">,</span>_<span class="keyword1">]</span>"</span> <span class="main">[</span>65<span class="main">,</span>65<span class="main">]</span> 65<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">HomFtorMap</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">≡</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span> <span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="bound">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="entity">HomFtor'</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> LSCategory_scheme <span class="main">⇒</span> <span class="tfree">'o</span> <span class="main">⇒</span> 
      <span class="main">(</span><span class="tfree">'o</span><span class="main">,</span>ZF<span class="main">,</span><span class="tfree">'m</span><span class="main">,</span>ZF<span class="main">,</span><span class="main">⦇</span>mor2ZF <span class="main">::</span> <span class="tfree">'m</span> <span class="main">⇒</span> ZF<span class="main">,</span> <span class="main">…</span> <span class="main">::</span> <span class="tfree">'a</span><span class="main">⦈</span><span class="main">,</span>unit<span class="main">)</span> Functor"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">HomP</span>ı<span class="keyword1">[</span>_<span class="keyword1">,─]</span>"</span> <span class="main">[</span>65<span class="main">]</span> 65<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">HomFtor'</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">≡</span> <span class="main">⦇</span>
        CatDom <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">,</span> 
        CatCod <span class="main">=</span> SET <span class="main">,</span>
        MapM   <span class="main">=</span> <span class="main">λ</span> <span class="bound">g</span> <span class="main">.</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">,</span><span class="bound">g</span><span class="main">]</span>
  <span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">HomFtor</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Hom</span>ı<span class="keyword1">[</span>_<span class="keyword1">,─]</span>"</span> <span class="main">[</span>65<span class="main">]</span> 65<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">HomFtor</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">≡</span> MakeFtor <span class="main">(</span>HomFtor' <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span> <span class="main">⟹</span> Category <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> LSCategory<span class="main">)</span> m2zz2m<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span> <span class="free">f</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span> <span class="free">X</span> <span class="free">Y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsToObj<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"HOMCollection <span class="free">C</span> <span class="free">X</span> <span class="free">Y</span> <span class="main">∈</span> range explode"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HOMSetIsSet<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span> <span class="free">f</span><span class="main">)</span> <span class="main">∈</span> HOMCollection <span class="free">C</span> <span class="free">X</span> <span class="free">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HOMCollection_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span> <span class="free">f</span><span class="main">)</span> <span class="main">|∈|</span> implode <span class="main">(</span>HOMCollection <span class="free">C</span> <span class="free">X</span> <span class="free">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Elem_implode<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomSet_def<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> LSCategory<span class="main">)</span> m2zz2mInv<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">z2m</span> <span class="main">(</span><span class="keyword1">m2z</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">∧</span> <span class="keyword1">m2z</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">m2z</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃!</span> <span class="bound">m</span> <span class="main">.</span> <span class="bound">m</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">∧</span> <span class="keyword1">m2z</span> <span class="bound">m</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">m2z</span> <span class="free">f</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> ex_ex1I<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">m</span> <span class="main">.</span> <span class="bound">m</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">∧</span> <span class="keyword1">m2z</span> <span class="bound">m</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">m2z</span> <span class="free">f</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free">f</span></span></span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">insert</span> 1<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">∧</span> <span class="keyword1">m2z</span> <span class="skolem">m</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">m2z</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">∧</span> <span class="keyword1">m2z</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">m2z</span> <span class="free">f</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mor2ZFInj<span class="main">)</span>
    <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZF2mor_def the1_equality<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> LSCategory<span class="main">)</span> z2mm2z<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span> <span class="free">X</span> <span class="free">Y</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">z2m</span> <span class="free">f</span> <span class="keyword1">maps</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span> <span class="main">∧</span> <span class="keyword1">m2z</span> <span class="main">(</span><span class="keyword1">z2m</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">m</span> <span class="main">.</span> <span class="bound">m</span> <span class="keyword1">maps</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span> <span class="main">∧</span> <span class="keyword1">m2z</span> <span class="bound">m</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"HOMCollection <span class="free">C</span> <span class="free">X</span> <span class="free">Y</span> <span class="main">∈</span> range explode"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HOMSetIsSet<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">|∈|</span> implode <span class="main">(</span>HOMCollection <span class="free">C</span> <span class="free">X</span> <span class="free">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomSet_def<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> HOMCollection <span class="free">C</span> <span class="free">X</span> <span class="free">Y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HOLZF.Elem_implode<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HOMCollection_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃!</span> <span class="bound">m</span> <span class="main">.</span> <span class="bound">m</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">∧</span> <span class="keyword1">m2z</span> <span class="bound">m</span> <span class="main">=</span> <span class="free">f</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> ex_ex1I<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">m</span> <span class="main">.</span> <span class="bound">m</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">∧</span> <span class="keyword1">m2z</span> <span class="bound">m</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">∧</span> <span class="keyword1">m2z</span> <span class="skolem">m</span> <span class="main">=</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">∧</span> <span class="keyword1">m2z</span> <span class="skolem">m</span> <span class="main">=</span> <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="keyword1">mor</span> <span class="main">∧</span> <span class="keyword1">m2z</span> <span class="skolem">y</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mor2ZFInj<span class="main">)</span>
    <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="keyword1">maps</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span> <span class="main">∧</span> <span class="keyword1">m2z</span> <span class="skolem">a</span> <span class="main">=</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∈</span> <span class="keyword1">mor</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">z2m</span> <span class="free">f</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 3 ZF2mor_def<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="free">f</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> the1_equality<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">λ</span></span> <span class="bound"><span class="bound">m</span></span> <span class="main"><span class="main">.</span></span> <span class="bound"><span class="bound">m</span></span> <span class="main"><span class="main">∈</span></span> <span class="keyword1"><span class="keyword1">mor</span></span> <span class="main"><span class="main">∧</span></span> <span class="keyword1"><span class="keyword1">m2z</span></span> <span class="bound"><span class="bound">m</span></span> <span class="main"><span class="main">=</span></span> <span class="free"><span class="free">f</span></span>"</span></span></span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">a</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 2 3 4<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 3<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-HomFtorMapLemma1"><span class="command">lemma</span></span>  HomFtorMapLemma1<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a c <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Simps<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">x</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> a b d 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.z2mm2z<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a c <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> Category.Ccompt<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a b d 2 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.m2zz2m<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> c <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Simps<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-HomFtorInMor'"><span class="command">lemma</span></span> HomFtorInMor'<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMap_def<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> HomFtorMapLemma1<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"isZFfun <span class="main">(</span>ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETfun<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET'_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-HomFtorMor'"><span class="command">lemma</span></span> HomFtorMor'<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">to</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span>  
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorInMor'<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMap_def SET'_def ZFfunDom<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMap_def SET'_def ZFfunCod<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-HomFtorMapsTo"><span class="command">lemma</span></span> HomFtorMapsTo<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span>LSCategory <span class="free">C</span> <span class="main">;</span> <span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">;</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">to</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMor' SET_def MakeCatMapsTo<span class="main">)</span>

<span class="keyword1" id="SetCat-HomFtorMor"><span class="command">lemma</span></span> HomFtorMor<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span> <span class="main">∈</span> Mor SET"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">to</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMapsTo<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span> <span class="main">∈</span> Mor SET"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-HomFtorCompDef'"><span class="command">lemma</span></span> HomFtorCompDef'<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>SET' </sub><span class="hidden">⇙</span><span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">g</span><span class="main">]</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">g</span><span class="main">]</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>HomFtorInMor'<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="keyword1">to</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">g</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="keyword1">to</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms a b <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMor'<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">g</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">g</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-HomFtorDist'"><span class="command">lemma</span></span> HomFtorDist'<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">g</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> c <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToMorDomCod<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">g</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>ZFfun <span class="var">?A</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="var">?f</span><span class="main">)</span> <span class="keyword1">|o|</span> <span class="main">(</span>ZFfun <span class="var">?B</span> <span class="var">?C</span> <span class="var">?g</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMap_def SET'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span>ZFfun <span class="var">?A</span> <span class="var">?B</span> <span class="var">?f</span><span class="main">)</span> <span class="keyword1">|o|</span> <span class="main">(</span>ZFfun <span class="var">?B</span> <span class="var">?C</span> <span class="var">?g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> ZFfun <span class="var">?A</span> <span class="var">?C</span> <span class="main">(</span><span class="var">?g</span> <span class="keyword1">o</span> <span class="var">?f</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> ZFfunComp<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">|∈|</span> <span class="var">?A</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="skolem">h</span> <span class="main">|∈|</span> <span class="var">?B</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="skolem">h</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms aa <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMapLemma1<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> ZFfun <span class="var">?A</span> <span class="var">?C</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> ZFfun_ext<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_def<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">|∈|</span> <span class="var">?A</span>"</span></span> 
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> bb<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span>"</span></span> 
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> c <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cdom<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms aa <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.z2mm2z<span class="main">)</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToMorDomCod<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.m2zz2mInv<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> bb c a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cassoc<span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 2 3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  HomFtorMap_def<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-HomFtorDist"><span class="command">lemma</span></span> HomFtorDist<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">g</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">g</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorDist'<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">g</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorCompDef'<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeCatComp SET_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-HomFtorId'"><span class="command">lemma</span></span> HomFtorId'<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">]</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="free">Y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a c <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Simps<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">Y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">]</span> <span class="main">=</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span> <span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="bound">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMap_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="free">Y</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="free">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span> <span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="bound">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="free">Y</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="free">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span> <span class="main">.</span> <span class="bound">f</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> ZFfun_ext<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="free">Y</span><span class="main">)</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">h</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> bb<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">h</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> assms aa <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.z2mm2z<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Simps<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">h</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> bb <span class="keyword1"><span class="command">.</span></span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET'_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-HomFtorId"><span class="command">lemma</span></span> HomFtorId<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">]</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="free">Y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">]</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="free">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorId'<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="free">Y</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>SET'</sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeCatId SET_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-HomFtorObj'"><span class="command">lemma</span></span> HomFtorObj'<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     b<span class="main">:</span> <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span><span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span> <span class="main">@@</span> <span class="free">Y</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="free">Y</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>HomFtor' <span class="free">C</span> <span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="var">?F</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtor'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="var">?F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="free">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorId HomFtor'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatDom <span class="var">?F</span></sub><span class="hidden">⇙</span> <span class="free">Y</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>CatCod <span class="var">?F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="free">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="free">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatCod <span class="var">?F</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorId HomFtor'_def SET_def SET'_def MakeCatObj<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>CatDom <span class="var">?F</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> d <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtor'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreFunctor.FmToFo<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="quoted"><span class="free">Y</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="free">Y</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-HomFtorFtor'"><span class="command">lemma</span></span> HomFtorFtor'<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"FunctorM <span class="main">(</span><span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">intro_locales</span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> PF<span class="main">:</span> <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span><span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtor'_def PreFunctor_def SETCategory a HomFtorDist b<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Z</span> <span class="keyword3"><span class="command">assume</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Z</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> 
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>SET </sub><span class="hidden">⇙</span><span class="main">.</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span><span class="main">]</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="bound">Y</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="skolem">Z</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Set.rev_bexI<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="skolem">Z</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET_def SET'_def MakeCatObj<span class="main">)</span> 
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span><span class="main">]</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="skolem">Z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms aa <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>HomFtorId<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">Z</span> <span class="skolem">Y</span> <span class="keyword3"><span class="command">assume</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">Z</span> <span class="keyword1">to</span> <span class="skolem">Y</span>"</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> bb<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Z</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aa a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToObj<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
      <span class="keyword1"><span class="command">have</span></span> dd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span> <span class="main">=</span> <span class="skolem">Z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ee<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span> <span class="main">=</span> <span class="skolem">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ff<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aa <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="skolem">f</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtor'_def<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">Z</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="skolem">Z</span>"</span></span> 
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">Y</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="skolem">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms bb cc PF <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorObj'<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="skolem">f</span><span class="main">]</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span><span class="main">)</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> assms ff <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMapsTo<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> dd ee <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"FunctorM_axioms <span class="main">(</span><span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> PF <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorM_axioms_def HomFtor'_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-HomFtorFtor"><span class="command">lemma</span></span> HomFtorFtor<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"Functor <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"FunctorM <span class="main">(</span><span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> HomFtorFtor'<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtor_def MakeFtor<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> 

<span class="keyword1" id="SetCat-HomFtorObj"><span class="command">lemma</span></span> HomFtorObj<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span> <span class="main">@@</span> <span class="free">Y</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="free">Y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"FunctorM <span class="main">(</span><span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorFtor'<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span><span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorM_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CatDom <span class="main">(</span><span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span> <span class="main">=</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtor'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span> <span class="main">@@</span> <span class="free">Y</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span> <span class="main">@@</span> <span class="free">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeFtorObj HomFtor_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorObj'<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">HomFtorMapContra</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> LSCategory_scheme <span class="main">⇒</span> <span class="tfree">'m</span> <span class="main">⇒</span> <span class="tfree">'o</span> <span class="main">⇒</span> ZF"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">HomC</span>ı<span class="keyword1">[</span>_<span class="keyword1">,</span>_<span class="keyword1">]</span>"</span> <span class="main">[</span>65<span class="main">,</span>65<span class="main">]</span> 65<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">HomFtorMapContra</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">≡</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span> <span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="bound">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="entity">HomFtorContra'</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'o</span><span class="main">,</span><span class="tfree">'m</span><span class="main">,</span><span class="tfree">'a</span><span class="main">)</span> LSCategory_scheme <span class="main">⇒</span> <span class="tfree">'o</span> <span class="main">⇒</span> 
      <span class="main">(</span><span class="tfree">'o</span><span class="main">,</span>ZF<span class="main">,</span><span class="tfree">'m</span><span class="main">,</span>ZF<span class="main">,</span><span class="main">⦇</span>mor2ZF <span class="main">::</span> <span class="tfree">'m</span> <span class="main">⇒</span> ZF<span class="main">,</span> <span class="main">…</span> <span class="main">::</span> <span class="tfree">'a</span><span class="main">⦈</span><span class="main">,</span>unit<span class="main">)</span> Functor"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">HomP</span>ı<span class="keyword1">[─,</span>_<span class="keyword1">]</span>"</span> <span class="main">[</span>65<span class="main">]</span> 65<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">HomFtorContra'</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">≡</span> <span class="main">⦇</span>
        CatDom <span class="main">=</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span><span class="main">,</span> 
        CatCod <span class="main">=</span> SET <span class="main">,</span>
        MapM   <span class="main">=</span> <span class="main">λ</span> <span class="bound">g</span> <span class="main">.</span> <span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="bound">g</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">]</span>
  <span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">HomFtorContra</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">Hom</span>ı<span class="keyword1">[─,</span>_<span class="keyword1">]</span>"</span> <span class="main">[</span>65<span class="main">]</span> 65<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">HomFtorContra</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">≡</span> MakeFtor<span class="main">(</span>HomFtorContra' <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="SetCat-HomContraAt"><span class="command">lemma</span></span> HomContraAt<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="free">X</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">f</span><span class="main">,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span> <span class="main">=</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMapContra_def ZFfunApp<span class="main">)</span>

<span class="keyword1" id="SetCat-mor2ZF_Op"><span class="command">lemma</span></span> mor2ZF_Op<span class="main">:</span> <span class="quoted"><span class="quoted">"mor2ZF <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">=</span> mor2ZF <span class="free">C</span>"</span></span>  
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">C</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="SetCat-mor_Op"><span class="command">lemma</span></span> mor_Op<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>
<span class="keyword1" id="SetCat-obj_Op"><span class="command">lemma</span></span> obj_Op<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">=</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>

<span class="keyword1" id="SetCat-ZF2mor_Op"><span class="command">lemma</span></span> ZF2mor_Op<span class="main">:</span> <span class="quoted"><span class="quoted">"ZF2mor <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="free">f</span> <span class="main">=</span> ZF2mor <span class="free">C</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZF2mor_def mor2ZF_Op mor_Op<span class="main">)</span>

<span class="keyword1" id="SetCat-mapsTo_Op"><span class="command">lemma</span></span> mapsTo_Op<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span> <span class="keyword1">to</span> <span class="free">X</span> <span class="main">=</span> <span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def mor_Op MapsTo_def<span class="main">)</span>

<span class="keyword1" id="SetCat-HOMCollection_Op"><span class="command">lemma</span></span> HOMCollection_Op<span class="main">:</span> <span class="quoted"><span class="quoted">"HOMCollection <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="free">X</span> <span class="free">Y</span> <span class="main">=</span> HOMCollection <span class="free">C</span> <span class="free">Y</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HOMCollection_def mapsTo_Op mor2ZF_Op<span class="main">)</span>

<span class="keyword1" id="SetCat-Hom_Op"><span class="command">lemma</span></span> Hom_Op<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="free">Y</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">Y</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomSet_def HOMCollection_Op<span class="main">)</span>

<span class="keyword1" id="SetCat-HomFtorContra'"><span class="command">lemma</span></span> HomFtorContra'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span> <span class="main">=</span> <span class="keyword1">HomP</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  HomFtorContra'_def 
                      HomFtor'_def HomFtorMapContra_def HomFtorMap_def mor2ZF_Op ZF2mor_Op Hom_Op<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>

<span class="keyword1" id="SetCat-HomFtorContra"><span class="command">lemma</span></span> HomFtorContra<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContra' HomFtorContra_def HomFtor_def<span class="main">)</span>

<span class="keyword1" id="SetCat-HomFtorContraDom"><span class="command">lemma</span></span> HomFtorContraDom<span class="main">:</span> <span class="quoted"><span class="quoted">"CatDom <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Op</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContra_def HomFtorContra'_def MakeFtor_def<span class="main">)</span>

<span class="keyword1" id="SetCat-HomFtorContraCod"><span class="command">lemma</span></span> HomFtorContraCod<span class="main">:</span> <span class="quoted"><span class="quoted">"CatCod <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> SET"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContra_def HomFtorContra'_def MakeFtor_def<span class="main">)</span>

<span class="keyword1" id="SetCat-LSCategory_Op"><span class="command">lemma</span></span> LSCategory_Op<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> LSCategory_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Category <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OpCatCat<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"LSCategory_axioms <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory_axioms_def mor_Op obj_Op mor2ZF_Op HOMCollection_Op 
                     LSCategory.mor2ZFInj LSCategory.HOMSetIsSet LSCategory.m2zExt<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-HomFtorContraFtor"><span class="command">lemma</span></span> HomFtorContraFtor<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟶</span> SET"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> functor_abbrev_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Functor <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContra<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory_Op<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorFtor<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"CatDom <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Op</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContra_def HomFtorContra'_def MakeFtor_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"CatCod <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> SET"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContra_def HomFtorContra'_def MakeFtor_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-HomFtorOpObj"><span class="command">lemma</span></span> HomFtorOpObj<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">@@</span> <span class="free">Y</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">Y</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> Obj <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">@@</span> <span class="free">Y</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,─]</span><span class="main">)</span> <span class="main">@@</span> <span class="free">Y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContra<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="free">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory_Op HomFtorObj<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">Y</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Hom_Op<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>
  

<span class="keyword1" id="SetCat-HomCHomOp"><span class="command">lemma</span></span> HomCHomOp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">g</span><span class="main">,</span><span class="free">X</span><span class="main">]</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">g</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  HomFtorContra'_def 
                      HomFtor'_def HomFtorMapContra_def HomFtorMap_def mor2ZF_Op ZF2mor_Op Hom_Op<span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>

<span class="keyword1" id="SetCat-HomFtorContraMapsTo"><span class="command">lemma</span></span> HomFtorContraMapsTo<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">f</span><span class="main">,</span><span class="free">X</span><span class="main">]</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="free">X</span>  <span class="keyword1">to</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory_Op<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">to</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMapsTo<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">f</span><span class="main">,</span><span class="free">X</span><span class="main">]</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomCHomOp<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="free">X</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Hom_Op<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  OppositeCategory_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="free">X</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Hom_Op<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  OppositeCategory_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-HomFtorContraMor"><span class="command">lemma</span></span> HomFtorContraMor<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">f</span><span class="main">,</span><span class="free">X</span><span class="main">]</span> <span class="main">∈</span> Mor SET"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">f</span><span class="main">,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="free">X</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">f</span><span class="main">,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">f</span><span class="main">,</span><span class="free">X</span><span class="main">]</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="free">X</span>  <span class="keyword1">to</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContraMapsTo<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">f</span><span class="main">,</span><span class="free">X</span><span class="main">]</span> <span class="main">∈</span> Mor SET"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">f</span><span class="main">,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="free">X</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">f</span><span class="main">,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="free">X</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="SetCat-HomContraMor"><span class="command">lemma</span></span> HomContraMor<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">##</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">f</span><span class="main">,</span><span class="free">X</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContra_def HomFtorContra'_def MakeFtor_def assms OppositeCategory_def<span class="main">)</span> 



<span class="comment1">(*This is used in the proof of the naturality of the Yoneda trans*)</span>
<span class="keyword1" id="SetCat-HomCHom"><span class="command">lemma</span></span> HomCHom<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">g</span><span class="main">,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">g</span><span class="main">,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> ObjDf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ObjDg<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cdom<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">have</span></span> ObjCg<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ObjCf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">obj</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Ccod<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">g</span><span class="main">,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">g</span><span class="main">,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">|o|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">g</span><span class="main">,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">,</span><span class="free">f</span><span class="main">]</span> <span class="main">∈</span> Mor SET"</span></span> <span class="keyword1"><span class="command">using</span></span> assms ObjDg <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMor<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">g</span><span class="main">,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span> <span class="main">∈</span> Mor SET"</span></span> <span class="keyword1"><span class="command">using</span></span> assms ObjDf <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContraMor<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">g</span><span class="main">,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms ObjDg ObjDf
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMor HomFtorContraMor<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET_def SET'_def MakeCatComp2<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> 
              <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">h</span> <span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="bound">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">o</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">h</span> <span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="bound">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMapContra_def HomFtorMap_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ZFfunComp<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> LSCategory.m2zz2m<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> ObjDg ObjDf<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aa ObjCg ObjDf assms<span class="main">(</span>1<span class="main">)</span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.z2mm2z<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Ccompt<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> 
              <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">h</span> <span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="bound">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">o</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">h</span> <span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="bound">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> ZFfun_ext<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">h</span> <span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="bound">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">o</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">h</span> <span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="bound">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">h</span> <span class="main">=</span> 
        <span class="main">(</span><span class="main">(</span><span class="main">λ</span> <span class="bound">h</span> <span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="bound">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">o</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">h</span> <span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="bound">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="skolem">h</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> MapsTo1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> ObjCg ObjDf aa <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.z2mm2z<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> CompDef1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> MapsTo1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">have</span></span> CompDef2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> MapsTo1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">have</span></span> c1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms CompDef1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToMorDomCod<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> c2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms CompDef2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToMorDomCod<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> c1
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.m2zz2mInv<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> CompDef1 CompDef2 assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cassoc<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> c2
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.m2zz2mInv<span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">g</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">|o|</span> <span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">g</span><span class="main">,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMapContra_def HomFtorMap_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ZFfunComp<span class="main"><span class="main">[</span></span><span class="operator">THEN</span> sym<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> LSCategory.m2zz2m<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> ObjCg ObjCf<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aa ObjCg ObjDf assms<span class="main">(</span>1<span class="main">)</span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.z2mm2z<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span> <span class="keyword1">to</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Ccompt<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">g</span><span class="main">,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">g</span><span class="main">,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">,</span><span class="free">f</span><span class="main">]</span> <span class="main">∈</span> Mor SET"</span></span> <span class="keyword1"><span class="command">using</span></span> assms ObjCg <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMor<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">g</span><span class="main">,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span> <span class="main">∈</span> Mor SET"</span></span> <span class="keyword1"><span class="command">using</span></span> assms ObjCf <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContraMor<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">g</span><span class="main">,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms ObjCg ObjCf
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMor HomFtorContraMor<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SET_def SET'_def MakeCatComp2<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="Yoneda">
<div class="head">
<h1>Theory Yoneda</h1>
</div>
<pre class="source"><span class="comment1">(*
Author: Alexander Katovsky
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Yoneda"</span></span>

<span class="keyword1"><span class="command">theory</span></span> Yoneda
<span class="keyword2"><span class="keyword">imports</span></span> <a href="NatTrans.html">NatTrans</a> <a href="SetCat.html">SetCat</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">YFtorNT'</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">≡</span> <span class="main">⦇</span>NTDom <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">]</span> <span class="main">,</span> NTCod <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">]</span> <span class="main">,</span>
                       NatTransMap <span class="main">=</span> <span class="main">λ</span> <span class="bound">B</span> <span class="main">.</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="bound">B</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">]</span><span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">YFtorNT</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">≡</span> MakeNT <span class="main">(</span>YFtorNT' <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> YFtorNT_defs <span class="main">=</span> YFtorNT'_def YFtorNT_def MakeNT_def

<span class="keyword1" id="Yoneda-YFtorNTCatDom"><span class="command">lemma</span></span> YFtorNTCatDom<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCatDom <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Op</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT_defs NTCatDom_def HomFtorContraDom<span class="main">)</span>

<span class="keyword1" id="Yoneda-YFtorNTCatCod"><span class="command">lemma</span></span> YFtorNTCatCod<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCatCod <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> SET"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT_defs NTCatCod_def HomFtorContraCod<span class="main">)</span>

<span class="keyword1" id="Yoneda-YFtorNTApp1"><span class="command">lemma</span></span> YFtorNTApp1<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtorNT <span class="free">C</span> <span class="free">f</span><span class="main">)</span> <span class="main">$$</span> <span class="free">X</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="free">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtorNT <span class="free">C</span> <span class="free">f</span><span class="main">)</span> <span class="main">$$</span> <span class="free">X</span> <span class="main">=</span> <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span> <span class="main">$$</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeNTApp YFtorNT_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT'_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">YFtor'</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">≡</span> <span class="main">⦇</span>
         CatDom <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">,</span> 
         CatCod <span class="main">=</span> CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> SET <span class="main">,</span> 
         MapM <span class="main">=</span> <span class="main">λ</span> <span class="bound">f</span> <span class="main">.</span> YFtorNT <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="bound">f</span>
  <span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">YFtor</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">≡</span> MakeFtor<span class="main">(</span>YFtor' <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> YFtor_defs <span class="main">=</span> YFtor'_def YFtor_def MakeFtor_def

<span class="keyword1" id="Yoneda-YFtorNTNatTrans'"><span class="command">lemma</span></span> YFtorNTNatTrans'<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"NatTransP <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> NatTransP_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> Fd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="main">(</span>NTDom <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟶</span> SET"</span></span> <span class="keyword1"><span class="command">using</span></span> assms 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  HomFtorContraFtor Category.Cdom YFtorNT'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> Fc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="main">(</span>NTCod <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟶</span> SET"</span></span> <span class="keyword1"><span class="command">using</span></span> assms 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  HomFtorContraFtor Category.Ccod YFtorNT'_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Functor <span class="main">(</span>NTDom <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Fd <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Functor <span class="main">(</span>NTCod <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Fc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTCatDom <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> CatDom <span class="main">(</span>NTCod <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT'_def NTCatDom_def HomFtorContraDom<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTCatCod <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> CatCod <span class="main">(</span>NTDom <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT'_def NTCatCod_def HomFtorContraCod<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">X</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">X</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatCod <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="main">(</span>NTDom <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span>NTCod <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> Obj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatDom_def YFtorNT'_def HomFtorContraDom OppositeCategory_def<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> H1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">X</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> "</span></span> <span class="keyword1"><span class="command">using</span></span> assms Obj <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorOpObj Category.Cdom<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> H2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">X</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">X</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> "</span></span> <span class="keyword1"><span class="command">using</span></span> assms Obj <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorOpObj Category.Ccod<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="skolem">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">X</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">X</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms Obj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorMapsTo<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> H1 H2 <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT'_def NTCatCod_def NTCatDom_def HomFtorContraCod<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span> <span class="skolem">X</span> <span class="skolem">Y</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>NTCatDom <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="skolem">X</span> <span class="keyword1">to</span> <span class="skolem">Y</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>NTDom <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span> </sub><span class="hidden">⇙</span><span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">=</span>
       <span class="main">(</span><span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>NTCatCod <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span> </sub><span class="hidden">⇙</span><span class="main">(</span>NTCod <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> M1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">X</span> <span class="keyword1">to</span> <span class="skolem">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatDom_def YFtorNT'_def HomFtorContraDom<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> D1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span> <span class="main">=</span> <span class="skolem">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> C1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span> <span class="main">=</span> <span class="skolem">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> morf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> morg<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms M1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> H1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="skolem">g</span><span class="main">,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">g</span>"</span></span> 
        <span class="keyword2"><span class="keyword">and</span></span> H2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="skolem">g</span><span class="main">,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M1 
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContra_def HomFtorContra'_def MakeFtor_def<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="skolem">g</span><span class="main">,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="skolem">g</span><span class="main">,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms morf morg
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomCHom<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="skolem">Y</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="skolem">X</span><span class="main">,</span><span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> H1 H2 D1 C1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT'_def NTCatCod_def HomFtorContraCod<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YFtorNTNatTrans"><span class="command">lemma</span></span> YFtorNTNatTrans<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms YFtorNTNatTrans' YFtorNT_def MakeNT<span class="main">)</span>

<span class="keyword1" id="Yoneda-YFtorNTMor"><span class="command">lemma</span></span> YFtorNTMor<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"YFtorNT <span class="free">C</span> <span class="free">f</span> <span class="main">∈</span> Mor <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp_def CatExp'_def MakeCatMor<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNTNatTrans<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTCatDom <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Op</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNTCatDom<span class="main">)</span> 
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTCatCod <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> SET"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNTCatCod<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YFtorNtMapsTo"><span class="command">lemma</span></span> YFtorNtMapsTo<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"YFtorNT <span class="free">C</span> <span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> MapsToI<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"YFtorNT <span class="free">C</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNTMor<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> YFtorNT <span class="free">C</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>CatExpDom YFtorNT_defs<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> YFtorNT <span class="free">C</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>CatExpCod YFtorNT_defs<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YFtorNTCompDef"><span class="command">lemma</span></span> YFtorNTCompDef<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"YFtorNT <span class="free">C</span> <span class="free">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> YFtorNT <span class="free">C</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"YFtorNT <span class="free">C</span> <span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"YFtorNT <span class="free">C</span> <span class="free">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">]</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNtMapsTo<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"YFtorNT <span class="free">C</span> <span class="free">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"YFtorNT <span class="free">C</span> <span class="free">g</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> YFtorNT <span class="free">C</span> <span class="free">f</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> YFtorNT <span class="free">C</span> <span class="free">g</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> YFtorNT <span class="free">C</span> <span class="free">f</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> YFtorNT <span class="free">C</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-PreSheafCat"><span class="command">lemma</span></span> PreSheafCat<span class="main">:</span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span> <span class="main">⟹</span> Category <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'_def OpCatCat SETCategory CatExpCat<span class="main">)</span>

<span class="keyword1" id="Yoneda-YFtor'Obj1"><span class="command">lemma</span></span> YFtor'Obj1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="main">(</span>CatDom <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span> <span class="main">##</span> <span class="main">(</span>Id <span class="main">(</span>CatDom <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span><span class="main">)</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> Id <span class="main">(</span>CatCod <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> NatTransExt<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> Obj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> HomObj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">∈</span> Obj <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms Obj <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp_defs HomFtorContraFtor<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> Id<span class="main">:</span> <span class="quoted"><span class="quoted">"Id <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">∈</span> Mor <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreSheafCat Category.CatIdInMor<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> CAT<span class="main">:</span> <span class="quoted"><span class="quoted">"Category<span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreSheafCat<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> HomObj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">∈</span> Obj <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms Obj 
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp_defs HomFtorContraFtor<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> YFtorNTNatTrans<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Id <span class="free">C</span> <span class="free">X</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms Obj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.CatIdInMor<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTrans<span class="main">(</span>Id <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Id <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExp_defs<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTDom <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> NTDom <span class="main">(</span>Id <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT_defs<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">]</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms Obj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.CatIdDomCod<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span>  <span class="main">(</span>Id <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> CAT HomObj
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.CatIdDomCod<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> NTDom <span class="main">(</span>Id <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Id <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExpDom<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">]</span> <span class="main">=</span> NTDom <span class="main">(</span>Id <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTCod <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> NTCod <span class="main">(</span>Id <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT_defs<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">]</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms Obj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.CatIdDomCod<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span>  <span class="main">(</span>Id <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> CAT HomObj
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.CatIdDomCod<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> NTCod <span class="main">(</span>Id <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Id <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExpCod<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">]</span> <span class="main">=</span> NTCod <span class="main">(</span>Id <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Y</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtorNT <span class="free">C</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">Y</span> <span class="main">=</span> <span class="main">(</span>Id <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">Y</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> CD<span class="main">:</span> <span class="quoted"><span class="quoted">"CatDom <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Op</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContraDom<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> CC<span class="main">:</span> <span class="quoted"><span class="quoted">"CatCod <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> SET"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContraCod<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> ObjY<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ObjYOp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> Obj <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNTCatDom OppositeCategory_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtorNT <span class="free">C</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">Y</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="skolem">Y</span><span class="main">,</span><span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNTApp1<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Obj ObjY assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorId<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">id</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Obj ObjY assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorOpObj <span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span>IdNatTrans <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> CD CC ObjYOp <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> IdNatTrans_map<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span>Id <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> HomObj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExpId<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YFtorPreFtor"><span class="command">lemma</span></span> YFtorPreFtor<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> PreFunctor_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> CAT<span class="main">:</span> <span class="quoted"><span class="quoted">"Category<span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> PreSheafCat<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">g</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span> <span class="main">##</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">g</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> NatTransExt<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> CD<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'_def<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> CD2<span class="main">:</span> <span class="quoted"><span class="quoted">"YFtorNT <span class="free">C</span> <span class="skolem">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> YFtorNT <span class="free">C</span> <span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> CD assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNTCompDef<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> Mor1<span class="main">:</span> <span class="quoted"><span class="quoted">"YFtorNT <span class="free">C</span> <span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> YFtorNT <span class="free">C</span> <span class="skolem">g</span> <span class="main">∈</span> Mor <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> CAT CD2
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToMorDomCod<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToMorDomCod CD YFtorNTNatTrans<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> YFtorNT <span class="free">C</span> <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Mor1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExpMorNT<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTDom <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> NTDom <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> YFtorNT <span class="free">C</span> <span class="skolem">g</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"YFtorNT <span class="free">C</span> <span class="skolem">f</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> CD2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NTDom <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">)</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT_defs<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> CD assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToMorDomCod<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> NTDom <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="skolem">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT_defs<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="skolem">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExpDom<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> YFtorNT <span class="free">C</span> <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> CD2 CAT
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToMorDomCod<span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Mor1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExpDom<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTCod <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> NTCod <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> YFtorNT <span class="free">C</span> <span class="skolem">g</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"YFtorNT <span class="free">C</span> <span class="skolem">g</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> CD2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NTCod <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">)</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT_defs<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> CD assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToMorDomCod<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> NTCod <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT_defs<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExpCod<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> YFtorNT <span class="free">C</span> <span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> CD2 CAT
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToMorDomCod<span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Mor1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExpCod<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">X</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"YFtorNT <span class="free">C</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">X</span> <span class="main">=</span> <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> YFtorNT <span class="free">C</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">X</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> Obj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ObjOp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> Obj <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNTCatDom OppositeCategory_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
          <span class="keyword1"><span class="command">have</span></span> App1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="skolem">X</span><span class="main">,</span><span class="skolem">f</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">X</span>"</span></span> 
            <span class="keyword2"><span class="keyword">and</span></span> App2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="skolem">X</span><span class="main">,</span><span class="skolem">g</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>YFtorNT <span class="free">C</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNTApp1 YFtorNTCatDom<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtorNT <span class="free">C</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">)</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">X</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="skolem">X</span><span class="main">,</span><span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">g</span><span class="main">)</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNTApp1<span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="skolem">X</span><span class="main">,</span><span class="skolem">f</span><span class="main">]</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="skolem">X</span><span class="main">,</span><span class="skolem">g</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> CD assms Obj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorDist<span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>YFtorNT <span class="free">C</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>YFtorNT <span class="free">C</span> <span class="skolem">g</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> App1 App2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> ObjOp CD2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CatExpDist<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">X</span> <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> Obj <span class="main">(</span>CatDom <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">Y</span> <span class="main">∈</span> Obj <span class="main">(</span>CatCod <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span><span class="main">)</span> <span class="main">.</span> YFtor' <span class="free">C</span> <span class="main">##</span> <span class="main">(</span>Id <span class="main">(</span>CatDom <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span><span class="main">)</span> <span class="skolem">X</span><span class="main">)</span> <span class="main">=</span> Id <span class="main">(</span>CatCod <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span><span class="main">)</span> <span class="bound">Y</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="skolem">X</span><span class="main">]</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Set.rev_bexI<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'_def<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="skolem">X</span><span class="main">]</span> <span class="main">∈</span> Obj <span class="main">(</span>CatCod <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'_def CatExp_defs HomFtorContraFtor<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span> <span class="main">##</span> <span class="main">(</span>Id <span class="main">(</span>CatDom <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span><span class="main">)</span> <span class="skolem">X</span><span class="main">)</span> <span class="main">=</span> Id <span class="main">(</span>CatCod <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="skolem">X</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a assms
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'Obj1<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Category <span class="main">(</span>CatDom <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Category <span class="main">(</span>CatCod <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> CAT <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YFtor'Obj"><span class="command">lemma</span></span> YFtor'Obj<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="main">(</span>CatDom <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> PreFunctor.FmToFo<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms YFtor'Obj1 YFtorPreFtor<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span> <span class="main">∈</span> Obj <span class="main">(</span>CatCod <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'_def CatExp_defs HomFtorContraFtor<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YFtorFtor'"><span class="command">lemma</span></span> YFtorFtor'<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"FunctorM <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> FunctorM_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> YFtorPreFtor<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"FunctorM_axioms <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>FunctorM_axioms_def<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">X</span> <span class="skolem">Y</span> <span class="keyword3"><span class="command">assume</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span> </sub><span class="hidden">⇙</span><span class="skolem">X</span> <span class="keyword1">to</span> <span class="skolem">Y</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"YFtor' <span class="free">C</span> <span class="main">##</span> <span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span></sub><span class="hidden">⇙</span> YFtor' <span class="free">C</span> <span class="main">@@</span> <span class="skolem">X</span> <span class="keyword1">to</span> YFtor' <span class="free">C</span> <span class="main">@@</span> <span class="skolem">Y</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> Mor1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">X</span> <span class="keyword1">to</span> <span class="skolem">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aa <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'_def<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Category <span class="main">(</span>CatDom <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'_def<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> Obj1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> Obj <span class="main">(</span>CatDom <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
              Obj2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> Obj <span class="main">(</span>CatDom <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aa assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToObj<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtor' <span class="free">C</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">=</span> YFtorNT <span class="free">C</span> <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'_def<span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"YFtor' <span class="free">C</span> <span class="main">@@</span> <span class="skolem">X</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="skolem">X</span><span class="main">]</span>"</span></span> 
          <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"YFtor' <span class="free">C</span> <span class="main">@@</span> <span class="skolem">Y</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="skolem">Y</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Obj1 Obj2 assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'Obj<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CatCod <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span> <span class="main">=</span> CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'_def<span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"YFtorNT <span class="free">C</span> <span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="skolem">X</span><span class="main">]</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="skolem">Y</span><span class="main">]</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> assms Mor1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNtMapsTo<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YFtorFtor"><span class="command">lemma</span></span> YFtorFtor<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="main">(</span>YFtor <span class="free">C</span><span class="main">)</span> <span class="main">:</span> <span class="free">C</span> <span class="main">⟶</span> <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> functor_abbrev_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Functor <span class="main">(</span>YFtor <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeFtor YFtor_def YFtorFtor'<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"CatDom <span class="main">(</span>YFtor <span class="free">C</span><span class="main">)</span> <span class="main">=</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"CatCod <span class="main">(</span>YFtor <span class="free">C</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>CatExp <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> SET<span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeFtor_def YFtor_def YFtor'_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YFtorObj"><span class="command">lemma</span></span> YFtorObj<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtor <span class="free">C</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CatDom <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span> <span class="main">=</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">hence</span></span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor'Obj<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"PreFunctor <span class="main">(</span>YFtor' <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorPreFtor<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeFtorObj YFtor_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YFtorObj2"><span class="command">lemma</span></span> YFtorObj2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span><span class="main">)</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="free">Y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="free">Y</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">Y</span><span class="main">]</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorOpObj<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorObj<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YFtorMor"><span class="command">lemma</span></span> YFtorMor<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>LSCategory <span class="free">C</span> <span class="main">;</span> <span class="free">f</span> <span class="main">∈</span> Mor <span class="free">C</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span>YFtor <span class="free">C</span><span class="main">)</span> <span class="main">##</span> <span class="free">f</span> <span class="main">=</span> YFtorNT <span class="free">C</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtor_defs MakeFtorMor<span class="main">)</span>

<span class="comment1">(*
We can't do this because the presheaf category may not be locally small
definition 
  NatHom ("Natı _ _") where
  "NatHom C F G ≡ Hom<span class="hidden">⇘</span><sub>CatExp (Op C) SET</sub><span class="hidden">⇙</span> F G"
*)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">YMap</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="free"><span class="bound"><span class="entity">η</span></span></span> <span class="main">≡</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">η</span></span></span> <span class="main">$$</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span> <span class="main">|@|</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">id</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span> </sub><span class="hidden">⇙</span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">YMapInv'</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">⦇</span>
      NTDom <span class="main">=</span> <span class="main">(</span><span class="main">(</span>YFtor <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">@@</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span><span class="main">,</span> 
      NTCod <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">,</span> 
      NatTransMap <span class="main">=</span> <span class="main">λ</span> <span class="bound">B</span> <span class="main">.</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="bound">B</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">@@</span> <span class="bound">B</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span> <span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">C</span></span></span></sub><span class="hidden">⇙</span> <span class="bound">f</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span>
  <span class="main">⦈</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">YMapInv</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> MakeNT <span class="main">(</span>YMapInv' <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Yoneda-YMapInvApp"><span class="command">lemma</span></span> YMapInvApp<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="free">x</span><span class="main">)</span> <span class="main">$$</span> <span class="free">B</span> <span class="main">=</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">B</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">B</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span> <span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="bound">f</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NTCatDom <span class="main">(</span>MakeNT <span class="main">(</span>YMapInv' <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> CatDom <span class="main">(</span>NTDom <span class="main">(</span>YMapInv' <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeNT_def NTCatDom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> CatDom <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorObj YMapInv'_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="keyword1">Op</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms HomFtorContraFtor<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">C</span></span> <span class="quoted"><span class="free">X</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NTCatDom <span class="main">(</span>MakeNT <span class="main">(</span>YMapInv' <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Op</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="main">(</span>MakeNT <span class="main">(</span>YMapInv' <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="free">x</span><span class="main">)</span> <span class="main">$$</span> <span class="free">B</span> <span class="main">=</span> <span class="main">(</span>MakeNT <span class="main">(</span>YMapInv' <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">$$</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YMapInv_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span>YMapInv' <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="free">x</span><span class="main">)</span> <span class="main">$$</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MakeNTApp<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YMapInv'_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> 

<span class="keyword1" id="Yoneda-YMapImage"><span class="command">lemma</span></span> YMapImage<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="free">F</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟶</span> SET"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">NT</span> <span class="free">η</span> <span class="main">:</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">F</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> YMap_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorObj<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟶</span> SET"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContraFtor<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CatDom <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Op</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> Obj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="main">(</span>CatDom <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"CatCod <span class="free">F</span>  <span class="main">=</span> SET"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">η</span> <span class="main">$$</span> <span class="free">X</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms Obj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NatTransMapsTo<span class="main">)</span> 
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">η</span> <span class="main">$$</span> <span class="free">X</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span>  <span class="main">|∈|</span> <span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Simps<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorObj2<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.m2zz2m<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="main">|@|</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETfunDomAppCod<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YMapInvNatTransP"><span class="command">lemma</span></span> YMapInvNatTransP<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="free">F</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟶</span> SET"</span></span> <span class="keyword2"><span class="keyword">and</span></span> xobj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> xinF<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">|∈|</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"NatTransP <span class="main">(</span>YMapInv' <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> NatTransP_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YMapInv'_def NTCatCod_def NTCatDom_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> yf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorObj<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> hf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟶</span> SET"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContraFtor<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"Functor <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> ftf<span class="main">:</span> <span class="quoted"><span class="quoted">"Functor <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> df<span class="main">:</span> <span class="quoted"><span class="quoted">"CatDom <span class="free">F</span> <span class="main">=</span> <span class="keyword1">Op</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cf<span class="main">:</span> <span class="quoted"><span class="quoted">"CatCod <span class="free">F</span> <span class="main">=</span> SET"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> dy<span class="main">:</span> <span class="quoted"><span class="quoted">"CatDom <span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Op</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cy<span class="main">:</span> <span class="quoted"><span class="quoted">"CatCod <span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> SET"</span></span> <span class="keyword1"><span class="command">using</span></span> hf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"CatDom <span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> CatDom <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> df dy <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"CatCod <span class="free">F</span> <span class="main">=</span> CatCod <span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cf cy <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Y</span> <span class="keyword3"><span class="command">assume</span></span> yobja<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> Obj <span class="main">(</span>CatDom <span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">f</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cf<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> MapsToI<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> yobj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> yobja dy <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> zffun<span class="main">:</span> <span class="quoted"><span class="quoted">"isZFfun <span class="main">(</span>ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="bound">f</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> SETfun<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
        <span class="keyword1"><span class="command">{</span></span>
          <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> yhom<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">y</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span> <span class="main">|∈|</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
            <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">y</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> yhom yobj assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.z2mm2z<span class="main">)</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">y</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="skolem">Y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsToOp<span class="main">)</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorMapsTo<span class="main">)</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"isZFfun <span class="main">(</span><span class="var">?f</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">|dom|</span> <span class="var">?f</span> <span class="main">=</span> <span class="free">F</span> <span class="main">@@</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">|cod|</span> <span class="var">?f</span> <span class="main">=</span> <span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETmapsTo<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?f</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms ZFfunDomAppCod<span class="main">[</span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="bound">f</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">mor</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> zffun
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETmor<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="bound">f</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> zffun
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETcod<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms yobj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorObj2<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="bound">f</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> zffun
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETdom<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">Z</span> <span class="skolem">Y</span> <span class="keyword3"><span class="command">assume</span></span> fmaps<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>CatDom <span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span> <span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="keyword1">to</span> <span class="skolem">Y</span>"</span></span> 
    <span class="keyword1"><span class="command">have</span></span> fmapsa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="keyword1">to</span> <span class="skolem">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fmaps dy <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> fmapsb<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="keyword1">to</span> <span class="skolem">Z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> MapsToOpOp<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> fmor<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> fdom<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span> <span class="main">=</span> <span class="skolem">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> fcod<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span> <span class="main">=</span> <span class="skolem">Z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> hc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="skolem">f</span><span class="main">,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomContraMor<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> yobj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> zobj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Z</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fmapsb assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToObj<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command">have</span></span> Ffmaps<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms fmapsa <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorMapsTo<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> Fzmaps<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">h</span> <span class="bound">A</span> <span class="bound">B</span> <span class="main">.</span> <span class="main">⟦</span><span class="bound">h</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="bound">A</span> <span class="bound">B</span><span class="main">)</span> <span class="main">;</span> <span class="bound">A</span> <span class="main">∈</span> Obj <span class="free">C</span> <span class="main">;</span> <span class="bound">B</span> <span class="main">∈</span> Obj <span class="free">C</span><span class="main">⟧</span> <span class="main">⟹</span> 
      <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="bound">B</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="bound">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h</span> <span class="skolem">A</span> <span class="skolem">B</span> <span class="keyword3"><span class="command">assume</span></span> h<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">A</span> <span class="skolem">B</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> oA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> oB<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span>  
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">A</span> <span class="keyword1">to</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms h oA oB <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.z2mm2z<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">B</span> <span class="keyword1">to</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> MapsToOp<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">B</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorMapsTo<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> hHomF<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">h</span><span class="main">.</span> <span class="bound">h</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span> <span class="main">|∈|</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> xobj zobj xinF
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> h<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> xobj zobj h <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Fzmaps<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span> <span class="main">|∈|</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETfunDomAppCod<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> Ff<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span> <span class="main">=</span> ZFfun <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">|@|</span> <span class="bound">h</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Ffmaps <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETZFfun<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> compdefa<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> 
          ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETmor<span class="main"><span class="main">[</span></span><span class="operator">THEN</span> sym<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"isZFfun <span class="main">(</span>ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> SETfun<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> h<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms h xobj zobj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.z2mm2z<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fmapsb assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Ccompt<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.m2zz2m<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"isZFfun <span class="main">(</span>ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> SETfun<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> h<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> xobj yobj h <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Fzmaps<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span> <span class="main">|∈|</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETfunDomAppCod<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span><span class="main">(</span>ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> 
        <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span><span class="main">(</span>ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETcod SETdom<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>      
    <span class="keyword1"><span class="command">have</span></span> compdefb<span class="main">:</span> <span class="quoted"><span class="quoted">"ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> 
          ZFfun <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">|@|</span> <span class="bound">h</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CompDefinedI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETmor<span class="main"><span class="main">[</span></span><span class="operator">THEN</span> sym<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"isZFfun <span class="main">(</span>ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> hHomF <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETfun<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"isZFfun <span class="main">(</span>ZFfun <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">|@|</span> <span class="bound">h</span><span class="main">)</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> SETfun<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> h<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">|∈|</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span> <span class="keyword1">to</span> <span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Ffmaps <span class="keyword1"><span class="command">.</span></span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">|@|</span> <span class="skolem">h</span> <span class="main">|∈|</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> h <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETfunDomAppCod<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span>ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> 
            <span class="keyword1">dom</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span>ZFfun <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">|@|</span> <span class="bound">h</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETcod SETdom<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> 
          ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> 
          ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">|o|</span> 
          ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Ff compdefa <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETComp<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">o</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> ZFfunComp<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span> 
      <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> h<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span>"</span></span> 
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Z</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fmapsb assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToObj<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms h <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.z2mm2z<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fmapsb assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Ccompt<span class="main">)</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.m2zz2m<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">}</span></span> 
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">|@|</span> <span class="bound">h</span><span class="main">)</span> <span class="keyword1">o</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> ZFfun_ext<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> h<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">have</span></span> zObj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Z</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fmapsb assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToObj<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> hmaps<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms h <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.z2mm2z<span class="main">)</span> 
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fcod <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> CompDef_hf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fmor <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> CompDef_hfOp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> CompDefOp<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> CompDef_FhfOp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorCompDef<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="skolem">Z</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> hmaps <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsToOp<span class="main">)</span> 
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorMapsTo<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> xin<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">|∈|</span> <span class="keyword1">|dom|</span><span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETmapsTo<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> CompDef_hf assms <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToMorDomCod<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.m2zz2mInv<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET </sub><span class="hidden">⇙</span><span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms CompDef_hfOp <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorComp<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">|@|</span> <span class="main">(</span><span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> CompDef_FhfOp xin <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> SETCompAt<span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="skolem">f</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">|@|</span> <span class="main">(</span><span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">|o|</span> 
          ZFfun <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">|@|</span> <span class="bound">h</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> ZFfunComp<span class="main"><span class="main">[</span></span><span class="operator">THEN</span> sym<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> hHomF<span class="main">)</span> 
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">h</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Ff compdefb <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETComp<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">f</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span>
             ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Z</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">f</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="bound">f</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>CatCod <span class="free">F</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="skolem">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cf yf hc fdom fcod HomFtorMapContra_def<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YMapInvNatTrans"><span class="command">lemma</span></span> YMapInvNatTrans<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="free">F</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟶</span> SET"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">|∈|</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms YMapInv_def MakeNT YMapInvNatTransP<span class="main">)</span>

<span class="keyword1" id="Yoneda-YMapInvImage"><span class="command">lemma</span></span> YMapInvImage<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="free">F</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟶</span> SET"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">|∈|</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">NT</span> <span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="free">x</span><span class="main">)</span> <span class="main">:</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">F</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> nt_abbrev_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YMapInvNatTrans<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTDom <span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YMapInv_def MakeNT_def YMapInv'_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTCod <span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YMapInv_def MakeNT_def YMapInv'_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YMap1"><span class="command">lemma</span></span> YMap1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> LSCat<span class="main">:</span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> Fftor<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="free">F</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟶</span> SET"</span></span> <span class="keyword2"><span class="keyword">and</span></span> XObj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> NT<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">NT</span> <span class="free">η</span> <span class="main">:</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">F</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span> <span class="main">=</span> <span class="free">η</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> NatTransExt<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YMapImage<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">NT</span> <span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span><span class="main">)</span> <span class="main">:</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YMapInvImage<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">η</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> NTDYI<span class="main">:</span> <span class="quoted"><span class="quoted">"NTDom <span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> NTDeta<span class="main">:</span> <span class="quoted"><span class="quoted">"NTDom <span class="free">η</span> <span class="main">=</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTDom <span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> NTDom <span class="free">η</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NTCod <span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> NTCeta<span class="main">:</span> <span class="quoted"><span class="quoted">"NTCod <span class="free">η</span> <span class="main">=</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"NTCod <span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> NTCod <span class="free">η</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Y</span> <span class="keyword3"><span class="command">assume</span></span> Yobja<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> CCF<span class="main">:</span> <span class="quoted"><span class="quoted">"CatCod <span class="free">F</span> <span class="main">=</span> SET"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟶</span> SET"</span></span> <span class="keyword1"><span class="command">using</span></span> LSCat XObj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContraFtor<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> CDH<span class="main">:</span> <span class="quoted"><span class="quoted">"CatDom <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Op</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> CDYF<span class="main">:</span> <span class="quoted"><span class="quoted">"CatDom <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Op</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> XObj LSCat <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorObj<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"NTCatDom <span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">Op</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> LSCat XObj NTDYI CDH  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatDom_def<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> YObjOp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> Obj <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Yobja <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> YObj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> XObjOp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> XObj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command">have</span></span> yinv_mapsTo<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> 1 CCF CDYF YObjOp NatTransMapsTo<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="skolem">Y</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> LSCat XObj YObj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorObj2<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> eta_mapsTo<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> NT CDYF CCF YObjOp NatTransMapsTo<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">η</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="skolem">Y</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> LSCat XObj YObj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorObj2<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">Y</span> <span class="main">=</span> <span class="free">η</span> <span class="main">$$</span> <span class="skolem">Y</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> ZFfunExt<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">|dom|</span><span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">|dom|</span><span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span>  
        <span class="keyword1"><span class="command">using</span></span> yinv_mapsTo eta_mapsTo <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETmapsTo<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">|cod|</span><span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">|cod|</span><span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> yinv_mapsTo eta_mapsTo <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETmapsTo<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"isZFfun <span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> yinv_mapsTo <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETmapsTo<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"isZFfun <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> eta_mapsTo <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETmapsTo<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="keyword3"><span class="command">assume</span></span> fdomYinv<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">|∈|</span> <span class="keyword1">|dom|</span><span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">have</span></span> fHom<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Y</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> yinv_mapsTo fdomYinv <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETmapsTo<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> fMapsTo<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">Y</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms YObj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.z2mm2z<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> fCod<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> fDom<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> fMor<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">|@|</span> <span class="skolem">f</span> <span class="main">=</span> 
              <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="main">(</span><span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="main">|@|</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> fHom assms YObj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunApp YMapInvApp YMap_def<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> aa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> 
            <span class="keyword1"><span class="command">using</span></span> NT CDYF CCF YObjOp XObjOp NatTransMapsTo<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">η</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="free">X</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">have</span></span> bb<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">to</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> 
            <span class="keyword1"><span class="command">using</span></span> fMapsTo Fftor <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsToOp FunctorMapsTo<span class="main">)</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> aa bb <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsToCompDef<span class="main">)</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">|∈|</span> <span class="keyword1">|dom|</span> <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms aa 
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETmapsTo YFtorObj2 Category.Cidm LSCategory.m2zz2m<span class="main">)</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETCompAt<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NTDom <span class="free">η</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> NTDeta assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorObj<span class="main">)</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">hence</span></span></span> <span class="quoted"><span class="quoted">"NTCatDom <span class="free">η</span> <span class="main">=</span> <span class="keyword1">Op</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatDom_def HomFtorContraDom<span class="main">)</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NTCatCod <span class="free">η</span> <span class="main">=</span> SET"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> NTCatCod_def<span class="main">)</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"NatTrans <span class="free">η</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"NTCod <span class="free">η</span> <span class="main">=</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="keyword1">Op</span> <span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">X</span> <span class="keyword1">to</span> <span class="skolem">Y</span>"</span></span> 
            <span class="keyword1"><span class="command">using</span></span> fMapsTo MapsToOp<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> <span class="var">?f</span> <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> <span class="var">?X</span> <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="skolem">Y</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> <span class="var">?Y</span> <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="free">X</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> <span class="var">?C</span> <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="free">C</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> NatTransP.NatTrans<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">η</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="free">X</span></span> <span class="quoted"><span class="skolem">Y</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span><span class="main">,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms fMor <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomContraMor<span class="main">)</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">|@|</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">|@|</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">≈&gt;</span><span class="hidden">⇘</span><sub>SET</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span> 
            <span class="keyword1"><span class="command">using</span></span> fCod fDom XObj LSCat fMor HomFtorContraMapsTo<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">C</span></span> <span class="quoted"><span class="free">X</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span>"</span></span><span class="main">]</span> eta_mapsTo <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> MapsToCompDef<span class="main">)</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">|dom|</span> <span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">,</span><span class="free">X</span><span class="main">]</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="free">X</span><span class="main">)</span>"</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunDom HomFtorMapContra_def<span class="main">)</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="free">X</span><span class="main">)</span>"</span></span> 
            <span class="keyword1"><span class="command">using</span></span> assms fCod <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cidm LSCategory.m2zz2m<span class="main">)</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETCompAt<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">|@|</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms fCod <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cidm<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span><span class="main">)</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.m2zz2m<span class="main">)</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomContraAt<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">|@|</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.m2zz2mInv Category.CatIdInMor<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">|@|</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> fCod fMor Category.Cidr<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">C</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">f</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">|@|</span> <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms YObj fHom <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.z2mm2z<span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">|@|</span> <span class="skolem">f</span> <span class="main">=</span> <span class="main">(</span><span class="free">η</span> <span class="main">$$</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">|@|</span> <span class="skolem">f</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YMap2"><span class="command">lemma</span></span> YMap2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="free">F</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟶</span> SET"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">|∈|</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"YMap <span class="free">C</span> <span class="free">X</span> <span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> YMap_def<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?η</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="free">F</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?η</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> ZFfun <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">f</span> <span class="main">.</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="bound">f</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YMapInvApp<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Simps LSCategory.m2zz2m<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?η</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="main">|@|</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ZFfunApp<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.CatIdInMor LSCategory.m2zz2mInv<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span>Id SET <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="free">x</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">##</span> <span class="main">(</span>Id <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Id SET <span class="main">(</span><span class="free">F</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorId<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Id <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> SETId<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?η</span> <span class="main">$$</span> <span class="free">X</span><span class="main">)</span> <span class="main">|@|</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span>Id <span class="free">C</span> <span class="free">X</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YFtorNT_YMapInv"><span class="command">lemma</span></span> YFtorNT_YMapInv<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"YFtorNT <span class="free">C</span> <span class="free">f</span> <span class="main">=</span> YMapInv <span class="free">C</span> <span class="free">X</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">Y</span><span class="main">]</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> YFtorNT_def YMapInv_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> NatTransExt'<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> Cf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> <span class="free">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> Df<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"NTCod <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> NTCod <span class="main">(</span>YMapInv' <span class="free">C</span> <span class="free">X</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">Y</span><span class="main">]</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT'_def YMapInv'_def <span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="keyword1">dom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">]</span> <span class="main">=</span> YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Df assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorObj Category.MapsToObj<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"NTDom <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> NTDom <span class="main">(</span>YMapInv' <span class="free">C</span> <span class="free">X</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">Y</span><span class="main">]</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT'_def YMapInv'_def <span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Z</span> <span class="keyword3"><span class="command">assume</span></span> ObjZ1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Z</span> <span class="main">∈</span> Obj <span class="main">(</span>NTCatDom <span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> ObjZ2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Z</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ObjZ1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT'_def NTCatDom_def OppositeCategory_def HomFtorContraDom<span class="main">)</span> 
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> ObjX<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ObjY<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToObj<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> 
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="free">X</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">Y</span><span class="main">]</span><span class="main">)</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">|@|</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="free">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> morf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> mapsx<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="skolem">Z</span> <span class="keyword1">to</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x assms<span class="main">(</span>1<span class="main">)</span> ObjZ2 ObjX <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.z2mm2z<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> morx<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">Y</span><span class="main">]</span><span class="main">)</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span><span class="free">Y</span><span class="main">]</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomContraMor<span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">HomC</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span><span class="free">Y</span><span class="main">]</span><span class="main">)</span> <span class="main">|@|</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span> <span class="main">;;</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> HomContraAt<span class="main">)</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> mapsx <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">f</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="free">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.m2zz2m<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms morf <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.m2zz2mInv<span class="main">)</span> 
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtorNT' <span class="free">C</span> <span class="free">f</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">Z</span> <span class="main">=</span> <span class="main">(</span>YMapInv' <span class="free">C</span> <span class="free">X</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">Y</span><span class="main">]</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">$$</span> <span class="skolem">Z</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Cf Df assms
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT'_def YMapInv'_def HomFtorMap_def HomFtorOpObj<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> ZFfun_ext<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">}</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YMapYoneda"><span class="command">lemma</span></span> YMapYoneda<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"YFtor <span class="free">C</span> <span class="main">##</span> <span class="free">f</span> <span class="main">=</span> YMapInv <span class="free">C</span> <span class="free">X</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToObj<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"YFtorNT <span class="free">C</span> <span class="free">f</span> <span class="main">=</span> YMapInv <span class="free">C</span> <span class="free">X</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">Y</span><span class="main">]</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorNT_YMapInv<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorMor YFtorObj<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YonedaFull"><span class="command">lemma</span></span> YonedaFull<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">NT</span> <span class="free">η</span> <span class="main">:</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"YFtor <span class="free">C</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">η</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> ftor<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟶</span> SET"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorObj HomFtorContraFtor<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YMapImage<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> yh<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="free">Y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorObj2<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.z2mm2z<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"YFtor <span class="free">C</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> YMapInv <span class="free">C</span> <span class="free">X</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms yh <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YMapYoneda<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> YMapInv <span class="free">C</span> <span class="free">X</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> assms yh <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.z2mm2z<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"YFtor <span class="free">C</span> <span class="main">##</span> <span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span>YMap <span class="free">C</span> <span class="free">X</span> <span class="free">η</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">η</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms ftor <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YMap1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YonedaFaithful"><span class="command">lemma</span></span> YonedaFaithful<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">X</span> <span class="keyword1">to</span> <span class="free">Y</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"YFtor <span class="free">C</span> <span class="main">##</span> <span class="free">f</span> <span class="main">=</span> YFtor <span class="free">C</span> <span class="main">##</span> <span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> ObjX<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ObjY<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.MapsToObj<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">have</span></span> M2Zf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> M2Zg<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span> <span class="main">@@</span> <span class="free">X</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms ObjX ObjY <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.m2zz2m YFtorObj2<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">have</span></span> Ftor<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟶</span> SET"</span></span> <span class="keyword1"><span class="command">using</span></span> assms ObjY <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorObj HomFtorContraFtor<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> Morf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> Morg<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> Mor <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"YMapInv <span class="free">C</span> <span class="free">X</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> YMapInv <span class="free">C</span> <span class="free">X</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YMapYoneda<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"YMap <span class="free">C</span> <span class="free">X</span> <span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> YMap <span class="free">C</span> <span class="free">X</span> <span class="main">(</span>YMapInv <span class="free">C</span> <span class="free">X</span> <span class="main">(</span>YFtor <span class="free">C</span> <span class="main">@@</span> <span class="free">Y</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms ObjX ObjY M2Zf M2Zg Ftor <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YMap2<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms Morf Morg <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.mor2ZFInj<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Yoneda-YonedaEmbedding"><span class="command">lemma</span></span> YonedaEmbedding<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"LSCategory <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> Obj <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>YFtor <span class="free">C</span><span class="main">)</span> <span class="main">@@</span> <span class="free">A</span> <span class="main">=</span> <span class="main">(</span>YFtor <span class="free">C</span><span class="main">)</span> <span class="main">@@</span> <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> AObjOp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> Obj <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> BObjOp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> Obj <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> OppositeCategory_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">hence</span></span> FtorA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">A</span><span class="main">]</span><span class="main">)</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟶</span> SET"</span></span> <span class="keyword2"><span class="keyword">and</span></span> FtorB<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Ftor</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">B</span><span class="main">]</span><span class="main">)</span> <span class="main">:</span> <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="main">⟶</span> SET"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorContraFtor<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">A</span><span class="main">]</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">B</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> YFtorObj<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">A</span><span class="main">]</span><span class="main">)</span> <span class="main">##</span> <span class="main">(</span>Id <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">B</span><span class="main">]</span><span class="main">)</span> <span class="main">##</span> <span class="main">(</span>Id <span class="main">(</span><span class="keyword1">Op</span> <span class="free">C</span><span class="main">)</span> <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"Id SET <span class="main">(</span><span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">A</span><span class="main">]</span><span class="main">)</span> <span class="main">@@</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> Id SET <span class="main">(</span><span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span><span class="main">[─,</span><span class="free">B</span><span class="main">]</span><span class="main">)</span> <span class="main">@@</span> <span class="free">A</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> AObjOp BObjOp FtorA FtorB <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> FunctorId<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"Id SET <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">A</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> Id SET <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">A</span> <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HomFtorOpObj<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">A</span> <span class="free">A</span> <span class="main">=</span> <span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">A</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> SETCategory <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.IdInj SETobj<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">A</span> <span class="free">A</span>"</span></span><span class="main"><span class="main">]</span></span> SETobj<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">A</span> <span class="free">B</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">A</span> <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.Cidm LSCategory.m2zz2m<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="main">|∈|</span> <span class="main">(</span><span class="keyword1">Hom</span><span class="hidden">⇘</span><sub><span class="free">C</span> </sub><span class="hidden">⇙</span><span class="free">A</span> <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">z2m</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="keyword1">m2z</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">A</span> <span class="keyword1">to</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LSCategory.z2mm2z<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Id <span class="free">C</span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">maps</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="free">A</span> <span class="keyword1">to</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.CatIdInMor LSCategory.m2zz2mInv<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">cod</span><span class="hidden">⇘</span><sub><span class="free">C</span></sub><span class="hidden">⇙</span> <span class="main">(</span>Id <span class="free">C</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Category.CatIdDomCod<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div>
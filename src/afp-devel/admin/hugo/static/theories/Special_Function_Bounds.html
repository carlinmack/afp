<div id="Bounds_Lemmas">
<div class="head">
<h1>Theory Bounds_Lemmas</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹General Lemmas for Proving Function Inequalities›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Bounds_Lemmas
<span class="keyword2"><span class="keyword">imports</span></span> <a href="../../HOL/HOL/Complex_Main.html">Complex_Main</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹These are for functions that are differentiable over a closed interval.›</span></span>

<span class="keyword1" id="Bounds_Lemmas-gen_lower_bound_increasing"><span class="command">lemma</span></span> gen_lower_bound_increasing<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">a</span> <span class="main">::</span> <span class="quoted">real</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="free">a</span> <span class="main">≤</span> <span class="bound">y</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">fl</span> <span class="bound">x</span> <span class="main">-</span> <span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_real_derivative</span> <span class="free">g</span> <span class="bound">y</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="free">a</span> <span class="main">≤</span> <span class="bound">y</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">g</span> <span class="bound">y</span> <span class="main">≤</span> <span class="main">0</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">fl</span> <span class="free">a</span> <span class="main">=</span> <span class="free">f</span> <span class="free">a</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">fl</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">f</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">fl</span> <span class="free">x</span> <span class="main">-</span> <span class="free">f</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">fl</span> <span class="free">a</span> <span class="main">-</span> <span class="free">f</span> <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> DERIV_nonpos_imp_nonincreasing <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> f <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">λ</span></span><span class="bound"><span class="bound">x</span></span><span class="main"><span class="main">.</span></span> <span class="free"><span class="free">fl</span></span> <span class="bound"><span class="bound">x</span></span> <span class="main"><span class="main">-</span></span> <span class="free"><span class="free">f</span></span> <span class="bound"><span class="bound">x</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> assms<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> allI impI exI conjI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> assms <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Bounds_Lemmas-gen_lower_bound_decreasing"><span class="command">lemma</span></span> gen_lower_bound_decreasing<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">a</span> <span class="main">::</span> <span class="quoted">real</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="free">x</span> <span class="main">≤</span> <span class="bound">y</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">fl</span> <span class="bound">x</span> <span class="main">-</span> <span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_real_derivative</span> <span class="free">g</span> <span class="bound">y</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="free">x</span> <span class="main">≤</span> <span class="bound">y</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">⟹</span> <span class="free">g</span> <span class="bound">y</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">fl</span> <span class="free">a</span> <span class="main">=</span> <span class="free">f</span> <span class="free">a</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">fl</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">f</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">fl</span> <span class="main">(</span><span class="main">-</span> <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="free">f</span> <span class="main">(</span><span class="main">-</span> <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_lower_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">-</span></span><span class="free"><span class="free">a</span></span>"</span></span></span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">-</span></span><span class="free"><span class="free">x</span></span>"</span></span></span> <span class="main"><span class="main">_</span></span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">λ</span></span><span class="bound"><span class="bound">u</span></span><span class="main"><span class="main">.</span></span> <span class="main"><span class="main">-</span></span> <span class="free"><span class="free">g</span></span> <span class="main"><span class="main">(</span></span><span class="main"><span class="main">-</span></span><span class="bound"><span class="bound">u</span></span><span class="main"><span class="main">)</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> assms<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> DERIV_mirror <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Bounds_Lemmas-gen_upper_bound_increasing"><span class="command">lemma</span></span> gen_upper_bound_increasing<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">a</span> <span class="main">::</span> <span class="quoted">real</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="free">a</span> <span class="main">≤</span> <span class="bound">y</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">fu</span> <span class="bound">x</span> <span class="main">-</span> <span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_real_derivative</span> <span class="free">g</span> <span class="bound">y</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="free">a</span> <span class="main">≤</span> <span class="bound">y</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">g</span> <span class="bound">y</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">fu</span> <span class="free">a</span> <span class="main">=</span> <span class="free">f</span> <span class="free">a</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">fu</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_lower_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">f</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">fu</span></span></span></span>  <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">λ</span></span><span class="bound"><span class="bound">u</span></span><span class="main"><span class="main">.</span></span> <span class="main"><span class="main">-</span></span> <span class="free"><span class="free">g</span></span> <span class="bound"><span class="bound">u</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> assms DERIV_minus <span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> f <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">fu</span> <span class="bound">x</span> <span class="main">-</span> <span class="free">f</span> <span class="bound">x</span>"</span></span><span class="main">]</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Bounds_Lemmas-gen_upper_bound_decreasing"><span class="command">lemma</span></span> gen_upper_bound_decreasing<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">a</span> <span class="main">::</span> <span class="quoted">real</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">a</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="free">x</span> <span class="main">≤</span> <span class="bound">y</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">fu</span> <span class="bound">x</span> <span class="main">-</span> <span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_real_derivative</span> <span class="free">g</span> <span class="bound">y</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="free">x</span> <span class="main">≤</span> <span class="bound">y</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">⟹</span> <span class="free">g</span> <span class="bound">y</span> <span class="main">≤</span> <span class="main">0</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">fu</span> <span class="free">a</span> <span class="main">=</span> <span class="free">f</span> <span class="free">a</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">fu</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_lower_bound_decreasing <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span> <span class="main"><span class="main">_</span></span> <span class="main"><span class="main">_</span></span>  <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">λ</span></span><span class="bound"><span class="bound">u</span></span><span class="main"><span class="main">.</span></span> <span class="main"><span class="main">-</span></span> <span class="free"><span class="free">g</span></span> <span class="bound"><span class="bound">u</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> assms DERIV_minus <span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> f <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">fu</span> <span class="bound">x</span> <span class="main">-</span> <span class="free">f</span> <span class="bound">x</span>"</span></span><span class="main">]</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword2"><span class="keyword">end</span></span>

</pre>
</div><div id="Atan_CF_Bounds">
<div class="head">
<h1>Theory Atan_CF_Bounds</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Arctan Upper and Lower Bounds›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Atan_CF_Bounds
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Bounds_Lemmas.html">Bounds_Lemmas</a>  
        <span class="quoted">"<a href="../../HOL/HOL-Library/Sum_of_Squares.html">HOL-Library.Sum_of_Squares</a>"</span>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Covers all bounds used in arctan-upper.ax, arctan-lower.ax and arctan-extended.ax,
excepting only arctan-extended2.ax, which is used in two atan-error-analysis problems.›</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Upper Bound 1›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_upper_11</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_upper_11</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span><span class="main">(</span>pi<span class="main">/</span><span class="numeral">2</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">/</span><span class="bound">x</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_arctan_upper_11</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_arctan_upper_11</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_11"><span class="command">lemma</span></span> d_delta_arctan_upper_11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span>
    <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_11 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_arctan_upper_11 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_11_def diff_delta_arctan_upper_11_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_11_pos"><span class="command">lemma</span></span> d_delta_arctan_upper_11_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> diff_delta_arctan_upper_11 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> diff_delta_arctan_upper_11_def
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> zero_less_mult_iff add_pos_pos<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Different proof needed here: they coincide not at zero, but at (-) infinity!›</span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_upper_11"><span class="command">lemma</span></span> arctan_upper_11<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">&lt;</span> arctan_upper_11 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_11 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="main">⤏</span> <span class="main">-</span> <span class="main">(</span>pi <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">-</span> <span class="main">0</span> <span class="main">-</span> <span class="main">(</span><span class="main">-</span> <span class="main">(</span>pi <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> at_bot"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_11_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">tendsto_intros</span></span> tendsto_arctan_at_bot<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ext <span class="main"><span class="main">[</span></span><span class="operator">OF</span> divide_inverse<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> tendsto_inverse_0 at_bot_le_at_infinity tendsto_mono<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> *<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_11 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="main">⤏</span> <span class="main">0</span><span class="main">)</span> at_bot"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> arctan_upper_11 <span class="free">x</span> <span class="main">-</span> arctan <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> DERIV_pos_imp_increasing_at_bot <span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ *<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> assms d_delta_arctan_upper_11 d_delta_arctan_upper_11_pos not_le<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_upper_12</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_upper_12</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="numeral">3</span><span class="main">*</span><span class="bound">x</span> <span class="main">/</span> <span class="main">(</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">3</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_arctan_upper_12</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_arctan_upper_12</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span><span class="numeral">4</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">3</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_12"><span class="command">lemma</span></span> d_delta_arctan_upper_12<span class="main">:</span>
     <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_12 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_arctan_upper_12 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_12_def diff_delta_arctan_upper_12_def
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span><span class="main"><span class="keyword3">,</span></span>  <span class="operator">simp_all</span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Strict inequalities also possible›</span></span>
<span class="keyword1" id="Atan_CF_Bounds-arctan_upper_12"><span class="command">lemma</span></span> arctan_upper_12<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> arctan_upper_12 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_decreasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_arctan_upper_12<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_arctan_upper_12_def arctan_upper_12_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_upper_13</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_upper_13</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_arctan_upper_13</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_arctan_upper_13</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">/</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_13"><span class="command">lemma</span></span> d_delta_arctan_upper_13<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_13 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_arctan_upper_13 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_13_def diff_delta_arctan_upper_13_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_upper_13"><span class="command">lemma</span></span> arctan_upper_13<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> arctan_upper_13 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_arctan_upper_13<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_arctan_upper_13_def arctan_upper_13_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_upper_14</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_upper_14</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> pi<span class="main">/</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">3</span><span class="main">*</span><span class="bound">x</span> <span class="main">/</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="numeral">3</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_arctan_upper_14</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_arctan_upper_14</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span><span class="numeral">4</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="numeral">3</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_14"><span class="command">lemma</span></span> d_delta_arctan_upper_14<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_14 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_arctan_upper_14 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_14_def diff_delta_arctan_upper_14_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> add_nonneg_eq_0_iff<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_14_neg"><span class="command">lemma</span></span> d_delta_arctan_upper_14_neg<span class="main">:</span> <span class="quoted"><span class="quoted">"diff_delta_arctan_upper_14 <span class="free">x</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> diff_delta_arctan_upper_14_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff zero_less_mult_iff<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> power2_less_0 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">arith</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Atan_CF_Bounds-lim14"><span class="command">lemma</span></span> lim14<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">::</span>real<span class="main">.</span> <span class="numeral">3</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">/</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="numeral">3</span> <span class="main">*</span> <span class="bound">x</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⤏</span> <span class="main">0</span><span class="main">)</span> at_infinity"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> tendsto_0_le <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> f <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="quoted"><span class="quoted">inverse</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">and</span></span></span></span> K<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="main"><span class="quoted"><span class="main">1</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> tendsto_inverse_0<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eventually_at_infinity<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="main">1</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power_eq_if abs_if <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_sign_intros<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Different proof needed here: they coincide not at zero, but at (+) infinity!›</span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_upper_14"><span class="command">lemma</span></span> arctan_upper_14<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">&lt;</span> arctan_upper_14 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_14 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="main">⤏</span> pi <span class="main">/</span> <span class="numeral">2</span> <span class="main">-</span> <span class="main">0</span> <span class="main">-</span> pi <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> at_top"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_14_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">tendsto_intros</span></span> tendsto_arctan_at_top<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> tendsto_mono <span class="main"><span class="main">[</span></span><span class="operator">OF</span> at_top_le_at_infinity lim14<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> *<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_14 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="main">⤏</span> <span class="main">0</span><span class="main">)</span> at_top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> arctan_upper_14 <span class="free">x</span> <span class="main">-</span> arctan <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> DERIV_neg_imp_decreasing_at_top <span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ *<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> d_delta_arctan_upper_14 d_delta_arctan_upper_14_neg<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Lower Bound 1›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_lower_11</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_lower_11</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span><span class="main">(</span>pi<span class="main">/</span><span class="numeral">2</span><span class="main">)</span> <span class="main">-</span> <span class="numeral">3</span><span class="main">*</span><span class="bound">x</span> <span class="main">/</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="numeral">3</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_lower_11"><span class="command">lemma</span></span> arctan_lower_11<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> arctan_lower_11 <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> arctan_upper_14 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> arctan_upper_14_def arctan_lower_11_def arctan_minus<span class="main">)</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_lower_12</span> <span class="main">≡</span> arctan_upper_13"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_lower_12"><span class="command">lemma</span></span> arctan_lower_12<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≥</span> arctan_lower_12 <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> arctan_upper_13 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> arctan_upper_13_def arctan_minus<span class="main">)</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_lower_13</span> <span class="main">≡</span> arctan_upper_12"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_lower_13"><span class="command">lemma</span></span> arctan_lower_13<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≥</span> arctan_lower_13 <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> arctan_upper_12 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> arctan_upper_12_def arctan_minus<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_lower_14</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_lower_14</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> pi<span class="main">/</span><span class="numeral">2</span> <span class="main">-</span> <span class="main">1</span><span class="main">/</span><span class="bound">x</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_lower_14"><span class="command">lemma</span></span> arctan_lower_14<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> arctan_lower_14 <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> arctan_upper_11 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> arctan_upper_11_def arctan_lower_14_def arctan_minus<span class="main">)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Upper Bound 3›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_upper_31</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_upper_31</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span><span class="main">(</span>pi<span class="main">/</span><span class="numeral">2</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">64</span> <span class="main">+</span> <span class="numeral">735</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">945</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">15</span><span class="main">*</span><span class="bound">x</span><span class="main">*</span><span class="main">(</span><span class="numeral">15</span> <span class="main">+</span> <span class="numeral">70</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">63</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_arctan_upper_31</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_arctan_upper_31</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="numeral">64</span> <span class="main">/</span> <span class="main">(</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="numeral">15</span> <span class="main">+</span> <span class="numeral">70</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">63</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_31"><span class="command">lemma</span></span> d_delta_arctan_upper_31<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_31 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_arctan_upper_31 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_31_def diff_delta_arctan_upper_31_def
  <span class="keyword1"><span class="command">using</span></span> assms
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> refl <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> add_nonneg_eq_0_iff<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_31_pos"><span class="command">lemma</span></span> d_delta_arctan_upper_31_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> diff_delta_arctan_upper_31 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> diff_delta_arctan_upper_31_def
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> zero_less_mult_iff add_pos_pos add_nonneg_eq_0_iff<span class="main">)</span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_upper_31"><span class="command">lemma</span></span> arctan_upper_31<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">&lt;</span> arctan_upper_31 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> *<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span><span class="main">::</span>real<span class="main">.</span>  <span class="main">(</span><span class="numeral">15</span> <span class="main">+</span> <span class="numeral">70</span> <span class="main">*</span> <span class="bound">x</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">63</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">^</span> <span class="numeral">4</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">sos</span> <span class="quoted">"((R&lt;1 + ((R&lt;1 * ((R&lt;7/8 * [19/7*x^2 + 1]^2) + ((R&lt;4 * [x]^2) + (R&lt;10/7 * [x^2]^2)))) + ((A&lt;=0 * R&lt;1) * (R&lt;1/8 * [1]^2)))))"</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> **<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span><span class="main">::</span>real<span class="main">.</span> <span class="main">¬</span> <span class="main">(</span><span class="numeral">15</span> <span class="main">+</span> <span class="numeral">70</span> <span class="main">*</span> <span class="bound">x</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">63</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">^</span> <span class="numeral">4</span><span class="main">)</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> not_less<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">::</span>real<span class="main">.</span> <span class="main">(</span><span class="numeral">64</span> <span class="main">+</span> <span class="numeral">735</span> <span class="main">*</span> <span class="bound">x</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">945</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">^</span> <span class="numeral">4</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">15</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">*</span> <span class="main">(</span><span class="numeral">15</span> <span class="main">+</span> <span class="numeral">70</span> <span class="main">*</span> <span class="bound">x</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">63</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">^</span> <span class="numeral">4</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⤏</span> <span class="main">0</span><span class="main">)</span> at_bot"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> tendsto_0_le <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> f <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="quoted"><span class="quoted">inverse</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">and</span></span></span></span> K<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="numeral"><span class="quoted"><span class="numeral">2</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> at_bot_le_at_infinity tendsto_inverse_0 tendsto_mono<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eventually_at_bot_linorder<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">-</span><span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> abs_if zero_less_mult_iff **<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_31 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="main">⤏</span> <span class="main">-</span> <span class="main">(</span>pi <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">-</span> <span class="main">0</span> <span class="main">-</span> <span class="main">(</span><span class="main">-</span> <span class="main">(</span>pi <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> at_bot"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_31_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">tendsto_intros</span></span> tendsto_arctan_at_bot<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> *<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_31 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="main">⤏</span> <span class="main">0</span><span class="main">)</span> at_bot"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> arctan_upper_31 <span class="free">x</span> <span class="main">-</span> arctan <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> DERIV_pos_imp_increasing_at_bot <span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ *<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> assms d_delta_arctan_upper_31 d_delta_arctan_upper_31_pos not_le<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_upper_32</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_upper_32</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="numeral">7</span><span class="main">*</span><span class="main">(</span><span class="numeral">33</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">170</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">165</span><span class="main">)</span><span class="main">*</span><span class="bound">x</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">5</span><span class="main">*</span><span class="main">(</span><span class="numeral">5</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span> <span class="main">+</span> <span class="numeral">105</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">315</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">231</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_arctan_upper_32</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_arctan_upper_32</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span><span class="numeral">256</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">12</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="numeral">5</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">105</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">315</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">231</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_32"><span class="command">lemma</span></span> d_delta_arctan_upper_32<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_32 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_arctan_upper_32 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_32_def diff_delta_arctan_upper_32_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp_all</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> add_nonneg_eq_0_iff <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_upper_32"><span class="command">lemma</span></span> arctan_upper_32<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> arctan_upper_32 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_decreasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_arctan_upper_32<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_arctan_upper_32_def arctan_upper_32_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_upper_33</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_upper_33</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="numeral">64</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">735</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">945</span><span class="main">)</span><span class="main">*</span><span class="bound">x</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">15</span><span class="main">*</span><span class="main">(</span><span class="numeral">15</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">70</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">63</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_arctan_upper_33</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_arctan_upper_33</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="numeral">64</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">10</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="numeral">15</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">70</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">63</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_33"><span class="command">lemma</span></span> d_delta_arctan_upper_33<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_33 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_arctan_upper_33 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_33_def diff_delta_arctan_upper_33_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> add_nonneg_eq_0_iff <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_upper_33"><span class="command">lemma</span></span> arctan_upper_33<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> arctan_upper_33 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_arctan_upper_33<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_arctan_upper_33_def arctan_upper_33_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_upper_34</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_upper_34</span> <span class="main">≡</span>
         <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> pi<span class="main">/</span><span class="numeral">2</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">33</span> <span class="main">+</span> <span class="numeral">170</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">165</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">)</span><span class="main">*</span><span class="numeral">7</span><span class="main">*</span><span class="bound">x</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">5</span><span class="main">*</span><span class="main">(</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">105</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">315</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">231</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_arctan_upper_34</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_arctan_upper_34</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span><span class="numeral">256</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="numeral">5</span><span class="main">+</span><span class="numeral">105</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">315</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">231</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_34"><span class="command">lemma</span></span> d_delta_arctan_upper_34<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_34 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_arctan_upper_34 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_34_def diff_delta_arctan_upper_34_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> add_nonneg_eq_0_iff<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_34_pos"><span class="command">lemma</span></span> d_delta_arctan_upper_34_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"diff_delta_arctan_upper_34 <span class="free">x</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> diff_delta_arctan_upper_34_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff zero_less_mult_iff<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> power2_less_0 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">arith</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_upper_34"><span class="command">lemma</span></span> arctan_upper_34<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">&lt;</span> arctan_upper_34 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_34 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="main">⤏</span> pi <span class="main">/</span> <span class="numeral">2</span> <span class="main">-</span> <span class="main">0</span> <span class="main">-</span> pi <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> at_top"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_34_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">tendsto_intros</span></span> tendsto_arctan_at_top<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> tendsto_0_le <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> f <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="quoted"><span class="quoted">inverse</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">and</span></span></span></span> K<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="main"><span class="quoted"><span class="main">1</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> tendsto_inverse_0 at_top_le_at_infinity tendsto_mono<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eventually_at_top_linorder<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="main">1</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> power_eq_if add_pos_pos <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> *<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_34 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="main">⤏</span> <span class="main">0</span><span class="main">)</span> at_top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> arctan_upper_34 <span class="free">x</span> <span class="main">-</span> arctan <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> DERIV_neg_imp_decreasing_at_top <span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ *<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> d_delta_arctan_upper_34 d_delta_arctan_upper_34_pos<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Lower Bound 3›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_lower_31</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_lower_31</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span><span class="main">(</span>pi<span class="main">/</span><span class="numeral">2</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">33</span> <span class="main">+</span> <span class="numeral">170</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">165</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">)</span><span class="main">*</span><span class="numeral">7</span><span class="main">*</span><span class="bound">x</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">5</span><span class="main">*</span><span class="main">(</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">105</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">315</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">231</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_lower_31"><span class="command">lemma</span></span> arctan_lower_31<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> arctan_lower_31 <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> arctan_upper_34 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> arctan_upper_34_def arctan_lower_31_def arctan_minus<span class="main">)</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_lower_32</span> <span class="main">≡</span> arctan_upper_33"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_lower_32"><span class="command">lemma</span></span> arctan_lower_32<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≥</span> arctan_lower_32 <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> arctan_upper_33 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> arctan_upper_33_def arctan_minus<span class="main">)</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_lower_33</span> <span class="main">≡</span> arctan_upper_32"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_lower_33"><span class="command">lemma</span></span> arctan_lower_33<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≥</span> arctan_lower_33 <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> arctan_upper_32 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> arctan_upper_32_def arctan_minus<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_lower_34</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_lower_34</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> pi<span class="main">/</span><span class="numeral">2</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">64</span> <span class="main">+</span> <span class="numeral">735</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">945</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">15</span><span class="main">*</span><span class="bound">x</span><span class="main">*</span><span class="main">(</span><span class="numeral">15</span> <span class="main">+</span> <span class="numeral">70</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">63</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_lower_34"><span class="command">lemma</span></span> arctan_lower_34<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> arctan_lower_34 <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> arctan_upper_31 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> arctan_upper_31_def arctan_lower_34_def arctan_minus<span class="main">)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Upper Bound 4›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_upper_41</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_upper_41</span> <span class="main">≡</span>
        <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span><span class="main">(</span>pi<span class="main">/</span><span class="numeral">2</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">256</span> <span class="main">+</span> <span class="numeral">5943</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">19250</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">15015</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span> <span class="main">/</span>
               <span class="main">(</span><span class="numeral">35</span><span class="main">*</span><span class="bound">x</span><span class="main">*</span><span class="main">(</span><span class="numeral">35</span> <span class="main">+</span> <span class="numeral">315</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">693</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">429</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_arctan_upper_41</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_arctan_upper_41</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="numeral">256</span> <span class="main">/</span> <span class="main">(</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="numeral">35</span><span class="main">+</span><span class="numeral">315</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">693</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">429</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_41"><span class="command">lemma</span></span> d_delta_arctan_upper_41<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_41 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_arctan_upper_41 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_41_def diff_delta_arctan_upper_41_def
  <span class="keyword1"><span class="command">using</span></span> assms
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> refl <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> add_nonneg_eq_0_iff<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_41_pos"><span class="command">lemma</span></span> d_delta_arctan_upper_41_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> diff_delta_arctan_upper_41 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> diff_delta_arctan_upper_41_def
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> zero_less_mult_iff add_pos_pos add_nonneg_eq_0_iff<span class="main">)</span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_upper_41"><span class="command">lemma</span></span> arctan_upper_41<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">&lt;</span> arctan_upper_41 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> *<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span><span class="main">::</span>real<span class="main">.</span> <span class="main">(</span><span class="numeral">35</span> <span class="main">+</span> <span class="numeral">315</span> <span class="main">*</span> <span class="bound">x</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">693</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">^</span> <span class="numeral">4</span> <span class="main">+</span> <span class="numeral">429</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">^</span> <span class="numeral">6</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">sos</span> <span class="quoted">"((R&lt;1 + ((R&lt;1 * ((R&lt;13/8589934592 * [95/26*x^2 + 1]^2) + ((R&lt;38654705675/4294967296 * [170080704731/154618822700*x^3 + x]^2) + ((R&lt;14271/446676598784 * [x^2]^2) + (R&lt;3631584276674589067439/2656331147370089676800 * [x^3]^2))))) + ((A&lt;=0 * R&lt;1) * (R&lt;245426703/8589934592 * [1]^2)))))"</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> **<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span><span class="main">::</span>real<span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="main">0</span> <span class="main">⟹</span> <span class="main">¬</span> <span class="main">(</span><span class="numeral">35</span> <span class="main">+</span> <span class="numeral">315</span> <span class="main">*</span> <span class="bound">x</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">693</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">^</span> <span class="numeral">4</span> <span class="main">+</span> <span class="numeral">429</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">^</span> <span class="numeral">6</span><span class="main">)</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> not_less<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">::</span>real<span class="main">.</span> <span class="main">(</span><span class="numeral">256</span> <span class="main">+</span> <span class="numeral">5943</span> <span class="main">*</span> <span class="bound">x</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">19250</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">^</span> <span class="numeral">4</span> <span class="main">+</span> <span class="numeral">15015</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">^</span> <span class="numeral">6</span><span class="main">)</span> <span class="main">/</span>
           <span class="main">(</span><span class="numeral">35</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">*</span> <span class="main">(</span><span class="numeral">35</span> <span class="main">+</span> <span class="numeral">315</span> <span class="main">*</span> <span class="bound">x</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">693</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">^</span> <span class="numeral">4</span> <span class="main">+</span> <span class="numeral">429</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">^</span> <span class="numeral">6</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⤏</span> <span class="main">0</span><span class="main">)</span> at_bot"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> tendsto_0_le <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> f <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="quoted"><span class="quoted">inverse</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">and</span></span></span></span> K<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="numeral"><span class="quoted"><span class="numeral">2</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> at_bot_le_at_infinity tendsto_inverse_0 tendsto_mono<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eventually_at_bot_linorder<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">"<span class="main">-</span><span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ** abs_if <span class="dynamic"><span class="dynamic">divide_simps</span></span> zero_less_mult_iff<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_41 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="main">⤏</span> <span class="main">-</span> <span class="main">(</span>pi <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">-</span> <span class="main">0</span> <span class="main">-</span> <span class="main">(</span><span class="main">-</span> <span class="main">(</span>pi <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> at_bot"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_41_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">tendsto_intros</span></span> tendsto_arctan_at_bot<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> *<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_41 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="main">⤏</span> <span class="main">0</span><span class="main">)</span> at_bot"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> arctan_upper_41 <span class="free">x</span> <span class="main">-</span> arctan <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> DERIV_pos_imp_increasing_at_bot <span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ *<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> assms d_delta_arctan_upper_41 d_delta_arctan_upper_41_pos not_le<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_upper_42</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_upper_42</span> <span class="main">≡</span>
          <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="numeral">15159</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">147455</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">345345</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">225225</span><span class="main">)</span><span class="main">*</span><span class="bound">x</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">35</span><span class="main">*</span><span class="main">(</span><span class="numeral">35</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">8</span><span class="main">+</span><span class="numeral">1260</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">6930</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">12012</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">6435</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_arctan_upper_42</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_arctan_upper_42</span> <span class="main">≡</span>
            <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span><span class="numeral">16384</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">16</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="numeral">35</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">8</span><span class="main">+</span><span class="numeral">1260</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">6930</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">12012</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">6435</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_42"><span class="command">lemma</span></span> d_delta_arctan_upper_42<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_42 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_arctan_upper_42 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_42_def diff_delta_arctan_upper_42_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_upper_42"><span class="command">lemma</span></span> arctan_upper_42<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> arctan_upper_42 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_decreasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_arctan_upper_42<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_arctan_upper_42_def arctan_upper_42_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_upper_43</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_upper_43</span> <span class="main">≡</span>
          <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="numeral">256</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">5943</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">19250</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">15015</span><span class="main">)</span><span class="main">*</span><span class="bound">x</span> <span class="main">/</span>
              <span class="main">(</span><span class="numeral">35</span> <span class="main">*</span> <span class="main">(</span><span class="numeral">35</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">315</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">693</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">429</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_arctan_upper_43</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_arctan_upper_43</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="numeral">256</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">14</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="numeral">35</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">315</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">693</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">429</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_43"><span class="command">lemma</span></span> d_delta_arctan_upper_43<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_43 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_arctan_upper_43 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_43_def diff_delta_arctan_upper_43_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> add_nonneg_eq_0_iff <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_upper_43"><span class="command">lemma</span></span> arctan_upper_43<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> arctan_upper_43 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_arctan_upper_43<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_arctan_upper_43_def arctan_upper_43_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_upper_44</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_upper_44</span> <span class="main">≡</span>
         <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> pi<span class="main">/</span><span class="numeral">2</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">15159</span><span class="main">+</span><span class="numeral">147455</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">345345</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">225225</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span><span class="main">*</span><span class="bound">x</span> <span class="main">/</span>
                 <span class="main">(</span><span class="numeral">35</span><span class="main">*</span><span class="main">(</span><span class="numeral">35</span><span class="main">+</span><span class="numeral">1260</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">6930</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">12012</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">6435</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">8</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_arctan_upper_44</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_arctan_upper_44</span> <span class="main">≡</span>
    <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span><span class="numeral">16384</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="numeral">35</span><span class="main">+</span><span class="numeral">1260</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">6930</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">12012</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">6435</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">8</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_44"><span class="command">lemma</span></span> d_delta_arctan_upper_44<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_44 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_arctan_upper_44 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_44_def diff_delta_arctan_upper_44_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> add_nonneg_eq_0_iff<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Atan_CF_Bounds-d_delta_arctan_upper_44_pos"><span class="command">lemma</span></span> d_delta_arctan_upper_44_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"diff_delta_arctan_upper_44 <span class="free">x</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> diff_delta_arctan_upper_44_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff zero_less_mult_iff<span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> power2_less_0 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">arith</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_upper_44"><span class="command">lemma</span></span> arctan_upper_44<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">&lt;</span> arctan_upper_44 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_44 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="main">⤏</span> pi <span class="main">/</span> <span class="numeral">2</span> <span class="main">-</span> <span class="main">0</span> <span class="main">-</span> pi <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> at_top"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> arctan_upper_44_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">tendsto_intros</span></span> tendsto_arctan_at_top<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> tendsto_0_le <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> f <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="quoted"><span class="quoted">inverse</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">and</span></span></span></span> K<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="main"><span class="quoted"><span class="main">1</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> tendsto_inverse_0 at_top_le_at_infinity tendsto_mono<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eventually_at_top_linorder<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="main">1</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> zero_le_mult_iff <span class="dynamic"><span class="dynamic">divide_simps</span></span> not_le<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> power_eq_if <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> *<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> arctan_upper_44 <span class="bound">x</span> <span class="main">-</span> arctan <span class="bound">x</span><span class="main">)</span> <span class="main">⤏</span> <span class="main">0</span><span class="main">)</span> at_top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> arctan_upper_44 <span class="free">x</span> <span class="main">-</span> arctan <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> DERIV_neg_imp_decreasing_at_top <span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ *<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> d_delta_arctan_upper_44 d_delta_arctan_upper_44_pos<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Lower Bound 4›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_lower_41</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_lower_41</span> <span class="main">≡</span>
     <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span><span class="main">(</span>pi<span class="main">/</span><span class="numeral">2</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">15159</span><span class="main">+</span><span class="numeral">147455</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">345345</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">225225</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span><span class="main">*</span><span class="bound">x</span> <span class="main">/</span>
                   <span class="main">(</span><span class="numeral">35</span><span class="main">*</span><span class="main">(</span><span class="numeral">35</span><span class="main">+</span><span class="numeral">1260</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">6930</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">12012</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">6435</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">8</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_lower_41"><span class="command">lemma</span></span> arctan_lower_41<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> arctan_lower_41 <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> arctan_upper_44 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> arctan_upper_44_def arctan_lower_41_def arctan_minus<span class="main">)</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_lower_42</span> <span class="main">≡</span> arctan_upper_43"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_lower_42"><span class="command">lemma</span></span> arctan_lower_42<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≥</span> arctan_lower_42 <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> arctan_upper_43 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> arctan_upper_43_def arctan_minus<span class="main">)</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_lower_43</span> <span class="main">≡</span> arctan_upper_42"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_lower_43"><span class="command">lemma</span></span> arctan_lower_43<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≥</span> arctan_lower_43 <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> arctan_upper_42 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> arctan_upper_42_def arctan_minus<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">arctan_lower_44</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">arctan_lower_44</span> <span class="main">≡</span>
    <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> pi<span class="main">/</span><span class="numeral">2</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">256</span><span class="main">+</span><span class="numeral">5943</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">19250</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">15015</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span> <span class="main">/</span>
               <span class="main">(</span><span class="numeral">35</span><span class="main">*</span><span class="bound">x</span><span class="main">*</span><span class="main">(</span><span class="numeral">35</span><span class="main">+</span><span class="numeral">315</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">693</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">429</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Atan_CF_Bounds-arctan_lower_44"><span class="command">lemma</span></span> arctan_lower_44<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arctan<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> arctan_lower_44 <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> arctan_upper_41 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> arctan_upper_41_def arctan_lower_44_def arctan_minus<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>

</pre>
</div><div id="Exp_Bounds">
<div class="head">
<h1>Theory Exp_Bounds</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Exp Upper and Lower Bounds›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Exp_Bounds
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Bounds_Lemmas.html">Bounds_Lemmas</a>
        <span class="quoted">"<a href="../../HOL/HOL-Library/Sum_of_Squares.html">HOL-Library.Sum_of_Squares</a>"</span>
        <a href="../Sturm_Sequences/Sturm.html">Sturm_Sequences.Sturm</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Covers all bounds used in exp-upper.ax, exp-lower.ax and exp-extended.ax.›</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Taylor Series Bounds›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>exp_positive›</span></span></span></span> is the theorem <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">thm</span></span> Transcendental.exp_ge_zero<span class="antiquote"><span class="antiquote">}</span></span></span></span>›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>exp_lower_taylor_1›</span></span></span></span> is the theorem <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">thm</span></span> Transcendental.exp_ge_add_one_self<span class="antiquote"><span class="antiquote">}</span></span></span></span>›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹All even approximants are lower bounds.›</span></span>
<span class="keyword1" id="Exp_Bounds-exp_lower_taylor_even"><span class="command">lemma</span></span> exp_lower_taylor_even<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span><span class="main">::</span><span class="quoted">real</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"even <span class="free">n</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∑</span><span class="bound">m</span><span class="main">&lt;</span><span class="free">n</span><span class="main">.</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="bound">m</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span>fact <span class="bound">m</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> exp <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Maclaurin_exp_le <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span> <span class="quoted"><span class="free">n</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> zero_le_even_power<span class="main">)</span>

<span class="keyword1" id="Exp_Bounds-exp_upper_taylor_even"><span class="command">lemma</span></span> exp_upper_taylor_even<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span><span class="main">::</span><span class="quoted">real</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> n<span class="main">:</span> <span class="quoted"><span class="quoted">"even <span class="free">n</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∑</span><span class="bound">m</span><span class="main">&lt;</span><span class="free">n</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">^</span> <span class="bound">m</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span>fact <span class="bound">m</span><span class="main">)</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>  <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?sum</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span><span class="main">)</span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"exp <span class="free">x</span> <span class="main">≤</span> inverse <span class="var">?sum</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> exp_lower_taylor_even <span class="main">[</span><span class="operator">OF</span> n<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> exp_minus inverse_inverse_eq le_imp_inverse_le pos<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹3 if the previous lemma is expressed in terms of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="numeral"><span class="numeral">2</span></span><span class="main"><span class="main">*</span></span><span class="free"><span class="free">m</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.›</span></span>
<span class="keyword1" id="Exp_Bounds-exp_lower_taylor_3"><span class="command">lemma</span></span> exp_lower_taylor_3<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span><span class="main">::</span><span class="quoted">real</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">+</span> <span class="free">x</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">6</span><span class="main">)</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">24</span><span class="main">)</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">120</span><span class="main">)</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">5</span> <span class="main">≤</span> exp <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> order_trans <span class="main"><span class="main">[</span></span><span class="operator">OF</span> _ exp_lower_taylor_even <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="numeral"><span class="quoted"><span class="numeral"><span class="quoted"><span class="numeral">6</span></span></span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
     <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> lessThan_nat_numeral fact_numeral<span class="main">)</span>

<span class="keyword1" id="Exp_Bounds-exp_lower_taylor_3_cubed"><span class="command">lemma</span></span> exp_lower_taylor_3_cubed<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span><span class="main">::</span><span class="quoted">real</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="free">x</span><span class="main">/</span><span class="numeral">3</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">6</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">24</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">120</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">^</span><span class="numeral">5</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span> <span class="main">≤</span> exp <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="free">x</span><span class="main">/</span><span class="numeral">3</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">6</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">24</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">120</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">^</span><span class="numeral">5</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">3</span>
        <span class="main">≤</span> exp <span class="main">(</span><span class="free">x</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">3</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> power_mono_odd odd_numeral exp_lower_taylor_3<span class="main">)</span>
 <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> exp <span class="free">x</span>"</span></span>
   <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_of_nat_mult <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
 <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Exp_Bounds-exp_lower_taylor_2"><span class="command">lemma</span></span> exp_lower_taylor_2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span><span class="main">::</span><span class="quoted">real</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">+</span> <span class="free">x</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">6</span><span class="main">)</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">≤</span> exp <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"even <span class="main">(</span><span class="numeral">4</span><span class="main">::</span>nat<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∑</span><span class="bound">m</span><span class="main">&lt;</span><span class="numeral">4</span><span class="main">.</span> <span class="free">x</span> <span class="main">^</span> <span class="bound">m</span> <span class="main">/</span> <span class="main">(</span>fact <span class="bound">m</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> exp <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exp_lower_taylor_even<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> numeral_eq_Suc<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Exp_Bounds-exp_upper_bound_case_3"><span class="command">lemma</span></span> exp_upper_bound_case_3<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span><span class="main">::</span><span class="quoted">real</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="numeral">3.19</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"exp <span class="free">x</span> <span class="main">≤</span> <span class="numeral">2304</span> <span class="main">/</span> <span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">6</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">24</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">48</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">48</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">6</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">24</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">48</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">6</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span> power2_eq_square power3_eq_cube<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> exp <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exp_lower_taylor_2<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">48</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">6</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">24</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">48</span><span class="main">)</span> <span class="main">≤</span> exp <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">6</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">24</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">48</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">/</span> <span class="numeral">2304</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">48</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">6</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">24</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">48</span><span class="main">)</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span> power2_eq_square power3_eq_cube<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span>exp <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> power_mono <span class="main"><span class="main">[</span></span><span class="operator">OF</span> 1<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">sos</span> <span class="quoted">"((R&lt;1 + ((R&lt;1 * ((R&lt;1323/13 * [~15/49*x + 1]^2) + (R&lt;1/637 * [x]^2))) + (((A&lt;0 * R&lt;1) * (R&lt;50/13 * [1]^2)) + ((A&lt;=0 * R&lt;1) * ((R&lt;56/13 * [~5/56*x + 1]^2) + (R&lt;199/728 * [x]^2)))))))"</span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> inverse <span class="main">(</span>exp <span class="free">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> exp_minus mult_exp_exp power2_eq_square field_sum_of_halves<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">6</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">24</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">48</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">/</span> <span class="numeral">2304</span> <span class="main">≤</span> inverse <span class="main">(</span>exp <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">6</span> <span class="main">*</span> <span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span> <span class="main">-</span> <span class="free">x</span> <span class="main">^</span> <span class="numeral">3</span> <span class="main">-</span> <span class="numeral">24</span> <span class="main">*</span> <span class="free">x</span> <span class="main">+</span> <span class="numeral">48</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">sos</span> <span class="quoted">"((R&lt;1 + (([~400/13] * A=0) + ((R&lt;1 * ((R&lt;1323/13 * [~15/49*x + 1]^2) + (R&lt;1/637 * [x]^2))) + ((A&lt;=0 * R&lt;1) * ((R&lt;56/13 * [~5/56*x + 1]^2) + (R&lt;199/728 * [x]^2)))))))"</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> Fields.linordered_field_class.le_imp_inverse_le <span class="main">[</span><span class="operator">OF</span> 2<span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Exp_Bounds-exp_upper_bound_case_5"><span class="command">lemma</span></span> exp_upper_bound_case_5<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span><span class="main">::</span><span class="quoted">real</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="numeral">6.36</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"exp <span class="free">x</span> <span class="main">≤</span> <span class="numeral">21743271936</span> <span class="main">/</span> <span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">12</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">96</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">384</span><span class="main">)</span><span class="main">^</span><span class="numeral">4</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">384</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">12</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">96</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">384</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">/</span><span class="numeral">4</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">/</span><span class="numeral">4</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">6</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">/</span><span class="numeral">4</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span> power2_eq_square power3_eq_cube<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> exp <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">/</span><span class="numeral">4</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exp_lower_taylor_2<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">384</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">12</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">96</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">384</span><span class="main">)</span> <span class="main">≤</span> exp <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">/</span><span class="numeral">4</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">12</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">96</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">384</span><span class="main">)</span><span class="main">^</span><span class="numeral">4</span> <span class="main">/</span> <span class="numeral">21743271936</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">384</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">12</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">96</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">384</span><span class="main">)</span><span class="main">)</span><span class="main">^</span><span class="numeral">4</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span>exp <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">/</span><span class="numeral">4</span><span class="main">)</span><span class="main">)</span><span class="main">^</span><span class="numeral">4</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> power_mono <span class="main"><span class="main">[</span></span><span class="operator">OF</span> 1<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">sos</span> <span class="quoted">"((R&lt;1 + ((R&lt;1 * ((R&lt;1777/32 * [~539/3554*x + 1]^2) + (R&lt;907/227456 * [x]^2))) + (((A&lt;0 * R&lt;1) * (R&lt;25/1024 * [1]^2)) + ((A&lt;=0 * R&lt;1) * ((R&lt;49/32 * [~2/49*x + 1]^2) + (R&lt;45/1568 * [x]^2)))))))"</span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> inverse <span class="main">(</span>exp <span class="free">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_of_nat_mult <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> exp_minus <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">12</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">96</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">384</span><span class="main">)</span><span class="main">^</span><span class="numeral">4</span> <span class="main">/</span> <span class="numeral">21743271936</span> <span class="main">≤</span> inverse <span class="main">(</span>exp <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">12</span> <span class="main">*</span> <span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span> <span class="main">-</span> <span class="free">x</span> <span class="main">^</span> <span class="numeral">3</span> <span class="main">-</span> <span class="numeral">96</span> <span class="main">*</span> <span class="free">x</span> <span class="main">+</span> <span class="numeral">384</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">sos</span> <span class="quoted">"((R&lt;1 + (([~25/32] * A=0) + ((R&lt;1 * ((R&lt;1777/32 * [~539/3554*x + 1]^2) + (R&lt;907/227456 * [x]^2))) + ((A&lt;=0 * R&lt;1) * ((R&lt;49/32 * [~2/49*x + 1]^2) + (R&lt;45/1568 * [x]^2)))))))"</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> Fields.linordered_field_class.le_imp_inverse_le <span class="main">[</span><span class="operator">OF</span> 2<span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Continued Fraction Bound 2›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">exp_cf2</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">exp_cf2</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">6</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="numeral">12</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">6</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="numeral">12</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Exp_Bounds-denom_cf2_pos"><span class="command">lemma</span></span> denom_cf2_pos<span class="main">:</span> <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span><span class="main">::</span><span class="quoted">real</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span> <span class="main">-</span> <span class="numeral">6</span> <span class="main">*</span> <span class="free">x</span> <span class="main">+</span> <span class="numeral">12</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">sos</span> <span class="quoted">"((R&lt;1 + ((R&lt;1 * ((R&lt;5 * [~3/10*x + 1]^2) + (R&lt;1/20 * [x]^2))) + ((A&lt;=0 * R&lt;1) * (R&lt;1/2 * [1]^2)))))"</span><span class="main">)</span>

<span class="keyword1" id="Exp_Bounds-numer_cf2_pos"><span class="command">lemma</span></span> numer_cf2_pos<span class="main">:</span> <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span><span class="main">::</span><span class="quoted">real</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span> <span class="main">+</span> <span class="numeral">6</span> <span class="main">*</span> <span class="free">x</span> <span class="main">+</span> <span class="numeral">12</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">sos</span> <span class="quoted">"((R&lt;1 + ((R&lt;1 * ((R&lt;5 * [3/10*x + 1]^2) + (R&lt;1/20 * [x]^2))) + ((A&lt;=0 * R&lt;1) * (R&lt;1/2 * [1]^2)))))"</span><span class="main">)</span>

<span class="keyword1" id="Exp_Bounds-exp_cf2_pos"><span class="command">lemma</span></span> exp_cf2_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"exp_cf2 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> exp_cf2_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> denom_cf2_pos numer_cf2_pos<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_lnexp_cf2</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_lnexp_cf2</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span> <span class="main">(</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">6</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="numeral">12</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">6</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="numeral">12</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Exp_Bounds-d_delta_lnexp_cf2_nonpos"><span class="command">lemma</span></span> d_delta_lnexp_cf2_nonpos<span class="main">:</span> <span class="quoted"><span class="quoted">"diff_delta_lnexp_cf2 <span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> diff_delta_lnexp_cf2_def
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">sos</span> <span class="quoted">"(((R&lt;1 + ((R&lt;1 * ((R&lt;5/4 * [~3/40*x^2 + 1]^2) + (R&lt;11/1280 * [x^2]^2))) +
      ((A&lt;1 * R&lt;1) * (R&lt;1/64 * [1]^2))))) &amp; ((R&lt;1 + ((R&lt;1 * ((R&lt;5/4 * [~3/40*x^2 + 1]^2) + (R&lt;11/1280 * [x^2]^2))) + ((A&lt;1 * R&lt;1) * (R&lt;1/64 * [1]^2))))))"</span><span class="main">)</span>

<span class="keyword1" id="Exp_Bounds-d_delta_lnexp_cf2"><span class="command">lemma</span></span> d_delta_lnexp_cf2<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> ln <span class="main">(</span>exp_cf2 <span class="bound">x</span><span class="main">)</span> <span class="main">-</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_lnexp_cf2 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> exp_cf2_def diff_delta_lnexp_cf2_def
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> exp_cf2_def exp_cf2_pos<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> denom_cf2_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> numer_cf2_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">algebra</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Upper bound for non-positive x›</span></span>
<span class="keyword1" id="Exp_Bounds-ln_exp_cf2_upper_bound_neg"><span class="command">lemma</span></span> ln_exp_cf2_upper_bound_neg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> ln <span class="main">(</span>exp_cf2 <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_decreasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_lnexp_cf2 d_delta_lnexp_cf2_nonpos<span class="main"><span class="main">]</span></span><span class="main">)</span>
     <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_cf2_def<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> exp_cf2_upper_bound_neg<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">≤</span><span class="main">0</span> <span class="main">⟹</span> exp<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> exp_cf2 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ln_exp_cf2_upper_bound_neg exp_cf2_pos exp_le_cancel_iff exp_ln_iff<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Lower bound for non-negative x›</span></span>
<span class="keyword1" id="Exp_Bounds-ln_exp_cf2_lower_bound_pos"><span class="command">lemma</span></span> ln_exp_cf2_lower_bound_pos<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">≤</span><span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln <span class="main">(</span>exp_cf2 <span class="free">x</span><span class="main">)</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> gen_lower_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_lnexp_cf2 d_delta_lnexp_cf2_nonpos<span class="main"><span class="main">]</span></span><span class="main">)</span>
     <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_cf2_def<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> exp_cf2_lower_bound_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">≤</span><span class="free">x</span> <span class="main">⟹</span> exp_cf2 <span class="free">x</span> <span class="main">≤</span> exp <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> exp_cf2_pos exp_le_cancel_iff exp_ln ln_exp_cf2_lower_bound_pos<span class="main">)</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Continued Fraction Bound 3›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This bound crosses the X-axis twice, causing complications.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">numer_cf3</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">numer_cf3</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">12</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">60</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="numeral">120</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">exp_cf3</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">exp_cf3</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> numer_cf3 <span class="bound">x</span> <span class="main">/</span> numer_cf3 <span class="main">(</span><span class="main">-</span><span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Exp_Bounds-numer_cf3_pos"><span class="command">lemma</span></span> numer_cf3_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="numeral">4.64</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> numer_cf3 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> numer_cf3_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">sturm</span>

<span class="keyword1" id="Exp_Bounds-exp_cf3_pos"><span class="command">lemma</span></span> exp_cf3_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"numer_cf3 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> numer_cf3 <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> exp_cf3 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_cf3_def<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_lnexp_cf3</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_lnexp_cf3</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span>numer_cf3 <span class="main">(</span><span class="main">-</span><span class="bound">x</span><span class="main">)</span> <span class="main">*</span> numer_cf3 <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Exp_Bounds-d_delta_lnexp_cf3_nonneg"><span class="command">lemma</span></span> d_delta_lnexp_cf3_nonneg<span class="main">:</span> <span class="quoted"><span class="quoted">"numer_cf3 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> numer_cf3 <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> diff_delta_lnexp_cf3 <span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> diff_delta_lnexp_cf3_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> mult_less_0_iff <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> divide_nonneg_neg<span class="main">)</span>

<span class="keyword1" id="Exp_Bounds-d_delta_lnexp_cf3"><span class="command">lemma</span></span> d_delta_lnexp_cf3<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"numer_cf3 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"numer_cf3 <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> ln <span class="main">(</span>exp_cf3 <span class="bound">x</span><span class="main">)</span> <span class="main">-</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_lnexp_cf3 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> exp_cf3_def numer_cf3_def diff_delta_lnexp_cf3_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command">using</span></span> assms numer_cf3_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> numer_cf3_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> numer_cf3_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">algebra</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Exp_Bounds-numer_cf3_mono"><span class="command">lemma</span></span> numer_cf3_mono<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> numer_cf3 <span class="free">y</span> <span class="main">≤</span> numer_cf3 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> numer_cf3_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">sos</span> <span class="quoted">"(((A&lt;0 * R&lt;1) + ((A&lt;=0 * R&lt;1) * ((R&lt;60 * [1/10*x + 1/10*y + 1]^2) +
                ((R&lt;2/5 * [x + ~1/4*y]^2) + (R&lt;3/8 * [y]^2))))))"</span><span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Upper bound for non-negative x›</span></span>
<span class="keyword1" id="Exp_Bounds-ln_exp_cf3_upper_bound_nonneg"><span class="command">lemma</span></span> ln_exp_cf3_upper_bound_nonneg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> x0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> xless<span class="main">:</span> <span class="quoted"><span class="quoted">"numer_cf3 <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> ln <span class="main">(</span>exp_cf3 <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> ncf3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="main">0</span> <span class="main">≤</span> <span class="bound">y</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> numer_cf3 <span class="main">(</span><span class="main">-</span><span class="bound">y</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> neg_le_iff_le numer_cf3_mono order.strict_trans2 xless<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> x0 d_delta_lnexp_cf3 d_delta_lnexp_cf3_nonneg<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ncf3 assms numer_cf3_pos<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_cf3_def numer_cf3_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> exp_cf3_upper_bound_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> numer_cf3 <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> exp <span class="free">x</span> <span class="main">≤</span> exp_cf3 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ln_exp_cf3_upper_bound_nonneg <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> exp_cf3_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> numer_cf3_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> exp_le_cancel_iff exp_ln_iff<span class="main">)</span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">≤</span> <span class="numeral">4.64</span> <span class="main">⟹</span> exp <span class="free">x</span> <span class="main">≤</span> exp_cf3 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> numer_cf3_pos neg_le_iff_le exp_cf3_upper_bound_pos<span class="main">)</span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Lower bound for negative x, provided <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span><span class="quoted"><span class="quoted">"exp_cf3 <span class="free"><span class="free">x</span></span> <span class="main"><span class="main">&gt;</span></span> <span class="main"><span class="main">0</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>]›</span></span>
<span class="keyword1" id="Exp_Bounds-ln_exp_cf3_lower_bound_neg"><span class="command">lemma</span></span> ln_exp_cf3_lower_bound_neg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> x0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> xgtr<span class="main">:</span> <span class="quoted"><span class="quoted">"numer_cf3 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln <span class="main">(</span>exp_cf3 <span class="free">x</span><span class="main">)</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> ncf3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="free">x</span> <span class="main">≤</span> <span class="bound">y</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">≤</span> <span class="main">0</span> <span class="main">⟹</span> numer_cf3 <span class="bound">y</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dual_order.strict_trans1 numer_cf3_mono xgtr<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_lower_bound_decreasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> x0 d_delta_lnexp_cf3 d_delta_lnexp_cf3_nonneg<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ncf3 assms numer_cf3_pos<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_cf3_def numer_cf3_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> exp_cf3_lower_bound_pos<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"exp_cf3 <span class="free">x</span> <span class="main">≤</span> exp <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"numer_cf3 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> True
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"exp_cf3 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms numer_cf3_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> exp_cf3_pos<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">using</span></span> ln_exp_cf3_lower_bound_neg <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> assms True
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> exp_le_cancel_iff exp_ln_iff<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"exp_cf3 <span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms numer_cf3_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">unfolding</span></span> exp_cf3_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> divide_nonpos_pos<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> exp_ge_zero order.trans<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Continued Fraction Bound 4›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Here we have the extended exp continued fraction bounds›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">numer_cf4</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">numer_cf4</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">20</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">180</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">840</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="numeral">1680</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">exp_cf4</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">exp_cf4</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> numer_cf4 <span class="bound">x</span> <span class="main">/</span> numer_cf4 <span class="main">(</span><span class="main">-</span><span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Exp_Bounds-numer_cf4_pos"><span class="command">lemma</span></span> numer_cf4_pos<span class="main">:</span> <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span><span class="main">::</span><span class="quoted">real</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"numer_cf4 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> numer_cf4_def
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">sos</span> <span class="quoted">"((R&lt;1 + ((R&lt;1 * ((R&lt;4469/256 * [1135/71504*x^2 + 4725/17876*x + 1]^2) + ((R&lt;3728645/18305024 * [536265/2982916*x^2 + x]^2) + (R&lt;106265/24436047872 * [x^2]^2)))) + ((A&lt;=0 * R&lt;1) * (R&lt;45/4096 * [1]^2)))))"</span><span class="main">)</span>

<span class="keyword1" id="Exp_Bounds-exp_cf4_pos"><span class="command">lemma</span></span> exp_cf4_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"exp_cf4 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> exp_cf4_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> numer_cf4_pos<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_lnexp_cf4</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_lnexp_cf4</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span> <span class="main">(</span><span class="bound">x</span><span class="main">^</span><span class="numeral">8</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span>numer_cf4 <span class="main">(</span><span class="main">-</span><span class="bound">x</span><span class="main">)</span> <span class="main">*</span> numer_cf4 <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Exp_Bounds-d_delta_lnexp_cf4_nonpos"><span class="command">lemma</span></span> d_delta_lnexp_cf4_nonpos<span class="main">:</span> <span class="quoted"><span class="quoted">"diff_delta_lnexp_cf4 <span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> diff_delta_lnexp_cf4_def
  <span class="keyword1"><span class="command">using</span></span> numer_cf4_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> numer_cf4_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> zero_le_divide_iff zero_le_mult_iff<span class="main">)</span>

<span class="keyword1" id="Exp_Bounds-d_delta_lnexp_cf4"><span class="command">lemma</span></span> d_delta_lnexp_cf4<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> ln <span class="main">(</span>exp_cf4 <span class="bound">x</span><span class="main">)</span> <span class="main">-</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_lnexp_cf4 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> exp_cf4_def numer_cf4_def diff_delta_lnexp_cf4_def
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">using</span></span> exp_cf4_pos
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_cf4_def numer_cf4_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> numer_cf4_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span>  numer_cf4_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> numer_cf4_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">algebra</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Upper bound for non-positive x›</span></span>
<span class="keyword1" id="Exp_Bounds-ln_exp_cf4_upper_bound_neg"><span class="command">lemma</span></span> ln_exp_cf4_upper_bound_neg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> ln <span class="main">(</span>exp_cf4 <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_decreasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_lnexp_cf4 d_delta_lnexp_cf4_nonpos<span class="main"><span class="main">]</span></span><span class="main">)</span>
     <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_cf4_def numer_cf4_def<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> exp_cf4_upper_bound_neg<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">≤</span><span class="main">0</span> <span class="main">⟹</span> exp<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> exp_cf4 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ln_exp_cf4_upper_bound_neg exp_cf4_pos exp_le_cancel_iff exp_ln_iff<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Lower bound for non-negative x›</span></span>
<span class="keyword1" id="Exp_Bounds-ln_exp_cf4_lower_bound_pos"><span class="command">lemma</span></span> ln_exp_cf4_lower_bound_pos<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">≤</span><span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln <span class="main">(</span>exp_cf4 <span class="free">x</span><span class="main">)</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> gen_lower_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_lnexp_cf4 d_delta_lnexp_cf4_nonpos<span class="main"><span class="main">]</span></span><span class="main">)</span>
     <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_cf4_def numer_cf4_def<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> exp_cf4_lower_bound_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">≤</span><span class="free">x</span> <span class="main">⟹</span> exp_cf4 <span class="free">x</span> <span class="main">≤</span> exp <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> exp_cf4_pos exp_le_cancel_iff exp_ln ln_exp_cf4_lower_bound_pos<span class="main">)</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Continued Fraction Bound 5›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This bound crosses the X-axis twice, causing complications.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">numer_cf5</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">numer_cf5</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">30</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">420</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">3360</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">15120</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="numeral">30240</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">exp_cf5</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">exp_cf5</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> numer_cf5 <span class="bound">x</span> <span class="main">/</span> numer_cf5 <span class="main">(</span><span class="main">-</span><span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Exp_Bounds-numer_cf5_pos"><span class="command">lemma</span></span> numer_cf5_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="numeral">7.293</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> numer_cf5 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> numer_cf5_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">sturm</span>

<span class="keyword1" id="Exp_Bounds-exp_cf5_pos"><span class="command">lemma</span></span> exp_cf5_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"numer_cf5 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> numer_cf5 <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> exp_cf5 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> exp_cf5_def numer_cf5_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> divide_neg_neg<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_lnexp_cf5</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_lnexp_cf5</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span><span class="main">^</span><span class="numeral">10</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span>numer_cf5 <span class="main">(</span><span class="main">-</span><span class="bound">x</span><span class="main">)</span> <span class="main">*</span> numer_cf5 <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Exp_Bounds-d_delta_lnexp_cf5_nonneg"><span class="command">lemma</span></span> d_delta_lnexp_cf5_nonneg<span class="main">:</span> <span class="quoted"><span class="quoted">"numer_cf5 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> numer_cf5 <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> diff_delta_lnexp_cf5 <span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> diff_delta_lnexp_cf5_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_less_0_iff <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> divide_nonneg_neg <span class="main">)</span>

<span class="keyword1" id="Exp_Bounds-d_delta_lnexp_cf5"><span class="command">lemma</span></span> d_delta_lnexp_cf5<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"numer_cf5 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"numer_cf5 <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> ln <span class="main">(</span>exp_cf5 <span class="bound">x</span><span class="main">)</span> <span class="main">-</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_lnexp_cf5 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> exp_cf5_def numer_cf5_def diff_delta_lnexp_cf5_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command">using</span></span> assms numer_cf5_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> numer_cf5_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> numer_cf5_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">algebra</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Proving monotonicity via a non-negative derivative›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">numer_cf5_deriv</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">numer_cf5_deriv</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="numeral">5</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">120</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">1260</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">6720</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="numeral">15120</span>"</span></span>

<span class="keyword1" id="Exp_Bounds-numer_cf5_deriv"><span class="command">lemma</span></span> numer_cf5_deriv<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>numer_cf5 <span class="keyword1">has_field_derivative</span> numer_cf5_deriv <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> numer_cf5_def numer_cf5_deriv_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1" id="Exp_Bounds-numer_cf5_deriv_pos"><span class="command">lemma</span></span> numer_cf5_deriv_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"numer_cf5_deriv <span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> numer_cf5_deriv_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">sos</span> <span class="quoted">"((R&lt;1 + ((R&lt;1 * ((R&lt;185533/8192 * [73459/5937056*x^2 + 43050/185533*x + 1]^2) + ((R&lt;4641265253/24318181376 * [700850925/4641265253*x^2 + x]^2) + (R&lt;38142496079/38933754831437824 * [x^2]^2)))) + ((A&lt;0 * R&lt;1) * (R&lt;205/131072 * [1]^2)))))"</span><span class="main">)</span>

<span class="keyword1" id="Exp_Bounds-numer_cf5_mono"><span class="command">lemma</span></span> numer_cf5_mono<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> numer_cf5 <span class="free">y</span> <span class="main">≤</span> numer_cf5 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> DERIV_nonneg_imp_nondecreasing numer_cf5_deriv numer_cf5_deriv_pos<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Results›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Upper bound for non-negative x›</span></span>
<span class="keyword1" id="Exp_Bounds-ln_exp_cf5_upper_bound_nonneg"><span class="command">lemma</span></span> ln_exp_cf5_upper_bound_nonneg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> x0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> xless<span class="main">:</span> <span class="quoted"><span class="quoted">"numer_cf5 <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> ln <span class="main">(</span>exp_cf5 <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> ncf5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="main">0</span> <span class="main">≤</span> <span class="bound">y</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> numer_cf5 <span class="main">(</span><span class="main">-</span><span class="bound">y</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> neg_le_iff_le numer_cf5_mono order.strict_trans2 xless<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> x0 d_delta_lnexp_cf5 d_delta_lnexp_cf5_nonneg<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ncf5 assms numer_cf5_pos<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_cf5_def numer_cf5_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> exp_cf5_upper_bound_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> numer_cf5 <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> exp <span class="free">x</span> <span class="main">≤</span> exp_cf5 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ln_exp_cf5_upper_bound_nonneg <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> exp_cf5_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> numer_cf5_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> exp_le_cancel_iff exp_ln_iff<span class="main">)</span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">≤</span> <span class="numeral">7.293</span> <span class="main">⟹</span> exp <span class="free">x</span> <span class="main">≤</span> exp_cf5 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> neg_le_iff_le numer_cf5_pos exp_cf5_upper_bound_pos<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Lower bound for negative x, provided <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span><span class="quoted"><span class="quoted">"exp_cf5 <span class="free"><span class="free">x</span></span> <span class="main"><span class="main">&gt;</span></span> <span class="main"><span class="main">0</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>]›</span></span>
<span class="keyword1" id="Exp_Bounds-ln_exp_cf5_lower_bound_neg"><span class="command">lemma</span></span> ln_exp_cf5_lower_bound_neg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> x0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> xgtr<span class="main">:</span> <span class="quoted"><span class="quoted">"numer_cf5 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln <span class="main">(</span>exp_cf5 <span class="free">x</span><span class="main">)</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> ncf5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="free">x</span> <span class="main">≤</span> <span class="bound">y</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">≤</span> <span class="main">0</span> <span class="main">⟹</span> numer_cf5 <span class="bound">y</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dual_order.strict_trans1 numer_cf5_mono xgtr<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_lower_bound_decreasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> x0 d_delta_lnexp_cf5 d_delta_lnexp_cf5_nonneg<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ncf5 assms numer_cf5_pos<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_cf5_def numer_cf5_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> exp_cf5_lower_bound_pos<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"exp_cf5 <span class="free">x</span> <span class="main">≤</span> exp <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"numer_cf5 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> True
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"exp_cf5 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms numer_cf5_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> exp_cf5_pos<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">using</span></span> ln_exp_cf5_lower_bound_neg <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> assms True
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> exp_le_cancel_iff exp_ln_iff<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"exp_cf5 <span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms numer_cf5_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">unfolding</span></span> exp_cf5_def numer_cf5_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> divide_nonpos_pos<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> exp_ge_zero order.trans<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Continued Fraction Bound 6›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">numer_cf6</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">numer_cf6</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">^</span><span class="numeral">6</span> <span class="main">+</span> <span class="numeral">42</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">840</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">10080</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">75600</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">332640</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="numeral">665280</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">exp_cf6</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">exp_cf6</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> numer_cf6 <span class="bound">x</span> <span class="main">/</span> numer_cf6 <span class="main">(</span><span class="main">-</span><span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Exp_Bounds-numer_cf6_pos"><span class="command">lemma</span></span> numer_cf6_pos<span class="main">:</span> <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span><span class="main">::</span><span class="quoted">real</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"numer_cf6 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> numer_cf6_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">sturm</span>

<span class="keyword1" id="Exp_Bounds-exp_cf6_pos"><span class="command">lemma</span></span> exp_cf6_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"exp_cf6 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> exp_cf6_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> numer_cf6_pos<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_lnexp_cf6</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_lnexp_cf6</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span> <span class="main">(</span><span class="bound">x</span><span class="main">^</span><span class="numeral">12</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span>numer_cf6 <span class="main">(</span><span class="main">-</span><span class="bound">x</span><span class="main">)</span> <span class="main">*</span> numer_cf6 <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Exp_Bounds-d_delta_lnexp_cf6_nonpos"><span class="command">lemma</span></span> d_delta_lnexp_cf6_nonpos<span class="main">:</span> <span class="quoted"><span class="quoted">"diff_delta_lnexp_cf6 <span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> diff_delta_lnexp_cf6_def
  <span class="keyword1"><span class="command">using</span></span> numer_cf6_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span>  numer_cf6_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> zero_le_divide_iff zero_le_mult_iff<span class="main">)</span>

<span class="keyword1" id="Exp_Bounds-d_delta_lnexp_cf6"><span class="command">lemma</span></span> d_delta_lnexp_cf6<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> ln <span class="main">(</span>exp_cf6 <span class="bound">x</span><span class="main">)</span> <span class="main">-</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_lnexp_cf6 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> exp_cf6_def diff_delta_lnexp_cf6_def numer_cf6_def
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">using</span></span> exp_cf6_pos
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_cf6_def numer_cf6_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> numer_cf6_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span>  numer_cf6_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> numer_cf6_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">algebra</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Upper bound for non-positive x›</span></span>
<span class="keyword1" id="Exp_Bounds-ln_exp_cf6_upper_bound_neg"><span class="command">lemma</span></span> ln_exp_cf6_upper_bound_neg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> ln <span class="main">(</span>exp_cf6 <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_decreasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_lnexp_cf6 d_delta_lnexp_cf6_nonpos<span class="main"><span class="main">]</span></span><span class="main">)</span>
     <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_cf6_def numer_cf6_def<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> exp_cf6_upper_bound_neg<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">≤</span><span class="main">0</span> <span class="main">⟹</span> exp<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> exp_cf6 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ln_exp_cf6_upper_bound_neg exp_cf6_pos exp_le_cancel_iff exp_ln_iff<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Lower bound for non-negative x›</span></span>
<span class="keyword1" id="Exp_Bounds-ln_exp_cf6_lower_bound_pos"><span class="command">lemma</span></span> ln_exp_cf6_lower_bound_pos<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">≤</span><span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln <span class="main">(</span>exp_cf6 <span class="free">x</span><span class="main">)</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> gen_lower_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_lnexp_cf6 d_delta_lnexp_cf6_nonpos<span class="main"><span class="main">]</span></span><span class="main">)</span>
     <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_cf6_def numer_cf6_def<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> exp_cf6_lower_bound_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">≤</span><span class="free">x</span> <span class="main">⟹</span> exp_cf6 <span class="free">x</span> <span class="main">≤</span> exp <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> exp_cf6_pos exp_le_cancel_iff exp_ln ln_exp_cf6_lower_bound_pos<span class="main">)</span>

  
<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Continued Fraction Bound 7›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This bound crosses the X-axis twice, causing complications.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">numer_cf7</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">numer_cf7</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">^</span><span class="numeral">7</span> <span class="main">+</span> <span class="numeral">56</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span> <span class="main">+</span> <span class="numeral">1512</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">25200</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">277200</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">1995840</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">8648640</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="numeral">17297280</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">exp_cf7</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">exp_cf7</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> numer_cf7 <span class="bound">x</span> <span class="main">/</span> numer_cf7 <span class="main">(</span><span class="main">-</span><span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Exp_Bounds-numer_cf7_pos"><span class="command">lemma</span></span> numer_cf7_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="numeral">9.943</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> numer_cf7 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> numer_cf7_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">sturm</span>

<span class="keyword1" id="Exp_Bounds-exp_cf7_pos"><span class="command">lemma</span></span> exp_cf7_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"numer_cf7 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> numer_cf7 <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> exp_cf7 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_cf7_def<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_lnexp_cf7</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_lnexp_cf7</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span><span class="main">^</span><span class="numeral">14</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span>numer_cf7 <span class="main">(</span><span class="main">-</span><span class="bound">x</span><span class="main">)</span> <span class="main">*</span> numer_cf7 <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Exp_Bounds-d_delta_lnexp_cf7_nonneg"><span class="command">lemma</span></span> d_delta_lnexp_cf7_nonneg<span class="main">:</span> <span class="quoted"><span class="quoted">"numer_cf7 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> numer_cf7 <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> diff_delta_lnexp_cf7 <span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> diff_delta_lnexp_cf7_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> mult_less_0_iff <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> divide_nonneg_neg<span class="main">)</span>

<span class="keyword1" id="Exp_Bounds-d_delta_lnexp_cf7"><span class="command">lemma</span></span> d_delta_lnexp_cf7<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"numer_cf7 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"numer_cf7 <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> ln <span class="main">(</span>exp_cf7 <span class="bound">x</span><span class="main">)</span> <span class="main">-</span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_lnexp_cf7 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> exp_cf7_def numer_cf7_def diff_delta_lnexp_cf7_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command">using</span></span> assms numer_cf7_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> numer_cf7_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> numer_cf7_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">algebra</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Proving monotonicity via a non-negative derivative›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">numer_cf7_deriv</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">numer_cf7_deriv</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="numeral">7</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span> <span class="main">+</span> <span class="numeral">336</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">7560</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">100800</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">831600</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">3991680</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="numeral">8648640</span>"</span></span>

<span class="keyword1" id="Exp_Bounds-numer_cf7_deriv"><span class="command">lemma</span></span> numer_cf7_deriv<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>numer_cf7 <span class="keyword1">has_field_derivative</span> numer_cf7_deriv <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> numer_cf7_def numer_cf7_deriv_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1" id="Exp_Bounds-numer_cf7_deriv_pos"><span class="command">lemma</span></span> numer_cf7_deriv_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"numer_cf7_deriv <span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> numer_cf7_deriv_def
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> order.strict_implies_order<span class="main">)</span>  <span class="comment1">― ‹FIXME should not be necessary›</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">sturm</span>

<span class="keyword1" id="Exp_Bounds-numer_cf7_mono"><span class="command">lemma</span></span> numer_cf7_mono<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> numer_cf7 <span class="free">y</span> <span class="main">≤</span> numer_cf7 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> DERIV_nonneg_imp_nondecreasing numer_cf7_deriv numer_cf7_deriv_pos<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Results›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Upper bound for non-negative x›</span></span>
<span class="keyword1" id="Exp_Bounds-ln_exp_cf7_upper_bound_nonneg"><span class="command">lemma</span></span> ln_exp_cf7_upper_bound_nonneg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> x0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> xless<span class="main">:</span> <span class="quoted"><span class="quoted">"numer_cf7 <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> ln <span class="main">(</span>exp_cf7 <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> ncf7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="main">0</span> <span class="main">≤</span> <span class="bound">y</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> numer_cf7 <span class="main">(</span><span class="main">-</span><span class="bound">y</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> neg_le_iff_le numer_cf7_mono order.strict_trans2 xless<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> x0 d_delta_lnexp_cf7 d_delta_lnexp_cf7_nonneg<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ncf7 assms numer_cf7_pos<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_cf7_def numer_cf7_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> exp_cf7_upper_bound_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> numer_cf7 <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> exp <span class="free">x</span> <span class="main">≤</span> exp_cf7 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ln_exp_cf7_upper_bound_nonneg <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> exp_cf7_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> numer_cf7_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> exp_le_cancel_iff exp_ln_iff<span class="main">)</span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">≤</span> <span class="numeral">9.943</span> <span class="main">⟹</span> exp <span class="free">x</span> <span class="main">≤</span> exp_cf7 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> neg_le_iff_le numer_cf7_pos exp_cf7_upper_bound_pos<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Lower bound for negative x, provided <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span><span class="quoted"><span class="quoted">"exp_cf7 <span class="free"><span class="free">x</span></span> <span class="main"><span class="main">&gt;</span></span> <span class="main"><span class="main">0</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>]›</span></span>
<span class="keyword1" id="Exp_Bounds-ln_exp_cf7_lower_bound_neg"><span class="command">lemma</span></span> ln_exp_cf7_lower_bound_neg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> x0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> xgtr<span class="main">:</span> <span class="quoted"><span class="quoted">"numer_cf7 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln <span class="main">(</span>exp_cf7 <span class="free">x</span><span class="main">)</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> ncf7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="free">x</span> <span class="main">≤</span> <span class="bound">y</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">≤</span> <span class="main">0</span> <span class="main">⟹</span> numer_cf7 <span class="bound">y</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dual_order.strict_trans1 numer_cf7_mono xgtr<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_lower_bound_decreasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> x0 d_delta_lnexp_cf7 d_delta_lnexp_cf7_nonneg<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ncf7 assms numer_cf7_pos<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> exp_cf7_def numer_cf7_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> exp_cf7_lower_bound_pos<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"exp_cf7 <span class="free">x</span> <span class="main">≤</span> exp <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"numer_cf7 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> True
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"exp_cf7 <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms numer_cf7_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> exp_cf7_pos<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">using</span></span> ln_exp_cf7_lower_bound_neg <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> assms True
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> exp_le_cancel_iff exp_ln_iff<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"exp_cf7 <span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms numer_cf7_pos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">unfolding</span></span> exp_cf7_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> divide_nonpos_pos<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> exp_ge_zero order.trans<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

</pre>
</div><div id="Log_CF_Bounds">
<div class="head">
<h1>Theory Log_CF_Bounds</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Log Upper and Lower Bounds›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Log_CF_Bounds
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Bounds_Lemmas.html">Bounds_Lemmas</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">theorem</span></span> ln_upper_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span> ln<span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ln_le_minus_one<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ln_lower_1</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ln_lower_1</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">1</span> <span class="main">-</span> <span class="main">(</span>inverse <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">corollary</span></span> ln_lower_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span> ln_lower_1 <span class="free">x</span> <span class="main">≤</span> ln <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ln_lower_1_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ln_inverse ln_le_minus_one positive_imp_inverse_positive minus_diff_eq minus_le_iff<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> ln_lower_1_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span> ln_lower_1 <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">/</span><span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ln_lower_1_def <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Upper Bound 3›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ln_upper_3</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ln_upper_3</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">+</span> <span class="numeral">5</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="bound">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_ln_upper_3</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_ln_upper_3</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Log_CF_Bounds-d_delta_ln_upper_3"><span class="command">lemma</span></span> d_delta_ln_upper_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span>
    <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> ln_upper_3 <span class="bound">x</span> <span class="main">-</span> ln <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_ln_upper_3 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> ln_upper_3_def diff_delta_ln_upper_3_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Strict inequalities also possible›</span></span>
<span class="keyword1" id="Log_CF_Bounds-ln_upper_3_pos"><span class="command">lemma</span></span> ln_upper_3_pos<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_3 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_ln_upper_3<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_ln_upper_3_def ln_upper_3_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Log_CF_Bounds-ln_upper_3_neg"><span class="command">lemma</span></span> ln_upper_3_neg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_3 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_decreasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> x1 d_delta_ln_upper_3<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_ln_upper_3_def <span class="dynamic"><span class="dynamic">divide_simps</span></span> ln_upper_3_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">theorem</span></span> ln_upper_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span> ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_3 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> le_less_linear less_eq_real_def ln_upper_3_neg ln_upper_3_pos<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ln_lower_3</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ln_lower_3</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span> ln_upper_3 <span class="main">(</span>inverse <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">corollary</span></span> ln_lower_3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span> ln_lower_3 <span class="free">x</span> <span class="main">≤</span> ln <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ln_lower_3_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ln_inverse inverse_positive_iff_positive minus_le_iff ln_upper_3<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> ln_lower_3_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span> ln_lower_3 <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">2</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="numeral">5</span><span class="main">*</span><span class="free">x</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ln_lower_3_def ln_upper_3_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span> <span class="operator">algebra</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Upper Bound 5›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ln_upper_5</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ln_upper_5</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">19</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> <span class="numeral">10</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">3</span><span class="main">*</span><span class="main">(</span><span class="numeral">3</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">6</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_ln_upper_5</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_ln_upper_5</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">^</span><span class="numeral">5</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="numeral">3</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">6</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">*</span><span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Log_CF_Bounds-d_delta_ln_upper_5"><span class="command">lemma</span></span> d_delta_ln_upper_5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span>
    <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> ln_upper_5 <span class="bound">x</span> <span class="main">-</span> ln <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_ln_upper_5 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ln_upper_5_def diff_delta_ln_upper_5_def
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> add_nonneg_eq_0_iff<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Log_CF_Bounds-ln_upper_5_pos"><span class="command">lemma</span></span> ln_upper_5_pos<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_5 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_ln_upper_5<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_ln_upper_5_def ln_upper_5_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Log_CF_Bounds-ln_upper_5_neg"><span class="command">lemma</span></span> ln_upper_5_neg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_5 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_decreasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> x1 d_delta_ln_upper_5<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_ln_upper_5_def <span class="dynamic"><span class="dynamic">divide_simps</span></span> ln_upper_5_def mult_less_0_iff<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">theorem</span></span> ln_upper_5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span> ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_5 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> le_less_linear less_eq_real_def ln_upper_5_neg ln_upper_5_pos<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ln_lower_5</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ln_lower_5</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span> ln_upper_5 <span class="main">(</span>inverse <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">corollary</span></span> ln_lower_5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span> ln_lower_5 <span class="free">x</span> <span class="main">≤</span> ln <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ln_lower_5_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ln_inverse inverse_positive_iff_positive minus_le_iff ln_upper_5<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> ln_lower_5_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span>
    ln_lower_5 <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">3</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="numeral">10</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">19</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">6</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">3</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ln_lower_5_def ln_upper_5_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> zero_less_mult_iff add_pos_pos dual_order.strict_implies_not_eq <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
     <span class="operator">algebra</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Upper Bound 7›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ln_upper_7</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ln_upper_7</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">(</span><span class="numeral">3</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">131</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">239</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> <span class="numeral">47</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">12</span><span class="main">*</span><span class="main">(</span><span class="numeral">4</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">18</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">12</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_ln_upper_7</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_ln_upper_7</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">^</span><span class="numeral">7</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="numeral">4</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">18</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">12</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Log_CF_Bounds-d_delta_ln_upper_7"><span class="command">lemma</span></span> d_delta_ln_upper_7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span>
    <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> ln_upper_7 <span class="bound">x</span> <span class="main">-</span> ln <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_ln_upper_7 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> ln_upper_7_def diff_delta_ln_upper_7_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> add_pos_pos dual_order.strict_implies_not_eq <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Log_CF_Bounds-ln_upper_7_pos"><span class="command">lemma</span></span> ln_upper_7_pos<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_7 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_ln_upper_7<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_ln_upper_7_def ln_upper_7_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Log_CF_Bounds-ln_upper_7_neg"><span class="command">lemma</span></span> ln_upper_7_neg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_7 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_decreasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> x1 d_delta_ln_upper_7<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_ln_upper_7_def <span class="dynamic"><span class="dynamic">divide_simps</span></span> ln_upper_7_def mult_less_0_iff<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">theorem</span></span> ln_upper_7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_7 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> le_less_linear less_eq_real_def ln_upper_7_neg ln_upper_7_pos<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ln_lower_7</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ln_lower_7</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span> ln_upper_7 <span class="main">(</span>inverse <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">corollary</span></span> ln_lower_7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> ln_lower_7 <span class="free">x</span> <span class="main">≤</span> ln <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ln_lower_7_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ln_inverse inverse_positive_iff_positive minus_le_iff ln_upper_7<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> ln_lower_7_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span>
  ln_lower_7 <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">12</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="numeral">47</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">239</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">131</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">3</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">12</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">18</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">4</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ln_lower_7_def ln_upper_7_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> zero_less_mult_iff add_pos_pos dual_order.strict_implies_not_eq <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
     <span class="operator">algebra</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Upper Bound 9›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ln_upper_9</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ln_upper_9</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">(</span><span class="numeral">6</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">481</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">1881</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">1281</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> <span class="numeral">131</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span>
                         <span class="main">(</span><span class="numeral">30</span> <span class="main">*</span> <span class="main">(</span><span class="numeral">5</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">40</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">60</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">20</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_ln_upper_9</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_ln_upper_9</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">^</span><span class="numeral">9</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="numeral">5</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">40</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">60</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">20</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">*</span> <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Log_CF_Bounds-d_delta_ln_upper_9"><span class="command">lemma</span></span> d_delta_ln_upper_9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span>
    <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> ln_upper_9 <span class="bound">x</span> <span class="main">-</span> ln <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_ln_upper_9 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> ln_upper_9_def diff_delta_ln_upper_9_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> add_pos_pos dual_order.strict_implies_not_eq <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Log_CF_Bounds-ln_upper_9_pos"><span class="command">lemma</span></span> ln_upper_9_pos<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_9 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_ln_upper_9<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_ln_upper_9_def ln_upper_9_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Log_CF_Bounds-ln_upper_9_neg"><span class="command">lemma</span></span> ln_upper_9_neg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_9 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_decreasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> x1 d_delta_ln_upper_9<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_ln_upper_9_def <span class="dynamic"><span class="dynamic">divide_simps</span></span> ln_upper_9_def mult_less_0_iff<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">theorem</span></span> ln_upper_9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span> ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_9 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> le_less_linear less_eq_real_def ln_upper_9_neg ln_upper_9_pos<span class="main">)</span>


<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ln_lower_9</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ln_lower_9</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span> ln_upper_9 <span class="main">(</span>inverse <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">corollary</span></span> ln_lower_9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> ln_lower_9 <span class="free">x</span> <span class="main">≤</span> ln <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ln_lower_9_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ln_inverse inverse_positive_iff_positive minus_le_iff ln_upper_9<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> ln_lower_9_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span>
      ln_lower_9 <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">30</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="numeral">6</span> <span class="main">+</span> <span class="numeral">481</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">1881</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">1281</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">131</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span>
                     <span class="main">(</span><span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">40</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">60</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">20</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ln_lower_9_def ln_upper_9_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> zero_less_mult_iff add_pos_pos dual_order.strict_implies_not_eq <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
     <span class="operator">algebra</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Upper Bound 11›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Extended bounds start here›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ln_upper_11</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ln_upper_11</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span>
           <span class="main">(</span><span class="numeral">5</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">647</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">4397</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">6397</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">2272</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> <span class="numeral">142</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span>
           <span class="main">(</span><span class="numeral">30</span><span class="main">*</span><span class="main">(</span><span class="numeral">6</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">75</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">200</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">150</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">30</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_ln_upper_11</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_ln_upper_11</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">^</span><span class="numeral">11</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="numeral">6</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">75</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">200</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">150</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">30</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Log_CF_Bounds-d_delta_ln_upper_11"><span class="command">lemma</span></span> d_delta_ln_upper_11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span>
    <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> ln_upper_11 <span class="bound">x</span> <span class="main">-</span> ln <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_ln_upper_11 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> ln_upper_11_def diff_delta_ln_upper_11_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> add_pos_pos dual_order.strict_implies_not_eq <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Log_CF_Bounds-ln_upper_11_pos"><span class="command">lemma</span></span> ln_upper_11_pos<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_11 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_ln_upper_11<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_ln_upper_11_def ln_upper_11_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Log_CF_Bounds-ln_upper_11_neg"><span class="command">lemma</span></span> ln_upper_11_neg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_11 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_decreasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> x1 d_delta_ln_upper_11<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_ln_upper_11_def <span class="dynamic"><span class="dynamic">divide_simps</span></span> ln_upper_11_def mult_less_0_iff<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">theorem</span></span> ln_upper_11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span> ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_11 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> le_less_linear less_eq_real_def ln_upper_11_neg ln_upper_11_pos<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ln_lower_11</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ln_lower_11</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span> ln_upper_11 <span class="main">(</span>inverse <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">corollary</span></span> ln_lower_11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span> ln_lower_11 <span class="free">x</span> <span class="main">≤</span> ln <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ln_lower_11_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ln_inverse inverse_positive_iff_positive minus_le_iff ln_upper_11<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> ln_lower_11_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span>
    ln_lower_11 <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">30</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="numeral">142</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">2272</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">6397</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">4397</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">647</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">5</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span>
                    <span class="main">(</span><span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">30</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">150</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">200</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">75</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">6</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ln_lower_11_def ln_upper_11_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> zero_less_mult_iff add_pos_pos dual_order.strict_implies_not_eq <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
     <span class="operator">algebra</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Upper Bound 13›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ln_upper_13</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ln_upper_13</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">(</span><span class="numeral">353</span> <span class="main">+</span> <span class="numeral">8389</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> <span class="numeral">20149</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">50774</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">38524</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">1921</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">10</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>
                          <span class="main">/</span> <span class="main">(</span><span class="numeral">70</span><span class="main">*</span><span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="numeral">42</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> <span class="numeral">525</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">700</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">315</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">126</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">7</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_ln_upper_13</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_ln_upper_13</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">^</span><span class="numeral">13</span> <span class="main">/</span>
                     <span class="main">(</span><span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="numeral">42</span><span class="main">*</span><span class="bound">x</span> <span class="main">+</span> <span class="numeral">525</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">700</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">315</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">126</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">7</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">*</span><span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Log_CF_Bounds-d_delta_ln_upper_13"><span class="command">lemma</span></span> d_delta_ln_upper_13<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span>
    <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> ln_upper_13 <span class="bound">x</span> <span class="main">-</span> ln <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_ln_upper_13 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> ln_upper_13_def diff_delta_ln_upper_13_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> add_pos_pos dual_order.strict_implies_not_eq <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Log_CF_Bounds-ln_upper_13_pos"><span class="command">lemma</span></span> ln_upper_13_pos<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_13 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_ln_upper_13<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_ln_upper_13_def ln_upper_13_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Log_CF_Bounds-ln_upper_13_neg"><span class="command">lemma</span></span> ln_upper_13_neg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_13 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_decreasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> x1 d_delta_ln_upper_13<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_ln_upper_13_def <span class="dynamic"><span class="dynamic">divide_simps</span></span> ln_upper_13_def mult_less_0_iff<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">theorem</span></span> ln_upper_13<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span> ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_13 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> le_less_linear less_eq_real_def ln_upper_13_neg ln_upper_13_pos<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ln_lower_13</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ln_lower_13</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span> ln_upper_13 <span class="main">(</span>inverse <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">corollary</span></span> ln_lower_13<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span> ln_lower_13 <span class="free">x</span> <span class="main">≤</span> ln <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ln_lower_13_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ln_inverse inverse_positive_iff_positive minus_le_iff ln_upper_13<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> ln_lower_13_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span>
    ln_lower_13 <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">70</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="numeral">10</span> <span class="main">+</span> <span class="numeral">1921</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">20149</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">50774</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">38524</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">8389</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">353</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span>
                    <span class="main">(</span><span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="numeral">7</span> <span class="main">+</span> <span class="numeral">126</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">525</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">700</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">315</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">42</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="free">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ln_lower_13_def ln_upper_13_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> zero_less_mult_iff add_pos_pos dual_order.strict_implies_not_eq <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
     <span class="operator">algebra</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Upper Bound 15›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ln_upper_15</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ln_upper_15</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span>
           <span class="main">(</span><span class="numeral">1487</span> <span class="main">+</span> <span class="numeral">49199</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> <span class="numeral">547235</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">718735</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">334575</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">141123</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">35</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">7</span> <span class="main">+</span> <span class="numeral">9411</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span>
           <span class="main">(</span><span class="numeral">280</span><span class="main">*</span><span class="main">(</span><span class="main">1</span> <span class="main">+</span> <span class="numeral">56</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">+</span> <span class="numeral">2450</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">1960</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">588</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">1176</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">8</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">7</span> <span class="main">+</span> <span class="numeral">196</span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">^</span><span class="numeral">6</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff_delta_ln_upper_15</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">diff_delta_ln_upper_15</span>
         <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span><span class="main">^</span><span class="numeral">15</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="main">1</span><span class="main">+</span><span class="numeral">56</span><span class="main">*</span><span class="bound">x</span><span class="main">+</span><span class="numeral">2450</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">1960</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">+</span><span class="numeral">588</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">8</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">7</span><span class="main">+</span><span class="numeral">196</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">1176</span><span class="main">*</span><span class="bound">x</span><span class="main">^</span><span class="numeral">5</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Log_CF_Bounds-d_delta_ln_upper_15"><span class="command">lemma</span></span> d_delta_ln_upper_15<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span>
    <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> ln_upper_15 <span class="bound">x</span> <span class="main">-</span> ln <span class="bound">x</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> diff_delta_ln_upper_15 <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> ln_upper_15_def diff_delta_ln_upper_15_def
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> add_pos_pos dual_order.strict_implies_not_eq <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">algebra</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Log_CF_Bounds-ln_upper_15_pos"><span class="command">lemma</span></span> ln_upper_15_pos<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_15 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms d_delta_ln_upper_15<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_ln_upper_15_def ln_upper_15_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Log_CF_Bounds-ln_upper_15_neg"><span class="command">lemma</span></span> ln_upper_15_neg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_15 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_upper_bound_decreasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> x1 d_delta_ln_upper_15<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diff_delta_ln_upper_15_def <span class="dynamic"><span class="dynamic">divide_simps</span></span> ln_upper_15_def mult_less_0_iff<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">theorem</span></span> ln_upper_15<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span> ln<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">≤</span> ln_upper_15 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> le_less_linear less_eq_real_def ln_upper_15_neg ln_upper_15_pos<span class="main">)</span>


<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ln_lower_15</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ln_lower_15</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span> ln_upper_15 <span class="main">(</span>inverse <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">corollary</span></span> ln_lower_15<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span> ln_lower_15 <span class="free">x</span> <span class="main">≤</span> ln <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ln_lower_15_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ln_inverse inverse_positive_iff_positive minus_le_iff ln_upper_15<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> ln_lower_15_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">&lt;</span><span class="free">x</span> <span class="main">⟹</span>
    ln_lower_15 <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">280</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="numeral">35</span> <span class="main">+</span> <span class="numeral">9411</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">141123</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">547235</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">718735</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">334575</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">49199</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">6</span> <span class="main">+</span> <span class="numeral">1487</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">7</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span>
                    <span class="main">(</span><span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="numeral">8</span> <span class="main">+</span> <span class="numeral">196</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">1176</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">2450</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">1960</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">588</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">5</span> <span class="main">+</span> <span class="numeral">56</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">6</span> <span class="main">+</span> <span class="free">x</span><span class="main">^</span><span class="numeral">7</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ln_lower_15_def ln_upper_15_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> zero_less_mult_iff add_pos_pos dual_order.strict_implies_not_eq
              <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span> <span class="operator">algebra</span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="Sin_Cos_Bounds">
<div class="head">
<h1>Theory Sin_Cos_Bounds</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Sine and Cosine Upper and Lower Bounds›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Sin_Cos_Bounds
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Bounds_Lemmas.html">Bounds_Lemmas</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">‹Simple base cases›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Upper bound for <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span><span class="quoted"><span class="quoted">"<span class="free"><span class="free">x</span></span><span class="main"><span class="main">≥</span></span><span class="main"><span class="main">0</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>›</span></span>
<span class="keyword1" id="Sin_Cos_Bounds-sin_le_arg"><span class="command">lemma</span></span> sin_le_arg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span> <span class="main">::</span> <span class="quoted">real</span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> sin <span class="free">x</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">fact</span> sin_x_le_x<span class="main">)</span>

<span class="keyword1" id="Sin_Cos_Bounds-cos_ge_1_arg"><span class="command">lemma</span></span> cos_ge_1_arg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span> <span class="main">::</span> <span class="quoted">real</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">-</span> <span class="free">x</span> <span class="main">≤</span> cos <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_lower_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemmas</span></span> sin_Taylor_0_upper_bound_pos <span class="main">=</span> sin_le_arg <span class="comment1">― ‹MetiTarski bound›</span>

<span class="keyword1" id="Sin_Cos_Bounds-cos_Taylor_1_lower_bound"><span class="command">lemma</span></span> cos_Taylor_1_lower_bound<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span> <span class="main">::</span> <span class="quoted">real</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">≤</span> cos <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_lower_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> refl <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sin_le_arg<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Sin_Cos_Bounds-sin_Taylor_1_lower_bound"><span class="command">lemma</span></span> sin_Taylor_1_lower_bound<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span> <span class="main">::</span> <span class="quoted">real</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="free">x</span> <span class="main">^</span> <span class="numeral">3</span> <span class="main">/</span> <span class="numeral">6</span><span class="main">)</span> <span class="main">≤</span> sin <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_lower_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> refl <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cos_Taylor_1_lower_bound<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">‹Taylor series approximants›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">sinpoly</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span>nat<span class="main">,</span>real<span class="main">]</span> <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">sinpoly</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">∑</span><span class="bound">k</span><span class="main">&lt;</span><span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">.</span> sin_coeff <span class="bound">k</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">^</span> <span class="bound">k</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">cospoly</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span>nat<span class="main">,</span>real<span class="main">]</span> <span class="main">⇒</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">cospoly</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">∑</span><span class="bound">k</span><span class="main">&lt;</span><span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">.</span> cos_coeff <span class="bound">k</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">^</span> <span class="bound">k</span><span class="main">)</span>"</span></span>

<span class="comment1">(*sin upper bounds have the form 4*n+2; lower bounds, 4*n
sinpoly 2 x = x                                      (upper)
sinpoly 4 x = x - (x^3)/6                            (lower)
sinpoly 6 x = x - (x^3)/6 + (x^5)/120                (upper)
sinpoly 8 x = x - (x^3)/6 + (x^5)/120 - (x^7)/5040   (lower)

cos upper bounds have the form 4*n+1; lower bounds, 4*n+3
cospoly 1 x = 1                                                             (upper)
cospoly 3 x = 1 - (x^2)/2                                                   (lower)
cospoly 5 x = 1 - (x^2)/2 + (x^4)/24 - x^6/720 + x^8/40320                  (upper)
cospoly 7 x = 1 - (x^2)/2 + (x^4)/24 - x^6/720 + x^8/40320 - x^10/3628800   (lower)
*)</span>

<span class="keyword1" id="Sin_Cos_Bounds-sinpoly_Suc"><span class="command">lemma</span></span> sinpoly_Suc<span class="main">:</span> <span class="quoted"><span class="quoted">"sinpoly <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> sinpoly <span class="free">n</span> <span class="bound">x</span> <span class="main">+</span> sin_coeff <span class="free">n</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">^</span> <span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sinpoly_def<span class="main">)</span>

<span class="keyword1" id="Sin_Cos_Bounds-cospoly_Suc"><span class="command">lemma</span></span> cospoly_Suc<span class="main">:</span> <span class="quoted"><span class="quoted">"cospoly <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> cospoly <span class="free">n</span> <span class="bound">x</span> <span class="main">+</span> cos_coeff <span class="free">n</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">^</span> <span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cospoly_def<span class="main">)</span>

<span class="keyword1" id="Sin_Cos_Bounds-sinpoly_minus"><span class="command">lemma</span></span> sinpoly_minus <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"sinpoly <span class="free">n</span> <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">-</span> sinpoly <span class="free">n</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> sinpoly_def sin_coeff_def<span class="main">)</span>

<span class="keyword1" id="Sin_Cos_Bounds-cospoly_minus"><span class="command">lemma</span></span> cospoly_minus <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"cospoly <span class="free">n</span> <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> cospoly <span class="free">n</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cospoly_def cos_coeff_def<span class="main">)</span>

<span class="keyword1" id="Sin_Cos_Bounds-d_sinpoly_cospoly"><span class="command">lemma</span></span> d_sinpoly_cospoly<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span>sinpoly <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> cospoly <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> 0 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sinpoly_def cospoly_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">=</span><span class="main">0</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sinpoly_def sin_coeff_def cospoly_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False <span class="keyword1"><span class="command">then</span></span>
    <span class="keyword1"><span class="command">have</span></span> xn<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">^</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> Suc <span class="main">0</span><span class="main">)</span> <span class="main">*</span> <span class="free">x</span> <span class="main">=</span> <span class="free">x</span> <span class="main">^</span> <span class="skolem">n</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Suc_pred mult.commute not_gr0 power_Suc<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Suc False
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sinpoly_Suc <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">n</span>"</span></span><span class="main"><span class="main">]</span></span> cospoly_def<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> xn mult.assoc sin_coeff_def cos_coeff_def <span class="dynamic"><span class="dynamic">divide_simps</span></span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> fact_Suc<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Sin_Cos_Bounds-d_cospoly_sinpoly"><span class="command">lemma</span></span> d_cospoly_sinpoly<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span>cospoly <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span> <span class="keyword1">has_field_derivative</span> <span class="main">-</span>sinpoly <span class="free">n</span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">at</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> 0 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sinpoly_def cospoly_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">=</span><span class="main">0</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sinpoly_def cospoly_def cos_coeff_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False <span class="keyword1"><span class="command">then</span></span>
    <span class="keyword1"><span class="command">have</span></span> xn<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">^</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> Suc <span class="main">0</span><span class="main">)</span> <span class="main">*</span> <span class="free">x</span> <span class="main">=</span> <span class="free">x</span> <span class="main">^</span> <span class="skolem">n</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Suc_pred mult.commute not_gr0 power_Suc<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> m1<span class="main">:</span> <span class="quoted"><span class="quoted">"odd <span class="skolem">n</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">-</span><span class="main">1</span> <span class="main">::</span> real<span class="main">)</span> <span class="main">^</span> <span class="main">(</span><span class="main">(</span><span class="skolem">n</span> <span class="main">-</span> Suc <span class="main">0</span><span class="main">)</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">=</span> <span class="main">-</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="main">^</span> <span class="main">(</span>Suc <span class="skolem">n</span> <span class="keyword1">div</span> <span class="numeral">2</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span> <span class="operator">simp_all</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Suc False
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cospoly_Suc <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">n</span>"</span></span><span class="main"><span class="main">]</span></span> sinpoly_def<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> xn mult.assoc sin_coeff_def cos_coeff_def m1 <span class="dynamic"><span class="dynamic">divide_simps</span></span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> fact_Suc<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">‹Inductive proof of sine inequalities›</span></span>

<span class="keyword1" id="Sin_Cos_Bounds-sinpoly_lb_imp_cospoly_ub"><span class="command">lemma</span></span> sinpoly_lb_imp_cospoly_ub<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> x0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> k0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="main">0</span> <span class="main">≤</span> <span class="bound">x</span> <span class="main">⟹</span> sinpoly <span class="main">(</span><span class="free">k</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="bound">x</span> <span class="main">≤</span> sin <span class="bound">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"cos <span class="free">x</span> <span class="main">≤</span> cospoly <span class="free">k</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_lower_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> x0<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">using</span></span> d_cospoly_sinpoly <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">-</span> <span class="main">1</span>"</span></span><span class="main">]</span> assms
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cospoly_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Sin_Cos_Bounds-cospoly_ub_imp_sinpoly_ub"><span class="command">lemma</span></span> cospoly_ub_imp_sinpoly_ub<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> x0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> k0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="main">0</span> <span class="main">≤</span> <span class="bound">x</span> <span class="main">⟹</span> cos <span class="bound">x</span> <span class="main">≤</span> cospoly <span class="main">(</span><span class="free">k</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="bound">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"sin <span class="free">x</span> <span class="main">≤</span> sinpoly <span class="free">k</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_lower_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> x0<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">using</span></span> d_sinpoly_cospoly <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">-</span> <span class="main">1</span>"</span></span><span class="main">]</span> assms
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sinpoly_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Sin_Cos_Bounds-sinpoly_ub_imp_cospoly_lb"><span class="command">lemma</span></span> sinpoly_ub_imp_cospoly_lb<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> x0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> k0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="main">0</span> <span class="main">≤</span> <span class="bound">x</span> <span class="main">⟹</span> sin <span class="bound">x</span> <span class="main">≤</span> sinpoly <span class="main">(</span><span class="free">k</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="bound">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"cospoly <span class="free">k</span> <span class="free">x</span> <span class="main">≤</span> cos <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_lower_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> x0<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">using</span></span> d_cospoly_sinpoly <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">-</span> <span class="main">1</span>"</span></span><span class="main">]</span> assms
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cospoly_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Sin_Cos_Bounds-cospoly_lb_imp_sinpoly_lb"><span class="command">lemma</span></span> cospoly_lb_imp_sinpoly_lb<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> x0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> k0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">&gt;</span><span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="main">0</span> <span class="main">≤</span> <span class="bound">x</span> <span class="main">⟹</span> cospoly <span class="main">(</span><span class="free">k</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="bound">x</span> <span class="main">≤</span> cos <span class="bound">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"sinpoly <span class="free">k</span> <span class="free">x</span> <span class="main">≤</span> sin <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> gen_lower_bound_increasing <span class="main"><span class="main">[</span></span><span class="operator">OF</span> x0<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> <span class="dynamic"><span class="dynamic">derivative_eq_intros</span></span> <span class="main"><span class="keyword3">|</span></span> <span class="operator">simp</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">using</span></span> d_sinpoly_cospoly <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">-</span> <span class="main">1</span>"</span></span><span class="main">]</span> assms
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sinpoly_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> sinpoly_lower_nonneg<span class="main">:</span> <span class="quoted"><span class="quoted">"sinpoly <span class="main">(</span><span class="numeral">4</span> <span class="main">*</span> Suc <span class="free">n</span><span class="main">)</span> <span class="free">x</span> <span class="main">≤</span> sin <span class="free">x</span>"</span></span>        <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="var"><span class="quoted"><span class="var">?th1</span></span></span><span class="main">)</span>
      <span class="keyword2"><span class="keyword">and</span></span> sinpoly_upper_nonneg<span class="main">:</span> <span class="quoted"><span class="quoted">"sin <span class="free">x</span> <span class="main">≤</span> sinpoly <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="main">(</span><span class="numeral">4</span><span class="main">*</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">x</span>"</span></span>  <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="var"><span class="quoted"><span class="var">?th2</span></span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sinpoly <span class="main">(</span><span class="numeral">4</span> <span class="main">*</span> Suc <span class="free">n</span><span class="main">)</span> <span class="free">x</span> <span class="main">≤</span> sin <span class="free">x</span>  <span class="main">∧</span>  sin <span class="free">x</span> <span class="main">≤</span> sinpoly <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="main">(</span><span class="numeral">4</span><span class="main">*</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">n</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">x</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sinpoly_def sin_coeff_def sin_Taylor_1_lower_bound sin_Taylor_0_upper_bound_pos lessThan_nat_numeral fact_numeral<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cospoly_lb_imp_sinpoly_lb sinpoly_ub_imp_cospoly_lb cospoly_ub_imp_sinpoly_ub sinpoly_lb_imp_cospoly_ub<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?th1</span></span></span> <span class="var"><span class="quoted"><span class="var">?th2</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">‹Collecting the results›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> sinpoly_upper_nonpos<span class="main">:</span>
     <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span> <span class="main">⟹</span> sin <span class="free">x</span> <span class="main">≤</span> sinpoly <span class="main">(</span><span class="numeral">4</span> <span class="main">*</span> Suc <span class="free">n</span><span class="main">)</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> sinpoly_lower_nonneg <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span> <span class="quoted"><span class="free">n</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">corollary</span></span> sinpoly_lower_nonpos<span class="main">:</span>
     <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span> <span class="main">⟹</span> sinpoly <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="main">(</span><span class="numeral">4</span><span class="main">*</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">x</span> <span class="main">≤</span> sin <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> sinpoly_upper_nonneg <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span> <span class="quoted"><span class="free">n</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">corollary</span></span> cospoly_lower_nonneg<span class="main">:</span>
     <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> cospoly <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="main">(</span><span class="numeral">4</span><span class="main">*</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">x</span> <span class="main">≤</span> cos <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> sinpoly_upper_nonneg sinpoly_ub_imp_cospoly_lb<span class="main">)</span>

<span class="keyword1" id="Sin_Cos_Bounds-cospoly_lower"><span class="command">lemma</span></span> cospoly_lower<span class="main">:</span>
     <span class="quoted"><span class="quoted">"cospoly <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="main">(</span><span class="numeral">4</span><span class="main">*</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free">x</span> <span class="main">≤</span> cos <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> le_cases <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="main"><span class="quoted"><span class="main">0</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> le <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cospoly_lower_nonneg<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> ge <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> cospoly_lower_nonneg <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Sin_Cos_Bounds-cospoly_upper_nonneg"><span class="command">lemma</span></span> cospoly_upper_nonneg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"cos <span class="free">x</span> <span class="main">≤</span> cospoly <span class="main">(</span>Suc <span class="main">(</span><span class="numeral">4</span><span class="main">*</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> 0 <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cospoly_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">m</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> sinpoly_lower_nonneg <span class="main">[</span><span class="operator">of</span> <span class="main">_</span> <span class="quoted"><span class="skolem">m</span></span><span class="main">]</span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> sinpoly_lb_imp_cospoly_ub<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Sin_Cos_Bounds-cospoly_upper"><span class="command">lemma</span></span> cospoly_upper<span class="main">:</span>
  <span class="quoted"><span class="quoted">"cos <span class="free">x</span> <span class="main">≤</span> cospoly <span class="main">(</span>Suc <span class="main">(</span><span class="numeral">4</span><span class="main">*</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> le_cases <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="main"><span class="quoted"><span class="main">0</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> le <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cospoly_upper_nonneg<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> ge <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> cospoly_upper_nonneg <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

</pre>
</div><div id="Sqrt_Bounds">
<div class="head">
<h1>Theory Sqrt_Bounds</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Square Root Upper and Lower Bounds›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Sqrt_Bounds
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Bounds_Lemmas.html">Bounds_Lemmas</a>
        <span class="quoted">"<a href="../../HOL/HOL-Library/Sum_of_Squares.html">HOL-Library.Sum_of_Squares</a>"</span>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Covers all bounds used in sqrt-upper.ax, sqrt-lower.ax and sqrt-extended.ax.›</span></span>

<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">‹Upper bounds›</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">sqrtu</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span>real<span class="main">,</span>nat<span class="main">]</span> <span class="main">⇒</span> real"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">sqrtu</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">0</span> <span class="main">=</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">/</span><span class="numeral">2</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">sqrtu</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">(</span>Suc <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">sqrtu</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">+</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">/</span><span class="free">sqrtu</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span>

<span class="keyword1" id="Sqrt_Bounds-sqrtu_upper"><span class="command">lemma</span></span> sqrtu_upper<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> sqrtu <span class="free">x</span> <span class="free">n</span> <span class="main">^</span> <span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> 0 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power2_eq_square<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">sos</span> <span class="quoted">"(((A&lt;0 * R&lt;1) + (R&lt;1 * (R&lt;1 * [~1*x + 1]^2))))"</span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> xy<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="main">⟦</span><span class="free">x</span> <span class="main">≤</span> <span class="bound">y</span> <span class="main">*</span> <span class="bound">y</span><span class="main">;</span> <span class="bound">y</span> <span class="main">≠</span> <span class="main">0</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">*</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="bound">y</span> <span class="main">*</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">*</span> <span class="free">x</span> <span class="main">+</span> <span class="bound">y</span> <span class="main">*</span> <span class="main">(</span><span class="bound">y</span> <span class="main">*</span> <span class="main">(</span><span class="bound">y</span> <span class="main">*</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">sos</span> <span class="quoted">"(((((A&lt;0 * A&lt;1) * R&lt;1) + ((A&lt;0 * R&lt;1) * (R&lt;1 * [~1*y^2 + x]^2)))) &amp;
                   ((((A&lt;0 * A&lt;1) * R&lt;1) + ((A&lt;0 * R&lt;1) * (R&lt;1 * [~1*y^2 + x]^2)))))"</span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> Suc
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> power2_eq_square <span class="dynamic"><span class="dynamic">algebra_simps</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> xy<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Sqrt_Bounds-sqrtu_numeral"><span class="command">lemma</span></span> sqrtu_numeral<span class="main">:</span>
  <span class="quoted"><span class="quoted">"sqrtu <span class="free">x</span> <span class="main">(</span>numeral <span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>sqrtu <span class="free">x</span> <span class="main">(</span>pred_numeral <span class="free">n</span><span class="main">)</span> <span class="main">+</span> <span class="free">x</span><span class="main">/</span>sqrtu <span class="free">x</span> <span class="main">(</span>pred_numeral <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> numeral_eq_Suc<span class="main">)</span>

<span class="keyword1" id="Sqrt_Bounds-sqrtu_gt_0"><span class="command">lemma</span></span> sqrtu_gt_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span> <span class="main">⟹</span> sqrtu <span class="free">x</span> <span class="free">n</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add_strict_increasing2 mult_zero_left not_real_square_gt_zero<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> gen_sqrt_upper<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> sqrt <span class="free">x</span> <span class="main">≤</span> sqrtu <span class="free">x</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> real_sqrt_le_mono <span class="main">[</span><span class="operator">OF</span> sqrtu_upper <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span> <span class="quoted"><span class="free">n</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> abs_of_nonneg dual_order.strict_iff_order sqrtu_gt_0<span class="main">)</span>

<span class="keyword1" id="Sqrt_Bounds-sqrt_upper_bound_0"><span class="command">lemma</span></span> sqrt_upper_bound_0<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="free">x</span> <span class="main">≤</span> <span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">/</span><span class="numeral">2</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">≤</span> <span class="var">?rhs</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="free">x</span> <span class="main">≤</span> sqrtu <span class="free">x</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms gen_sqrt_upper<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?rhs</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Sqrt_Bounds-sqrt_upper_bound_1"><span class="command">lemma</span></span> sqrt_upper_bound_1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="free">x</span> <span class="main">≤</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">4</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">6</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">≤</span> <span class="var">?rhs</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="free">x</span> <span class="main">≤</span> sqrtu <span class="free">x</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms gen_sqrt_upper<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?rhs</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span> <span class="operator">algebra</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Sqrt_Bounds-sqrtu_2_eq"><span class="command">lemma</span></span> sqrtu_2_eq<span class="main">:</span>
   <span class="quoted"><span class="quoted">"sqrtu <span class="free">x</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">8</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">28</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">70</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">28</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">6</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sqrtu_numeral <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span> <span class="operator">algebra</span>

<span class="keyword1" id="Sqrt_Bounds-sqrt_upper_bound_2"><span class="command">lemma</span></span> sqrt_upper_bound_2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="free">x</span> <span class="main">≤</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">8</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">28</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">70</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">28</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">6</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms gen_sqrt_upper sqrtu_2_eq<span class="main">)</span>

<span class="keyword1" id="Sqrt_Bounds-sqrtu_4_eq"><span class="command">lemma</span></span> sqrtu_4_eq<span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span> <span class="main">⟹</span>
    sqrtu <span class="free">x</span> <span class="numeral">4</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">32</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="numeral">225792840</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">64512240</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">5</span><span class="main">+</span><span class="numeral">601080390</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">8</span><span class="main">+</span><span class="numeral">471435600</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">7</span><span class="main">+</span><span class="numeral">496</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">+</span><span class="numeral">35960</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">906192</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">+</span><span class="numeral">10518300</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="free">x</span><span class="main">^</span><span class="numeral">16</span><span class="main">+</span><span class="numeral">906192</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">13</span><span class="main">+</span><span class="numeral">10518300</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">12</span><span class="main">+</span><span class="numeral">496</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">15</span><span class="main">+</span><span class="numeral">35960</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">14</span><span class="main">+</span><span class="numeral">471435600</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">9</span><span class="main">+</span><span class="numeral">225792840</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">10</span><span class="main">+</span><span class="numeral">64512240</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">11</span><span class="main">)</span>
             <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">6</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">28</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">+</span><span class="numeral">70</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">28</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="numeral">1820</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">8008</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">5</span><span class="main">+</span><span class="free">x</span><span class="main">^</span><span class="numeral">8</span><span class="main">+</span><span class="numeral">120</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">7</span><span class="main">+</span><span class="numeral">120</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">+</span><span class="numeral">1820</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">8008</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">+</span><span class="numeral">12870</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sqrtu_numeral <span class="dynamic"><span class="dynamic">divide_simps</span></span> add_nonneg_eq_0_iff<span class="main">)</span> <span class="operator">algebra</span>

<span class="keyword1" id="Sqrt_Bounds-sqrt_upper_bound_4"><span class="command">lemma</span></span> sqrt_upper_bound_4<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="free">x</span> <span class="main">≤</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">32</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="numeral">225792840</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">64512240</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">5</span><span class="main">+</span><span class="numeral">601080390</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">8</span><span class="main">+</span><span class="numeral">471435600</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">7</span><span class="main">+</span><span class="numeral">496</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">+</span><span class="numeral">35960</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">906192</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">+</span><span class="numeral">10518300</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="free">x</span><span class="main">^</span><span class="numeral">16</span><span class="main">+</span><span class="numeral">906192</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">13</span><span class="main">+</span><span class="numeral">10518300</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">12</span><span class="main">+</span><span class="numeral">496</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">15</span><span class="main">+</span><span class="numeral">35960</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">14</span><span class="main">+</span><span class="numeral">471435600</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">9</span><span class="main">+</span><span class="numeral">225792840</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">10</span><span class="main">+</span><span class="numeral">64512240</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">11</span><span class="main">)</span>
             <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">6</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">28</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">+</span><span class="numeral">70</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">28</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="numeral">1820</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">8008</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">5</span><span class="main">+</span><span class="free">x</span><span class="main">^</span><span class="numeral">8</span><span class="main">+</span><span class="numeral">120</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">7</span><span class="main">+</span><span class="numeral">120</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">+</span><span class="numeral">1820</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">8008</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">+</span><span class="numeral">12870</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms gen_sqrt_upper sqrtu_4_eq<span class="main">)</span>

<span class="keyword1" id="Sqrt_Bounds-gen_sqrt_upper_scaled"><span class="command">lemma</span></span> gen_sqrt_upper_scaled<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">u</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="free">x</span> <span class="main">≤</span> sqrtu <span class="main">(</span><span class="free">x</span><span class="main">*</span><span class="free">u</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="free">n</span> <span class="main">/</span> <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="free">x</span> <span class="main">=</span> sqrt <span class="free">x</span> <span class="main">*</span> sqrt <span class="main">(</span><span class="free">u</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">/</span> <span class="free">u</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sqrt <span class="main">(</span><span class="free">x</span><span class="main">*</span><span class="free">u</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">/</span> <span class="free">u</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> real_sqrt_mult<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> sqrtu <span class="main">(</span><span class="free">x</span><span class="main">*</span><span class="free">u</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="free">n</span> <span class="main">/</span> <span class="free">u</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> gen_sqrt_upper zero_le_mult_iff zero_le_power2<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Sqrt_Bounds-sqrt_upper_bound_2_small"><span class="command">lemma</span></span> sqrt_upper_bound_2_small<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="free">x</span> <span class="main">≤</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">32</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="numeral">65536</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">114688</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">17920</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">448</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="numeral">16</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="numeral">256</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">96</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> order_trans <span class="main"><span class="main">[</span></span><span class="operator">OF</span> gen_sqrt_upper_scaled <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span> <span class="quoted"><span class="numeral"><span class="quoted"><span class="numeral">4</span></span></span></span> <span class="quoted"><span class="numeral"><span class="quoted"><span class="numeral">2</span></span></span></span><span class="main"><span class="main">]</span></span> eq_refl<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> sqrtu_2_eq <span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">algebra</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Sqrt_Bounds-sqrt_upper_bound_2_large"><span class="command">lemma</span></span> sqrt_upper_bound_2_large<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="free">x</span> <span class="main">≤</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="numeral">32</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="numeral">65536</span> <span class="main">+</span> <span class="numeral">114688</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">17920</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">448</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">16</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="numeral">256</span> <span class="main">+</span> <span class="numeral">96</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> order_trans <span class="main"><span class="main">[</span></span><span class="operator">OF</span> gen_sqrt_upper_scaled <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">1</span></span><span class="main"><span class="main">/</span></span><span class="numeral"><span class="numeral">4</span></span>"</span></span></span> <span class="quoted"><span class="numeral"><span class="quoted"><span class="numeral">2</span></span></span></span><span class="main"><span class="main">]</span></span> eq_refl<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> sqrtu_2_eq <span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">algebra</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">‹Lower bounds›</span></span>

<span class="keyword1" id="Sqrt_Bounds-sqrt_lower_bound_id"><span class="command">lemma</span></span> sqrt_lower_bound_id<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> sqrt <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> one_le_numeral power_decreasing power_one_right<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> real_le_rsqrt<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">sqrtl</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span>real<span class="main">,</span>nat<span class="main">]</span> <span class="main">⇒</span> real"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">sqrtl</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">/</span>sqrtu <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span>"</span></span>

<span class="keyword1" id="Sqrt_Bounds-sqrtl_lower"><span class="command">lemma</span></span> sqrtl_lower<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> sqrtl <span class="free">x</span> <span class="free">n</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> sqrtl_def <span class="keyword1"><span class="command">using</span></span> sqrtu_upper <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span> <span class="quoted"><span class="free">n</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> power2_eq_square <span class="dynamic"><span class="dynamic">divide_simps</span></span> mult_left_mono<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> gen_sqrt_lower<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> sqrtl <span class="free">x</span> <span class="free">n</span> <span class="main">≤</span> sqrt <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> real_sqrt_le_mono <span class="main">[</span><span class="operator">OF</span> sqrtl_lower <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span> <span class="quoted"><span class="free">n</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Sqrt_Bounds-sqrt_lower_bound_0"><span class="command">lemma</span></span> sqrt_lower_bound_0<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span><span class="main">*</span><span class="free">x</span><span class="main">/</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> sqrt <span class="free">x</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">≤</span> <span class="main">_</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> sqrtl <span class="free">x</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sqrtl_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> sqrt <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms gen_sqrt_lower<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Sqrt_Bounds-sqrt_lower_bound_1"><span class="command">lemma</span></span> sqrt_lower_bound_1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">4</span><span class="main">*</span><span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">6</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span> <span class="main">≤</span> sqrt <span class="free">x</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">≤</span> <span class="main">_</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?lhs</span> <span class="main">=</span> sqrtl <span class="free">x</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sqrtl_def power_eq_if <span class="dynamic"><span class="dynamic">algebra_simps</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> sqrt <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms gen_sqrt_lower<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Sqrt_Bounds-sqrtl_2_eq"><span class="command">lemma</span></span> sqrtl_2_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"sqrtl <span class="free">x</span> <span class="numeral">2</span> <span class="main">=</span>
    <span class="numeral">8</span><span class="main">*</span><span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">6</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">28</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">70</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">28</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> sqrtu_gt_0 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span> <span class="quoted"><span class="numeral">2</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sqrtl_def sqrtu_2_eq<span class="main">)</span>

<span class="keyword1" id="Sqrt_Bounds-sqrt_lower_bound_2"><span class="command">lemma</span></span> sqrt_lower_bound_2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">8</span><span class="main">*</span><span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">6</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">28</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">70</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">28</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">≤</span> sqrt <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms sqrtl_2_eq gen_sqrt_lower<span class="main">)</span>

<span class="keyword1" id="Sqrt_Bounds-sqrtl_4_eq"><span class="command">lemma</span></span> sqrtl_4_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span> <span class="main">⟹</span>
  sqrtl <span class="free">x</span> <span class="numeral">4</span>
    <span class="main">=</span> <span class="main">(</span><span class="numeral">32</span><span class="main">*</span><span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">6</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">28</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">+</span><span class="numeral">70</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">28</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="numeral">1820</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">8008</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">5</span><span class="main">+</span><span class="free">x</span><span class="main">^</span><span class="numeral">8</span><span class="main">+</span><span class="numeral">120</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">7</span><span class="main">+</span><span class="numeral">120</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">+</span><span class="numeral">1820</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">8008</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">+</span><span class="numeral">12870</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">)</span><span class="main">)</span>
    <span class="main">/</span> <span class="main">(</span><span class="numeral">225792840</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">64512240</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">5</span><span class="main">+</span><span class="numeral">601080390</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">8</span><span class="main">+</span><span class="numeral">471435600</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">7</span><span class="main">+</span><span class="numeral">496</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">+</span><span class="numeral">35960</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">906192</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">+</span><span class="numeral">10518300</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="free">x</span><span class="main">^</span><span class="numeral">16</span><span class="main">+</span><span class="numeral">906192</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">13</span><span class="main">+</span><span class="numeral">10518300</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">12</span><span class="main">+</span><span class="numeral">496</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">15</span><span class="main">+</span><span class="numeral">35960</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">14</span><span class="main">+</span><span class="numeral">471435600</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">9</span><span class="main">+</span><span class="numeral">225792840</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">10</span><span class="main">+</span><span class="numeral">64512240</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">11</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> sqrtu_gt_0 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span> <span class="quoted"><span class="numeral">4</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sqrtl_def sqrtu_4_eq<span class="main">)</span>

<span class="keyword1" id="Sqrt_Bounds-sqrt_lower_bound_4"><span class="command">lemma</span></span> sqrt_lower_bound_4<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">32</span><span class="main">*</span><span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">6</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="numeral">28</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">+</span><span class="numeral">70</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">28</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="numeral">1820</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">8008</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">5</span><span class="main">+</span><span class="free">x</span><span class="main">^</span><span class="numeral">8</span><span class="main">+</span><span class="numeral">120</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">7</span><span class="main">+</span><span class="numeral">120</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">+</span><span class="numeral">1820</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">8008</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">+</span><span class="numeral">12870</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">)</span><span class="main">)</span>
           <span class="main">/</span> <span class="main">(</span><span class="numeral">225792840</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">6</span><span class="main">+</span><span class="numeral">64512240</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">5</span><span class="main">+</span><span class="numeral">601080390</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">8</span><span class="main">+</span><span class="numeral">471435600</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">7</span><span class="main">+</span><span class="numeral">496</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="main">1</span><span class="main">+</span><span class="numeral">35960</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="numeral">906192</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span><span class="main">+</span><span class="numeral">10518300</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span><span class="main">+</span><span class="free">x</span><span class="main">^</span><span class="numeral">16</span><span class="main">+</span><span class="numeral">906192</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">13</span><span class="main">+</span><span class="numeral">10518300</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">12</span><span class="main">+</span><span class="numeral">496</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">15</span><span class="main">+</span><span class="numeral">35960</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">14</span><span class="main">+</span><span class="numeral">471435600</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">9</span><span class="main">+</span><span class="numeral">225792840</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">10</span><span class="main">+</span><span class="numeral">64512240</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">11</span><span class="main">)</span>
           <span class="main">≤</span> sqrt <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms sqrtl_4_eq gen_sqrt_lower<span class="main">)</span>

<span class="keyword1" id="Sqrt_Bounds-gen_sqrt_lower_scaled"><span class="command">lemma</span></span> gen_sqrt_lower_scaled<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">u</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"sqrtl <span class="main">(</span><span class="free">x</span><span class="main">*</span><span class="free">u</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="free">n</span> <span class="main">/</span> <span class="free">u</span> <span class="main">≤</span> sqrt <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sqrtl <span class="main">(</span><span class="free">x</span><span class="main">*</span><span class="free">u</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="free">n</span> <span class="main">/</span> <span class="free">u</span> <span class="main">≤</span> sqrt <span class="main">(</span><span class="free">x</span><span class="main">*</span><span class="free">u</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">/</span> <span class="free">u</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> gen_sqrt_lower zero_le_mult_iff zero_le_power2<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sqrt <span class="free">x</span> <span class="main">*</span> sqrt <span class="main">(</span><span class="free">u</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">/</span> <span class="free">u</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> real_sqrt_mult<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sqrt <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Sqrt_Bounds-sqrt_lower_bound_2_small"><span class="command">lemma</span></span> sqrt_lower_bound_2_small<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">32</span><span class="main">*</span><span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="numeral">16</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="numeral">256</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">96</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">65536</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">114688</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">17920</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">448</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span> <span class="main">≤</span> sqrt <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> order_trans <span class="main"><span class="main">[</span></span><span class="operator">OF</span> eq_refl gen_sqrt_lower_scaled <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span> <span class="quoted"><span class="numeral"><span class="quoted"><span class="numeral">4</span></span></span></span> <span class="quoted"><span class="numeral"><span class="quoted"><span class="numeral">2</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> sqrtl_2_eq <span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">algebra</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Sqrt_Bounds-sqrt_lower_bound_2_large"><span class="command">lemma</span></span> sqrt_lower_bound_2_large<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">32</span><span class="main">*</span><span class="free">x</span><span class="main">*</span><span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">16</span><span class="main">)</span><span class="main">*</span><span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">96</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">256</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">4</span> <span class="main">+</span> <span class="numeral">448</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">17920</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">114688</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="numeral">65536</span><span class="main">)</span> <span class="main">≤</span> sqrt <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> order_trans <span class="main"><span class="main">[</span></span><span class="operator">OF</span> eq_refl gen_sqrt_lower_scaled <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">1</span></span><span class="main"><span class="main">/</span></span><span class="numeral"><span class="numeral">4</span></span>"</span></span></span> <span class="quoted"><span class="numeral"><span class="quoted"><span class="numeral">2</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> sqrtl_2_eq<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword2"><span class="keyword">end</span></span>

</pre>
</div>
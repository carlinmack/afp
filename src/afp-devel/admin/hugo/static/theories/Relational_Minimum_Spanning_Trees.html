<div id="Kruskal">
<div class="head">
<h1>Theory Kruskal</h1>
</div>
<pre class="source"><span class="comment1">(* Title:      Kruskal's Minimum Spanning Tree Algorithm
   Author:     Walter Guttmann
   Maintainer: Walter Guttmann &lt;walter.guttmann at canterbury.ac.nz&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Kruskal's Minimum Spanning Tree Algorithm›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
In this theory we prove total correctness of Kruskal's minimum spanning tree algorithm.
The proof uses the following steps \cite{Guttmann2018c}.
We first establish that the algorithm terminates and constructs a spanning tree.
This is a constructive proof of the existence of a spanning tree; any spanning tree algorithm could be used for this.
We then conclude that a minimum spanning tree exists.
This is necessary to establish the invariant for the actual correctness proof, which shows that Kruskal's algorithm produces a minimum spanning tree.
›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Kruskal

<span class="keyword2"><span class="keyword">imports</span></span> <span class="quoted">"<a href="../../HOL/HOL-Hoare/Hoare_Logic.html">HOL-Hoare.Hoare_Logic</a>"</span> <a href="../Aggregation_Algebras/Aggregation_Algebras.html">Aggregation_Algebras.Aggregation_Algebras</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">context</span></span> m_kleene_algebra
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">spanning_forest</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">≡</span> forest <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∧</span> components <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">≤</span> forest_components <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∧</span> regular <span class="free"><span class="bound"><span class="entity">f</span></span></span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">minimum_spanning_forest</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">≡</span> spanning_forest <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">u</span> <span class="main">.</span> spanning_forest <span class="bound">u</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">⟶</span> sum <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">⊓</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="bound">u</span> <span class="main">⊓</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">kruskal_spanning_invariant</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">≡</span> symmetric <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">∧</span> spanning_forest <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span><span class="main">-</span><span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">⊓</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">kruskal_invariant</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">≡</span> kruskal_spanning_invariant <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">w</span> <span class="main">.</span> minimum_spanning_forest <span class="bound">w</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">≤</span> <span class="bound">w</span> <span class="main">⊔</span> <span class="bound">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
We first show two verification conditions which are used in both correctness proofs.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> kruskal_vc_1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"kruskal_spanning_invariant bot <span class="free">g</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> kruskal_spanning_invariant_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">=</span> <span class="free">g</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span> <span class="main">=</span> <span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> inf.sup_monoid.add_commute selection_closed_id <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"spanning_forest bot <span class="main">(</span><span class="main">-</span><span class="free">g</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> star.circ_transitive_equal spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> kruskal_vc_2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"kruskal_spanning_invariant <span class="free">f</span> <span class="free">g</span> <span class="free">h</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">≠</span> bot"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>minarc <span class="free">h</span> <span class="main">≤</span> <span class="main">-</span>forest_components <span class="free">f</span> <span class="main">⟶</span> kruskal_spanning_invariant <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> minarc <span class="free">h</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> top <span class="main">*</span> minarc <span class="free">h</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> minarc <span class="free">h</span><span class="main">)</span> <span class="free">g</span> <span class="main">(</span><span class="free">h</span> <span class="main">⊓</span> <span class="main">-</span>minarc <span class="free">h</span> <span class="main">⊓</span> <span class="main">-</span>minarc <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>
                                               <span class="main">∧</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">h</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span>minarc <span class="free">h</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span>minarc <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span> <span class="main">&lt;</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">h</span> <span class="main">}</span><span class="main">)</span> <span class="main">∧</span>
           <span class="main">(</span><span class="main">¬</span> minarc <span class="free">h</span> <span class="main">≤</span> <span class="main">-</span>forest_components <span class="free">f</span> <span class="main">⟶</span> kruskal_spanning_invariant <span class="free">f</span> <span class="free">g</span> <span class="main">(</span><span class="free">h</span> <span class="main">⊓</span> <span class="main">-</span>minarc <span class="free">h</span> <span class="main">⊓</span> <span class="main">-</span>minarc <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>
                                                 <span class="main">∧</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">h</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span>minarc <span class="free">h</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span>minarc <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span> <span class="main">&lt;</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">h</span> <span class="main">}</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"minarc <span class="free">h</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?h</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?e</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">h</span> <span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">h</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?e</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="free">f</span> <span class="main">∧</span> regular <span class="var">?e</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> kruskal_spanning_invariant_def spanning_forest_def minarc_regular<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="var">?f</span> <span class="main">∧</span> regular <span class="var">?F</span> <span class="main">∧</span> regular <span class="main">(</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?e</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> inf.orderE minarc_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> psubset_card_mono<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> finite_regular <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">using</span></span> 1 3 kruskal_spanning_invariant_def minarc_below <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟶</span> kruskal_spanning_invariant <span class="var">?f</span> <span class="free">g</span> <span class="var">?h</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">¬</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟶</span> kruskal_spanning_invariant <span class="free">f</span> <span class="free">g</span> <span class="var">?h</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> conjI<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"injective <span class="var">?f</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_injective_inv<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> covector_mult_closed<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative comp_isotone star.right_plus_below_circ<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">meson</span> mult_left_isotone order_lesseq_imp star_outer_increasing top.extremum<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> kruskal_spanning_invariant_def kruskal_injective_inv_2 minarc_arc spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> arc_injective minarc_arc <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> kruskal_spanning_invariant_def kruskal_injective_inv_3 minarc_arc spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟶</span> kruskal_spanning_invariant <span class="var">?f</span> <span class="free">g</span> <span class="var">?h</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> 7<span class="main">:</span> <span class="quoted"><span class="quoted">"equivalence <span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def forest_components_equivalence spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> arc_top_arc minarc_arc<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 6 7 conv_complement conv_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">hence</span></span> 8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">=</span> bot"</span></span>
        <span class="keyword1"><span class="command">using</span></span> le_bot triple_schroeder_p <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"kruskal_spanning_invariant <span class="var">?f</span> <span class="free">g</span> <span class="var">?h</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> kruskal_spanning_invariant_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?h</span> <span class="main">=</span> <span class="var">?h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_complement conv_dist_inf inf_commute inf_left_commute kruskal_spanning_invariant_def<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="var">?h</span> <span class="main">=</span> <span class="var">?h</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>hide_lams<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> kruskal_spanning_invariant_def inf_assoc pp_dist_inf<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"spanning_forest <span class="var">?f</span> <span class="main">(</span><span class="main">-</span><span class="var">?h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> spanning_forest_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="var">?f</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="var">?f</span>"</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_acyclic_inv<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> covector_mult_closed<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> 8 assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def kruskal_acyclic_inv_1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> 8 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative mult_left_sub_dist_sup_left star.circ_loop_fixpoint sup_commute le_bot<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> 6 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> p_antitone_iff<span class="main">)</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="main">-</span><span class="var">?h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_subgraph_inv<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> kruskal_spanning_invariant_def minarc_below order.trans pp_isotone_inf<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"components <span class="main">(</span><span class="main">-</span><span class="var">?h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> forest_components <span class="var">?f</span>"</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_spanning_inv<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> 5 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> 1 regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?f</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟶</span> kruskal_spanning_invariant <span class="free">f</span> <span class="free">g</span> <span class="var">?h</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> 9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 assms<span class="main">(</span>2<span class="main">)</span> arc_in_partition minarc_arc <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"kruskal_spanning_invariant <span class="free">f</span> <span class="free">g</span> <span class="var">?h</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> kruskal_spanning_invariant_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?h</span> <span class="main">=</span> <span class="var">?h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_complement conv_dist_inf inf_commute inf_left_commute kruskal_spanning_invariant_def<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="var">?h</span> <span class="main">=</span> <span class="var">?h</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>hide_lams<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> kruskal_spanning_invariant_def inf_assoc pp_dist_inf<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"spanning_forest <span class="free">f</span> <span class="main">(</span><span class="main">-</span><span class="var">?h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> spanning_forest_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="free">f</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="free">f</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="main">-</span><span class="free">h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="main">-</span><span class="var">?h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> comp_inf.mult_right_isotone inf.sup_monoid.add_commute inf_left_commute p_antitone_inf pp_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span>
          <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="main">-</span><span class="var">?h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"components <span class="main">(</span><span class="main">-</span><span class="var">?h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> <span class="var">?F</span>"</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_spanning_inv_1<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> 9 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def forest_components_equivalence spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">f</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
The following result shows that Kruskal's algorithm terminates and constructs a spanning tree.
We cannot yet show that this is a minimum spanning tree.
›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> kruskal_spanning<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">VARS</span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">e</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">f</span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">h</span></span></span></span></span></span></span></span></span></span></span></span></span></span>
  <span class="main">[</span> symmetric <span class="free">g</span> <span class="main">]</span>
  f <span class="main">:=</span> bot<span class="main">;</span>
  h <span class="main">:=</span> <span class="free">g</span><span class="main">;</span>
  <span class="keyword1">WHILE</span> <span class="bound">h</span> <span class="main">≠</span> bot
    <span class="keyword1">INV</span> <span class="main">{</span> kruskal_spanning_invariant <span class="bound">f</span> <span class="free">g</span> <span class="bound">h</span> <span class="main">}</span>
    <span class="keyword1">VAR</span> <span class="main">{</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="bound">h</span> <span class="main">}</span> <span class="main">}</span>
     <span class="keyword1">DO</span> e <span class="main">:=</span> minarc <span class="bound">h</span><span class="main">;</span>
        <span class="keyword1">IF</span> <span class="bound">e</span> <span class="main">≤</span> <span class="main">-</span>forest_components <span class="bound">f</span> <span class="keyword1">THEN</span>
          f <span class="main">:=</span> <span class="main">(</span><span class="bound">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> <span class="bound">e</span> <span class="main">*</span> <span class="bound">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="bound">f</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="bound">e</span> <span class="main">*</span> <span class="bound">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="bound">e</span>
        <span class="keyword1">ELSE</span>
          <span class="keyword1">SKIP</span>
        <span class="keyword1">FI</span><span class="main">;</span>
        h <span class="main">:=</span> <span class="bound">h</span> <span class="main">⊓</span> <span class="main">-</span><span class="bound">e</span> <span class="main">⊓</span> <span class="main">-</span><span class="bound">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>
     <span class="keyword1">OD</span>
  <span class="main">[</span> spanning_forest <span class="bound">f</span> <span class="free">g</span> <span class="main">]</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">vcg_tc_simp</span>
  <span class="keyword1"><span class="command">using</span></span> kruskal_vc_1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">using</span></span> kruskal_vc_2 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">using</span></span> kruskal_spanning_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Because we have shown total correctness, we conclude that a spanning tree exists.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> kruskal_exists_spanning<span class="main">:</span>
  <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">f</span> <span class="main">.</span> spanning_forest <span class="bound">f</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> tc_extract_function kruskal_spanning <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
This implies that a minimum spanning tree exists, which is used in the subsequent correctness proof.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> kruskal_exists_minimal_spanning<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">f</span> <span class="main">.</span> minimum_spanning_forest <span class="bound">f</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?s</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="bound">f</span> <span class="main">.</span> spanning_forest <span class="bound">f</span> <span class="free">g</span> <span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">m</span><span class="main">∈</span><span class="var">?s</span> <span class="main">.</span> <span class="main">∀</span><span class="bound">z</span><span class="main">∈</span><span class="var">?s</span> <span class="main">.</span> sum <span class="main">(</span><span class="bound">m</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="bound">z</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> finite_set_minimal<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> finite_regular spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">using</span></span> assms kruskal_exists_spanning <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">using</span></span> sum_linear <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> minimum_spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Kruskal's minimum spanning tree algorithm terminates and is correct.
This is the same algorithm that is used in the previous correctness proof, with the same precondition and variant, but with a different invariant and postcondition.
›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> kruskal<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">VARS</span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">e</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">f</span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">h</span></span></span></span></span></span></span></span></span></span></span></span></span></span>
  <span class="main">[</span> symmetric <span class="free">g</span> <span class="main">]</span>
  f <span class="main">:=</span> bot<span class="main">;</span>
  h <span class="main">:=</span> <span class="free">g</span><span class="main">;</span>
  <span class="keyword1">WHILE</span> <span class="bound">h</span> <span class="main">≠</span> bot
    <span class="keyword1">INV</span> <span class="main">{</span> kruskal_invariant <span class="bound">f</span> <span class="free">g</span> <span class="bound">h</span> <span class="main">}</span>
    <span class="keyword1">VAR</span> <span class="main">{</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="bound">h</span> <span class="main">}</span> <span class="main">}</span>
     <span class="keyword1">DO</span> e <span class="main">:=</span> minarc <span class="bound">h</span><span class="main">;</span>
        <span class="keyword1">IF</span> <span class="bound">e</span> <span class="main">≤</span> <span class="main">-</span>forest_components <span class="bound">f</span> <span class="keyword1">THEN</span>
          f <span class="main">:=</span> <span class="main">(</span><span class="bound">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> <span class="bound">e</span> <span class="main">*</span> <span class="bound">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="bound">f</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="bound">e</span> <span class="main">*</span> <span class="bound">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="bound">e</span>
        <span class="keyword1">ELSE</span>
          <span class="keyword1">SKIP</span>
        <span class="keyword1">FI</span><span class="main">;</span>
        h <span class="main">:=</span> <span class="bound">h</span> <span class="main">⊓</span> <span class="main">-</span><span class="bound">e</span> <span class="main">⊓</span> <span class="main">-</span><span class="bound">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>
     <span class="keyword1">OD</span>
  <span class="main">[</span> minimum_spanning_forest <span class="bound">f</span> <span class="free">g</span> <span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">vcg_tc_simp</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"kruskal_invariant bot <span class="free">g</span> <span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> kruskal_vc_1 kruskal_exists_minimal_spanning kruskal_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">h</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"minarc <span class="skolem">h</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?h</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?e</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="skolem">f</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="skolem">h</span> <span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="skolem">h</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?e</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"kruskal_invariant <span class="skolem">f</span> <span class="free">g</span> <span class="skolem">h</span> <span class="main">∧</span> <span class="skolem">h</span> <span class="main">≠</span> bot"</span></span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">w</span></span> <span class="keyword2"><span class="keyword">where</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"minimum_spanning_forest <span class="skolem">w</span> <span class="free">g</span> <span class="main">∧</span> <span class="skolem">f</span> <span class="main">≤</span> <span class="skolem">w</span> <span class="main">⊔</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> kruskal_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="skolem">f</span> <span class="main">∧</span> regular <span class="skolem">w</span> <span class="main">∧</span> regular <span class="var">?e</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> kruskal_invariant_def kruskal_spanning_invariant_def minimum_spanning_forest_def spanning_forest_def minarc_regular<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟶</span> kruskal_invariant <span class="var">?f</span> <span class="free">g</span> <span class="var">?h</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">¬</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟶</span> kruskal_invariant <span class="skolem">f</span> <span class="free">g</span> <span class="var">?h</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> conjI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟶</span> kruskal_invariant <span class="var">?f</span> <span class="free">g</span> <span class="var">?h</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"equivalence <span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 kruskal_invariant_def kruskal_spanning_invariant_def forest_components_equivalence spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> arc_top_arc minarc_arc<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 4 5 conv_complement conv_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">hence</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">=</span> bot"</span></span>
        <span class="keyword1"><span class="command">using</span></span> le_bot triple_schroeder_p <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"kruskal_invariant <span class="var">?f</span> <span class="free">g</span> <span class="var">?h</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> kruskal_invariant_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"kruskal_spanning_invariant <span class="var">?f</span> <span class="free">g</span> <span class="var">?h</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 1 4 kruskal_vc_2 kruskal_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">w</span> <span class="main">.</span> minimum_spanning_forest <span class="bound">w</span> <span class="free">g</span> <span class="main">∧</span> <span class="var">?f</span> <span class="main">≤</span> <span class="bound">w</span> <span class="main">⊔</span> <span class="bound">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span>
          <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?p</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
          <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?v</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">have</span></span> 7<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="var">?p</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 3 regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">have</span></span> 8<span class="main">:</span> <span class="quoted"><span class="quoted">"injective <span class="var">?v</span>"</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_exchange_injective_inv_1<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> 2 minimum_spanning_forest_def spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> covector_mult_closed<span class="main">)</span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative comp_isotone star.right_plus_below_circ<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> 1 2 kruskal_injective_inv_3 minarc_arc minimum_spanning_forest_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">have</span></span> 9<span class="main">:</span> <span class="quoted"><span class="quoted">"components <span class="free">g</span> <span class="main">≤</span> forest_components <span class="var">?v</span>"</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_exchange_spanning_inv_1<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> 8 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> 7 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> 2 minimum_spanning_forest_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">have</span></span> 10<span class="main">:</span> <span class="quoted"><span class="quoted">"spanning_forest <span class="var">?v</span> <span class="free">g</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> spanning_forest_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="var">?v</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="var">?v</span>"</span></span>
              <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_exchange_acyclic_inv_1<span class="main">)</span>
              <span class="keyword1"><span class="command">using</span></span> 2 minimum_spanning_forest_def spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> covector_mult_closed<span class="main">)</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
              <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> sup_least<span class="main">)</span>
              <span class="keyword1"><span class="command">using</span></span> 2 inf.coboundedI1 minimum_spanning_forest_def spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> kruskal_invariant_def kruskal_spanning_invariant_def conv_complement conv_dist_inf order.trans inf.absorb2 inf.cobounded1 minimum_spanning_forest_def spanning_forest_def<span class="main">)</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"components <span class="free">g</span> <span class="main">≤</span> forest_components <span class="var">?v</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 9 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?v</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 3 regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">have</span></span> 11<span class="main">:</span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="var">?p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_complement conv_top epm_8 inf_import_p inf_top_right regular_closed_top vector_top_closed minimum_spanning_forest_def spanning_forest_def sum_disjoint<span class="main">)</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="var">?p</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 1 kruskal_invariant_def kruskal_spanning_invariant_def sum_symmetric <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?p</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> inf_commute inf_left_commute sum_disjoint <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 3 7 maddux_3_11_pp <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">have</span></span> 12<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">⊔</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="skolem">w</span> <span class="main">⊔</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">⊔</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?p</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?p</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> conv_complement conv_dist_inf conv_dist_sup inf_import_p sup_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">w</span> <span class="main">⊔</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 3 7 conv_complement conv_dist_inf inf_import_p maddux_3_11_pp sup_monoid.add_assoc sup_monoid.add_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">have</span></span> 13<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_reroot_edge<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> minarc_arc<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> 2 minimum_spanning_forest_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">⊓</span> <span class="var">?e</span> <span class="main">≤</span> <span class="var">?v</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> inf.sup_right_isotone top_left_mult_increasing <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?v</span> <span class="main">*</span> <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> covector_restrict_comp_conv covector_mult_closed vector_top_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 14<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">⊓</span> <span class="var">?e</span> <span class="main">=</span> bot"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 13 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_dist_comp mult_assoc le_bot mult_left_zero<span class="main">)</span>
          <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?d</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">-</span><span class="var">?F</span>"</span></span>
          <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?w</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">have</span></span> 15<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="var">?d</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 3 regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">have</span></span> 16<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?d</span>"</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_edge_between_components_1<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> 5 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> 1 conv_dist_comp minarc_arc mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">have</span></span> 17<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">⊔</span> <span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_edge_between_components_2<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> 16 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> 1 kruskal_invariant_def kruskal_spanning_invariant_def spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> 2 12 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_dist_sup conv_involutive conv_isotone le_supI sup_commute<span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"minimum_spanning_forest <span class="var">?w</span> <span class="free">g</span> <span class="main">∧</span> <span class="var">?f</span> <span class="main">≤</span> <span class="var">?w</span> <span class="main">⊔</span> <span class="var">?w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> conjI<span class="main">)</span>
            <span class="keyword1"><span class="command">have</span></span> 18<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
              <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_edge_arc_1<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> g<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="free"><span class="quoted"><span class="free">g</span></span></span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">and</span></span></span></span> h<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">h</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
              <span class="keyword1"><span class="command">using</span></span> minarc_below <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> kruskal_invariant_def kruskal_spanning_invariant_def inf_le1<span class="main">)</span>
              <span class="keyword1"><span class="command">using</span></span> 1 kruskal_invariant_def kruskal_spanning_invariant_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">using</span></span> 9 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">using</span></span> 13 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">have</span></span> 19<span class="main">:</span> <span class="quoted"><span class="quoted">"arc <span class="var">?d</span>"</span></span>
              <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_edge_arc<span class="main">)</span>
              <span class="keyword1"><span class="command">using</span></span> 5 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">using</span></span> 10 spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> minarc_arc<span class="main">)</span>
              <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> conv_complement pp_dist_star regular_mult_closed<span class="main">)</span>
              <span class="keyword1"><span class="command">using</span></span> 2 8 12 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> kruskal_forest_components_inf<span class="main">)</span>
              <span class="keyword1"><span class="command">using</span></span> 10 spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">using</span></span> 13 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">using</span></span> 6 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">using</span></span> 18 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"minimum_spanning_forest <span class="var">?w</span> <span class="free">g</span>"</span></span>
            <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> minimum_spanning_forest_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span><span class="main">)</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?v</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> inf_le1 mult_left_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span><span class="main">)</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 13 le_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">hence</span></span> 20<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
                <span class="keyword1"><span class="command">using</span></span> conv_dist_comp conv_involutive conv_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
              <span class="keyword1"><span class="command">have</span></span> 21<span class="main">:</span> <span class="quoted"><span class="quoted">"injective <span class="var">?w</span>"</span></span>
                <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> injective_sup<span class="main">)</span>
                <span class="keyword1"><span class="command">using</span></span> 8 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> injective_inf_closed<span class="main">)</span>
                <span class="keyword1"><span class="command">using</span></span> 20 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
                <span class="keyword1"><span class="command">using</span></span> 1 arc_injective minarc_arc <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"spanning_forest <span class="var">?w</span> <span class="free">g</span>"</span></span>
              <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> spanning_forest_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
                <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="var">?w</span>"</span></span>
                  <span class="keyword1"><span class="command">using</span></span> 21 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">next</span></span>
                <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="var">?w</span>"</span></span>
                  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_exchange_acyclic_inv_2<span class="main">)</span>
                  <span class="keyword1"><span class="command">using</span></span> 10 spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">blast</span>
                  <span class="keyword1"><span class="command">using</span></span> 8 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
                  <span class="keyword1"><span class="command">using</span></span> inf.coboundedI1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
                  <span class="keyword1"><span class="command">using</span></span> 19 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
                  <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> minarc_arc<span class="main">)</span>
                  <span class="keyword1"><span class="command">using</span></span> inf.cobounded2 inf.coboundedI1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
                  <span class="keyword1"><span class="command">using</span></span> 13 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">next</span></span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?w</span> <span class="main">≤</span> <span class="var">?v</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
                  <span class="keyword1"><span class="command">using</span></span> inf_le1 sup_left_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
                <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
                  <span class="keyword1"><span class="command">using</span></span> 10 sup_left_isotone spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span> <span class="main">⊔</span> <span class="main">-</span><span class="main">-</span><span class="skolem">h</span>"</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_supI2 minarc_below<span class="main">)</span>
                <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
                  <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> kruskal_invariant_def kruskal_spanning_invariant_def pp_isotone_inf sup.orderE<span class="main">)</span>
                <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?w</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">next</span></span>
                <span class="keyword1"><span class="command">have</span></span> 22<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?d</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
                  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_exchange_spanning_inv_2<span class="main">)</span>
                  <span class="keyword1"><span class="command">using</span></span> 8 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
                  <span class="keyword1"><span class="command">using</span></span> 13 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> semiring.mult_not_zero star_absorb star_simulation_right_equal<span class="main">)</span>
                  <span class="keyword1"><span class="command">using</span></span> 17 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.coboundedI1<span class="main">)</span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"components <span class="free">g</span> <span class="main">≤</span> forest_components <span class="var">?v</span>"</span></span>
                  <span class="keyword1"><span class="command">using</span></span> 10 spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> forest_components <span class="var">?w</span>"</span></span>
                  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_exchange_forest_components_inv<span class="main">)</span>
                  <span class="keyword1"><span class="command">using</span></span> 21 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
                  <span class="keyword1"><span class="command">using</span></span> 15 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
                  <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> arc_top_arc minarc_arc<span class="main">)</span>
                  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.coboundedI1<span class="main">)</span>
                  <span class="keyword1"><span class="command">using</span></span> 13 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
                  <span class="keyword1"><span class="command">using</span></span> 8 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
                  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_infI1<span class="main">)</span>
                  <span class="keyword1"><span class="command">using</span></span> 22 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
                <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"components <span class="free">g</span> <span class="main">≤</span> forest_components <span class="var">?w</span>"</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">next</span></span>
                <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?w</span>"</span></span>
                  <span class="keyword1"><span class="command">using</span></span> 3 7 regular_conv_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword1"><span class="command">have</span></span> 23<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">⊓</span> <span class="free">g</span> <span class="main">≠</span> bot"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> kruskal_invariant_def kruskal_spanning_invariant_def comp_inf.semiring.mult_zero_right inf.sup_monoid.add_assoc inf.sup_monoid.add_commute minarc_bot_iff minarc_meet_bot<span class="main">)</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">h</span> <span class="main">≤</span> <span class="main">(</span><span class="free">g</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">h</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> star.circ_increasing <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="free">g</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">h</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> pp_increasing star_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?F</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 1 kruskal_invariant_def kruskal_spanning_invariant_def inf.sup_monoid.add_commute spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 24<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">h</span> <span class="main">≤</span> <span class="var">?F</span>"</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?d</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 10 inf.coboundedI1 spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?d</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?F</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 16 inf.boundedI p_antitone_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="free">g</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?F</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="skolem">h</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 24 p_shunting_swap pp_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
              <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 25<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?d</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="skolem">h</span>"</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?d</span> <span class="main">=</span> bot <span class="main">⟶</span> top <span class="main">=</span> bot"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 19 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_left_zero mult_right_zero<span class="main">)</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?d</span> <span class="main">≠</span> bot"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 1 le_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">hence</span></span> 26<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?d</span> <span class="main">⊓</span> <span class="skolem">h</span> <span class="main">≠</span> bot"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 25 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.absorb_iff2 inf_commute pseudo_complement<span class="main">)</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?e</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> sum <span class="main">(</span><span class="var">?e</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="skolem">h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.absorb1 minarc_below<span class="main">)</span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="var">?e</span> <span class="main">⊓</span> <span class="skolem">h</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> kruskal_invariant_def kruskal_spanning_invariant_def inf.left_commute inf.sup_monoid.add_commute<span class="main">)</span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> sum <span class="main">(</span><span class="var">?d</span> <span class="main">⊓</span> <span class="skolem">h</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 19 26 minarc_min <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="var">?d</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="skolem">h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 1 kruskal_invariant_def kruskal_spanning_invariant_def inf_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="var">?d</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 25 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.absorb2 inf_assoc inf_commute<span class="main">)</span>
              <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 27<span class="main">:</span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?e</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="var">?d</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">⊓</span> <span class="var">?e</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span> <span class="main">=</span> bot"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 14 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> sum <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="var">?e</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> sum_disjoint inf_commute inf_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> sum <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="var">?d</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 23 27 sum_plus_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?d</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> sum_disjoint inf_le2 pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">(</span><span class="var">?v</span> <span class="main">⊔</span> <span class="var">?d</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span><span class="var">?d</span> <span class="main">⊔</span> <span class="var">?d</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sup_inf_distrib2<span class="main">)</span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">(</span><span class="var">?v</span> <span class="main">⊔</span> <span class="var">?d</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 15 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf_top_right stone<span class="main">)</span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.sup_monoid.add_assoc<span class="main">)</span>
              <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">u</span> <span class="main">.</span> spanning_forest <span class="bound">u</span> <span class="free">g</span> <span class="main">⟶</span> sum <span class="main">(</span><span class="var">?w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="bound">u</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 2 11 minimum_spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">≤</span> <span class="skolem">f</span> <span class="main">⊔</span> <span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> conv_dist_inf inf_le1 sup_left_isotone sup_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 17 sup_left_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> inf.cobounded1 sup_inf_distrib2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?w</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sup_assoc sup_commute<span class="main">)</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?w</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> inf.sup_right_isotone inf_assoc sup_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?w</span> <span class="main">⊔</span> <span class="var">?w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> conv_complement conv_dist_inf conv_dist_sup sup_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">≤</span> <span class="var">?w</span> <span class="main">⊔</span> <span class="var">?w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 1 kruskal_vc_2 kruskal_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟶</span> kruskal_invariant <span class="skolem">f</span> <span class="free">g</span> <span class="var">?h</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 kruskal_vc_2 kruskal_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span>
  <span class="keyword3"><span class="command">assume</span></span> 28<span class="main">:</span> <span class="quoted"><span class="quoted">"kruskal_invariant <span class="skolem">f</span> <span class="free">g</span> bot"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> 29<span class="main">:</span> <span class="quoted"><span class="quoted">"spanning_forest <span class="skolem">f</span> <span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> kruskal_invariant_def kruskal_spanning_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> 28 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">w</span></span> <span class="keyword2"><span class="keyword">where</span></span> 30<span class="main">:</span> <span class="quoted"><span class="quoted">"minimum_spanning_forest <span class="skolem">w</span> <span class="free">g</span> <span class="main">∧</span> <span class="skolem">f</span> <span class="main">≤</span> <span class="skolem">w</span> <span class="main">⊔</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> kruskal_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">=</span> <span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.absorb1 minimum_spanning_forest_def spanning_forest_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">w</span> <span class="main">⊓</span> components <span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.sup_right_isotone star.circ_increasing<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">w</span> <span class="main">⊓</span> <span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="skolem">f</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 29 spanning_forest_def inf.sup_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">f</span> <span class="main">⊔</span> <span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> cancel_separate_6<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> z<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">w</span></span></span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">and</span></span></span></span> y<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">"<span class="skolem"><span class="skolem">w</span></span><span class="keyword1"><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> 30 minimum_spanning_forest_def spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">using</span></span> 30 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> conv_dist_inf conv_dist_sup conv_involutive inf.cobounded2 inf.orderE<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> 30 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sup_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> 30 minimum_spanning_forest_def spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">using</span></span> 30 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> acyclic_star_below_complement comp_inf.mult_right_isotone inf_p le_bot minimum_spanning_forest_def spanning_forest_def<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 31<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">≤</span> <span class="skolem">f</span> <span class="main">⊔</span> <span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="skolem">f</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">(</span><span class="skolem">w</span> <span class="main">⊔</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 30 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf_absorb2 inf.assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 30 inf.commute acyclic_asymmetric sum_disjoint minimum_spanning_forest_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_dist_inf conv_involutive sum_conv<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">f</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 28 inf.commute inf.assoc kruskal_invariant_def kruskal_spanning_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">(</span><span class="skolem">f</span> <span class="main">⊔</span> <span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 29 acyclic_asymmetric inf.sup_monoid.add_commute sum_disjoint spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 31 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf_absorb2 inf.assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"minimum_spanning_forest <span class="skolem">f</span> <span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 29 30 minimum_spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

</pre>
</div><div id="Prim">
<div class="head">
<h1>Theory Prim</h1>
</div>
<pre class="source"><span class="comment1">(* Title:      Prim's Minimum Spanning Tree Algorithm
   Author:     Walter Guttmann
   Maintainer: Walter Guttmann &lt;walter.guttmann at canterbury.ac.nz&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Prim's Minimum Spanning Tree Algorithm›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
In this theory we prove total correctness of Prim's minimum spanning tree algorithm.
The proof has the same overall structure as the total-correctness proof of Kruskal's algorithm \cite{Guttmann2018c}.
The partial-correctness proof of Prim's algorithm is discussed in \cite{Guttmann2016c,Guttmann2018b}.
›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Prim

<span class="keyword2"><span class="keyword">imports</span></span> <span class="quoted">"<a href="../../HOL/HOL-Hoare/Hoare_Logic.html">HOL-Hoare.Hoare_Logic</a>"</span> <a href="../Aggregation_Algebras/Aggregation_Algebras.html">Aggregation_Algebras.Aggregation_Algebras</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">context</span></span> m_kleene_algebra
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">component</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">spanning_tree</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">≡</span> forest <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">≤</span> <span class="main">(</span>component <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span>component <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∧</span> component <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">∧</span> regular <span class="free"><span class="bound"><span class="entity">t</span></span></span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">minimum_spanning_tree</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">≡</span> spanning_tree <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">u</span> <span class="main">.</span> spanning_tree <span class="bound">u</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">⟶</span> sum <span class="main">(</span><span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">⊓</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="bound">u</span> <span class="main">⊓</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">prim_precondition</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">∧</span> injective <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">∧</span> vector <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">∧</span> regular <span class="free"><span class="bound"><span class="entity">r</span></span></span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">prim_spanning_invariant</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">v</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">≡</span> prim_precondition <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">v</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">∧</span> spanning_tree <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">v</span></span></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">v</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">prim_invariant</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">v</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">≡</span> prim_spanning_invariant <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="free"><span class="bound"><span class="entity">v</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">w</span> <span class="main">.</span> minimum_spanning_tree <span class="bound">w</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span> <span class="main">≤</span> <span class="bound">w</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> span_tree_split<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"vector <span class="free">r</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">≤</span> <span class="main">(</span>component <span class="free">g</span> <span class="free">r</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span>component <span class="free">g</span> <span class="free">r</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span> <span class="main">⟷</span> <span class="main">(</span><span class="free">t</span> <span class="main">≤</span> <span class="main">(</span>component <span class="free">g</span> <span class="free">r</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">∧</span> <span class="free">t</span> <span class="main">≤</span> component <span class="free">g</span> <span class="free">r</span> <span class="main">∧</span> <span class="free">t</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>component <span class="free">g</span> <span class="free">r</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span>component <span class="free">g</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>component <span class="free">g</span> <span class="free">r</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> component <span class="free">g</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms conv_involutive covector_mult_closed vector_conv_covector vector_covector<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> span_tree_component<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"spanning_tree <span class="free">t</span> <span class="free">g</span> <span class="free">r</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"component <span class="free">g</span> <span class="free">r</span> <span class="main">=</span> component <span class="free">t</span> <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> antisym mult_right_isotone star_isotone spanning_tree_def<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
We first show three verification conditions which are used in both correctness proofs.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> prim_vc_1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"prim_precondition <span class="free">g</span> <span class="free">r</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"prim_spanning_invariant bot <span class="free">r</span> <span class="free">g</span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> prim_spanning_invariant_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"prim_precondition <span class="free">g</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> bot<span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star_absorb<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?ss</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">*</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"spanning_tree bot <span class="var">?ss</span> <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> spanning_tree_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective bot"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic bot"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"bot <span class="main">≤</span> <span class="main">(</span>component <span class="var">?ss</span> <span class="free">r</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span>component <span class="var">?ss</span> <span class="free">r</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="var">?ss</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"component <span class="var">?ss</span> <span class="free">r</span> <span class="main">≤</span> component <span class="main">(</span><span class="free">r</span> <span class="main">*</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="free">r</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_right_isotone star_isotone<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">1</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.eq_iff p_antitone regular_one_closed star_sub_one prim_precondition_def<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> bot<span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star.circ_zero star_one<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"component <span class="var">?ss</span> <span class="free">r</span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> bot<span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular bot"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> prim_vc_2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"prim_spanning_invariant <span class="free">t</span> <span class="free">v</span> <span class="free">g</span> <span class="free">r</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="main">-</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span> <span class="main">≠</span> bot"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"prim_spanning_invariant <span class="main">(</span><span class="free">t</span> <span class="main">⊔</span> minarc <span class="main">(</span><span class="free">v</span> <span class="main">*</span> <span class="main">-</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊔</span> minarc <span class="main">(</span><span class="free">v</span> <span class="main">*</span> <span class="main">-</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span> <span class="free">g</span> <span class="free">r</span> <span class="main">∧</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> component <span class="free">g</span> <span class="free">r</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">(</span><span class="free">v</span> <span class="main">⊔</span> minarc <span class="main">(</span><span class="free">v</span> <span class="main">*</span> <span class="main">-</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span> <span class="main">&lt;</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> component <span class="free">g</span> <span class="free">r</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?vcv</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="main">-</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"minarc <span class="var">?vcv</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?t</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?v</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">⊔</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?c</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"component <span class="free">g</span> <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="var">?c</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="var">?c</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="free">v</span> <span class="main">∧</span> regular <span class="main">(</span><span class="free">v</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">∧</span> regular <span class="main">(</span><span class="var">?v</span> <span class="main">*</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">∧</span> regular <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> prim_spanning_invariant_def spanning_tree_def prim_precondition_def regular_conv_closed regular_closed_star regular_mult_closed conv_involutive regular_closed_top regular_closed_sup minarc_regular<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">≤</span> <span class="free">v</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> prim_spanning_invariant_def spanning_tree_def inf_pp_commute inf.boundedE<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">≤</span> <span class="free">v</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">≤</span> <span class="var">?g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="free">v</span> <span class="main">*</span> <span class="main">-</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> minarc_below pp_dist_inf regular_mult_closed regular_closed_p<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="free">v</span> <span class="main">*</span> <span class="main">-</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 7<span class="main">:</span> <span class="quoted"><span class="quoted">"vector <span class="free">v</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> prim_spanning_invariant_def prim_precondition_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> covector_mult_closed vector_conv_covector<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="free">v</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 6 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_complement inf.boundedE vector_complement_closed vector_covector<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="free">t</span> <span class="main">=</span> bot"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 3 6 7 et<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> 10<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="free">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 3 6 7 et<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 11<span class="main">:</span> <span class="quoted"><span class="quoted">"arc <span class="var">?e</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> minarc_arc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">t</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_right_isotone order_refl semiring.mult_not_zero star.circ_separate_mult_1 star_absorb<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 12<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> prim_spanning_invariant_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 13<span class="main">:</span> <span class="quoted"><span class="quoted">"vector <span class="free">r</span> <span class="main">∧</span> injective <span class="free">r</span> <span class="main">∧</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">t</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> prim_spanning_invariant_def prim_precondition_def minimum_spanning_tree_def spanning_tree_def reachable_restrict <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">=</span> <span class="free">g</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> prim_invariant_def prim_spanning_invariant_def prim_precondition_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> 14<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?g</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="var">?g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> conv_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"prim_spanning_invariant <span class="var">?t</span> <span class="var">?v</span> <span class="free">g</span> <span class="free">r</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> conjI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"prim_spanning_invariant <span class="var">?t</span> <span class="var">?v</span> <span class="free">g</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> prim_spanning_invariant_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"prim_precondition <span class="free">g</span> <span class="free">r</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> prim_spanning_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?t</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> 6 7 9 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> reachable_inv prim_spanning_invariant_def prim_precondition_def spanning_tree_def<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?G</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">*</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"spanning_tree <span class="var">?t</span> <span class="var">?G</span> <span class="free">r</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> spanning_tree_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="var">?t</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> 10 11 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> injective_inv prim_spanning_invariant_def spanning_tree_def<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="var">?t</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> 3 6 7 acyclic_inv prim_spanning_invariant_def spanning_tree_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?t</span> <span class="main">≤</span> <span class="main">(</span>component <span class="var">?G</span> <span class="free">r</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span>component <span class="var">?G</span> <span class="free">r</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="var">?G</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 1 2 5 7 13 prim_subgraph_inv inf_pp_commute mst_subgraph_inv_2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"component <span class="main">(</span><span class="var">?v</span> <span class="main">*</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="free">r</span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?t</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> 15<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?g</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">t</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> prim_spanning_invariant_def spanning_tree_def inf_pp_commute<span class="main">)</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"component <span class="main">(</span><span class="var">?v</span> <span class="main">*</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="free">r</span> <span class="main">=</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?v</span> <span class="main">*</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?g</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?t</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 2 6 7 11 12 13 14 15 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> span_inv<span class="main">)</span>
          <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">.</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?t</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> prim_spanning_invariant_def spanning_tree_def regular_closed_sup minarc_regular<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">have</span></span> 16<span class="main">:</span> <span class="quoted"><span class="quoted">"top <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="var">?c</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"top <span class="main">*</span> <span class="var">?e</span> <span class="main">=</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 11 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> arc_top_edge mult_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 7 8 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_dist_comp conv_isotone mult_left_isotone symmetric_top_closed<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?g</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 5 mult_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">t</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?g</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 13 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?g</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?g</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 4 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_isotone mult_right_isotone star_isotone<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?c</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative mult_right_isotone star.right_plus_below_circ<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> 17<span class="main">:</span> <span class="quoted"><span class="quoted">"top <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 6 7 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> schroeder_4_p vTeT<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> 18<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> inf.orderE minarc_bot_iff conv_complement_sub_inf inf_p inf_top.left_neutral p_bot symmetric_top_closed vector_top_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> 19<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="main">-</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_comp conv_dist_sup<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> 20<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 18 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> psubset_card_mono<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> finite_regular <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">using</span></span> 1 16 17 19 20 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> prim_vc_3<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"prim_spanning_invariant <span class="free">t</span> <span class="free">v</span> <span class="free">g</span> <span class="free">r</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="main">-</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span> <span class="main">=</span> bot"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"spanning_tree <span class="free">t</span> <span class="free">g</span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="free">v</span> <span class="main">∧</span> regular <span class="main">(</span><span class="free">v</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> prim_spanning_invariant_def spanning_tree_def prim_precondition_def regular_conv_closed regular_closed_star regular_mult_closed conv_involutive<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="main">-</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?g</span> <span class="main">=</span> bot"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> pp_inf_bot_iff pp_pp_inf_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">t</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">∧</span> vector <span class="free">v</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> covector_mult_closed prim_invariant_def prim_spanning_invariant_def vector_conv_covector prim_precondition_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">≤</span> <span class="free">v</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> prim_spanning_invariant_def inf_pp_commute spanning_tree_def inf.boundedE<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?g</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">t</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> prim_spanning_invariant_def inf_pp_commute spanning_tree_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"component <span class="free">g</span> <span class="free">r</span> <span class="main">=</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 2 3 4 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> span_post<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"regular <span class="main">(</span><span class="free">v</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> prim_spanning_invariant_def spanning_tree_def prim_precondition_def regular_conv_closed regular_closed_star regular_mult_closed conv_involutive<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">≤</span> <span class="free">v</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?g</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> prim_spanning_invariant_def spanning_tree_def inf_pp_commute inf.boundedE<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"spanning_tree <span class="free">t</span> <span class="free">g</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">unfold</span> spanning_tree_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> prim_spanning_invariant_def spanning_tree_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> prim_spanning_invariant_def spanning_tree_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">using</span></span> 5 6 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> 5 prim_spanning_invariant_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> prim_spanning_invariant_def spanning_tree_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
The following result shows that Prim's algorithm terminates and constructs a spanning tree.
We cannot yet show that this is a minimum spanning tree.
›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> prim_spanning<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">VARS</span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">t</span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">v</span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">e</span></span></span></span></span></span></span></span></span></span></span></span></span></span>
  <span class="main">[</span> prim_precondition <span class="free">g</span> <span class="free">r</span> <span class="main">]</span>
  t <span class="main">:=</span> bot<span class="main">;</span>
  v <span class="main">:=</span> <span class="free">r</span><span class="main">;</span>
  <span class="keyword1">WHILE</span> <span class="bound">v</span> <span class="main">*</span> <span class="main">-</span><span class="bound">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span> <span class="main">≠</span> bot
    <span class="keyword1">INV</span> <span class="main">{</span> prim_spanning_invariant <span class="bound">t</span> <span class="bound">v</span> <span class="free">g</span> <span class="free">r</span> <span class="main">}</span>
    <span class="keyword1">VAR</span> <span class="main">{</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> component <span class="free">g</span> <span class="free">r</span> <span class="main">⊓</span> <span class="main">-</span><span class="bound">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span> <span class="main">}</span>
     <span class="keyword1">DO</span> e <span class="main">:=</span> minarc <span class="main">(</span><span class="bound">v</span> <span class="main">*</span> <span class="main">-</span><span class="bound">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">;</span>
        t <span class="main">:=</span> <span class="bound">t</span> <span class="main">⊔</span> <span class="bound">e</span><span class="main">;</span>
        v <span class="main">:=</span> <span class="bound">v</span> <span class="main">⊔</span> <span class="bound">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top
     <span class="keyword1">OD</span>
  <span class="main">[</span> spanning_tree <span class="bound">t</span> <span class="free">g</span> <span class="free">r</span> <span class="main">]</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">vcg_tc_simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> prim_vc_1<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> prim_vc_2 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">using</span></span> prim_vc_3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Because we have shown total correctness, we conclude that a spanning tree exists.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> prim_exists_spanning<span class="main">:</span>
  <span class="quoted"><span class="quoted">"prim_precondition <span class="free">g</span> <span class="free">r</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">t</span> <span class="main">.</span> spanning_tree <span class="bound">t</span> <span class="free">g</span> <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> tc_extract_function prim_spanning <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
This implies that a minimum spanning tree exists, which is used in the subsequent correctness proof.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> prim_exists_minimal_spanning<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"prim_precondition <span class="free">g</span> <span class="free">r</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">t</span> <span class="main">.</span> minimum_spanning_tree <span class="bound">t</span> <span class="free">g</span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?s</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="bound">t</span> <span class="main">.</span> spanning_tree <span class="bound">t</span> <span class="free">g</span> <span class="free">r</span> <span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">m</span><span class="main">∈</span><span class="var">?s</span> <span class="main">.</span> <span class="main">∀</span><span class="bound">z</span><span class="main">∈</span><span class="var">?s</span> <span class="main">.</span> sum <span class="main">(</span><span class="bound">m</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="bound">z</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> finite_set_minimal<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> finite_regular spanning_tree_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">using</span></span> assms prim_exists_spanning <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">using</span></span> sum_linear <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> minimum_spanning_tree_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Prim's minimum spanning tree algorithm terminates and is correct.
This is the same algorithm that is used in the previous correctness proof, with the same precondition and variant, but with a different invariant and postcondition.
›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> prim<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">VARS</span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">t</span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">v</span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">e</span></span></span></span></span></span></span></span></span></span></span></span></span></span>
  <span class="main">[</span> prim_precondition <span class="free">g</span> <span class="free">r</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">w</span> <span class="main">.</span> minimum_spanning_tree <span class="bound">w</span> <span class="free">g</span> <span class="free">r</span><span class="main">)</span> <span class="main">]</span>
  t <span class="main">:=</span> bot<span class="main">;</span>
  v <span class="main">:=</span> <span class="free">r</span><span class="main">;</span>
  <span class="keyword1">WHILE</span> <span class="bound">v</span> <span class="main">*</span> <span class="main">-</span><span class="bound">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span> <span class="main">≠</span> bot
    <span class="keyword1">INV</span> <span class="main">{</span> prim_invariant <span class="bound">t</span> <span class="bound">v</span> <span class="free">g</span> <span class="free">r</span> <span class="main">}</span>
    <span class="keyword1">VAR</span> <span class="main">{</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> component <span class="free">g</span> <span class="free">r</span> <span class="main">⊓</span> <span class="main">-</span><span class="bound">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span> <span class="main">}</span>
     <span class="keyword1">DO</span> e <span class="main">:=</span> minarc <span class="main">(</span><span class="bound">v</span> <span class="main">*</span> <span class="main">-</span><span class="bound">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">;</span>
        t <span class="main">:=</span> <span class="bound">t</span> <span class="main">⊔</span> <span class="bound">e</span><span class="main">;</span>
        v <span class="main">:=</span> <span class="bound">v</span> <span class="main">⊔</span> <span class="bound">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top
     <span class="keyword1">OD</span>
  <span class="main">[</span> minimum_spanning_tree <span class="bound">t</span> <span class="free">g</span> <span class="free">r</span> <span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">vcg_tc_simp</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"prim_precondition <span class="free">g</span> <span class="free">r</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">w</span> <span class="main">.</span> minimum_spanning_tree <span class="bound">w</span> <span class="free">g</span> <span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"prim_invariant bot <span class="free">r</span> <span class="free">g</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> prim_invariant_def prim_vc_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">t</span> <span class="skolem">v</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?vcv</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">*</span> <span class="main">-</span><span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?vv</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">*</span> <span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"minarc <span class="var">?vcv</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?t</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?v</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">⊔</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?c</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"component <span class="free">g</span> <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="var">?c</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="var">?c</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"prim_invariant <span class="skolem">t</span> <span class="skolem">v</span> <span class="free">g</span> <span class="free">r</span> <span class="main">∧</span> <span class="var">?vcv</span> <span class="main">≠</span> bot"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="skolem">v</span> <span class="main">∧</span> regular <span class="main">(</span><span class="skolem">v</span> <span class="main">*</span> <span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> hide_lams<span class="main"><span class="main">)</span></span> prim_invariant_def prim_spanning_invariant_def spanning_tree_def prim_precondition_def regular_conv_closed regular_closed_star regular_mult_closed conv_involutive<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">≤</span> <span class="skolem">v</span> <span class="main">*</span> <span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> hide_lams<span class="main"><span class="main">)</span></span> prim_invariant_def prim_spanning_invariant_def spanning_tree_def inf_pp_commute inf.boundedE<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">≤</span> <span class="skolem">v</span> <span class="main">*</span> <span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">≤</span> <span class="var">?g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="skolem">v</span> <span class="main">*</span> <span class="main">-</span><span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> minarc_below pp_dist_inf regular_mult_closed regular_closed_p<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="skolem">v</span> <span class="main">*</span> <span class="main">-</span><span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 8<span class="main">:</span> <span class="quoted"><span class="quoted">"vector <span class="skolem">v</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 prim_invariant_def prim_spanning_invariant_def prim_precondition_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> covector_mult_closed vector_conv_covector<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 9<span class="main">:</span> <span class="quoted"><span class="quoted">"arc <span class="var">?e</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 minarc_arc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">w</span></span> <span class="keyword2"><span class="keyword">where</span></span> 10<span class="main">:</span> <span class="quoted"><span class="quoted">"minimum_spanning_tree <span class="skolem">w</span> <span class="free">g</span> <span class="free">r</span> <span class="main">∧</span> <span class="skolem">t</span> <span class="main">≤</span> <span class="skolem">w</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> prim_invariant_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 11<span class="main">:</span> <span class="quoted"><span class="quoted">"vector <span class="free">r</span> <span class="main">∧</span> injective <span class="free">r</span> <span class="main">∧</span> <span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">t</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">∧</span> forest <span class="skolem">w</span> <span class="main">∧</span> <span class="skolem">t</span> <span class="main">≤</span> <span class="skolem">w</span> <span class="main">∧</span> <span class="skolem">w</span> <span class="main">≤</span> <span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?c</span> <span class="main">⊓</span> <span class="var">?g</span> <span class="main">∧</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?c</span> <span class="main">⊓</span> <span class="var">?g</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">w</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 2 prim_invariant_def prim_spanning_invariant_def prim_precondition_def minimum_spanning_tree_def spanning_tree_def reachable_restrict <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> 12<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">*</span> <span class="skolem">v</span> <span class="main">≤</span> <span class="skolem">v</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> predecessors_reachable reachable_restrict <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 13<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">=</span> <span class="free">g</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 prim_invariant_def prim_spanning_invariant_def prim_precondition_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> 14<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?g</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="var">?g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> conv_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"prim_invariant <span class="var">?t</span> <span class="var">?v</span> <span class="free">g</span> <span class="free">r</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> prim_invariant_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"prim_spanning_invariant <span class="var">?t</span> <span class="var">?v</span> <span class="free">g</span> <span class="free">r</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 prim_invariant_def prim_vc_2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">w</span> <span class="main">.</span> minimum_spanning_tree <span class="bound">w</span> <span class="free">g</span> <span class="free">r</span> <span class="main">∧</span> <span class="var">?t</span> <span class="main">≤</span> <span class="bound">w</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">⊓</span> <span class="skolem">v</span> <span class="main">*</span> <span class="main">-</span><span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?p</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">v</span> <span class="main">*</span> <span class="main">-</span><span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?fp</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?w</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?fp</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> 15<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="var">?f</span> <span class="main">∧</span> regular <span class="var">?fp</span> <span class="main">∧</span> regular <span class="var">?w</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 10 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> regular_conv_closed regular_closed_star regular_mult_closed regular_closed_top regular_closed_inf regular_closed_sup minarc_regular minimum_spanning_tree_def spanning_tree_def<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"minimum_spanning_tree <span class="var">?w</span> <span class="free">g</span> <span class="free">r</span> <span class="main">∧</span> <span class="var">?t</span> <span class="main">≤</span> <span class="var">?w</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> conjI<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"minimum_spanning_tree <span class="var">?w</span> <span class="free">g</span> <span class="free">r</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> minimum_spanning_tree_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"spanning_tree <span class="var">?w</span> <span class="free">g</span> <span class="free">r</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> spanning_tree_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="var">?w</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 7 8 9 11 exchange_injective <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="var">?w</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 7 8 11 12 exchange_acyclic <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?w</span> <span class="main">≤</span> <span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?c</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
            <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
              <span class="keyword1"><span class="command">have</span></span> 16<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?fp</span> <span class="main">≤</span> <span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?c</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 10 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_infI1 minimum_spanning_tree_def spanning_tree_def<span class="main">)</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_isotone inf.sup_monoid.add_assoc<span class="main">)</span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?c</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 11 conv_order <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?c</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 2 14 conv_dist_comp conv_dist_inf <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 17<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?c</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
                <span class="keyword1"><span class="command">.</span></span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?c</span> <span class="main">⊓</span> <span class="var">?g</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 5 6 11 mst_subgraph_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
                <span class="keyword1"><span class="command">using</span></span> 16 17 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?c</span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?w</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
            <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?c</span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">w</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 10 minimum_spanning_tree_def spanning_tree_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?w</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 4 7 8 10 11 12 15 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mst_reachable_inv<span class="main">)</span>
              <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
                <span class="keyword1"><span class="command">.</span></span>
            <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?w</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 15 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">have</span></span> 18<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">⊔</span> <span class="var">?p</span> <span class="main">=</span> <span class="var">?fp</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 2 8 epm_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"arc <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="skolem">v</span> <span class="main">*</span> <span class="main">-</span><span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 5 6 8 9 11 12 reachable_restrict arc_edge <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> 19<span class="main">:</span> <span class="quoted"><span class="quoted">"arc <span class="var">?f</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">=</span> bot <span class="main">⟶</span> top <span class="main">=</span> bot"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_left_zero mult_right_zero<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">≠</span> bot"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 1 le_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">⊓</span> <span class="skolem">v</span> <span class="main">*</span> <span class="main">-</span><span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?g</span> <span class="main">≠</span> bot"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 2 11 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.absorb1 le_infI1<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">⊓</span> <span class="main">(</span><span class="var">?f</span> <span class="main">⊓</span> <span class="skolem">v</span> <span class="main">*</span> <span class="main">-</span><span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">≠</span> bot"</span></span>
            <span class="keyword1"><span class="command">using</span></span> inf_commute pp_inf_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">hence</span></span> 20<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">⊓</span> <span class="var">?vcv</span> <span class="main">≠</span> bot"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf_assoc inf_commute<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> 21<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">⊓</span> <span class="free">g</span> <span class="main">=</span> <span class="var">?f</span> <span class="main">⊓</span> <span class="var">?vcv</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf_assoc inf_commute inf_left_commute<span class="main">)</span>
          <span class="keyword1"><span class="command">have</span></span> 22<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">⊓</span> <span class="free">g</span> <span class="main">=</span> minarc <span class="var">?vcv</span> <span class="main">⊓</span> <span class="var">?vcv</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 7 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.absorb2 inf.assoc inf.commute<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> 23<span class="main">:</span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?e</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="var">?f</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 15 19 20 21 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> minarc_min<span class="main">)</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≠</span> bot"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 20 comp_inf.semiring.mult_not_zero semiring.mult_not_zero <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">hence</span></span> 24<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">⊓</span> <span class="free">g</span> <span class="main">≠</span> bot"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 22 minarc_meet_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?fp</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="var">?p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="var">?e</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 7 8 10 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> sum_disjoint_3 epm_8 epm_9 epm_10 minimum_spanning_tree_def spanning_tree_def<span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?fp</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="var">?e</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 11 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> epm_8 sum_disjoint<span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> sum <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?fp</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="var">?f</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 23 24 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sum_plus_right_isotone<span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?fp</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="var">?p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="var">?f</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 11 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> epm_8 sum_disjoint<span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?fp</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="var">?p</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="var">?f</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 13 sum_symmetric <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?fp</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?p</span> <span class="main">⊔</span> <span class="var">?f</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 2 8 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> sum_disjoint_3 epm_11 epm_12 epm_13<span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 2 8 15 18 epm_2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
          <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">.</span></span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">u</span> <span class="main">.</span> spanning_tree <span class="bound">u</span> <span class="free">g</span> <span class="free">r</span> <span class="main">⟶</span> sum <span class="main">(</span><span class="var">?w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="bound">u</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 10 order_lesseq_imp minimum_spanning_tree_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?t</span> <span class="main">≤</span> <span class="var">?w</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 4 8 10 mst_extends_new_tree <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 prim_invariant_def prim_vc_2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">t</span> <span class="skolem">v</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 25<span class="main">:</span> <span class="quoted"><span class="quoted">"prim_invariant <span class="skolem">t</span> <span class="skolem">v</span> <span class="free">g</span> <span class="free">r</span> <span class="main">∧</span> <span class="skolem">v</span> <span class="main">*</span> <span class="main">-</span><span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span> <span class="main">=</span> bot"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> 26<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="skolem">v</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> prim_invariant_def prim_spanning_invariant_def spanning_tree_def prim_precondition_def regular_conv_closed regular_closed_star regular_mult_closed conv_involutive<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> 25 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">w</span></span> <span class="keyword2"><span class="keyword">where</span></span> 27<span class="main">:</span> <span class="quoted"><span class="quoted">"minimum_spanning_tree <span class="skolem">w</span> <span class="free">g</span> <span class="free">r</span> <span class="main">∧</span> <span class="skolem">t</span> <span class="main">≤</span> <span class="skolem">w</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> prim_invariant_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"spanning_tree <span class="skolem">t</span> <span class="free">g</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 25 prim_invariant_def prim_vc_3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"component <span class="free">g</span> <span class="free">r</span> <span class="main">=</span> <span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> 25 prim_invariant_def span_tree_component prim_spanning_invariant_def spanning_tree_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 28<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">≤</span> <span class="skolem">v</span> <span class="main">*</span> <span class="skolem">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 26 27 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> minimum_spanning_tree_def spanning_tree_def inf_pp_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"vector <span class="free">r</span> <span class="main">∧</span> injective <span class="free">r</span> <span class="main">∧</span> forest <span class="skolem">w</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 25 27 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> prim_invariant_def prim_spanning_invariant_def prim_precondition_def minimum_spanning_tree_def spanning_tree_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">=</span> <span class="skolem">t</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 25 27 28 prim_invariant_def prim_spanning_invariant_def mst_post <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"minimum_spanning_tree <span class="skolem">t</span> <span class="free">g</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 27 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

</pre>
</div><div id="Boruvka">
<div class="head">
<h1>Theory Boruvka</h1>
</div>
<pre class="source"><span class="comment1">(* Title:      Borůvka's Minimum Spanning Tree Algorithm
   Author:     Nicolas Robinson-O'Brien
   Maintainer: Walter Guttmann &lt;walter.guttmann at canterbury.ac.nz&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Bor\r{u}vka's Minimum Spanning Tree Algorithm›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
In this theory we prove partial correctness of Bor\r{u}vka's minimum spanning tree algorithm.
›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Boruvka

<span class="keyword2"><span class="keyword">imports</span></span>
  <a href="../Relational_Disjoint_Set_Forests/Disjoint_Set_Forests.html">Relational_Disjoint_Set_Forests.Disjoint_Set_Forests</a>
  <a href="Kruskal.html">Kruskal</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹General results›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
The proof is carried out in $m$-$k$-Stone-Kleene relation algebras.
In this section we give results that hold more generally.
›</span></span>

<span class="keyword1"><span class="command">context</span></span> stone_kleene_relation_algebra
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">big_forest</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="free"><span class="bound"><span class="entity">d</span></span></span> <span class="main">≡</span>
    equivalence <span class="free"><span class="bound"><span class="entity">H</span></span></span>
  <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span> <span class="main">≤</span> <span class="main">-</span><span class="free"><span class="bound"><span class="entity">H</span></span></span>
  <span class="main">∧</span> univalent <span class="main">(</span><span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span><span class="main">)</span>
  <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">⊓</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>
  <span class="main">∧</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">bf_between_points</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="free"><span class="bound"><span class="entity">d</span></span></span> <span class="main">≡</span> point <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">∧</span> point <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">≤</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">bf_between_arcs</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="free"><span class="bound"><span class="entity">b</span></span></span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="free"><span class="bound"><span class="entity">d</span></span></span> <span class="main">≡</span> arc <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">∧</span> arc <span class="free"><span class="bound"><span class="entity">b</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">b</span></span></span> <span class="main">*</span> top"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 3›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> He_eq_He_THe_star<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"arc <span class="free">e</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"equivalence <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> <span class="main">(</span>top <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="free">e</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">≤</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> <span class="main">(</span>top <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> comp_isotone star.circ_reflexive <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> <span class="main">(</span>top <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> <span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> preorder_idempotent surjective_var<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">⊔</span> top <span class="main">*</span> <span class="main">(</span><span class="free">e</span> <span class="main">*</span> top<span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eq_refl star.circ_mult_1<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">⊔</span> top <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star.circ_left_top<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">⊔</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult.semigroup_axioms semiring.distrib_left semigroup.assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> <span class="main">(</span>top <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms arc_top_arc mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> path_through_components<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"equivalence <span class="free">H</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"arc <span class="free">e</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">e</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">≤</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_isotone<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> preorder_idempotent surjective_var mult_assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> arc_top_arc mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">≤</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">e</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">⊔</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_left_dist_sup<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 star_separate_3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> simplify_f<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">p</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">e</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span> <span class="main">=</span> <span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span> <span class="main">⊔</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span>
    <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span> <span class="main">⊓</span> <span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_complement conv_dist_inf<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span>
      <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">p</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
    <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
    <span class="main">⊔</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> sup_inf_distrib2 sup_assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span>
      <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊔</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">f</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">p</span> <span class="main">⊔</span> <span class="free">f</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">p</span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">p</span> <span class="main">⊔</span> <span class="free">p</span><span class="main">)</span><span class="main">)</span>
    <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">e</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">e</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">e</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span>
    <span class="main">⊔</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> sup_inf_distrib1 sup_assoc inf_assoc sup_inf_distrib1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span>
      <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊔</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">f</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">p</span> <span class="main">⊔</span> <span class="free">p</span><span class="main">)</span><span class="main">)</span>
    <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">e</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">e</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span> <span class="main">⊔</span> <span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span>
    <span class="main">⊔</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> abel_semigroup.commute inf.abel_semigroup_axioms inf.left_commute sup.abel_semigroup_axioms<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">p</span> <span class="main">⊔</span> <span class="free">p</span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> inf.sup_monoid.add_assoc inf.sup_monoid.add_commute inf_sup_absorb sup.idem<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="main">)</span> <span class="main">⊔</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> conv_complement inf_top_right stone<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊔</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="free">e</span> <span class="main">⊔</span> <span class="free">e</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> sup.left_commute sup_assoc sup_inf_distrib2<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> abel_semigroup.commute assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> conv_complement inf_top_right stone sup.abel_semigroup_axioms sup_assoc<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> simplify_forest_components_f<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">p</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">e</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"injective <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"injective <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span> <span class="main">⊔</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span><span class="main">)</span> <span class="main">=</span> wcc <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> forest_components_wcc<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊔</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> conv_dist_sup sup_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> sup_assoc sup_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span> <span class="main">⊔</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 2<span class="main">,</span> 3<span class="main">,</span> 4<span class="main">)</span> simplify_f <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> components_disj_increasing<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">p</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">e</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"injective <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"injective <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="free">f</span> <span class="main">≤</span> forest_components <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"forest_components <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">p</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span> <span class="main">⊔</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> simplify_forest_components_f assms<span class="main">(</span>1<span class="main">,</span> 2<span class="main">,</span> 3<span class="main">,</span> 4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="free">f</span> <span class="main">=</span> wcc <span class="free">f</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> forest_components_wcc<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">e</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_supI2 star_isotone sup_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 sup.left_commute sup_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> fch_equivalence<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">h</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"equivalence <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms forest_components_equivalence<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> big_forest_path_split_1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"arc <span class="free">a</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"equivalence <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?H</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">H</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">a</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?a</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?d</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="free">d</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?d</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span> <span class="main">≤</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span><span class="var">?y</span> <span class="main">*</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span> <span class="main">≤</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span> <span class="main">*</span> <span class="var">?a</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> mult_left_isotone star.circ_right_top top_right_mult_increasing mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ex231e mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span><span class="var">?y</span> <span class="main">*</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span> <span class="main">≤</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?d</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span> <span class="main">=</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="free">a</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> 12<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="free">a</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> arc_regular <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="free">a</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top<span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 12 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf_top_right maddux_3_11_pp<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> mult_left_dist_sup <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?y</span> <span class="main">⊔</span> <span class="var">?x</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_inf.coreflexive_idempotent comp_isotone inf.cobounded1 inf.sup_monoid.add_commute semiring.add_mono star_isotone top.extremum<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?x</span> <span class="main">⊔</span> <span class="var">?y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sup_commute mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?y</span> <span class="main">*</span> <span class="main">(</span><span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> <span class="var">?a</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> mult_right_dist_sup star.circ_sup_9 star.circ_unfold_sum mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?y</span> <span class="main">*</span> <span class="main">(</span>top <span class="main">*</span> <span class="var">?y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> <span class="var">?a</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">(</span>top <span class="main">*</span> <span class="var">?y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_isotone star_isotone<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_inf.coreflexive_idempotent comp_inf.transitive_star eq_refl mult_left_dist_sup top.extremum mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?y</span> <span class="main">*</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> <span class="var">?a</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 2<span class="main">)</span> He_eq_He_THe_star arc_regular mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 13<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span> <span class="main">≤</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span> <span class="main">⊔</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?y</span> <span class="main">*</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> 14<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?y</span> <span class="main">*</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span> <span class="main">≤</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 11 mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> 13 14 sup.absorb1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?d</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?a</span> <span class="main">≥</span> <span class="var">?x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span><span class="var">?a</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_isotone star_isotone<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 2 antisym mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> dTransHd_le_1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"equivalence <span class="free">H</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"univalent <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> conv_dist_comp mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> preorder_idempotent<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> HcompaT_le_compHaT<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"equivalence <span class="free">H</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"injective <span class="main">(</span><span class="free">a</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">-</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> conv_dist_comp symmetric_top_closed vector_top_closed mult_assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">≤</span> <span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> comp_isotone order_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">*</span> top <span class="main">*</span> top <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">≤</span> <span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vector_mult_closed<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> conv_dist_comp symmetric_top_closed vector_top_closed mult_assoc<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> comp_injective_below_complement mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 4›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> expand_big_forest<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"big_forest <span class="free">H</span> <span class="free">d</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms big_forest_def mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms big_forest_def conv_dist_comp <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cancel_separate_eq comp_associative<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> big_forest_path_bot<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"arc <span class="free">a</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≤</span> <span class="free">d</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"big_forest <span class="free">H</span> <span class="free">d</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">≤</span> bot"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> big_forest_def dTransHd_le_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> <span class="main">-</span> <span class="main">1</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> triple_schroeder_p <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> <span class="main">-</span> <span class="main">1</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_supI2<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">d</span> <span class="main">*</span> <span class="main">-</span> <span class="main">1</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> big_forest_def inf_commute regular_one_closed shunting_p le_supI<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> <span class="main">1</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">d</span> <span class="main">*</span> <span class="main">-</span> <span class="main">1</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">⊔</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> comp_associative mult_right_dist_sup <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_dist_sup<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> regular_complement_top <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> conv_isotone dual_order.trans mult_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative conv_dist_comp<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">≤</span> <span class="main">(</span><span class="main">1</span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">H</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> shunt_bijective<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">⊔</span> <span class="main">-</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative mult_right_dist_sup<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">⊔</span> <span class="main">-</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 3<span class="main">)</span> HcompaT_le_compHaT big_forest_def sup_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">⊔</span> <span class="main">-</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">using</span></span> shunting_var_p <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">≤</span> <span class="free">a</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">using</span></span> inf.sup_right_isotone order.trans pp_increasing <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">≤</span> top <span class="main">*</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>top <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dedekind inf_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">d</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">d</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_comp inf_vector_comp mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">d</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">d</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> mult_right_isotone mult_left_isotone conv_isotone inf.sup_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">d</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> big_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">d</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.sup_right_isotone mult_right_isotone mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> top <span class="main">*</span> <span class="free">a</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_isotone<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">≤</span> top <span class="main">*</span> <span class="free">a</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">≤</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 2 3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">*</span> top <span class="main">*</span> <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative comp_inf.star.circ_decompose_9 comp_inf.star_star_absorb comp_inf_covector vector_inf_comp vector_top_closed<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vector_mult_closed<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">≤</span> <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> arc_top_arc<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span> <span class="main">≤</span> <span class="main">-</span><span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> arc_regular p_shunting_swap <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">-</span><span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> mult.semigroup_axioms p_antitone_iff schroeder_4_p semigroup.assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> schroeder_3_p<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> big_forest_path_split_2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"arc <span class="free">a</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≤</span> <span class="free">d</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"big_forest <span class="free">H</span> <span class="free">d</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?lhs</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> big_forest_def dTransHd_le_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">≤</span> <span class="var">?lhs</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> le_iff_sup star.circ_loop_fixpoint star.circ_transitive_equal star_involutive sup_commute mult_assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">⊔</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star_left_unfold_equal<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">⊔</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> mult_left_dist_sup star.circ_loop_fixpoint star.circ_mult_1 star_slide sup_commute mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> bot <span class="main">⊔</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span> 2<span class="main"><span class="main">,</span></span> 3<span class="main"><span class="main">)</span></span> big_forest_path_bot mult_assoc le_bot<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> calculation<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> conv_isotone inf.cobounded1 mult_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">1</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> le_iff_sup mult_right_dist_sup<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">≤</span> <span class="var">?lhs</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">≤</span> <span class="var">?lhs</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">≤</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 3 mult_right_isotone mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> big_forest_def star_slide mult_assoc preorder_idempotent<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> big_forest_def preorder_idempotent <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> big_forest_def preorder_idempotent star_slide mult_assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">⊔</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">≤</span> <span class="var">?lhs</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> 51<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> star.left_plus_below_circ mult_left_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> 52<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">⊔</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">⊔</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> mult_right_dist_sup <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">⊔</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> star.left_plus_below_circ mult_left_isotone sup_left_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> 4 51 52 mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">⊔</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">≤</span> <span class="var">?lhs</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">⊔</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">≤</span> <span class="var">?lhs</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 5 star_left_induct_mult_iff mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> star.circ_decompose_11 star_decompose_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">hence</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">≤</span> <span class="var">?lhs</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> mult_left_dist_sup <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_isotone semiring.distrib_left star_isotone<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> 6 7 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_assoc<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹An operation to select components›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
We introduce the operation <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>choose_component›</span></span></span></span>.
\begin{itemize}
\item Axiom <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>component_in_v›</span></span></span></span> expresses that the result of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>choose_component›</span></span></span></span> is contained in the set of vertices, $v$, we are selecting from, ignoring the weights.
\item Axiom <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>component_is_vector›</span></span></span></span> states that the result of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>choose_component›</span></span></span></span> is a vector.
\item Axiom <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>component_is_regular›</span></span></span></span> states that the result of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>choose_component›</span></span></span></span> is regular.
\item Axiom <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>component_is_connected›</span></span></span></span> states that any two vertices from the result of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>choose_component›</span></span></span></span> are connected in $e$.
\item Axiom <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>component_single›</span></span></span></span> states that the result of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>choose_component›</span></span></span></span> is closed under being connected in $e$.
\item Finally, axiom <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>component_not_bot_when_v_bot_bot›</span></span></span></span> expresses that the operation <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>choose_component›</span></span></span></span> returns a non-empty component if the input satisfies the given criteria.
\end{itemize}
›</span></span>

<span class="keyword1"><span class="command">class</span></span> choose_component <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free"><span class="free"><span class="free">choose_component</span></span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span>"</span></span>

<span class="keyword1"><span class="command">class</span></span> choose_component_algebra <span class="main">=</span> choose_component <span class="main">+</span> stone_relation_algebra <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> component_in_v<span class="main">:</span> <span class="quoted"><span class="quoted">"choose_component <span class="free">e</span> <span class="free">v</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">v</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> component_is_vector<span class="main">:</span> <span class="quoted"><span class="quoted">"vector <span class="main">(</span>choose_component <span class="free">e</span> <span class="free">v</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> component_is_regular<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="main">(</span>choose_component <span class="free">e</span> <span class="free">v</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> component_is_connected<span class="main">:</span> <span class="quoted"><span class="quoted">"choose_component <span class="free">e</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span>choose_component <span class="free">e</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">e</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> component_single<span class="main">:</span> <span class="quoted"><span class="quoted">"choose_component <span class="free">e</span> <span class="free">v</span> <span class="main">=</span> <span class="free">e</span> <span class="main">*</span> choose_component <span class="free">e</span> <span class="free">v</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> component_not_bot_when_v_bot_bot<span class="main">:</span> <span class="quoted"><span class="quoted">"
      regular <span class="free">e</span>
    <span class="main">∧</span> equivalence <span class="free">e</span>
    <span class="main">∧</span> vector <span class="free">v</span>
    <span class="main">∧</span> regular <span class="free">v</span>
    <span class="main">∧</span> <span class="free">e</span> <span class="main">*</span> <span class="free">v</span> <span class="main">=</span> <span class="free">v</span>
    <span class="main">∧</span> <span class="free">v</span> <span class="main">≠</span> bot <span class="main">⟶</span> choose_component <span class="free">e</span> <span class="free">v</span> <span class="main">≠</span> bot"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 1›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Every <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>m_kleene_algebra›</span></span></span></span> is an instance of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>choose_component_algebra›</span></span></span></span> when the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>choose_component›</span></span></span></span> operation is defined as follows:
›</span></span>

<span class="keyword1"><span class="command">context</span></span> m_kleene_algebra
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">choose_component_input_condition</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">v</span></span></span> <span class="main">≡</span>
    regular <span class="free"><span class="bound"><span class="entity">e</span></span></span>
  <span class="main">∧</span> equivalence <span class="free"><span class="bound"><span class="entity">e</span></span></span>
  <span class="main">∧</span> vector <span class="free"><span class="bound"><span class="entity">v</span></span></span>
  <span class="main">∧</span> regular <span class="free"><span class="bound"><span class="entity">v</span></span></span>
  <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">v</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">v</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">m_choose_component</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">v</span></span></span> <span class="main">≡</span>
  <span class="keyword1">if</span> choose_component_input_condition <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="free"><span class="bound"><span class="entity">v</span></span></span> <span class="keyword1">then</span>
    <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">*</span> minarc<span class="main">(</span><span class="free"><span class="bound"><span class="entity">v</span></span></span><span class="main">)</span> <span class="main">*</span> top
  <span class="keyword1">else</span>
    bot"</span></span>

<span class="keyword1"><span class="command">sublocale</span></span> m_choose_component_algebra<span class="main">:</span> choose_component_algebra <span class="keyword2"><span class="keyword">where</span></span> choose_component <span class="main">=</span> <span class="quoted">m_choose_component</span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">e</span> <span class="skolem">v</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"m_choose_component <span class="skolem">e</span> <span class="skolem">v</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span> <span class="skolem">v</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"choose_component_input_condition <span class="skolem">e</span> <span class="skolem">v</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"m_choose_component <span class="skolem">e</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">e</span> <span class="main">*</span> minarc<span class="main">(</span><span class="skolem">v</span><span class="main">)</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> m_choose_component_def<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">e</span> <span class="main">*</span> <span class="main">-</span><span class="main">-</span><span class="skolem">v</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_isotone minarc_below<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">e</span> <span class="main">*</span> <span class="skolem">v</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> True choose_component_input_condition_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">v</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> True choose_component_input_condition_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> True choose_component_input_condition_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"m_choose_component <span class="skolem">e</span> <span class="skolem">v</span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> False m_choose_component_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">e</span> <span class="skolem">v</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"vector <span class="main">(</span>m_choose_component <span class="skolem">e</span> <span class="skolem">v</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"choose_component_input_condition <span class="skolem">e</span> <span class="skolem">v</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_assoc m_choose_component_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> m_choose_component_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">e</span> <span class="skolem">v</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="main">(</span>m_choose_component <span class="skolem">e</span> <span class="skolem">v</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> choose_component_input_condition_def minarc_regular regular_closed_star regular_mult_closed m_choose_component_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">e</span> <span class="skolem">v</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"m_choose_component <span class="skolem">e</span> <span class="skolem">v</span> <span class="main">*</span> <span class="main">(</span>m_choose_component <span class="skolem">e</span> <span class="skolem">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="skolem">e</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"choose_component_input_condition <span class="skolem">e</span> <span class="skolem">v</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"choose_component_input_condition <span class="skolem">e</span> <span class="skolem">v</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"m_choose_component <span class="skolem">e</span> <span class="skolem">v</span> <span class="main">*</span> <span class="main">(</span>m_choose_component <span class="skolem">e</span> <span class="skolem">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="skolem">e</span> <span class="main">*</span> minarc<span class="main">(</span><span class="skolem">v</span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="skolem">e</span> <span class="main">*</span> minarc<span class="main">(</span><span class="skolem">v</span><span class="main">)</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> m_choose_component_def<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">e</span> <span class="main">*</span> minarc<span class="main">(</span><span class="skolem">v</span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> minarc<span class="main">(</span><span class="skolem">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative conv_dist_comp<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">e</span> <span class="main">*</span> minarc<span class="main">(</span><span class="skolem">v</span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> top <span class="main">*</span> minarc<span class="main">(</span><span class="skolem">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">e</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 choose_component_input_condition_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">e</span> <span class="main">*</span> minarc<span class="main">(</span><span class="skolem">v</span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> minarc<span class="main">(</span><span class="skolem">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">e</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">e</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">=</span> bot"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> True
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> True minarc_bot<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> False
      <span class="keyword3"><span class="command">assume</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">≠</span> bot"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">e</span> <span class="main">*</span> minarc<span class="main">(</span><span class="skolem">v</span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> minarc<span class="main">(</span><span class="skolem">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="skolem">e</span> <span class="main">*</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 3 minarc_arc arc_expanded comp_associative mult_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">e</span> <span class="main">*</span> minarc<span class="main">(</span><span class="skolem">v</span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> minarc<span class="main">(</span><span class="skolem">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">e</span> <span class="main">≤</span> <span class="skolem">e</span> <span class="main">*</span> <span class="main">1</span> <span class="main">*</span> <span class="skolem">e</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> mult_left_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">e</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 choose_component_input_condition_def preorder_idempotent <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> calculation <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> calculation<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> m_choose_component_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">e</span> <span class="skolem">v</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"m_choose_component <span class="skolem">e</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">e</span> <span class="main">*</span> m_choose_component <span class="skolem">e</span> <span class="skolem">v</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"choose_component_input_condition <span class="skolem">e</span> <span class="skolem">v</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> choose_component_input_condition_def preorder_idempotent m_choose_component_def mult_assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> m_choose_component_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">e</span> <span class="skolem">v</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="skolem">e</span> <span class="main">∧</span> equivalence <span class="skolem">e</span> <span class="main">∧</span> vector <span class="skolem">v</span> <span class="main">∧</span> regular <span class="skolem">v</span> <span class="main">∧</span> <span class="skolem">e</span> <span class="main">*</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">v</span> <span class="main">∧</span> <span class="skolem">v</span> <span class="main">≠</span> bot <span class="main">⟶</span> m_choose_component <span class="skolem">e</span> <span class="skolem">v</span> <span class="main">≠</span> bot"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"choose_component_input_condition <span class="skolem">e</span> <span class="skolem">v</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"m_choose_component <span class="skolem">e</span> <span class="skolem">v</span> <span class="main">≥</span> minarc<span class="main">(</span><span class="skolem">v</span><span class="main">)</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> choose_component_input_condition_def mult_1_left mult_left_isotone m_choose_component_def<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≥</span> minarc<span class="main">(</span><span class="skolem">v</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> calculation dual_order.trans top_right_mult_increasing <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> True bot_unique minarc_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> choose_component_input_condition_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹m-k-Stone-Kleene relation algebras›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
$m$-$k$-Stone-Kleene relation algebras are an extension of $m$-Kleene algebras where the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>choose_component›</span></span></span></span> operation has been added.
›</span></span>

<span class="keyword1"><span class="command">class</span></span> m_kleene_algebra_choose_component <span class="main">=</span>
  m_kleene_algebra
  <span class="main">+</span> choose_component_algebra
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
A <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>selected_edge›</span></span></span></span> is a minimum-weight edge whose source is in a component, with respect to $h$, $j$ and $g$, and whose target is not in that component.
›</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">selected_edge</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="free"><span class="bound"><span class="entity">j</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">≡</span> minarc <span class="main">(</span>choose_component <span class="main">(</span>forest_components <span class="free"><span class="bound"><span class="entity">h</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">j</span></span></span> <span class="main">*</span> <span class="main">-</span> choose_component <span class="main">(</span>forest_components <span class="free"><span class="bound"><span class="entity">h</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">j</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
A <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>path›</span></span></span></span> is any sequence of edges in the forest, $f$, of the graph, $g$, backwards from the target of the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>selected_edge›</span></span></span></span> to a root in $f$.
›</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">path</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="free"><span class="bound"><span class="entity">j</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">≡</span> top <span class="main">*</span> selected_edge <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="free"><span class="bound"><span class="entity">j</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">*</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">⊓</span> <span class="main">-</span> selected_edge <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="free"><span class="bound"><span class="entity">j</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">boruvka_outer_invariant</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">≡</span>
    symmetric <span class="free"><span class="bound"><span class="entity">g</span></span></span>
  <span class="main">∧</span> forest <span class="free"><span class="bound"><span class="entity">f</span></span></span>
  <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free"><span class="bound"><span class="entity">g</span></span></span>
  <span class="main">∧</span> regular <span class="free"><span class="bound"><span class="entity">f</span></span></span>
  <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">w</span> <span class="main">.</span> minimum_spanning_forest <span class="bound">w</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">≤</span> <span class="bound">w</span> <span class="main">⊔</span> <span class="bound">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">boruvka_inner_invariant</span> <span class="free"><span class="bound"><span class="entity">j</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">d</span></span></span> <span class="main">≡</span>
    boruvka_outer_invariant <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span>
  <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">≠</span> bot
  <span class="main">∧</span> vector <span class="free"><span class="bound"><span class="entity">j</span></span></span>
  <span class="main">∧</span> regular <span class="free"><span class="bound"><span class="entity">j</span></span></span>
  <span class="main">∧</span> boruvka_outer_invariant <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span>
  <span class="main">∧</span> forest <span class="free"><span class="bound"><span class="entity">h</span></span></span>
  <span class="main">∧</span> forest_components <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">≤</span> forest_components <span class="free"><span class="bound"><span class="entity">f</span></span></span>
  <span class="main">∧</span> big_forest <span class="main">(</span>forest_components <span class="free"><span class="bound"><span class="entity">h</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span>
  <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">-</span> <span class="free"><span class="bound"><span class="entity">j</span></span></span>
  <span class="main">∧</span> forest_components <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">j</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">j</span></span></span>
  <span class="main">∧</span> forest_components <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">=</span> <span class="main">(</span>forest_components <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">*</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">d</span></span></span> <span class="main">⊔</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> forest_components <span class="free"><span class="bound"><span class="entity">h</span></span></span>
  <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">⊔</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">⊔</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span> <span class="main">⊔</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>
  <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">a</span> <span class="bound">b</span> <span class="main">.</span> bf_between_arcs <span class="bound">a</span> <span class="bound">b</span> <span class="main">(</span>forest_components <span class="free"><span class="bound"><span class="entity">h</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span> <span class="main">∧</span> <span class="bound">a</span> <span class="main">≤</span> <span class="main">-</span><span class="main">(</span>forest_components <span class="free"><span class="bound"><span class="entity">h</span></span></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∧</span> <span class="bound">b</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span>
    <span class="main">⟶</span> sum<span class="main">(</span><span class="bound">b</span> <span class="main">⊓</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span> <span class="main">≤</span> sum<span class="main">(</span><span class="bound">a</span> <span class="main">⊓</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span><span class="main">)</span>
  <span class="main">∧</span> regular <span class="free"><span class="bound"><span class="entity">d</span></span></span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> expression_equivalent_without_e_complement<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">≤</span> <span class="main">-</span> forest_components <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="main">(</span>selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="main">(</span>path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="main">(</span>selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span>path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span>selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span>
         <span class="main">=</span> <span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="main">(</span>path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">(</span>path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span>selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?p</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?F</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?F</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_dist_comp conv_involutive conv_order conv_star_commute forest_components_increasing<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="var">?F</span> <span class="main">≤</span> <span class="main">-</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> p_antitone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 dual_order.trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?e</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> p_antitone_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_complement conv_dist_inf inf.orderE inf.orderI<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> <span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> inf.orderE <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?p</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span> <span class="main">=</span> <span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?p</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="var">?p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 2›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
The source of the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>selected_edge›</span></span></span></span> is contained in $j$, the vector describing those vertices still to be processed in the inner loop of Bor\r{u}vka's algorithm.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> et_below_j<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"vector <span class="free">j</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">j</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">≠</span> bot"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">*</span> top <span class="main">≤</span> <span class="free">j</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?c</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"choose_component <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">j</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="var">?c</span> <span class="main">*</span> <span class="main">-</span><span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">using</span></span> comp_isotone minarc_below <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="var">?c</span> <span class="main">*</span> <span class="main">-</span><span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span><span class="main">)</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?c</span> <span class="main">*</span> <span class="main">-</span><span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span><span class="main">)</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">using</span></span> component_is_regular regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?c</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span><span class="main">)</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> component_is_vector conv_complement vector_complement_closed vector_covector<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?c</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">using</span></span> inf.cobounded1 mult_left_isotone order_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">j</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> comp_inf.star.circ_sup_2 comp_isotone component_in_v<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">j</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‹Components of forests and big forests›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
We prove a number of properties about <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>big_forest›</span></span></span></span> and <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>forest_components›</span></span></span></span>.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> fc_j_eq_j_inv<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">h</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span> <span class="main">*</span> <span class="free">j</span> <span class="main">=</span> <span class="free">j</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span> <span class="main">*</span> <span class="main">(</span><span class="free">j</span> <span class="main">⊓</span> <span class="main">-</span> choose_component <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">j</span><span class="main">)</span> <span class="main">=</span> <span class="free">j</span> <span class="main">⊓</span> <span class="main">-</span> choose_component <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">j</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?c</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"choose_component <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">j</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?H</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span><span class="quoted"><span class="quoted">"equivalence <span class="var">?H</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> forest_components_equivalence<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">j</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?c</span><span class="main">)</span> <span class="main">=</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">j</span> <span class="main">⊓</span> <span class="var">?H</span> <span class="main">*</span> <span class="main">-</span> <span class="var">?c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> equivalence_comp_dist_inf inf.sup_monoid.add_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">j</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?c</span><span class="main">)</span> <span class="main">=</span> <span class="free">j</span> <span class="main">⊓</span> <span class="var">?H</span> <span class="main">*</span> <span class="main">-</span> <span class="var">?c</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?c</span> <span class="main">≤</span> <span class="var">?H</span> <span class="main">*</span> <span class="main">-</span> <span class="var">?c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> dedekind_1 dual_order.trans equivalence_comp_dist_inf inf.cobounded2<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="var">?c</span> <span class="main">≤</span> <span class="var">?c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> component_single <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?c</span> <span class="main">≤</span> <span class="var">?c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="main">-</span> <span class="var">?c</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> component_is_regular schroeder_3_p <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">⊓</span> <span class="var">?H</span> <span class="main">*</span> <span class="main">-</span> <span class="var">?c</span> <span class="main">≤</span> <span class="free">j</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> inf.sup_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> 2 3 antisym <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 5›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
There is a path in the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>big_forest›</span></span></span></span> between edges $a$ and $b$ if and only if there is either a path in the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>big_forest›</span></span></span></span> from $a$ to $b$ or one from $a$ to $c$ and one from $c$ to $b$.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> big_forest_path_split_disj<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"equivalence <span class="free">H</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"arc <span class="free">c</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">a</span> <span class="main">∧</span> regular <span class="free">b</span> <span class="main">∧</span> regular <span class="free">c</span> <span class="main">∧</span> regular <span class="free">d</span> <span class="main">∧</span> regular <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="free">b</span> <span class="free">H</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">c</span><span class="main">)</span> <span class="main">⟷</span> bf_between_arcs <span class="free">a</span> <span class="free">b</span> <span class="free">H</span> <span class="free">d</span> <span class="main">∨</span> <span class="main">(</span>bf_between_arcs <span class="free">a</span> <span class="free">c</span> <span class="free">H</span> <span class="free">d</span> <span class="main">∧</span> bf_between_arcs <span class="free">c</span> <span class="free">b</span> <span class="free">H</span> <span class="free">d</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="free">b</span> <span class="free">H</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">c</span><span class="main">)</span> <span class="main">⟶</span> bf_between_arcs <span class="free">a</span> <span class="free">b</span> <span class="free">H</span> <span class="free">d</span> <span class="main">∨</span> <span class="main">(</span>bf_between_arcs <span class="free">a</span> <span class="free">c</span> <span class="free">H</span> <span class="free">d</span> <span class="main">∧</span> bf_between_arcs <span class="free">c</span> <span class="free">b</span> <span class="free">H</span> <span class="free">d</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> 11<span class="main">:</span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="free">b</span> <span class="free">H</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">c</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">c</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bf_between_arcs_def<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">c</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 2<span class="main">)</span> path_through_components <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top <span class="main">⊔</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">c</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_right_dist_sup<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 12<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top <span class="main">⊔</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">c</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> 13<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top <span class="main">∨</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">c</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> point_in_vector_sup<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"point <span class="main">(</span><span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 11 bf_between_arcs_def mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"vector <span class="main">(</span><span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> vector_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="main">(</span><span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> pp_dist_comp pp_dist_star <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top <span class="main">⊔</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">c</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 12 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="free">b</span> <span class="free">H</span> <span class="free">d</span> <span class="main">∨</span> <span class="main">(</span>bf_between_arcs <span class="free">a</span> <span class="free">c</span> <span class="free">H</span> <span class="free">d</span> <span class="main">∧</span> bf_between_arcs <span class="free">c</span> <span class="free">b</span> <span class="free">H</span> <span class="free">d</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> True
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="free">b</span> <span class="free">H</span> <span class="free">d</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 11 bf_between_arcs_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> False
      <span class="keyword1"><span class="command">have</span></span> 14<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">c</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 13 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> False<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> 15<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">c</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_right_isotone order_lesseq_imp top_greatest mult_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">-</span><span class="main">(</span><span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">,</span></span> 3<span class="main"><span class="main">)</span></span> point_in_vector_or_complement regular_closed_star regular_closed_top regular_mult_closed vector_mult_closed vector_top_closed<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top <span class="main">≤</span> bot"</span></span>
          <span class="keyword1"><span class="command">using</span></span> schroeder_3_p mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 13 False sup.absorb_iff1 mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="free">c</span> <span class="free">H</span> <span class="free">d</span> <span class="main">∧</span> bf_between_arcs <span class="free">c</span> <span class="free">b</span> <span class="free">H</span> <span class="free">d</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 11 15 assms<span class="main">(</span>2<span class="main">)</span> bf_between_arcs_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="free">b</span> <span class="free">H</span> <span class="free">d</span> <span class="main">∨</span> <span class="main">(</span>bf_between_arcs <span class="free">a</span> <span class="free">c</span> <span class="free">H</span> <span class="free">d</span> <span class="main">∧</span> bf_between_arcs <span class="free">c</span> <span class="free">b</span> <span class="free">H</span> <span class="free">d</span><span class="main">)</span> <span class="main">⟶</span> bf_between_arcs <span class="free">a</span> <span class="free">b</span> <span class="free">H</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">c</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> 21<span class="main">:</span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="free">b</span> <span class="free">H</span> <span class="free">d</span> <span class="main">⟶</span> bf_between_arcs <span class="free">a</span> <span class="free">b</span> <span class="free">H</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">c</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> 22<span class="main">:</span><span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="free">b</span> <span class="free">H</span> <span class="free">d</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">using</span></span> bf_between_arcs_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">c</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_isotone mult_right_dist_sup mult_right_isotone order.trans star_isotone star_slide<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="free">b</span> <span class="free">H</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">c</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 22 bf_between_arcs_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="free">c</span> <span class="free">H</span> <span class="free">d</span> <span class="main">∧</span> bf_between_arcs <span class="free">c</span> <span class="free">b</span> <span class="free">H</span> <span class="free">d</span> <span class="main">⟶</span> bf_between_arcs <span class="free">a</span> <span class="free">b</span> <span class="free">H</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">c</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> 23<span class="main">:</span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="free">c</span> <span class="free">H</span> <span class="free">d</span> <span class="main">∧</span> bf_between_arcs <span class="free">c</span> <span class="free">b</span> <span class="free">H</span> <span class="free">d</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">c</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">using</span></span> bf_between_arcs_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">c</span> <span class="main">*</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">c</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ex231c comp_inf.star.circ_sup_2 mult_isotone mult_right_isotone mult_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">c</span> <span class="main">*</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_right_isotone mult_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">c</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 23 mult_right_isotone mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bf_between_arcs_def<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top <span class="main">⊔</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">c</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bf_between_arcs_def<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">c</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 2<span class="main">)</span> path_through_components mult_right_dist_sup <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="free">b</span> <span class="free">H</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">c</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 23 bf_between_arcs_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> 21 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> dT_He_eq_bot<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"vector <span class="free">j</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">j</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">-</span> <span class="free">j</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span> <span class="main">*</span> <span class="free">j</span> <span class="main">=</span> <span class="free">j</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">≠</span> bot"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> forest_components <span class="free">h</span> <span class="main">*</span> selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">≤</span> bot"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?H</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> top <span class="main">≤</span> <span class="free">j</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 2<span class="main">,</span> 5<span class="main">)</span> et_below_j <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="var">?e</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_isotone conv_isotone top_right_mult_increasing<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">j</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 mult_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span> <span class="free">j</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">j</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> conv_isotone mult_left_isotone<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span> <span class="free">j</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">j</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">)</span> comp_associative <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> bot"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> conv_complement covector_vector_comp<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> coreflexive_bot_closed le_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> big_forest_d_U_e<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">f</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"vector <span class="free">j</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">j</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">h</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span> <span class="main">≤</span> forest_components <span class="free">f</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"big_forest <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">d</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">-</span> <span class="free">j</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span> <span class="main">*</span> <span class="free">j</span> <span class="main">=</span> <span class="free">j</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">h</span> <span class="main">⊔</span> <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">d</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">≤</span> <span class="main">-</span> forest_components <span class="free">f</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">≠</span> bot"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">≠</span> bot"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"big_forest <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> big_forest_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?H</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?d'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> 01<span class="main">:</span> <span class="quoted"><span class="quoted">"reflexive <span class="var">?H</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> forest_components_equivalence<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> 02<span class="main">:</span> <span class="quoted"><span class="quoted">"transitive <span class="var">?H</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> forest_components_equivalence<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> 03<span class="main">:</span> <span class="quoted"><span class="quoted">"symmetric <span class="var">?H</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> forest_components_equivalence<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 04<span class="main">:</span> <span class="quoted"><span class="quoted">"equivalence <span class="var">?H</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 01 02 03<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?d'</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">≤</span> <span class="var">?F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> 11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>10<span class="main">)</span> order_lesseq_imp p_antitone <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>6<span class="main">)</span> big_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 11<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"univalent <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="var">?d'</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="var">?d'</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="var">?d'</span><span class="main">)</span> <span class="main">=</span> <span class="var">?d'</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?d'</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> conv_dist_comp mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?d'</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?d'</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_comp conv_star_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?d'</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?d'</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 01 02 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> preorder_idempotent mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 21<span class="main">:</span> <span class="quoted"><span class="quoted">"univalent <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="var">?d'</span><span class="main">)</span> <span class="main">⟷</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">⊔</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> conv_dist_sup semiring.distrib_left semiring.distrib_right <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> 22<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> 221<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_isotone mult_right_isotone<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"arc <span class="var">?e</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>11<span class="main">)</span> minarc_arc minarc_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> arc_expanded <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> 221 dual_order.trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> 24<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">,</span></span> 3<span class="main"><span class="main">,</span></span> 7<span class="main"><span class="main">,</span></span> 8<span class="main"><span class="main">,</span></span> 12<span class="main"><span class="main">)</span></span> dT_He_eq_bot coreflexive_bot_closed le_bot<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> conv_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_comp mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> 25<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">)</span> fch_equivalence <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> 8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 04 assms<span class="main">(</span>6<span class="main">)</span> dTransHd_le_1 big_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> 21 22 24 25 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"coreflexive <span class="main">(</span><span class="var">?H</span> <span class="main">⊓</span> <span class="var">?d'</span> <span class="main">*</span> <span class="var">?d'</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"coreflexive <span class="main">(</span><span class="var">?H</span> <span class="main">⊓</span> <span class="var">?d'</span> <span class="main">*</span> <span class="var">?d'</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⟷</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="var">?e</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_sup<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">⟷</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">d</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_left_dist_sup mult_right_dist_sup sup.left_commute sup_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"coreflexive <span class="main">(</span><span class="var">?H</span> <span class="main">⊓</span> <span class="var">?d'</span> <span class="main">*</span> <span class="var">?d'</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⟷</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="var">?e</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="var">?e</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf_sup_distrib1<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> 31<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>6<span class="main">)</span> big_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span> 32<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">⊓</span> <span class="var">?e</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_isotone mult_isotone top_right_mult_increasing<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">-</span> <span class="free">j</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>7<span class="main"><span class="main">)</span></span> conv_complement conv_isotone mult_right_isotone<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">j</span> <span class="main">*</span> <span class="main">-</span> <span class="free">j</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">,</span> 3<span class="main">,</span> 12<span class="main">)</span> et_below_j mult_left_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 03 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">,</span></span> 3<span class="main"><span class="main">,</span></span> 8<span class="main"><span class="main">)</span></span> conv_complement conv_dist_comp equivalence_top_closed mult_left_isotone schroeder_3_p vector_top_closed<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.coboundedI1 p_antitone_iff p_shunting_swap regular_one_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> 33<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> 331<span class="main">:</span> <span class="quoted"><span class="quoted">"injective <span class="free">h</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?H</span> <span class="main">⊓</span> <span class="var">?e</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 32 coreflexive_conv_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">⊓</span> <span class="main">(</span><span class="var">?e</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 331 conv_dist_inf forest_components_equivalence <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> conv_dist_comp <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> 34<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">⊓</span> <span class="var">?e</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> 341<span class="main">:</span><span class="quoted"><span class="quoted">"arc <span class="var">?e</span> <span class="main">∧</span> arc <span class="main">(</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>11<span class="main">)</span> minarc_arc minarc_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">⊓</span> <span class="var">?e</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?e</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> 341 arc_injective le_infI2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 31 32 33 34 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> 4<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="var">?e</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>10<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?e</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> p_antitone_iff<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?e</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> fch_equivalence <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?e</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> fch_equivalence forest_components_star star.circ_decompose_9<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> 41<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="var">?F</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?F</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> triple_schroeder_p <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> 42<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?F</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> 43<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">*</span> <span class="var">?F</span> <span class="main">=</span> <span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> forest_components_equivalence preorder_idempotent <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="var">?F</span> <span class="main">=</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> forest_components_star<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 43 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> 41 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">hence</span></span> 44<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> 45<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">≤</span> <span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> 46<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_isotone<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">≤</span> <span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>9<span class="main">)</span> sup.left_commute sup_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> forest_components_increasing le_supI2 star.circ_back_loop_fixpoint star.circ_increasing sup.bounded_iff<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">≤</span> <span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">≤</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 45 mult_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> 47<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">(</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star_isotone<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 46 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_left_isotone mult_right_isotone mult_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 47 mult_left_isotone mult_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_isotone<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 42 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 45 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> p_antitone<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="var">?e</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">=</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="var">?e</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="var">?e</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> star.circ_plus_same <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="var">?e</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">,</span> 11<span class="main">)</span> forest_components_equivalence minarc_arc minarc_bot_iff path_through_components <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="var">?e</span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="var">?e</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> mult_right_dist_sup <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">⊔</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">⊔</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_dist_sup<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">⊔</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> mult_left_dist_sup mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">⊔</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star.circ_plus_same mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult.semigroup_axioms semiring.distrib_left sup.semigroup_axioms semigroup.assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative comp_inf.coreflexive_idempotent comp_inf.coreflexive_transitive comp_isotone top.extremum<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?e</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>11<span class="main">)</span> arc_top_arc minarc_arc minarc_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="var">?e</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative comp_isotone<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> sup_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">d</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> eq_iff sup.left_commute sup.orderE sup_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> star.circ_plus_same mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_dist_sup sup_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star_left_unfold_equal<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 44 assms<span class="main">(</span>6<span class="main">)</span> big_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‹Identifying arcs›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
The expression $d \sqcap \top e^\top H \sqcap (H d^\top)^* H a^\top \top$ identifies the edge incoming to the component that the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>selected_edge›</span></span></span></span>, $e$, is outgoing from and which is on the path from edge $a$ to $e$.
Here, we prove this expression is an <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>arc›</span></span></span></span>.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> shows_arc_x<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"big_forest <span class="free">H</span> <span class="free">d</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="free">e</span> <span class="free">H</span> <span class="free">d</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="free">H</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">a</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">e</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">H</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">d</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arc <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span><span class="quoted"><span class="quoted">"regular <span class="var">?x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>5<span class="main">,</span> 6<span class="main">,</span> 7<span class="main">,</span> 8<span class="main">)</span> regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="free">a</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> arc_expanded assms<span class="main">(</span>2<span class="main">)</span> bf_between_arcs_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> bf_between_arcs_def arc_expanded <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"top <span class="main">*</span> <span class="var">?x</span> <span class="main">*</span> top <span class="main">=</span> top"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> bf_between_arcs_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊔</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> star.circ_loop_fixpoint star.circ_plus_same sup_commute mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊔</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">∨</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">,</span> 6<span class="main">,</span> 7<span class="main">)</span> point_in_vector_sup bf_between_arcs_def regular_mult_closed vector_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative covector_inf_comp_3 star.circ_left_top star.circ_top<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> conv_dist_comp mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> big_forest_def<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"bijective <span class="main">(</span><span class="free">e</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">∧</span> bijective <span class="main">(</span><span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> bf_between_arcs_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> bijective_reverse mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_comp mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> big_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> big_forest_def conv_dist_comp conv_star_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> conv_dist_comp big_forest_def comp_associative conv_dist_inf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative star_slide<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="main">(</span><span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> comp_inf_vector covector_comp_inf vector_conv_covector vector_top_closed mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> big_forest_def conv_dist_comp mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_inf<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">*</span> top <span class="main">≤</span> <span class="free">H</span> <span class="main">*</span> <span class="var">?x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">≠</span> bot"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="var">?x</span> <span class="main">≠</span> bot"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">*</span> top <span class="main">=</span> bot"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 3 le_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">,</span> 4<span class="main">)</span> bf_between_arcs_def mult_assoc semiring.mult_zero_right <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">using</span></span> tarski <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> 51<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> 511<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="free">H</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 3<span class="main">)</span> big_forest_def preorder_idempotent schroeder_4_p triple_schroeder_p <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">d</span> <span class="main">≤</span> <span class="main">-</span> <span class="free">H</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> star_slide <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="free">d</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> big_forest_def conv_dist_comp conv_star_commute schroeder_4_p star_slide<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 511 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> big_forest_def schroeder_5_p star_slide<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> p_antitone_iff schroeder_4_p star_slide mult_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> bot"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bot_unique pseudo_complement<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bot_unique<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> 512<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> univalent_comp_left_dist_inf assms<span class="main">(</span>1<span class="main">)</span> big_forest_def mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">hence</span></span> 513<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> big_forest_def conv_dist_comp conv_involutive mult_1_right mult_left_isotone<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">using</span></span> 512 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> dual_order.trans p_antitone p_shunting_swap regular_one_closed<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">≤</span> <span class="main">1</span> <span class="main">⊔</span> <span class="main">-</span> <span class="free">H</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> big_forest_def dTransHd_le_1 le_supI1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span> <span class="main">1</span> <span class="main">⊓</span> <span class="free">H</span><span class="main">)</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">≤</span> <span class="main">-</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> big_forest_def dTransHd_le_1 inf.sup_monoid.add_commute le_infI2 p_antitone_iff regular_one_closed schroeder_4_p mult_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span> <span class="main">1</span> <span class="main">⊓</span> <span class="free">H</span><span class="main">)</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="free">H</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> big_forest_def conv_dist_comp schroeder_3_p triple_schroeder_p<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span> <span class="main">1</span> <span class="main">⊓</span> <span class="free">H</span><span class="main">)</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.coboundedI1 p_antitone_iff p_shunting_swap regular_one_closed<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">H</span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span> <span class="main">1</span> <span class="main">⊓</span> <span class="free">H</span><span class="main">)</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> big_forest_def le_supI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="main">1</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span> <span class="main">1</span> <span class="main">⊓</span> <span class="free">H</span><span class="main">)</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> comp_inf.semiring.distrib_left <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">-</span> <span class="main">1</span> <span class="main">⊓</span> <span class="free">H</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_dist_sup mult_right_dist_sup<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> 514<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> big_forest_def comp_inf.semiring.distrib_left inf.le_iff_sup inf.sup_monoid.add_commute inf_top_right regular_one_closed stone<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 513 514 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">⊔</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_inf.semiring.distrib_left inf.sup_monoid.add_commute<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">⊔</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_dist_sup mult_assoc<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.sup_monoid.add_commute star_left_unfold_equal<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">H</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_comp conv_dist_inf conv_star_commute mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> big_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">⊓</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf_vector_comp vector_export_comp<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">⊓</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vector_mult_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top<span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> covector_comp_inf_1 covector_mult_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> comp_associative comp_inf.star_star_absorb comp_inf_vector conv_star_commute covector_comp_inf covector_conv_vector fc_top star.circ_top total_conv_surjective vector_conv_covector vector_inf_comp<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> inf.sup_monoid.add_assoc inf.sup_monoid.add_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> top <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> comp_inf.star.circ_decompose_9 comp_inf.star_star_absorb comp_inf_covector fc_top star.circ_decompose_11 star.circ_top vector_export_comp<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> big_forest_def conv_dist_comp mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_inf_covector inf_top.left_neutral mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">1</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative comp_isotone mult_left_isotone mult_semi_associative star.circ_transitive_equal<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> big_forest_def mult.semigroup_axioms preorder_idempotent semigroup.assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> star_slide mult_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> inf.sup_left_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">1</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_isotone idempotent_one_closed mult_left_isotone mult_sub_right_one mult_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> big_forest_def mult_left_isotone mult_one_associative mult_semi_associative preorder_idempotent<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> inf.sup_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> big_forest_def comp_associative preorder_idempotent star_slide<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> expand_big_forest mult.semigroup_axioms semigroup.assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊔</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_dist_sup mult_right_dist_sup<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> big_forest_def inf_sup_distrib2 mult.semigroup_axioms preorder_idempotent star_slide semigroup.assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="free">d</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 51 comp_inf.semiring.add_left_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 51 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> big_forest_def conv_dist_comp conv_dist_inf conv_dist_sup conv_involutive conv_star_commute equivalence_one_closed mult.semigroup_axioms sup.absorb2 semigroup.assoc conv_isotone conv_order<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?x</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?x</span> <span class="main">=</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">H</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_comp conv_dist_inf conv_star_commute mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> big_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> comp_associative inf.sup_monoid.add_assoc inf.sup_monoid.add_commute star.circ_left_top star.circ_top vector_inf_comp<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span>top <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top<span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> covector_comp_inf_1 covector_mult_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> big_forest_def comp_associative conv_dist_comp <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> comp_associative comp_inf_covector inf.sup_monoid.add_assoc inf.sup_monoid.add_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span>top <span class="main">⊓</span> <span class="main">(</span><span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative comp_inf_vector vector_conv_covector vector_top_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">d</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> big_forest_def conv_dist_comp inf.left_commute inf.sup_monoid.add_commute symmetric_top_closed mult_assoc inf_top.left_neutral<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">d</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> vector_covector vector_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">d</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> conv_dist_comp mult.semigroup_axioms symmetric_top_closed semigroup.assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">d</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> big_forest_def conv_dist_comp conv_star_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">⊓</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">d</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> vector_top_closed mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">H</span> <span class="main">⊓</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">d</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">≤</span> <span class="free">H</span> <span class="main">*</span> <span class="main">1</span> <span class="main">*</span> <span class="free">H</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative mult_left_isotone mult_right_isotone<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> big_forest_def preorder_idempotent <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 611<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">≤</span> <span class="free">H</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">d</span> <span class="main">≤</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">1</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">d</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative mult_left_isotone mult_right_isotone<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">d</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> big_forest_def mult.semigroup_axioms preorder_idempotent semigroup.assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">d</span> <span class="main">≤</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">d</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> 611 comp_inf.comp_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> star_slide mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">1</span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> big_forest_def conv_dist_comp mult_left_isotone mult_right_isotone preorder_idempotent mult_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> inf.sup_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> expand_big_forest<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_inf.semiring.distrib_left<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⊔</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> 612<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">1</span> <span class="main">⊔</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> big_forest_def reflexive_inf_star <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">1</span> <span class="main">⊔</span> <span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> big_forest_def reflexive_inf_star <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> 612 sup_assoc sup_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> 613<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> inf.coboundedI1 p_antitone_iff p_shunting_swap regular_one_closed<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> big_forest_def conv_dist_comp conv_dist_inf conv_plus_commute coreflexive_symmetric<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 613<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 7<span class="main">:</span><span class="quoted"><span class="quoted">"bijective <span class="main">(</span><span class="var">?x</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 4 5 6 arc_expanded <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"bijective <span class="main">(</span><span class="var">?x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 4 5 6 arc_expanded <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> 7 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
To maintain that $f$ can be extended to a minimum spanning forest we identify an edge, $i = v \sqcap \overline{F}e\top \sqcap \top e^\top F$, that may be exchanged with the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>selected_edge›</span></span></span></span>, $e$.
Here, we show that $i$ is an <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>arc›</span></span></span></span>.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> boruvka_edge_arc<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"equivalence <span class="free">F</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">v</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"arc <span class="free">e</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">F</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">≤</span> forest_components <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">v</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">=</span> bot"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">≠</span> bot"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arc <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?i</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?i</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?i</span> <span class="main">=</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> conv_complement conv_dist_comp conv_dist_inf mult.semigroup_axioms semigroup.assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> covector_comp_inf covector_mult_closed inf_vector_comp vector_export_comp vector_top_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span>top <span class="main">⊓</span> <span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> comp_associative comp_inf_vector_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span>top <span class="main">⊓</span> <span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>top <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="free">v</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> comp_inf_vector conv_dist_comp mult.semigroup_axioms symmetric_top_closed semigroup.assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">v</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">v</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative conv_complement conv_dist_comp<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative comp_inf_covector inf.sup_monoid.add_assoc inf_top.left_neutral vector_top_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> injective_comp_right_dist_inf mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> conv_dist_comp inf.sup_monoid.add_assoc inf.sup_monoid.add_commute mult.semigroup_axioms univalent_comp_left_dist_inf semigroup.assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative comp_inf_covector inf_top.left_neutral vector_top_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> conv_dist_comp mult_left_isotone shunt_bijective symmetric_top_closed top_right_mult_increasing mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> inf.absorb1 inf.cobounded1 mult_isotone preorder_idempotent<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>5<span class="main">)</span> comp_inf.mult_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">≤</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">F</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_complement dedekind_2 inf_commute<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> equivalence_comp_left_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">≤</span> <span class="free">F</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> 11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">=</span> <span class="free">F</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.antisym_conv inf.sup_monoid.add_commute comp_left_subdist_inf inf.boundedE inf.sup_right_isotone<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> conv_complement conv_dist_comp conv_dist_inf<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> 12<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span> <span class="main">=</span> <span class="free">F</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> abel_semigroup.commute inf.abel_semigroup_axioms<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 11 12 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative comp_isotone inf.cobounded2<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> comp_inf.mult_left_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative inf_sup_distrib1 star.circ_loop_fixpoint<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> conv_dist_inf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> bot <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> bot"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 2<span class="main">)</span> forests_bot_2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> le_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">1</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star.circ_plus_same star_left_unfold_equal<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">1</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_inf.semiring.distrib_left<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">1</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> sup_left_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">1</span> <span class="main">⊔</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 2<span class="main">)</span> forests_bot_3 comp_inf.semiring.add_left_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_inf<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_complement conv_dist_comp mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> inf.left_commute inf.sup_monoid.add_assoc vector_export_comp<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> comp_inf_covector inf.sup_monoid.add_assoc inf.sup_monoid.add_commute mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top<span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_inf_vector_1 mult.semigroup_axioms semigroup.assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top<span class="main">)</span> <span class="main">*</span> <span class="main">(</span>top <span class="main">⊓</span> <span class="main">(</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> comp_inf_vector covector_comp_inf vector_conv_covector vector_mult_closed vector_top_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative conv_dist_comp<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> comp_associative comp_inf_covector inf.sup_monoid.add_assoc inf_top.left_neutral vector_top_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> injective_comp_right_dist_inf assms<span class="main">(</span>3<span class="main">)</span> mult.semigroup_axioms semigroup.assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> injective_comp_right_dist_inf assms<span class="main">(</span>3<span class="main">)</span> conv_dist_comp inf.sup_monoid.add_assoc mult.semigroup_axioms univalent_comp_left_dist_inf semigroup.assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf_top_right vector_export_comp vector_top_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> conv_dist_comp mult.semigroup_axioms mult_left_isotone shunt_bijective symmetric_top_closed top_right_mult_increasing semigroup.assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">v</span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> conv_dist_comp<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> conv_complement conv_dist_inf <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.sup_monoid.add_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?Fv</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span> <span class="main">≤</span> <span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>5<span class="main">)</span> inf.sup_right_isotone mult_right_isotone comp_associative <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span> <span class="main">≤</span> <span class="free">F</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> dual_order.trans mult_left_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="free">F</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> mult_1_right preorder_idempotent star.circ_sup_one_right_unfold star.circ_transitive_equal star_one star_simulation_right_equal mult_assoc<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="free">F</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> conv_isotone dual_order.trans inf.cobounded2 inf.sup_monoid.add_commute mult_left_isotone mult_right_isotone<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="free">F</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> conv_isotone dual_order.trans inf.cobounded2 inf.sup_monoid.add_commute mult_left_isotone mult_right_isotone comp_isotone conv_dist_inf inf.cobounded1 star_isotone<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> bot"</span></span>
          <span class="keyword1"><span class="command">using</span></span> eq_iff p_antitone pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> bot_least le_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊔</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sup_inf_distrib2<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊔</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="main">1</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.sup_monoid.add_commute mult.semigroup_axioms mult_left_dist_sup mult_right_dist_sup semigroup.assoc<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊔</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star_left_unfold_equal sup_commute<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">F</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> comp_inf.mult_right_sub_dist_sup_left inf.order_lesseq_imp <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.sup_monoid.add_commute<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dedekind_2 conv_star_commute inf.sup_monoid.add_commute<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> conv_isotone inf.sup_right_isotone mult_left_isotone mult_right_isotone star_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> equivalence_comp_right_complement mult_left_one star_one star_simulation_right_equal<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> equivalence_comp_right_complement inf.sup_monoid.add_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_isotone conv_isotone<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative conv_dist_comp conv_star_commute<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="free">F</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> fc_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">F</span> <span class="main">*</span> <span class="free">F</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> preorder_idempotent star.circ_sup_one_left_unfold star.circ_transitive_equal star_right_induct_mult<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 21<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="free">F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> dual_order.trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fc_isotone<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 21 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">F</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> cancel_separate_eq<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">,</span></span> 6<span class="main"><span class="main">)</span></span> comp_associative comp_inf.semiring.distrib_left comp_isotone inf_pp_semi_commute mult_left_isotone regular_closed_inf<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_dist_sup mult_right_dist_sup<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span> inf.coboundedI1 mult_right_isotone<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative comp_inf.mult_right_dist_sup mult_left_dist_sup star.circ_loop_fixpoint<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">⊔</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative comp_isotone inf.coboundedI2 inf.sup_monoid.add_commute le_supI1<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">⊔</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> comp_inf.mult_right_isotone comp_inf.semiring.add_mono eq_iff inf.cobounded2 inf.sup_monoid.add_commute mult_right_isotone star_isotone<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> bot <span class="main">⊔</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span> 2<span class="main"><span class="main">)</span></span> forests_bot_1 comp_associative comp_inf.semiring.add_right_mono mult_semi_associative vector_bot_closed<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> acyclic_star_inf_conv<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 22<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> conv_dist_inf conv_star_commute conv_dist_comp<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 22 conv_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> 22 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">,</span></span> 6<span class="main"><span class="main">)</span></span> comp_associative comp_inf.pp_comp_semi_commute comp_inf.semiring.add_mono comp_isotone inf_pp_commute mult_left_isotone<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">⊓</span> <span class="free">v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">v</span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_isotone conv_isotone<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> calculation dual_order.trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"top <span class="main">*</span> <span class="var">?i</span> <span class="main">*</span> top <span class="main">=</span> top"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> 31<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="main">(</span><span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">,</span> 4<span class="main">,</span> 6<span class="main">)</span> arc_regular regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> 32<span class="main">:</span> <span class="quoted"><span class="quoted">"bijective <span class="main">(</span><span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_comp<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"top <span class="main">*</span> <span class="var">?i</span> <span class="main">*</span> top <span class="main">=</span> top <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative comp_inf_vector_1<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span>top <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> comp_inf_vector conv_dist_comp <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative conv_complement conv_dist_comp<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 33<span class="main">:</span> <span class="quoted"><span class="quoted">"top <span class="main">*</span> <span class="var">?i</span> <span class="main">*</span> top <span class="main">=</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"top <span class="main">*</span> <span class="var">?i</span> <span class="main">*</span> top <span class="main">≠</span> bot"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> top <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="main">)</span> <span class="main">*</span> top <span class="main">≠</span> bot"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">=</span> bot"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 33 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">=</span> bot"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 31 tarski comp_associative le_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"top <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="free">F</span> <span class="main">*</span> <span class="free">v</span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span><span class="main">(</span><span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative conv_complement_sub_leq conv_involutive p_bot schroeder_5_p<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="free">F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span><span class="main">(</span><span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative conv_complement conv_dist_comp<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">F</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span> 4<span class="main"><span class="main">)</span></span> comp_associative conv_dist_comp schroeder_3_p symmetric_top_closed<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">F</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">≤</span> <span class="free">F</span> <span class="main">*</span> <span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 32 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> shunt_bijective comp_associative conv_involutive<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">≤</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">using</span></span> comp_associative conv_dist_comp <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">≤</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">using</span></span> comp_associative star_left_induct_mult_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">≤</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms<span class="main"><span class="main">(</span></span>9<span class="main"><span class="main">)</span></span> mult_left_isotone order_trans<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="free">e</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 32 shunt_bijective assms<span class="main">(</span>3<span class="main">)</span> mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> 34<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">F</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_dist_comp mult.semigroup_axioms symmetric_top_closed semigroup.assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_involutive ex231c<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> comp_associative mult_left_isotone mult_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_isotone top_right_mult_increasing vector_mult_closed<span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">using</span></span> 34 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">hence</span></span> 35<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">≤</span> <span class="free">F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> conv_order <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"top <span class="main">*</span> <span class="main">(</span><span class="free">F</span> <span class="main">*</span> <span class="free">e</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="free">e</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>8<span class="main">)</span> comp_associative schroeder_4_p <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">F</span> <span class="main">≤</span> <span class="main">-</span> <span class="free">e</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> comp_associative conv_dist_comp<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">e</span> <span class="main">≤</span> <span class="main">-</span> <span class="free">F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> schroeder_3_p <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">e</span> <span class="main">≤</span> <span class="main">-</span> <span class="free">F</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_comp<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">≤</span> <span class="main">-</span> <span class="free">F</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> arc_top_arc<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">≤</span> <span class="free">F</span> <span class="main">⊓</span> <span class="main">-</span> <span class="free">F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 35 inf.boundedI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">=</span> bot"</span></span>
        <span class="keyword1"><span class="command">using</span></span> bot_unique <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>10<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">,</span></span> 4<span class="main"><span class="main">,</span></span> 6<span class="main"><span class="main">)</span></span> arc_regular regular_closed_inf regular_closed_top regular_conv_closed regular_mult_closed semiring.mult_not_zero tarski<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"bijective <span class="main">(</span><span class="var">?i</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">∧</span> bijective <span class="main">(</span><span class="var">?i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 2 3 arc_expanded <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‹Comparison of edge weights›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
In this section we compare the weight of the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>selected_edge›</span></span></span></span> with other edges of interest.
Theorems 8, 9, 10 and 11 are supporting lemmas.
For example, Theorem 8 is used to show that the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>selected_edge›</span></span></span></span> has its source inside and its target outside the component it is chosen for.
›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 8›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> e_leq_c_c_complement_transpose_general<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">=</span> minarc <span class="main">(</span><span class="free">c</span> <span class="main">*</span> <span class="main">-</span><span class="main">(</span><span class="free">c</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">≤</span> <span class="free">c</span> <span class="main">*</span> <span class="main">-</span><span class="main">(</span><span class="free">c</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span> <span class="main">(</span><span class="free">c</span> <span class="main">*</span> <span class="main">-</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> minarc_below order_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span> <span class="main">(</span><span class="free">c</span> <span class="main">*</span> <span class="main">-</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> order_lesseq_imp pp_isotone_inf <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">c</span> <span class="main">*</span> <span class="main">-</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 9›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> x_leq_c_transpose_general<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">h</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"vector <span class="free">c</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> forest_components<span class="main">(</span><span class="free">h</span><span class="main">)</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">≤</span> <span class="free">c</span> <span class="main">*</span> <span class="main">-</span><span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">=</span> forest_components<span class="main">(</span><span class="free">h</span><span class="main">)</span> <span class="main">*</span> <span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?H</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> top <span class="main">*</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> top_left_mult_increasing <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> conv_dist_comp conv_order <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> comp_associative conv_dist_comp forest_components_equivalence <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> top <span class="main">*</span> <span class="main">(</span><span class="free">c</span> <span class="main">*</span> <span class="main">-</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> conv_isotone mult_left_isotone mult_right_isotone<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> top <span class="main">*</span> <span class="main">(</span><span class="main">-</span> <span class="free">c</span> <span class="main">*</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="var">?H</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_complement conv_dist_comp<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> top <span class="main">*</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_left_isotone top.extremum mult_assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 2<span class="main">)</span> component_is_vector vector_conv_covector <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span> 5<span class="main"><span class="main">)</span></span> fch_equivalence conv_dist_comp<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 10›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> x_leq_c_complement_general<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"vector <span class="free">c</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">*</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> forest_components <span class="free">h</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">-</span>forest_components <span class="free">h</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">-</span><span class="free">c</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?H</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">,</span> 4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span> <span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">⊓</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?H</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 2<span class="main">)</span> vector_covector <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="var">?H</span> <span class="main">⊓</span> <span class="free">c</span> <span class="main">⊓</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> inf.sup_monoid.add_assoc p_antitone pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> le_bot p_shunting_swap pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 11›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> sum_e_below_sum_x_when_outgoing_same_component_general<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">=</span> minarc <span class="main">(</span><span class="free">c</span> <span class="main">*</span> <span class="main">-</span><span class="main">(</span><span class="free">c</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">c</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">h</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"vector <span class="free">c</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">=</span> <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="main">*</span> <span class="free">c</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">*</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> forest_components <span class="free">h</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">-</span> forest_components <span class="free">h</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"arc <span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">≠</span> bot"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="free">e</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?H</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">≤</span> <span class="free">c</span> <span class="main">*</span> <span class="main">-</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 2<span class="main">)</span> e_leq_c_c_complement_transpose_general <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 assms<span class="main">(</span>3<span class="main">,</span> 4<span class="main">,</span> 5<span class="main">,</span> 6<span class="main">)</span> x_leq_c_transpose_general <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">-</span><span class="free">c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">,</span> 7<span class="main">,</span> 8<span class="main">)</span> x_leq_c_complement_general inf.boundedE <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">-</span> <span class="free">c</span> <span class="main">⊓</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">-</span> <span class="free">c</span> <span class="main">*</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vector_complement_closed vector_covector<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_complement conv_dist_comp conv_isotone<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">c</span> <span class="main">*</span> <span class="main">-</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>8<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>9<span class="main">)</span> conv_complement conv_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">c</span> <span class="main">*</span> <span class="main">-</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span> <span class="main">≠</span> bot"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>10<span class="main"><span class="main">,</span></span> 11<span class="main"><span class="main">)</span></span> comp_inf.semiring.mult_not_zero conv_dist_comp
          conv_involutive inf.orderE mult_right_zero top.extremum<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">c</span> <span class="main">*</span> <span class="main">-</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span> <span class="main">≠</span> bot"</span></span>
    <span class="keyword1"><span class="command">using</span></span> inf.sup_monoid.add_commute pp_inf_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span>minarc <span class="main">(</span><span class="free">c</span> <span class="main">*</span> <span class="main">-</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">c</span> <span class="main">*</span> <span class="main">-</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">c</span> <span class="main">*</span> <span class="main">-</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>10<span class="main">)</span> minarc_min inf.sup_monoid.add_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="free">e</span> <span class="main">⊓</span> <span class="free">c</span> <span class="main">*</span> <span class="main">-</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">c</span> <span class="main">*</span> <span class="main">-</span> <span class="free">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> inf.sup_monoid.add_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="free">e</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.orderE<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="free">e</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>9<span class="main">)</span> sum_symmetric <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> sum_e_below_sum_x_when_outgoing_same_component<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"vector <span class="free">j</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">h</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">-</span> forest_components <span class="free">h</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> forest_components <span class="free">h</span> <span class="main">*</span> selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">*</span> top"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">≠</span> bot"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"arc <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span>selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?c</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"choose_component <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">j</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?H</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> sum_e_below_sum_x_when_outgoing_same_component_general<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">=</span> minarc <span class="main">(</span><span class="var">?c</span> <span class="main">*</span> <span class="main">-</span> <span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?c</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> component_is_regular <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">h</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"vector <span class="var">?c</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">,</span></span> 6<span class="main"><span class="main">)</span></span> component_is_vector<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?c</span> <span class="main">=</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?c</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> component_single <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?c</span> <span class="main">*</span> <span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?H</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> component_is_connected<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?H</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"arc <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>7<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?c</span> <span class="main">≠</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">,</span> 5 <span class="main">,</span> 6<span class="main">,</span> 7<span class="main">)</span> inf_bot_left le_bot minarc_bot mult_left_zero mult_right_zero <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
If there is a path in the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>big_forest›</span></span></span></span> from an edge between components, $a$, to the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>selected_edge›</span></span></span></span>, $e$, then the weight of $e$ is no greater than the weight of $a$.
This is because either,
\begin{itemize}
\item the edges $a$ and $e$ are adjacent the same component so that we can use <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>sum_e_below_sum_x_when_outgoing_same_component›</span></span></span></span>, or
\item there is at least one edge between $a$ and $e$, namely $x$, the edge incoming to the component that $e$ is outgoing from.
      The path from $a$ to $e$ is split on $x$ using <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>big_forest_path_split_disj›</span></span></span></span>.
      We show that the weight of $e$ is no greater than the weight of $x$ by making use of lemma <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>sum_e_below_sum_x_when_outgoing_same_component›</span></span></span></span>.
      We define $x$ in a way that we can show that the weight of $x$ is no greater than the weight of $a$ using the invariant.
      Then, it follows that the weight of $e$ is no greater than the weight of $a$ owing to transitivity.
\end{itemize}
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> a_to_e_in_bigforest<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"vector <span class="free">j</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">h</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"big_forest <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">d</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">h</span> <span class="main">⊔</span> <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">d</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span> <span class="bound">a</span> <span class="bound">b</span> <span class="main">.</span> bf_between_arcs <span class="bound">a</span> <span class="bound">b</span> <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">d</span> <span class="main">∧</span> <span class="bound">a</span> <span class="main">≤</span> <span class="main">-</span><span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span> <span class="main">∧</span> <span class="bound">b</span> <span class="main">≤</span> <span class="free">d</span> <span class="main">⟶</span> sum<span class="main">(</span><span class="bound">b</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum<span class="main">(</span><span class="bound">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">d</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">≠</span> bot"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">=</span> selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"arc <span class="free">a</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="free">b</span> <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≤</span> <span class="main">-</span> forest_components <span class="free">h</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">h</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="free">b</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="free">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?p</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?H</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="free">b</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="free">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⟹</span> sum <span class="main">(</span><span class="free">b</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="free">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?e</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="free">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> sum_e_below_sum_x_when_outgoing_same_component<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"vector <span class="free">j</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">h</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>13<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top"</span></span>
          <span class="keyword1"><span class="command">using</span></span> True <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">≠</span> bot"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>9<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"arc <span class="free">a</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>11<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>10<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⟹</span> sum <span class="main">(</span><span class="free">b</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="free">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?d'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">have</span></span> 61<span class="main">:</span> <span class="quoted"><span class="quoted">"arc <span class="main">(</span><span class="var">?x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> shows_arc_x<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"big_forest <span class="var">?H</span> <span class="free">d</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="var">?e</span> <span class="var">?H</span> <span class="free">d</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> 611<span class="main">:</span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="free">b</span> <span class="var">?H</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">b</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>10<span class="main">,</span> 12<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">have</span></span> 616<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="free">h</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>14<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">a</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 611 bf_between_arcs_def arc_regular <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">using</span></span> 616 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> big_forest_path_split_disj assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">,</span></span> 8<span class="main"><span class="main">,</span></span> 10<span class="main"><span class="main">,</span></span> 12<span class="main"><span class="main">)</span></span> bf_between_arcs_def fch_equivalence minarc_regular regular_closed_star regular_conv_closed regular_mult_closed<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>5<span class="main">)</span> big_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> False<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">a</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>12<span class="main">)</span> bf_between_arcs_def arc_regular <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> minarc_regular <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?H</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>14<span class="main">)</span> pp_dist_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">d</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>8<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">have</span></span> 62<span class="main">:</span> <span class="quoted"><span class="quoted">"bijective <span class="main">(</span><span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>11<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> 63<span class="main">:</span> <span class="quoted"><span class="quoted">"bijective <span class="main">(</span><span class="var">?x</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 61 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> 64<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">using</span></span> mult_left_isotone inf_vector_comp <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?x</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 62 63 64 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> bijective_reverse mult_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="var">?H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?x</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">using</span></span> conv_dist_comp conv_star_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?x</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star_slide<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?x</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> 65<span class="main">:</span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="free">a</span> <span class="var">?x</span> <span class="var">?H</span> <span class="free">d</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 61 assms<span class="main">(</span>12<span class="main">)</span> bf_between_arcs_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">have</span></span> 66<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">≤</span> <span class="free">d</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.sup_monoid.add_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> x_below_a<span class="main">:</span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?x</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="free">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 65 bf_between_arcs_def assms<span class="main">(</span>7<span class="main">,</span> 13<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?e</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="var">?x</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> sum_e_below_sum_x_when_outgoing_same_component<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"vector <span class="free">j</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">h</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> 67<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 66 assms<span class="main">(</span>5<span class="main">)</span> big_forest_def order_lesseq_imp <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">≤</span> <span class="free">d</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_isotone inf.sup_monoid.add_assoc<span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">⊔</span> <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">d</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>6<span class="main"><span class="main">)</span></span><span class="main">)</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">)</span></span> le_supE sup.absorb_iff2 sup.idem<span class="main">)</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 2<span class="main">)</span> conv_complement conv_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
          <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 67<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> inf.coboundedI1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top"</span></span>
            <span class="keyword1"><span class="command">using</span></span> conv_dist_comp conv_dist_inf conv_star_commute inf.orderI inf.sup_monoid.add_assoc inf.sup_monoid.add_commute mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> top"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_isotone<span class="main">)</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_assoc<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">≠</span> bot"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>9<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"arc <span class="main">(</span><span class="var">?x</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 61 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?e</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="free">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> x_below_a order.trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>10<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‹Maintenance of algorithm invariants›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
In this section, most of the work is done to maintain the invariants of the inner and outer loops of the algorithm.
In particular, we use <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>exists_a_w›</span></span></span></span> to maintain that $f$ can be extended to a minimum spanning forest.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> boruvka_exchange_spanning_inv<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">v</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">≤</span> <span class="free">v</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"arc <span class="free">i</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"arc <span class="free">e</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">w</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"components <span class="free">g</span> <span class="main">≤</span> forest_components <span class="free">v</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">≤</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> comp_isotone order.trans inf.cobounded1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"bijective <span class="main">(</span><span class="free">i</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">∧</span> bijective <span class="main">(</span><span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">,</span> 5<span class="main">)</span> mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">≤</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span>top <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> covector_mult_closed covector_restrict_comp_conv order_lesseq_imp vector_top_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">v</span> <span class="main">*</span> <span class="free">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative conv_dist_comp<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">v</span> <span class="main">*</span> <span class="free">w</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_star_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">v</span> <span class="main">*</span> <span class="free">w</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>5<span class="main">)</span> arc_eq_1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">v</span> <span class="main">*</span> <span class="free">w</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative mult_right_isotone<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="free">g</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="free">g</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="free">g</span><span class="main">)</span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>6<span class="main">,</span> 7<span class="main">,</span> 8<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_isotone star_isotone<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="free">g</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_isotone mult_left_isotone star.circ_increasing star.circ_transitive_equal<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>9<span class="main"><span class="main">)</span></span> mult_left_isotone<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> comp_associative<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">≤</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">*</span> top <span class="main">≤</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative mult_left_isotone vector_top_closed<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> bijective_reverse mult_assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_star_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> star.circ_loop_fixpoint sup_right_divisibility mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">i</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top <span class="main">≤</span> <span class="free">i</span> <span class="main">*</span> top <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_isotone inf.cobounded1 inf.sup_monoid.add_commute mult_left_isotone top.extremum<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">i</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">i</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 3 dual_order.trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_left_isotone star.circ_increasing star.left_plus_circ<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> <span class="main">-</span><span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="free">v</span> <span class="main">≤</span> <span class="main">-</span><span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_left_isotone order_trans star.circ_increasing star.circ_plus_same<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="main">1</span> <span class="main">≤</span> <span class="main">-</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> schroeder_5_p<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">≤</span> <span class="main">-</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">⊓</span> <span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> bot"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bot_unique pseudo_complement<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> 7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">⊓</span> <span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> bot"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> comp_inf.mult_right_isotone conv_dist_inf inf.boundedE inf.le_iff_sup le_bot<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top <span class="main">≤</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> le_bot semiring.mult_zero_left <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">hence</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> bot_least le_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span> 8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">=</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">i</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> 81<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="free">i</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> arc_regular<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 7 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_inf.coreflexive_comp_inf_complement inf_import_p inf_p le_bot maddux_3_11_pp top.extremum<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">i</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">i</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sup.semigroup_axioms semigroup.assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">v</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 81 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> maddux_3_11_pp<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">i</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top <span class="main">⊔</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top <span class="main">⊔</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 4 5 6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">i</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_right_dist_sup<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">*</span> top <span class="main">⊔</span> <span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> 9<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star_left_induct_mult mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top <span class="main">≤</span> <span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 3 mult_right_isotone mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> 9 order.trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">i</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> bijective_reverse mult_assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">using</span></span> comp_inf.inf_vector_comp conv_complement conv_dist_inf conv_star_commute inf.sup_monoid.add_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_isotone star_isotone<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">≤</span> <span class="main">(</span><span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">using</span></span> dual_order.trans top_right_mult_increasing sup_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 cancel_separate_1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sup_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf_assoc mult_left_isotone mult_right_isotone star_isotone<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_left_isotone star_isotone inf.cobounded2 inf.left_commute inf.sup_monoid.add_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">v</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">i</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">using</span></span> conv_complement conv_dist_inf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> exists_a_w<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">f</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">f</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">w</span> <span class="main">.</span> minimum_spanning_forest <span class="bound">w</span> <span class="free">g</span> <span class="main">∧</span> <span class="free">f</span> <span class="main">≤</span> <span class="bound">w</span> <span class="main">⊔</span> <span class="bound">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"vector <span class="free">j</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">j</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">h</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span> <span class="main">≤</span> forest_components <span class="free">f</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"big_forest <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">d</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">-</span> <span class="free">j</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span> <span class="main">*</span> <span class="free">j</span> <span class="main">=</span> <span class="free">j</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="free">f</span> <span class="main">=</span> <span class="main">(</span>forest_components <span class="free">h</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> forest_components <span class="free">h</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">h</span> <span class="main">⊔</span> <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">d</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span> <span class="bound">a</span> <span class="bound">b</span> <span class="main">.</span> bf_between_arcs <span class="bound">a</span> <span class="bound">b</span> <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">d</span> <span class="main">∧</span> <span class="bound">a</span> <span class="main">≤</span> <span class="main">-</span><span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span> <span class="main">∧</span> <span class="bound">b</span> <span class="main">≤</span> <span class="free">d</span> <span class="main">⟶</span> sum<span class="main">(</span><span class="bound">b</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum<span class="main">(</span><span class="bound">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">d</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">≤</span> <span class="main">-</span> forest_components <span class="free">f</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">≠</span> bot"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">≠</span> bot"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">h</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">w</span><span class="main">.</span> minimum_spanning_forest <span class="bound">w</span> <span class="free">g</span> <span class="main">∧</span>
    <span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="main">(</span>selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="main">(</span>path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="main">(</span>selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span>path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span>selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> <span class="bound">w</span> <span class="main">⊔</span> <span class="bound">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?p</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?p</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?H</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?ec</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"choose_component <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">j</span> <span class="main">*</span> <span class="main">-</span> choose_component <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">j</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">w</span></span> <span class="keyword2"><span class="keyword">where</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"minimum_spanning_forest <span class="skolem">w</span> <span class="free">g</span> <span class="main">∧</span> <span class="free">f</span> <span class="main">≤</span> <span class="skolem">w</span> <span class="main">⊔</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>5<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="skolem">w</span> <span class="main">∧</span> regular <span class="free">f</span> <span class="main">∧</span> regular <span class="var">?e</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> minarc_regular minimum_spanning_forest_def spanning_forest_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"equivalence <span class="var">?F</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> forest_components_equivalence <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> arc_conv_closed arc_top_arc coreflexive_bot_closed coreflexive_symmetric minarc_arc minarc_bot_iff semiring.mult_not_zero<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 5 assms<span class="main">(</span>17<span class="main">)</span> conv_complement conv_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">hence</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">=</span> bot"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> le_bot triple_schroeder_p <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?q</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?v</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?q</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 7<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="var">?q</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 3 regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 8<span class="main">:</span> <span class="quoted"><span class="quoted">"injective <span class="var">?v</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_exchange_injective_inv_1<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="skolem">w</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 2 minimum_spanning_forest_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"covector <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> covector_mult_closed<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_right_isotone star.right_plus_below_circ mult_assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"coreflexive <span class="main">(</span><span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">w</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_inf.semiring.mult_not_zero forest_bot kruskal_injective_inv_3 minarc_arc minarc_bot_iff minimum_spanning_forest_def semiring.mult_not_zero spanning_forest_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 9<span class="main">:</span> <span class="quoted"><span class="quoted">"components <span class="free">g</span> <span class="main">≤</span> forest_components <span class="var">?v</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_exchange_spanning_inv_1<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span> <span class="main">(</span>top <span class="main">*</span><span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 7 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"components <span class="free">g</span> <span class="main">≤</span> forest_components <span class="skolem">w</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 2 minimum_spanning_forest_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 10<span class="main">:</span> <span class="quoted"><span class="quoted">"spanning_forest <span class="var">?v</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> spanning_forest_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="var">?v</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="var">?v</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_exchange_acyclic_inv_1<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pd_kleene_allegory_class.acyclic <span class="skolem">w</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 minimum_spanning_forest_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"covector <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> covector_mult_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> sup_least<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span> <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="main">-</span> <span class="main">-</span> <span class="free">g</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 7 inf.coboundedI1 minimum_spanning_forest_def spanning_forest_def 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="main">-</span> <span class="free">g</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> conv_complement conv_isotone inf.coboundedI1 minimum_spanning_forest_def spanning_forest_def<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"components <span class="free">g</span> <span class="main">≤</span> forest_components <span class="var">?v</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 9 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?v</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 3 regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 11<span class="main">:</span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="var">?q</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> conv_complement conv_top epm_8 inf_import_p inf_top_right regular_closed_top vector_top_closed minimum_spanning_forest_def spanning_forest_def sum_disjoint<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="var">?q</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> sum_symmetric<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?q</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> inf_commute inf_left_commute sum_disjoint <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 3 7 8 maddux_3_11_pp <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 12<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">⊔</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="skolem">w</span> <span class="main">⊔</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">⊔</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?q</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?q</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?q</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?q</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> conv_complement conv_dist_inf conv_dist_sup inf_import_p sup_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">w</span> <span class="main">⊔</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 3 7 conv_complement conv_dist_inf inf_import_p maddux_3_11_pp sup_monoid.add_assoc sup_monoid.add_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 13<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_reroot_edge<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="main">(</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>18<span class="main">)</span> minarc_arc minarc_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pd_kleene_allegory_class.acyclic <span class="skolem">w</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 2 minimum_spanning_forest_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">⊓</span> <span class="var">?e</span> <span class="main">≤</span> <span class="var">?v</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> inf.sup_right_isotone top_left_mult_increasing <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?v</span> <span class="main">*</span> <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> covector_restrict_comp_conv covector_mult_closed vector_top_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 14<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">⊓</span> <span class="var">?e</span> <span class="main">=</span> bot"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 13 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_dist_comp mult_assoc le_bot mult_left_zero<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?i</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span> <span class="var">?F</span><span class="main">)</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?w</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 15<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="var">?i</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 3 regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 16<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?i</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> 161<span class="main">:</span> <span class="quoted"><span class="quoted">"bijective <span class="main">(</span><span class="var">?e</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>18<span class="main">)</span> minarc_arc minarc_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">using</span></span> inf.cobounded2 inf.coboundedI1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span> <span class="main">(</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 161 comp_bijective_complement <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> <span class="main">-</span> <span class="main">(</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> 162<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">⊓</span> <span class="var">?F</span> <span class="main">≤</span> <span class="main">-</span> <span class="main">(</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> inf.coboundedI1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">⊓</span> <span class="var">?F</span> <span class="main">≤</span> <span class="var">?F</span> <span class="main">⊓</span> <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> inf_le1 inf_le2 le_infI order_trans<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?F</span> <span class="main">*</span> <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> covector_mult_closed covector_restrict_comp_conv<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_comp mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_comp conv_star_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 5 preorder_idempotent<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">⊓</span> <span class="var">?F</span> <span class="main">≤</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">⊓</span> <span class="var">?F</span> <span class="main">≤</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="main">-</span> <span class="main">(</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 162 inf.bounded_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> le_bot p_antitone_iff pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 17<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> <span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 2 8 12 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> inf.sup_right_isotone kruskal_forest_components_inf mult_right_isotone mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> star_left_unfold_equal star.circ_right_unfold_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_left_dist_sup mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> comp_inf.semiring.distrib_left <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> comp_inf.semiring.add_right_mono inf_le2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_inf<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?F</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?F</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> star_isotone <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_isotone<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span> <span class="main">≤</span> <span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?F</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> inf.sup_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> sup_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?F</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> forest_components_star<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 5 mult.semigroup_axioms preorder_idempotent semigroup.assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>18<span class="main">)</span> arc_expanded minarc_arc minarc_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?F</span> <span class="main">*</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative comp_isotone mult_semi_associative star.circ_transitive_equal<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">*</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 8 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> comp_isotone mult_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> 171<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">*</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?F</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?v</span> <span class="main">*</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_inf mult_left_isotone mult_right_isotone<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">using</span></span> 171 order_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">hence</span></span> 172<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="var">?F</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span><span class="var">?v</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> schroeder_4_p comp_associative order_lesseq_imp pp_increasing<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="var">?F</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="main">-</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative conv_dist_comp<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> comp_associative <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> comp_associative comp_inf.star.circ_decompose_9 comp_inf.star_star_absorb comp_inf_covector inf_vector_comp vector_top_closed<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="var">?F</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="main">-</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?v</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 172 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span> <span class="main">≤</span> bot"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> bot_unique inf.sup_monoid.add_commute p_shunting_swap pseudo_complement<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> le_bot sup_monoid.add_0_right <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 16 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> comp_inf.coreflexive_comp_inf_complement inf_top_right p_bot pseudo_complement top.extremum<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 18<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 17 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> mult_right_isotone conv_isotone star_isotone inf.cobounded2 inf.sup_monoid.add_assoc <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.sup_monoid.add_assoc eq_iff inf.sup_monoid.add_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?e</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> mult_right_isotone conv_isotone star_isotone sup_ge1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 19<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 17 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> mult_right_isotone conv_isotone star_isotone inf.cobounded2 inf.sup_monoid.add_assoc <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.sup_monoid.add_assoc eq_iff inf.sup_monoid.add_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?v</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> mult_right_isotone conv_isotone star_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> 20<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_edge_between_components_2<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?i</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 16 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="free">f</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span> <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span> <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 2 12 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_dist_sup conv_involutive conv_isotone le_supI sup_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"minimum_spanning_forest <span class="var">?w</span> <span class="free">g</span> <span class="main">∧</span> <span class="var">?f</span> <span class="main">≤</span> <span class="var">?w</span> <span class="main">⊔</span> <span class="var">?w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> conjI<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> 211<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_edge_arc_1<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> g<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="free"><span class="quoted"><span class="free">g</span></span></span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">and</span></span></span></span> h<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">"<span class="var"><span class="var">?ec</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span> <span class="var">?ec</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> minarc_below <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?ec</span> <span class="main">≤</span> <span class="free">g</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">)</span> inf.cobounded2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> boruvka_inner_invariant_def boruvka_outer_invariant_def conv_dist_inf<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> boruvka_inner_invariant_def boruvka_outer_invariant_def<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"components <span class="free">g</span> <span class="main">≤</span> forest_components <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span> <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 9 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span> <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 13 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> 212<span class="main">:</span> <span class="quoted"><span class="quoted">"arc <span class="var">?i</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> boruvka_edge_arc<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"equivalence <span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 5<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"forest <span class="var">?v</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 10 spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"arc <span class="var">?e</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>18<span class="main">)</span> minarc_arc minarc_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 3 regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">≤</span> forest_components <span class="main">(</span><span class="var">?F</span> <span class="main">⊓</span> <span class="var">?v</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 12 2 8 kruskal_forest_components_inf<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?v</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 10 spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 13 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">=</span> bot"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 6<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 211 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≠</span> bot"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>18<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"minimum_spanning_forest <span class="var">?w</span> <span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> minimum_spanning_forest_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?v</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> inf_le1 mult_left_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 13 le_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> 221<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
        <span class="keyword1"><span class="command">using</span></span> conv_dist_comp conv_involutive conv_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
      <span class="keyword1"><span class="command">have</span></span> 222<span class="main">:</span> <span class="quoted"><span class="quoted">"injective <span class="var">?w</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> injective_sup<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 8 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> injective_inf_closed<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"coreflexive <span class="main">(</span><span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 221 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> arc_injective minarc_arc coreflexive_bot_closed coreflexive_injective minarc_bot_iff<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"spanning_forest <span class="var">?w</span> <span class="free">g</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> spanning_forest_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="var">?w</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 222 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="var">?w</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_exchange_acyclic_inv_2<span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="var">?v</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 10 spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="var">?v</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span><span class="var">?v</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> inf.coboundedI1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"bijective <span class="main">(</span><span class="var">?i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 212 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"bijective <span class="main">(</span><span class="var">?e</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 14 212 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> comp_inf.idempotent_bot_closed conv_complement minarc_arc minarc_bot_iff p_bot regular_closed_bot semiring.mult_not_zero symmetric_top_closed<span class="main">)</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span><span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 19 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">=</span> bot"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 13 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?w</span> <span class="main">≤</span> <span class="var">?v</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> inf_le1 sup_left_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 10 sup_left_isotone spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span> <span class="main">⊔</span> <span class="main">-</span><span class="main">-</span><span class="free">h</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="main">-</span><span class="free">g</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span> <span class="main">⊔</span> <span class="main">-</span><span class="main">-</span><span class="free">h</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span> <span class="main">⊔</span> <span class="main">-</span><span class="main">-</span><span class="free">h</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.coboundedI1 inf.sup_monoid.add_commute minarc_below order.trans p_dist_inf p_dist_sup sup.cobounded1<span class="main">)</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>20<span class="main">,</span> 21<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?w</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword1"><span class="command">have</span></span> 223<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> boruvka_exchange_spanning_inv<span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"forest <span class="var">?v</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 10 spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 13 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> conv_complement conv_dist_comp conv_involutive conv_star_commute dense_pp fc_top regular_closed_top star_absorb<span class="main">)</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> <span class="var">?v</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 18 inf.sup_monoid.add_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"arc <span class="var">?i</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 212 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"arc <span class="var">?e</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>18<span class="main">)</span> minarc_arc minarc_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 10 spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?w</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
            <span class="keyword1"><span class="command">have</span></span> 2231<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.boundedE minarc_below pp_dist_inf<span class="main">)</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?w</span> <span class="main">≤</span> <span class="var">?v</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> inf_le1 sup_left_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 2231 10 spanning_forest_def sup_least <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.boundedE minarc_below pp_dist_inf<span class="main">)</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"components <span class="free">g</span> <span class="main">≤</span> forest_components <span class="var">?v</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 9<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"components <span class="free">g</span> <span class="main">≤</span> forest_components <span class="var">?v</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 10 spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> forest_components <span class="var">?w</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_exchange_forest_components_inv<span class="main">)</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="main">(</span><span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?e</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 222 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?i</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 15 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">=</span> <span class="var">?e</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> arc_top_arc minarc_arc minarc_bot_iff semiring.mult_not_zero<span class="main">)</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 19 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">=</span> bot"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 13 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="var">?v</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> <span class="var">?v</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_infI1<span class="main">)</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 223 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"components <span class="free">g</span> <span class="main">≤</span> forest_components <span class="var">?w</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?w</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 3 7 regular_conv_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">have</span></span> 224<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">⊓</span> <span class="free">g</span> <span class="main">≠</span> bot"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>18<span class="main">)</span> inf.left_commute inf_bot_right minarc_meet_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">have</span></span> 225<span class="main">:</span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?e</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="var">?i</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> a_to_e_in_bigforest<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">≠</span> bot"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>19<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"vector <span class="free">j</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>6<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">h</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>8<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">" big_forest <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">d</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>10<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">h</span> <span class="main">⊔</span> <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">d</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>14<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> bf_between_arcs <span class="bound">a</span> <span class="bound">b</span> <span class="main">(</span><span class="var">?H</span><span class="main">)</span> <span class="free">d</span> <span class="main">∧</span> <span class="bound">a</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="main">-</span> <span class="main">-</span> <span class="free">g</span> <span class="main">∧</span> <span class="bound">b</span> <span class="main">≤</span> <span class="free">d</span> <span class="main">⟶</span> sum <span class="main">(</span><span class="bound">b</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="bound">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>15<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">d</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>16<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">=</span> <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"arc <span class="var">?i</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 212 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="var">?i</span> <span class="var">?e</span> <span class="var">?H</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="var">?e</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">=</span> bot"</span></span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>6<span class="main">,</span> 7<span class="main">,</span> 11<span class="main">,</span> 12<span class="main">,</span> 19<span class="main">)</span> dT_He_eq_bot le_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">hence</span></span> 251<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>8<span class="main"><span class="main">)</span></span> forest_components_star star.circ_decompose_9 mult_assoc<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>10<span class="main">)</span> big_forest_def dTransHd_le_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_left_isotone star.circ_circ_mult star_involutive star_one<span class="main">)</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 251 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">⊔</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative comp_left_dist_sup semiring.distrib_right<span class="main">)</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star_left_unfold_equal<span class="main">)</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_right_isotone mult_assoc<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="var">?H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> star_slide mult_assoc<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">*</span> <span class="var">?H</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>8<span class="main"><span class="main">)</span></span> forest_components_star star.circ_decompose_9<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> star_slide <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="free">d</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">⊔</span> <span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> le_supI star.circ_loop_fixpoint sup.cobounded2 sup_commute mult_assoc<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> semiring.distrib_left semiring.distrib_right<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star_left_induct_mult mult_assoc<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> 252<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> mult_left_dist_sup star.circ_transitive_equal star_slide star_sup_1 mult_assoc<span class="main">)</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?F</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_comp conv_dist_inf mult_assoc<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="var">?F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
            <span class="keyword1"><span class="command">using</span></span> comp_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?F</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vector_mult_closed<span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_comp conv_star_commute<span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>13<span class="main"><span class="main">)</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="free">d</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 252 comp_isotone<span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="var">?e</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_isotone star_isotone<span class="main">)</span>
          <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="var">?e</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> top"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">using</span></span> 212 assms<span class="main">(</span>18<span class="main">)</span> bf_between_arcs_def minarc_arc minarc_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> 241<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?H</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 16 assms<span class="main">(</span>9<span class="main">)</span> inf.order_lesseq_imp p_antitone_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 10 inf.coboundedI1 spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">using</span></span> 241 inf_greatest <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">h</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>20<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="main">⊓</span> <span class="var">?e</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span> <span class="main">=</span> bot"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 14 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> sum <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="var">?e</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> sum_disjoint inf_commute inf_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> sum <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="var">?i</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 224 225 sum_plus_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?i</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> sum_disjoint inf_le2 pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">(</span><span class="var">?v</span> <span class="main">⊔</span> <span class="var">?i</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span><span class="var">?i</span> <span class="main">⊔</span> <span class="var">?i</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sup_inf_distrib2<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">(</span><span class="var">?v</span> <span class="main">⊔</span> <span class="var">?i</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 15 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf_top_right stone<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.sup_monoid.add_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">u</span> <span class="main">.</span> spanning_forest <span class="bound">u</span> <span class="free">g</span> <span class="main">⟶</span> sum <span class="main">(</span><span class="var">?w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="bound">u</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 11 minimum_spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">≤</span> <span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> conv_dist_inf inf_le1 sup_left_isotone sup_mono inf.order_lesseq_imp<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 20 sup_left_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?v</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.cobounded1 sup_inf_distrib2<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?w</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sup_assoc sup_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?w</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?v</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?i</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> inf.sup_right_isotone inf_assoc sup_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?w</span> <span class="main">⊔</span> <span class="var">?w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> conv_complement conv_dist_inf conv_dist_sup sup_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">≤</span> <span class="var">?w</span> <span class="main">⊔</span> <span class="var">?w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> boruvka_outer_invariant_when_e_not_bot<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"boruvka_inner_invariant <span class="free">j</span> <span class="free">f</span> <span class="free">h</span> <span class="free">g</span> <span class="free">d</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">≠</span> bot"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">≤</span> <span class="main">-</span> forest_components <span class="free">f</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">≠</span> bot"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"boruvka_outer_invariant <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?c</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"choose_component <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">j</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?p</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?H</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?p</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?d'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?j'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?c</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"boruvka_outer_invariant <span class="var">?f'</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> boruvka_outer_invariant_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> boruvka_inner_invariant_def boruvka_outer_invariant_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="var">?f'</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_injective_inv<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> boruvka_inner_invariant_def boruvka_outer_invariant_def injective_inf_closed<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"covector <span class="main">(</span><span class="var">?p</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> covector_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?p</span> <span class="main">*</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?p</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_right_isotone star.left_plus_below_circ star_plus mult_assoc<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="var">?p</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> mult_left_isotone order.trans star_outer_increasing top.extremum<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?p</span> <span class="main">*</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?e</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?p</span> <span class="main">*</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="var">?p</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_inf mult_right_isotone<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> conv_dist_inf star_isotone comp_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 4<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def kruskal_injective_inv_2 minarc_arc minarc_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="main">(</span><span class="var">?e</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> arc_injective coreflexive_bot_closed minarc_arc minarc_bot_iff semiring.mult_not_zero<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"coreflexive <span class="main">(</span><span class="var">?p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?p</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?p</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="var">?p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?p</span> <span class="main">⊓</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">f</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> conv_dist_inf inf.sup_right_isotone mult_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">f</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative comp_inf.coreflexive_transitive comp_inf.mult_right_isotone comp_isotone conv_isotone inf.cobounded1 inf.idem inf.sup_monoid.add_commute star_isotone top.extremum<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 4<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def kruskal_injective_inv_3 minarc_arc minarc_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="var">?f'</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_acyclic_inv<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> f_intersect_below<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="free">f</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> boruvka_inner_invariant_def boruvka_outer_invariant_def<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">using</span></span> comp_isotone dual_order.trans star_isotone f_intersect_below <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"covector <span class="var">?p</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative vector_top_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">f</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">f</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> arc_top_arc minarc_arc minarc_bot_iff semiring.mult_not_zero<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">f</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative conv_complement conv_dist_comp conv_isotone symmetric_top_closed<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">f</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_comp conv_star_commute<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">f</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> bot"</span></span>
          <span class="keyword1"><span class="command">using</span></span> triple_schroeder_p <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">f</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> bot"</span></span>
          <span class="keyword1"><span class="command">using</span></span> mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_inf star_isotone<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="var">?p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_isotone conv_dist_inf inf.orderI inf.sup_monoid.add_assoc<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="var">?p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">f</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_isotone star_isotone<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">f</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_inf.comp_isotone comp_inf.coreflexive_transitive comp_isotone conv_isotone inf.idem top.extremum<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="free">f</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_inf<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> top <span class="main">*</span> <span class="main">(</span><span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="free">f</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> top_left_mult_increasing mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span>top <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">f</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> covector_comp_inf_1 covector_mult_closed eq_iff inf.sup_monoid.add_commute vector_top_closed<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">f</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">f</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> conv_dist_comp conv_isotone conv_star_commute mult_left_isotone mult_right_isotone star.left_plus_below_circ mult_assoc<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> bot"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 1 covector_bot_closed le_bot mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">using</span></span> le_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?F</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"injective <span class="free">f</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> boruvka_inner_invariant_def boruvka_outer_invariant_def<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"equivalence <span class="var">?F</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 forest_components_equivalence <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">hence</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> arc_conv_closed arc_top_arc covector_complement_closed covector_conv_vector ex231e minarc_arc minarc_bot_iff pp_surjective regular_closed_top vector_mult_closed vector_top_closed<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 3 conv_isotone conv_complement calculation <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">=</span> bot"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 4 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> triple_schroeder_p le_bot pp_total regular_closed_top vector_top_closed<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="free">f</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star_isotone<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="var">?e</span> <span class="main">*</span> <span class="free">f</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> mult_left_isotone mult_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?e</span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_star_commute forest_components_increasing mult_left_isotone mult_right_isotone star_involutive<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> bot"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> 6 le_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?e</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?F</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">f</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="var">?F</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> forest_components_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">using</span></span> 1 order_lesseq_imp p_antitone_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f'</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?p</span><span class="main">)</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> boruvka_inner_invariant_def boruvka_outer_invariant_def inf.coboundedI1<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_isotone inf.sup_monoid.add_assoc<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> boruvka_inner_invariant_def boruvka_outer_invariant_def conv_complement conv_isotone<span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.boundedE minarc_below pp_dist_inf<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> 1 2 3
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?f'</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def minarc_regular regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">w</span><span class="main">.</span> minimum_spanning_forest <span class="bound">w</span> <span class="free">g</span> <span class="main">∧</span> <span class="var">?f'</span> <span class="main">≤</span> <span class="bound">w</span> <span class="main">⊔</span> <span class="bound">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> exists_a_w<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">f</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">f</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">w</span> <span class="main">.</span> minimum_spanning_forest <span class="bound">w</span> <span class="free">g</span> <span class="main">∧</span> <span class="free">f</span> <span class="main">≤</span> <span class="bound">w</span> <span class="main">⊔</span> <span class="bound">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"vector <span class="free">j</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">j</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">h</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span> <span class="main">≤</span> forest_components <span class="free">f</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"big_forest <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">d</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">-</span> <span class="free">j</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span> <span class="main">*</span> <span class="free">j</span> <span class="main">=</span> <span class="free">j</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="free">f</span> <span class="main">=</span> <span class="main">(</span>forest_components <span class="free">h</span> <span class="main">*</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> forest_components <span class="free">h</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">h</span> <span class="main">⊔</span> <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">d</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span> <span class="bound">a</span> <span class="bound">b</span> <span class="main">.</span> bf_between_arcs <span class="bound">a</span> <span class="bound">b</span> <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">d</span> <span class="main">∧</span> <span class="bound">a</span> <span class="main">≤</span> <span class="main">-</span><span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span> <span class="main">∧</span> <span class="bound">b</span> <span class="main">≤</span> <span class="free">d</span> <span class="main">⟶</span> sum<span class="main">(</span><span class="bound">b</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum<span class="main">(</span><span class="bound">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">d</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">≤</span> <span class="main">-</span> forest_components <span class="free">f</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">≠</span> bot"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">≠</span> bot"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">h</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> second_inner_invariant_when_e_not_bot<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"boruvka_inner_invariant <span class="free">j</span> <span class="free">f</span> <span class="free">h</span> <span class="free">g</span> <span class="free">d</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">≠</span> bot"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">≤</span> <span class="main">-</span> forest_components <span class="free">f</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">≠</span> bot"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"boruvka_inner_invariant
         <span class="main">(</span><span class="free">j</span> <span class="main">⊓</span> <span class="main">-</span> choose_component <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">j</span><span class="main">)</span>
         <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">⊔</span>
          <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span>
          selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span>
         <span class="free">h</span> <span class="free">g</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?c</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"choose_component <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">j</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?p</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?H</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?p</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?d'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?j'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?c</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"boruvka_inner_invariant <span class="var">?j'</span> <span class="var">?f'</span> <span class="free">h</span> <span class="free">g</span> <span class="var">?d'</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> boruvka_inner_invariant_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"boruvka_outer_invariant <span class="var">?f'</span> <span class="free">g</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 2<span class="main">,</span> 3<span class="main">,</span> 4<span class="main">)</span> boruvka_outer_invariant_when_e_not_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"boruvka_outer_invariant <span class="var">?f'</span> <span class="free">g</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 2<span class="main">,</span> 3<span class="main">,</span> 4<span class="main">)</span> boruvka_outer_invariant_when_e_not_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">≠</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"vector <span class="var">?j'</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 2<span class="main">)</span> boruvka_inner_invariant_def component_is_vector vector_complement_closed vector_inf_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?j'</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"boruvka_outer_invariant <span class="free">h</span> <span class="free">g</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> boruvka_inner_invariant_def<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="free">h</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> boruvka_inner_invariant_def<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pd_kleene_allegory_class.acyclic <span class="free">h</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> boruvka_inner_invariant_def<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">≤</span> forest_components <span class="var">?f'</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">≤</span> forest_components <span class="var">?f'</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> components_disj_increasing<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?p</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def minarc_regular regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>1<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def minarc_regular regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">[</span></span>1<span class="main"><span class="keyword3">]</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="var">?f'</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 1 boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="free">f</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def dual_order.trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"big_forest <span class="var">?H</span> <span class="var">?d'</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 2<span class="main">,</span> 3<span class="main">,</span> 4<span class="main">)</span> big_forest_d_U_e boruvka_inner_invariant_def boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?d'</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">-</span><span class="var">?j'</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> 31<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?d'</span> <span class="main">*</span> top <span class="main">=</span> <span class="free">d</span> <span class="main">*</span> top <span class="main">⊔</span> <span class="var">?e</span> <span class="main">*</span> top"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_right_dist_sup<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> 32<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">-</span><span class="var">?j'</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> boruvka_inner_invariant_def inf.coboundedI1 p_antitone_iff<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"regular <span class="main">(</span><span class="var">?c</span> <span class="main">*</span> <span class="main">-</span> <span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def component_is_regular regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"minarc<span class="main">(</span><span class="var">?c</span> <span class="main">*</span> <span class="main">-</span> <span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> minarc<span class="main">(</span><span class="var">?c</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> component_is_vector covector_comp_inf inf_top.left_neutral vector_conv_compl<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span> <span class="main">(</span><span class="var">?c</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> minarc_below <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span> <span class="var">?c</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.sup_monoid.add_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?c</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> component_is_regular <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="var">?c</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> top <span class="main">≤</span> <span class="var">?c</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> component_is_vector mult_left_isotone<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="free">j</span> <span class="main">⊔</span> <span class="var">?c</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span> <span class="main">(</span><span class="free">j</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?c</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> component_is_regular <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 33<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">-</span> <span class="main">(</span><span class="free">j</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?c</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> 31 32 33 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="var">?j'</span> <span class="main">=</span> <span class="var">?j'</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> fc_j_eq_j_inv assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="var">?f'</span> <span class="main">=</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="var">?d'</span> <span class="main">⊔</span> <span class="var">?d'</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="var">?f'</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span> <span class="main">⊔</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> simplify_forest_components_f<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?p</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def minarc_regular regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> minarc_regular <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="var">?f'</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 2<span class="main">,</span> 3<span class="main">,</span> 4<span class="main">)</span> boruvka_outer_invariant_def boruvka_outer_invariant_when_e_not_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="free">f</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">h</span> <span class="main">⊔</span> <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">d</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span> <span class="main">⊔</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">h</span> <span class="main">⊔</span> <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?d'</span> <span class="main">⊔</span> <span class="var">?d'</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> conv_dist_sup sup_monoid.add_assoc sup_monoid.add_commute<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">h</span> <span class="main">⊔</span> <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?d'</span> <span class="main">⊔</span> <span class="var">?d'</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">h</span> <span class="main">⊔</span> <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> star.circ_sup_9 sup_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def forest_components_wcc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f'</span> <span class="main">⊔</span> <span class="var">?f'</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">h</span> <span class="main">⊔</span> <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?d'</span> <span class="main">⊔</span> <span class="var">?d'</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f'</span> <span class="main">⊔</span> <span class="var">?f'</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?p</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?p</span><span class="main">)</span> <span class="main">⊔</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_sup sup_monoid.add_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?p</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?p</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> <span class="var">?p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sup.left_commute sup_commute<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span> <span class="main">⊔</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> simplify_f<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?p</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def minarc_regular regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?e</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> minarc_regular <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">h</span> <span class="main">⊔</span> <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">d</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span> <span class="main">⊔</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> conv_dist_sup sup.left_commute sup_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">a</span> <span class="bound">b</span> <span class="main">.</span> bf_between_arcs <span class="bound">a</span> <span class="bound">b</span> <span class="var">?H</span> <span class="var">?d'</span> <span class="main">∧</span> <span class="bound">a</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span> <span class="main">∧</span> <span class="bound">b</span> <span class="main">≤</span> <span class="var">?d'</span> <span class="main">⟶</span> sum <span class="main">(</span><span class="bound">b</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="bound">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> bf_between_arcs_def<span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span>
      <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>arc <span class="skolem">a</span> <span class="main">∧</span> arc <span class="skolem">b</span> <span class="main">∧</span> <span class="skolem">a</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="var">?d'</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">∧</span> <span class="skolem">a</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span> <span class="main">∧</span> <span class="skolem">b</span> <span class="main">≤</span> <span class="var">?d'</span>"</span></span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="skolem">b</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="skolem">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">=</span> <span class="var">?e</span>"</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">case</span></span> b_equals_e<span class="main">:</span> True
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="var">?e</span>"</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">case</span></span> True
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">using</span></span> b_equals_e <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">case</span></span> a_ne_e<span class="main">:</span> False
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="skolem">b</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="skolem">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> a_to_e_in_bigforest<span class="main">)</span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">≠</span> bot"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"vector <span class="free">j</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">h</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">" big_forest <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">d</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">h</span> <span class="main">⊔</span> <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">d</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> bf_between_arcs <span class="bound">a</span> <span class="bound">b</span> <span class="main">(</span><span class="var">?H</span><span class="main">)</span> <span class="free">d</span> <span class="main">∧</span> <span class="bound">a</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="main">-</span> <span class="main">-</span> <span class="free">g</span> <span class="main">∧</span> <span class="bound">b</span> <span class="main">≤</span> <span class="free">d</span> <span class="main">⟶</span> sum <span class="main">(</span><span class="bound">b</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="bound">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">d</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">=</span> <span class="var">?e</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> b_equals_e <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"arc <span class="skolem">a</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="skolem">a</span> <span class="skolem">b</span> <span class="var">?H</span> <span class="var">?d'</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 1 bf_between_arcs_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">h</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> b_not_equal_e<span class="main">:</span> False
        <span class="keyword1"><span class="command">hence</span></span> b_below_d<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">≤</span> <span class="free">d</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> different_arc_in_sup_arc minarc_arc minarc_bot_iff<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="free">d</span>"</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">case</span></span> True
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="skolem">a</span> <span class="skolem">b</span> <span class="var">?H</span> <span class="free">d</span> <span class="main">∧</span> <span class="skolem">b</span> <span class="main">≤</span> <span class="free">d</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 1 bf_between_arcs_def sup.absorb1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">using</span></span> 1 assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">case</span></span> e_not_less_than_d<span class="main">:</span> False
          <span class="keyword1"><span class="command">have</span></span> 71<span class="main">:</span><span class="quoted"><span class="quoted">"equivalence <span class="var">?H</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> fch_equivalence boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> 72<span class="main">:</span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="skolem">a</span> <span class="skolem">b</span> <span class="var">?H</span> <span class="var">?d'</span> <span class="main">⟷</span> bf_between_arcs <span class="skolem">a</span> <span class="skolem">b</span> <span class="var">?H</span> <span class="free">d</span> <span class="main">∨</span> <span class="main">(</span>bf_between_arcs <span class="skolem">a</span> <span class="var">?e</span> <span class="var">?H</span> <span class="free">d</span> <span class="main">∧</span> bf_between_arcs <span class="var">?e</span> <span class="skolem">b</span> <span class="var">?H</span> <span class="free">d</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> big_forest_path_split_disj<span class="main">)</span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"arc <span class="var">?e</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">)</span> minarc_arc minarc_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="skolem">a</span> <span class="main">∧</span> regular <span class="skolem">b</span> <span class="main">∧</span> regular <span class="var">?e</span> <span class="main">∧</span> regular <span class="free">d</span> <span class="main">∧</span> regular <span class="var">?H</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> 1 boruvka_inner_invariant_def boruvka_outer_invariant_def arc_regular minarc_regular regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="skolem">a</span> <span class="skolem">b</span> <span class="var">?H</span> <span class="free">d</span>"</span></span><span class="main">)</span>
            <span class="keyword3"><span class="command">case</span></span> True
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="skolem">a</span> <span class="skolem">b</span> <span class="var">?H</span> <span class="free">d</span> <span class="main">∧</span> <span class="skolem">b</span> <span class="main">≤</span> <span class="free">d</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> True b_not_equal_e minarc_arc minarc_bot_iff different_arc_in_sup_arc<span class="main">)</span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
              <span class="keyword1"><span class="command">using</span></span> 1 assms<span class="main">(</span>1<span class="main">)</span> b_below_d boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">case</span></span> False
            <span class="keyword1"><span class="command">have</span></span> 73<span class="main">:</span><span class="quoted"><span class="quoted">"bf_between_arcs <span class="skolem">a</span> <span class="var">?e</span> <span class="var">?H</span> <span class="free">d</span> <span class="main">∧</span> bf_between_arcs <span class="var">?e</span> <span class="skolem">b</span> <span class="var">?H</span> <span class="free">d</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 1 72 False bf_between_arcs_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> 74<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.boundedE minarc_below pp_dist_inf<span class="main">)</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span> 3<span class="main"><span class="main">)</span></span> boruvka_inner_invariant_def dual_order.trans p_antitone_iff<span class="main">)</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 74 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">hence</span></span> 75<span class="main">:</span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="skolem">b</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="var">?e</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> b_below_d 73 boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> 76<span class="main">:</span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="skolem">a</span> <span class="var">?e</span> <span class="var">?H</span> <span class="var">?d'</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> 73 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> big_forest_path_split_disj assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> bf_between_arcs_def boruvka_inner_invariant_def boruvka_outer_invariant_def fch_equivalence arc_regular regular_closed_star regular_conv_closed regular_mult_closed<span class="main">)</span>
            <span class="keyword1"><span class="command">have</span></span> 77<span class="main">:</span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="var">?e</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="skolem">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> a_to_e_in_bigforest<span class="main">)</span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">≠</span> bot"</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"vector <span class="free">j</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"forest <span class="free">h</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">" big_forest <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">d</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊔</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">h</span> <span class="main">⊔</span> <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="free">d</span> <span class="main">⊔</span> <span class="free">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> bf_between_arcs <span class="bound">a</span> <span class="bound">b</span> <span class="main">(</span><span class="var">?H</span><span class="main">)</span> <span class="free">d</span> <span class="main">∧</span> <span class="bound">a</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="main">-</span> <span class="main">-</span> <span class="free">g</span> <span class="main">∧</span> <span class="bound">b</span> <span class="main">≤</span> <span class="free">d</span> <span class="main">⟶</span> sum <span class="main">(</span><span class="bound">b</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="bound">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">d</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">=</span> <span class="var">?e</span>"</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"arc <span class="skolem">a</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"bf_between_arcs <span class="skolem">a</span> <span class="var">?e</span> <span class="var">?H</span> <span class="var">?d'</span>"</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 76<span class="main">)</span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?H</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">h</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
              <span class="keyword1"><span class="command">using</span></span> 75 order.trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?d'</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> boruvka_inner_invariant_def minarc_regular <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> second_inner_invariant_when_e_bot<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">=</span> bot"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">≤</span> <span class="main">-</span> forest_components <span class="free">f</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"boruvka_inner_invariant <span class="free">j</span> <span class="free">f</span> <span class="free">h</span> <span class="free">g</span> <span class="free">d</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"boruvka_inner_invariant
     <span class="main">(</span><span class="free">j</span> <span class="main">⊓</span> <span class="main">-</span> choose_component <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">j</span><span class="main">)</span>
     <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span> path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span> <span class="main">⊔</span>
      <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span> selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span>
      selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span>
     <span class="free">h</span> <span class="free">g</span> <span class="main">(</span><span class="free">d</span> <span class="main">⊔</span> selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?c</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"choose_component <span class="main">(</span>forest_components <span class="free">h</span><span class="main">)</span> <span class="free">j</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?p</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"path <span class="free">f</span> <span class="free">h</span> <span class="free">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?H</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">h</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"selected_edge <span class="free">h</span> <span class="free">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?p</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?d'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?j'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?c</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"boruvka_inner_invariant <span class="var">?j'</span> <span class="var">?f'</span> <span class="free">h</span> <span class="free">g</span> <span class="var">?d'</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> boruvka_inner_invariant_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"boruvka_outer_invariant <span class="var">?f'</span> <span class="free">g</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 3<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">≠</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"vector <span class="var">?j'</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> boruvka_inner_invariant_def component_is_vector vector_complement_closed vector_inf_closed<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?j'</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"boruvka_outer_invariant <span class="free">h</span> <span class="free">g</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="free">h</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pd_kleene_allegory_class.acyclic <span class="free">h</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">≤</span> forest_components <span class="var">?f'</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 3<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">" big_forest <span class="var">?H</span> <span class="var">?d'</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 3<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?d'</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">-</span><span class="var">?j'</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span> 3<span class="main"><span class="main">)</span></span> boruvka_inner_invariant_def order.trans p_antitone_inf sup_monoid.add_0_right<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="var">?j'</span> <span class="main">=</span> <span class="var">?j'</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> fc_j_eq_j_inv boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"forest_components <span class="var">?f'</span> <span class="main">=</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="var">?d'</span> <span class="main">⊔</span> <span class="var">?d'</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span><span class="var">?H</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 3<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f'</span> <span class="main">⊔</span> <span class="var">?f'</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">h</span> <span class="main">⊔</span> <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?d'</span> <span class="main">⊔</span> <span class="var">?d'</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 3<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> bf_between_arcs <span class="bound">a</span> <span class="bound">b</span> <span class="var">?H</span> <span class="var">?d'</span> <span class="main">∧</span> <span class="bound">a</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?H</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span> <span class="main">∧</span> <span class="bound">b</span> <span class="main">≤</span> <span class="var">?d'</span> <span class="main">⟶</span> sum<span class="main">(</span><span class="bound">b</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum<span class="main">(</span><span class="bound">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 3<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?d'</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span> 3<span class="main">)</span> boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Formalization and correctness proof›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
The following result shows that Bor\r{u}vka's algorithm constructs a minimum spanning forest.
We have the same postcondition as the proof of Kruskal's minimum spanning tree algorithm.
We show only partial correctness.
›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> boruvka_mst<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">VARS</span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">f</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">j</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">h</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">c</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">e</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">d</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
  <span class="main">{</span> symmetric <span class="free">g</span> <span class="main">}</span>
  f <span class="main">:=</span> bot<span class="main">;</span>
  <span class="keyword1">WHILE</span> <span class="main">-</span><span class="main">(</span>forest_components <span class="bound">f</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">g</span> <span class="main">≠</span> bot
    <span class="keyword1">INV</span> <span class="main">{</span> boruvka_outer_invariant <span class="bound">f</span> <span class="free">g</span> <span class="main">}</span>
    <span class="keyword1">DO</span>
      j <span class="main">:=</span> top<span class="main">;</span>
      h <span class="main">:=</span> <span class="bound">f</span><span class="main">;</span>
      d <span class="main">:=</span> bot<span class="main">;</span>
      <span class="keyword1">WHILE</span> <span class="bound">j</span> <span class="main">≠</span> bot
        <span class="keyword1">INV</span> <span class="main">{</span> boruvka_inner_invariant <span class="bound">j</span> <span class="bound">f</span> <span class="bound">h</span> <span class="free">g</span> <span class="bound">d</span> <span class="main">}</span>
        <span class="keyword1">DO</span>
          c <span class="main">:=</span> choose_component <span class="main">(</span>forest_components <span class="bound">h</span><span class="main">)</span> <span class="bound">j</span><span class="main">;</span>
          e <span class="main">:=</span> minarc<span class="main">(</span><span class="bound">c</span> <span class="main">*</span> <span class="main">-</span><span class="bound">c</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">;</span>
          <span class="keyword1">IF</span> <span class="bound">e</span> <span class="main">≤</span> <span class="main">-</span><span class="main">(</span>forest_components <span class="bound">f</span><span class="main">)</span> <span class="keyword1">THEN</span>
            f <span class="main">:=</span> <span class="bound">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="bound">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">;</span>
            f <span class="main">:=</span> <span class="main">(</span><span class="bound">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> <span class="bound">e</span> <span class="main">*</span> <span class="bound">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="bound">f</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="bound">e</span> <span class="main">*</span> <span class="bound">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="bound">e</span><span class="main">;</span>
            d <span class="main">:=</span> <span class="bound">d</span> <span class="main">⊔</span> <span class="bound">e</span>
          <span class="keyword1">ELSE</span>
            <span class="keyword1">SKIP</span>
          <span class="keyword1">FI</span><span class="main">;</span>
          j <span class="main">:=</span> <span class="bound">j</span> <span class="main">⊓</span> <span class="main">-</span><span class="bound">c</span>
        <span class="keyword1">OD</span>
    <span class="keyword1">OD</span>
  <span class="main">{</span> minimum_spanning_forest <span class="bound">f</span> <span class="free">g</span> <span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">vcg_simp</span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"boruvka_outer_invariant bot <span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 boruvka_outer_invariant_def kruskal_exists_minimal_spanning <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="skolem">f</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"boruvka_outer_invariant <span class="skolem">f</span> <span class="free">g</span> <span class="main">∧</span> <span class="main">-</span> <span class="var">?F</span> <span class="main">⊓</span> <span class="free">g</span> <span class="main">≠</span> bot"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"equivalence <span class="var">?F</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 boruvka_outer_invariant_def forest_components_equivalence <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"boruvka_inner_invariant top <span class="skolem">f</span> <span class="skolem">f</span> <span class="free">g</span> bot"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> boruvka_inner_invariant_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"boruvka_outer_invariant <span class="skolem">f</span> <span class="free">g</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 1<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">≠</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"surjective top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"boruvka_outer_invariant <span class="skolem">f</span> <span class="free">g</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="skolem">f</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pd_kleene_allegory_class.acyclic <span class="skolem">f</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">≤</span> <span class="var">?F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"big_forest <span class="var">?F</span> bot"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 2 big_forest_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"bot <span class="main">*</span> top <span class="main">≤</span> <span class="main">-</span> top"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"times_top_class.total <span class="main">(</span><span class="var">?F</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star.circ_right_top mult_assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">=</span> <span class="main">(</span><span class="var">?F</span> <span class="main">*</span> <span class="main">(</span>bot <span class="main">⊔</span> bot<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_right_zero semiring.mult_zero_left star.circ_loop_fixpoint sup_commute sup_monoid.add_0_right symmetric_bot_closed<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">⊔</span> <span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="skolem">f</span> <span class="main">⊔</span> <span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> bot <span class="main">⊔</span> bot<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> bf_between_arcs <span class="bound">a</span> <span class="bound">b</span> <span class="var">?F</span> bot <span class="main">∧</span> <span class="bound">a</span> <span class="main">≤</span> <span class="main">-</span> <span class="var">?F</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span> <span class="free">g</span> <span class="main">∧</span> <span class="bound">b</span> <span class="main">≤</span> bot <span class="main">⟶</span> sum <span class="main">(</span><span class="bound">b</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum <span class="main">(</span><span class="bound">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> bf_between_arcs_def bot_unique mult_left_zero mult_right_zero top.extremum<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular bot"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">j</span> <span class="skolem">h</span> <span class="skolem">d</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?c</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"choose_component <span class="main">(</span>forest_components <span class="skolem">h</span><span class="main">)</span> <span class="skolem">j</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?p</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"path <span class="skolem">f</span> <span class="skolem">h</span> <span class="skolem">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="skolem">f</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?H</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="skolem">h</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"selected_edge <span class="skolem">h</span> <span class="skolem">j</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?p</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="var">?p</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?d'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">d</span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?j'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">j</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?c</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"boruvka_inner_invariant <span class="skolem">j</span> <span class="skolem">f</span> <span class="skolem">h</span> <span class="free">g</span> <span class="skolem">d</span> <span class="main">∧</span> <span class="skolem">j</span> <span class="main">≠</span> bot"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟶</span> boruvka_inner_invariant <span class="var">?j'</span> <span class="var">?f'</span> <span class="skolem">h</span> <span class="free">g</span> <span class="var">?d'</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">¬</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟶</span> boruvka_inner_invariant <span class="var">?j'</span> <span class="skolem">f</span> <span class="skolem">h</span> <span class="free">g</span> <span class="skolem">d</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> conjI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟶</span> boruvka_inner_invariant <span class="var">?j'</span> <span class="var">?f'</span> <span class="skolem">h</span> <span class="free">g</span> <span class="var">?d'</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">=</span> bot"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> True
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 second_inner_invariant_when_e_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> False
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 second_inner_invariant_when_e_not_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟶</span> boruvka_inner_invariant <span class="var">?j'</span> <span class="skolem">f</span> <span class="skolem">h</span> <span class="free">g</span> <span class="skolem">d</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> impI<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> boruvka_inner_invariant_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"boruvka_outer_invariant <span class="skolem">f</span> <span class="free">g</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">≠</span> bot"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"vector <span class="var">?j'</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 boruvka_inner_invariant_def component_is_vector vector_complement_closed vector_inf_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?j'</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"boruvka_outer_invariant <span class="skolem">h</span> <span class="free">g</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="skolem">h</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"pd_kleene_allegory_class.acyclic <span class="skolem">h</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">≤</span> <span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"big_forest <span class="var">?H</span> <span class="skolem">d</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">d</span> <span class="main">*</span> top <span class="main">≤</span> <span class="main">-</span><span class="var">?j'</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> boruvka_inner_invariant_def dual_order.trans p_antitone_inf<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?H</span> <span class="main">*</span> <span class="var">?j'</span> <span class="main">=</span> <span class="var">?j'</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 fc_j_eq_j_inv boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">=</span> <span class="main">(</span><span class="var">?H</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">d</span> <span class="main">⊔</span> <span class="skolem">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="var">?H</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">⊔</span> <span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="skolem">h</span> <span class="main">⊔</span> <span class="skolem">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="skolem">d</span> <span class="main">⊔</span> <span class="skolem">d</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟹</span> <span class="main">∀</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> bf_between_arcs <span class="bound">a</span> <span class="bound">b</span> <span class="var">?H</span> <span class="skolem">d</span> <span class="main">∧</span> <span class="bound">a</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?H</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span> <span class="main">∧</span> <span class="bound">b</span> <span class="main">≤</span> <span class="skolem">d</span> <span class="main">⟶</span> sum<span class="main">(</span><span class="bound">b</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> sum<span class="main">(</span><span class="bound">a</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟹</span> regular <span class="skolem">d</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 boruvka_inner_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">h</span> <span class="skolem">d</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"boruvka_inner_invariant bot <span class="skolem">f</span> <span class="skolem">h</span> <span class="free">g</span> <span class="skolem">d</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"boruvka_outer_invariant <span class="skolem">f</span> <span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> boruvka_inner_invariant_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"boruvka_outer_invariant <span class="skolem">f</span> <span class="free">g</span> <span class="main">∧</span> <span class="main">-</span> forest_components <span class="skolem">f</span> <span class="main">⊓</span> <span class="free">g</span> <span class="main">=</span> bot"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span><span class="quoted"><span class="quoted">"spanning_forest <span class="skolem">f</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> spanning_forest_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="skolem">f</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="skolem">f</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"components <span class="free">g</span> <span class="main">≤</span> forest_components <span class="skolem">f</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="skolem">f</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="var">?F</span> <span class="main">⊓</span> <span class="free">g</span> <span class="main">≤</span> bot"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 1<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="main">-</span><span class="free">g</span> <span class="main">≤</span> bot <span class="main">⊔</span> <span class="main">-</span><span class="main">-</span><span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 shunting_p p_antitone pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="main">-</span><span class="free">g</span> <span class="main">≤</span> <span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 boruvka_outer_invariant_def pp_dist_comp pp_dist_star regular_conv_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="free">g</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="var">?F</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star_isotone<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 boruvka_outer_invariant_def forest_components_star <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="skolem">f</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> 1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">w</span></span> <span class="keyword2"><span class="keyword">where</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"minimum_spanning_forest <span class="skolem">w</span> <span class="free">g</span> <span class="main">∧</span> <span class="skolem">f</span> <span class="main">≤</span> <span class="skolem">w</span> <span class="main">⊔</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">=</span> <span class="skolem">w</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.absorb1 minimum_spanning_forest_def spanning_forest_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">w</span> <span class="main">⊓</span> components <span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.sup_right_isotone star.circ_increasing<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">w</span> <span class="main">⊓</span> <span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="skolem">f</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 2 spanning_forest_def inf.sup_right_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">f</span> <span class="main">⊔</span> <span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> cancel_separate_6<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> z<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">w</span></span></span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">and</span></span></span></span> y<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">"<span class="skolem"><span class="skolem">w</span></span><span class="keyword1"><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="skolem">w</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 3 minimum_spanning_forest_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="skolem">w</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_dist_inf conv_dist_sup conv_involutive inf.cobounded2 inf.orderE<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">≤</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="skolem">w</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sup_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="skolem">w</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 3 minimum_spanning_forest_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">⊓</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> acyclic_star_below_complement comp_inf.mult_right_isotone inf_p le_bot minimum_spanning_forest_def spanning_forest_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">≤</span> <span class="skolem">f</span> <span class="main">⊔</span> <span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sum <span class="main">(</span><span class="skolem">f</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">(</span><span class="skolem">w</span> <span class="main">⊔</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf_absorb2 inf.assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 3 inf.commute acyclic_asymmetric sum_disjoint minimum_spanning_forest_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">g</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_dist_inf conv_involutive sum_conv<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">f</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> sum <span class="main">(</span><span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> 51<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="free">g</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 boruvka_outer_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> 52<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">w</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.left_commute<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> 51 52 abel_semigroup.left_commute inf.abel_semigroup_axioms <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="main">(</span><span class="skolem">f</span> <span class="main">⊔</span> <span class="skolem">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 2 acyclic_asymmetric inf.sup_monoid.add_commute sum_disjoint spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sum <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 4 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf_absorb2 inf.assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"minimum_spanning_forest <span class="skolem">f</span> <span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 2 3 minimum_spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

</pre>
</div>
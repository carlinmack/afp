<div id="Propositional_Resolution">
<div class="head">
<h1>Theory Propositional_Resolution</h1>
</div>
<pre class="source"><span class="comment1">(* N. Peltier. LIG/CNRS http://membres-lig.imag.fr/peltier/ *)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Syntax of Propositional Clausal Logic›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We define the usual syntactic notions of clausal propositional logic.
The set of atoms may be arbitrary (even uncountable), but a well-founded total order is assumed 
to be given.›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Propositional_Resolution

<span class="keyword2"><span class="keyword">imports</span></span> <a href="../../HOL/HOL/Main.html">Main</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">locale</span></span> propositional_atoms <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">atom_ordering</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'at</span> <span class="main">×</span> <span class="tfree">'at</span><span class="main">)</span> set"</span></span> 
  <span class="keyword2"><span class="keyword">assumes</span></span>
        atom_ordering_wf <span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>wf <span class="free">atom_ordering</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span>   atom_ordering_total<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main">≠</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">y</span><span class="main">,</span><span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>   atom_ordering_trans<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">y</span><span class="main">,</span><span class="bound">z</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>
          <span class="main">⟶</span> <span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">z</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>   atom_ordering_irrefl<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">y</span><span class="main">,</span><span class="bound">x</span><span class="main">)</span> <span class="main">∉</span> <span class="free">atom_ordering</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Literals are defined as usual and clauses and formulas are considered as sets. 
Clause sets are not assumed to be finite (so that the results can 
be applied to sets of clauses obtained by grounding first-order clauses).›</span></span>

<span class="keyword1"><span class="command">datatype</span></span> <span class="tfree">'a</span> Literal <span class="main">=</span> Pos <span class="quoted"><span class="quoted">"<span class="tfree">'a</span>"</span></span> <span class="main">|</span> Neg <span class="quoted"><span class="quoted">"<span class="tfree">'a</span>"</span></span> 

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">atoms</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">x</span><span class="main">::</span><span class="tfree">'at</span><span class="main">.</span> True <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">atom</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> Literal <span class="main">⇒</span> <span class="tfree">'a</span>"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">atom</span> <span class="main">(</span>Pos <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">atom</span> <span class="main">(</span>Neg <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>"</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">complement</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> Literal <span class="main">⇒</span> <span class="tfree">'a</span> Literal"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">complement</span> <span class="main">(</span>Pos <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span>"</span></span> <span class="main">|</span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">complement</span> <span class="main">(</span>Neg <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> atom_property <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="main">(</span>atom <span class="free">L</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">L</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="free">A</span><span class="main">)</span> <span class="main">∨</span> <span class="free">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> atom.elims<span class="main">)</span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">positive</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Literal <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">positive</span> <span class="main">(</span>Pos <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> True"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">positive</span> <span class="main">(</span>Neg <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> False"</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">negative</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Literal <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">negative</span> <span class="main">(</span>Pos <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> False"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">negative</span> <span class="main">(</span>Neg <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> True"</span></span>

<span class="keyword1"><span class="command">type_synonym</span></span> <span class="tfree">'a</span> Clause <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> Literal set"</span></span>

<span class="keyword1"><span class="command">type_synonym</span></span> <span class="tfree">'a</span> Formula <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> Clause set"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Note that the clauses are not assumed to be finite (some of the properties below
hold for infinite clauses).›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The following functions return the set of atoms occurring in a clause or formula.›</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">atoms_clause</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> set"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">atoms_clause</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">=</span> <span class="main">{</span> <span class="bound">A</span><span class="main">.</span> <span class="main">∃</span><span class="bound">L</span><span class="main">.</span> <span class="bound">L</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">∧</span> <span class="bound">A</span> <span class="main">=</span> atom<span class="main">(</span><span class="bound">L</span><span class="main">)</span> <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">atoms_formula</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Formula <span class="main">⇒</span> <span class="tfree">'at</span> set"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">atoms_formula</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">=</span> <span class="main">{</span> <span class="bound">A</span><span class="main">.</span> <span class="main">∃</span><span class="bound">C</span><span class="main">.</span> <span class="bound">C</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∧</span> <span class="bound">A</span> <span class="main">∈</span> atoms_clause<span class="main">(</span><span class="bound">C</span><span class="main">)</span> <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> atoms_formula_subset<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">S1</span> <span class="main">⊆</span> <span class="free">S2</span> <span class="main">⟹</span> atoms_formula <span class="free">S1</span> <span class="main">⊆</span> atoms_formula <span class="free">S2</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> atoms_formula_union<span class="main">:</span> <span class="quoted"><span class="quoted">"atoms_formula <span class="main">(</span><span class="free">S1</span> <span class="main">∪</span> <span class="free">S2</span><span class="main">)</span> <span class="main">=</span> atoms_formula <span class="free">S1</span> <span class="main">∪</span> atoms_formula <span class="free">S2</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The following predicate is useful to state that every clause in a set fulfills 
some property.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">all_fulfill</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'at</span> Clause <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'at</span> Formula <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">all_fulfill</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">C</span><span class="main">.</span> <span class="main">(</span><span class="bound">C</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">⟶</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="bound">C</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The order on atoms induces a (non total) order among literals:›</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">literal_ordering</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Literal <span class="main">⇒</span> <span class="tfree">'at</span> Literal <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">literal_ordering</span> <span class="free"><span class="bound"><span class="entity">L1</span></span></span> <span class="free"><span class="bound"><span class="entity">L2</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>atom <span class="free"><span class="bound"><span class="entity">L1</span></span></span><span class="main">,</span>atom <span class="free"><span class="bound"><span class="entity">L2</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> literal_ordering_trans <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"literal_ordering <span class="free">A</span> <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"literal_ordering <span class="free">B</span> <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"literal_ordering <span class="free">A</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> assms<span class="main">(</span>2<span class="main">)</span> atom_ordering_trans literal_ordering.simps <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">strictly_maximal_literal</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Literal <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">strictly_maximal_literal</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">B</span><span class="main">.</span> <span class="main">(</span> <span class="bound">B</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">≠</span> <span class="bound">B</span><span class="main">)</span>  <span class="main">⟶</span> <span class="main">(</span>literal_ordering <span class="bound">B</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Semantics›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We define the notions of interpretation, satisfiability and entailment and establish  
some basic properties.›</span></span>

<span class="keyword1"><span class="command">type_synonym</span></span> <span class="tfree">'a</span> Interpretation  <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set"</span></span> 

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">validate_literal</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Interpretation <span class="main">⇒</span> <span class="tfree">'at</span> Literal <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">⊨</span>"</span> 65<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">validate_literal</span> <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="main">(</span>Pos <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">I</span></span></span><span class="main">)</span>"</span></span> <span class="main">|</span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">validate_literal</span> <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="main">(</span>Neg <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∉</span> <span class="free"><span class="bound"><span class="entity">I</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">validate_clause</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Interpretation <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">⊨</span>"</span> 65<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">validate_clause</span> <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span><span class="bound">L</span><span class="main">.</span> <span class="main">(</span><span class="bound">L</span> <span class="main">∈</span>  <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>validate_literal <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="bound">L</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">validate_formula</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Interpretation <span class="main">⇒</span> <span class="tfree">'at</span> Formula <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">⊨</span>"</span> 65<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">validate_formula</span> <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">C</span><span class="main">.</span> <span class="main">(</span><span class="bound">C</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">⟶</span> <span class="main">(</span>validate_clause <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="bound">C</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>     

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">satisfiable</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Formula <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">satisfiable</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">(</span><span class="main">∃</span><span class="bound">I</span><span class="main">.</span> <span class="main">(</span>validate_formula <span class="bound">I</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We define the usual notions of entailment between clauses and formulas.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">entails</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Formula <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">entails</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">(</span><span class="main">∀</span><span class="bound">I</span><span class="main">.</span> <span class="main">(</span>validate_formula <span class="bound">I</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span>validate_clause <span class="bound">I</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> entails_member<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"entails <span class="free">S</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> entails_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">entails_formula</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Formula <span class="main">⇒</span> <span class="tfree">'at</span> Formula <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">entails_formula</span> <span class="free"><span class="bound"><span class="entity">S1</span></span></span> <span class="free"><span class="bound"><span class="entity">S2</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">C</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S2</span></span></span><span class="main">.</span> <span class="main">(</span>entails <span class="free"><span class="bound"><span class="entity">S1</span></span></span> <span class="bound">C</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">equivalent</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Formula <span class="main">⇒</span> <span class="tfree">'at</span> Formula <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">equivalent</span> <span class="free"><span class="bound"><span class="entity">S1</span></span></span> <span class="free"><span class="bound"><span class="entity">S2</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>entails_formula <span class="free"><span class="bound"><span class="entity">S1</span></span></span> <span class="free"><span class="bound"><span class="entity">S2</span></span></span> <span class="main">∧</span> entails_formula <span class="free"><span class="bound"><span class="entity">S2</span></span></span> <span class="free"><span class="bound"><span class="entity">S1</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> equivalent_symmetric<span class="main">:</span> <span class="quoted"><span class="quoted">"equivalent <span class="free">S1</span> <span class="free">S2</span> <span class="main">⟹</span> equivalent <span class="free">S2</span> <span class="free">S1</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> equivalent_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> entailment_implies_validity<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="free">S1</span> <span class="free">S2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"validate_formula <span class="free">I</span> <span class="free">S1</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"validate_formula <span class="free">I</span> <span class="free">S2</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms entails_def entails_formula_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> validity_implies_entailment<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">I</span><span class="main">.</span> validate_formula <span class="bound">I</span> <span class="free">S1</span> <span class="main">⟶</span> validate_formula <span class="bound">I</span> <span class="free">S2</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="free">S1</span> <span class="free">S2</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms entails_def entails_formula_def validate_formula.elims<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> entails_transitive<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="free">S1</span> <span class="free">S2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="free">S2</span> <span class="free">S3</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="free">S1</span> <span class="free">S3</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms entailment_implies_validity validity_implies_entailment<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> equivalent_transitive<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"equivalent <span class="free">S1</span> <span class="free">S2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"equivalent <span class="free">S2</span> <span class="free">S3</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"equivalent <span class="free">S1</span> <span class="free">S3</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms entails_transitive equivalent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> entailment_subset <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">S2</span> <span class="main">⊆</span> <span class="free">S1</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="free">S1</span> <span class="free">S2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">L</span> <span class="bound">La</span><span class="main">.</span> <span class="bound">L</span> <span class="main">∉</span> <span class="bound">La</span> <span class="main">∨</span> entails <span class="bound">La</span> <span class="bound">L</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> entails_member<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms entails_formula_def rev_subsetD<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> entailed_formula_entails_implicates<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="free">S1</span> <span class="free">S2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"entails <span class="free">S2</span> <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"entails <span class="free">S1</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms entailment_implies_validity entails_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Inference Rules›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We first define an abstract notion of a binary inference rule.›</span></span>

<span class="keyword1"><span class="command">type_synonym</span></span> <span class="tfree">'a</span> BinaryRule <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> Clause <span class="main">⇒</span> <span class="tfree">'a</span> Clause <span class="main">⇒</span> <span class="tfree">'a</span> Clause <span class="main">⇒</span> bool"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">less_restrictive</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> BinaryRule <span class="main">⇒</span> <span class="tfree">'at</span> BinaryRule <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">less_restrictive</span> <span class="free"><span class="bound"><span class="entity">R1</span></span></span> <span class="free"><span class="bound"><span class="entity">R2</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">P1</span> <span class="bound">P2</span> <span class="bound">C</span><span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">R2</span></span></span> <span class="bound">P1</span> <span class="bound">P2</span> <span class="bound">C</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">R1</span></span></span> <span class="bound">P1</span> <span class="bound">P2</span> <span class="bound">C</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">R1</span></span></span> <span class="bound">P2</span> <span class="bound">P1</span> <span class="bound">C</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The following functions allow to generate all the clauses that are deducible
from a given clause set (in one step).›</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">all_deducible_clauses</span><span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> BinaryRule <span class="main">⇒</span> <span class="tfree">'at</span> Formula <span class="main">⇒</span> <span class="tfree">'at</span> Formula"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">all_deducible_clauses</span> <span class="free"><span class="bound"><span class="entity">R</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">=</span> <span class="main">{</span> <span class="bound">C</span><span class="main">.</span> <span class="main">∃</span><span class="bound">P1</span> <span class="bound">P2</span><span class="main">.</span> <span class="bound">P1</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∧</span> <span class="bound">P2</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">R</span></span></span> <span class="bound">P1</span> <span class="bound">P2</span> <span class="bound">C</span><span class="main">)</span> <span class="main">}</span>"</span></span> 

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">add_all_deducible_clauses</span><span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> BinaryRule <span class="main">⇒</span> <span class="tfree">'at</span> Formula <span class="main">⇒</span> <span class="tfree">'at</span> Formula"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">add_all_deducible_clauses</span> <span class="free"><span class="bound"><span class="entity">R</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∪</span> all_deducible_clauses <span class="free"><span class="bound"><span class="entity">R</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">derived_clauses_are_finite</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> BinaryRule <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">derived_clauses_are_finite</span> <span class="free"><span class="bound"><span class="entity">R</span></span></span> <span class="main">=</span> 
    <span class="main">(</span><span class="main">∀</span><span class="bound">P1</span> <span class="bound">P2</span> <span class="bound">C</span><span class="main">.</span> <span class="main">(</span>finite <span class="bound">P1</span> <span class="main">⟶</span> finite <span class="bound">P2</span> <span class="main">⟶</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">R</span></span></span> <span class="bound">P1</span> <span class="bound">P2</span> <span class="bound">C</span><span class="main">)</span> <span class="main">⟶</span> finite <span class="bound">C</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> less_restrictive_and_finite <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"less_restrictive <span class="free">R1</span> <span class="free">R2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"derived_clauses_are_finite <span class="free">R1</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"derived_clauses_are_finite <span class="free">R2</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms derived_clauses_are_finite_def less_restrictive_def<span class="main">)</span>  <span class="comment1">(* takes a few seconds *)</span>
 
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We then define the unrestricted resolution rule and usual resolution refinements.›</span></span> 

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Unrestricted Resolution›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">resolvent</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> BinaryRule"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">resolvent</span> <span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">≡</span> 
    <span class="main">(</span><span class="main">∃</span><span class="bound">A</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span>Pos <span class="bound">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="main">∧</span> <span class="main">(</span>Neg <span class="bound">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">=</span> <span class="main">(</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="main">-</span> <span class="main">{</span> Pos <span class="bound">A</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="main">-</span> <span class="main">{</span> Neg <span class="bound">A</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹For technical convience, we now introduce a slightly extended definition in which resolution 
upon a literal  not occurring in the premises is allowed (the obtained resolvent is then redundant 
with the premises). If the atom is fixed then this version of the resolution rule can be turned into 
a total function.›</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">resolvent_upon</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> <span class="main">⇒</span> <span class="tfree">'at</span> Clause"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">resolvent_upon</span> <span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">=</span>
      <span class="main">(</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> resolvent_upon_is_resolvent <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Pos <span class="free">A</span> <span class="main">∈</span> <span class="free">P1</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Neg <span class="free">A</span> <span class="main">∈</span> <span class="free">P2</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"resolvent <span class="free">P1</span> <span class="free">P2</span> <span class="main">(</span>resolvent_upon <span class="free">P1</span> <span class="free">P2</span> <span class="free">A</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> resolvent_is_resolvent_upon <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"resolvent <span class="free">P1</span> <span class="free">P2</span> <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">A</span><span class="main">.</span> <span class="free">C</span> <span class="main">=</span> resolvent_upon <span class="free">P1</span> <span class="free">P2</span> <span class="bound">A</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> resolvent_is_finite <span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"derived_clauses_are_finite resolvent"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>derived_clauses_are_finite resolvent"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">P1</span> <span class="bound">P2</span> <span class="bound">C</span><span class="main">.</span> <span class="main">¬</span><span class="main">(</span>resolvent <span class="bound">P1</span> <span class="bound">P2</span> <span class="bound">C</span> <span class="main">⟶</span> finite <span class="bound">P1</span> <span class="main">⟶</span> finite <span class="bound">P2</span> <span class="main">⟶</span> finite <span class="bound">C</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> derived_clauses_are_finite_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
 <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">P1</span>"</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">P2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>finite <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>    
 <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">P1</span>›</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">P2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>finite <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
 <span class="keyword1"><span class="command">unfolding</span></span> resolvent_def <span class="keyword1"><span class="command">using</span></span> finite_Diff <span class="keyword2"><span class="keyword">and</span></span> finite_Union <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹In the next subsections we introduce various resolution refinements and show that they are 
more restrictive than unrestricted resolution.›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Ordered Resolution›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹In the first refinement, resolution is only allowed on maximal literals.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ordered_resolvent</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> bool"</span></span> 
  <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">ordered_resolvent</span> <span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">≡</span> 
    <span class="main">(</span><span class="main">∃</span><span class="bound">A</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">=</span> <span class="main">(</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="main">-</span> <span class="main">{</span> Pos <span class="bound">A</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="main">-</span> <span class="main">{</span> Neg <span class="bound">A</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
      <span class="main">∧</span> <span class="main">(</span>strictly_maximal_literal <span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="main">(</span>Pos <span class="bound">A</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>strictly_maximal_literal <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="main">(</span>Neg <span class="bound">A</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We now show that the maximal literal of the resolvent is always smaller than those of 
the premises.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> resolution_and_max_literal <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span> <span class="main">=</span> resolvent_upon <span class="free">P1</span> <span class="free">P2</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="free">P1</span> <span class="main">(</span>Pos <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="free">P2</span> <span class="main">(</span>Neg <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="free">R</span> <span class="free">M</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>atom <span class="free">M</span><span class="main">,</span> <span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">MA</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="skolem">MA</span><span class="main">)</span> <span class="main">∨</span> <span class="free">M</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">MA</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Literal.exhaust <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">M</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">MA</span> <span class="main">=</span> <span class="main">(</span>atom <span class="free">M</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="free">R</span> <span class="free">M</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">R</span> <span class="main">=</span> resolvent_upon <span class="free">P1</span> <span class="free">P2</span> <span class="free">A</span>›</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">∈</span> <span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">A</span> <span class="main">}</span> <span class="main">∨</span> <span class="free">M</span> <span class="main">∈</span> <span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span> <span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">MA</span><span class="main">,</span><span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> 
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">∈</span> <span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">A</span> <span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">M</span> <span class="main">∈</span> <span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">A</span> <span class="main">}</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="free">P1</span> <span class="main">(</span>Pos <span class="free">A</span><span class="main">)</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"literal_ordering <span class="free">M</span> <span class="main">(</span>Pos <span class="free">A</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">M</span> <span class="main">=</span> Pos <span class="skolem">MA</span> <span class="main">∨</span> <span class="free">M</span> <span class="main">=</span> Neg <span class="skolem">MA</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹literal_ordering <span class="free">M</span> <span class="main">(</span>Pos <span class="free">A</span><span class="main">)</span>›</span></span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">MA</span><span class="main">,</span><span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">∈</span> <span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span> <span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">M</span> <span class="main">∈</span> <span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span> <span class="main">}</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="free">P2</span> <span class="main">(</span>Neg <span class="free">A</span><span class="main">)</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"literal_ordering <span class="free">M</span> <span class="main">(</span>Neg <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> strictly_maximal_literal_def<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">M</span> <span class="main">=</span> Pos <span class="skolem">MA</span> <span class="main">∨</span> <span class="free">M</span> <span class="main">=</span> Neg <span class="skolem">MA</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹literal_ordering <span class="free">M</span> <span class="main">(</span>Neg <span class="free">A</span><span class="main">)</span>›</span></span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">MA</span><span class="main">,</span><span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">MA</span> <span class="main">=</span> atom <span class="free">M</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Ordered Resolution with Selection›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹In the next restriction strategy, some negative literals are selected with highest priority 
for applying the resolution rule, regardless of the ordering. Relaxed ordering restrictions also 
apply.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">selected_part</span> <span class="free"><span class="bound"><span class="entity">Sel</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">L</span><span class="main">.</span> <span class="bound">L</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">A</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">Sel</span></span></span><span class="main">.</span> <span class="bound">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="bound">A</span><span class="main">)</span><span class="main">)</span> <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ordered_sel_resolvent</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> set <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> bool"</span></span> 
  <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">ordered_sel_resolvent</span> <span class="free"><span class="bound"><span class="entity">Sel</span></span></span> <span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">≡</span> 
    <span class="main">(</span><span class="main">∃</span><span class="bound">A</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">=</span> <span class="main">(</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="main">-</span> <span class="main">{</span> Pos <span class="bound">A</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="main">-</span> <span class="main">{</span> Neg <span class="bound">A</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
      <span class="main">∧</span> <span class="main">(</span>strictly_maximal_literal <span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="main">(</span>Pos <span class="bound">A</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">(</span>selected_part <span class="free"><span class="bound"><span class="entity">Sel</span></span></span> <span class="free"><span class="bound"><span class="entity">P1</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span><span class="main">)</span> <span class="main">∧</span> 
          <span class="main">(</span> <span class="main">(</span><span class="main">(</span>strictly_maximal_literal <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="main">(</span>Neg <span class="bound">A</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>selected_part <span class="free"><span class="bound"><span class="entity">Sel</span></span></span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span><span class="main">)</span> 
          <span class="main">∨</span> <span class="main">(</span>strictly_maximal_literal <span class="main">(</span>selected_part <span class="free"><span class="bound"><span class="entity">Sel</span></span></span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span><span class="main">)</span> <span class="main">(</span>Neg <span class="bound">A</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ordered_resolvent_is_resolvent <span class="main">:</span> <span class="quoted"><span class="quoted">"less_restrictive resolvent ordered_resolvent"</span></span>
<span class="keyword1"><span class="command">using</span></span> less_restrictive_def ordered_resolvent_def resolvent_upon_is_resolvent strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The next lemma states that ordered resolution with selection coincides with ordered 
resolution if the selected part is empty.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ordered_sel_resolvent_is_ordered_resolvent <span class="main">:</span> 
 <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ordered_resolvent <span class="free">P1</span> <span class="free">P2</span> <span class="free">C</span>"</span></span>
 <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"selected_part <span class="free">Sel</span> <span class="free">P1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
 <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"selected_part <span class="free">Sel</span> <span class="free">P2</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
 <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ordered_sel_resolvent <span class="free">Sel</span> <span class="free">P1</span> <span class="free">P2</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms ordered_resolvent_def ordered_sel_resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> ordered_resolvent_upon_is_resolvent <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="free">P1</span> <span class="main">(</span>Pos <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="free">P2</span> <span class="main">(</span>Neg <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ordered_resolvent <span class="free">P1</span> <span class="free">P2</span> <span class="main">(</span>resolvent_upon <span class="free">P1</span> <span class="free">P2</span> <span class="free">A</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms ordered_resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Semantic Resolution›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹In this strategy, resolution is applied only if one parent is false in some (fixed) 
interpretation. Note that ordering restrictions still apply, although they are relaxed.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">validated_part</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> set <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Clause"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">validated_part</span> <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">L</span><span class="main">.</span> <span class="bound">L</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">∧</span> <span class="main">(</span>validate_literal <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="bound">L</span><span class="main">)</span> <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ordered_model_resolvent</span> <span class="main">::</span> 
  <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Interpretation <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">ordered_model_resolvent</span> <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">=</span> 
    <span class="main">(</span><span class="main">∃</span><span class="bound">L</span><span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="main">-</span> <span class="main">{</span> <span class="bound">L</span> <span class="main">}</span> <span class="main">∪</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="main">-</span> <span class="main">{</span> complement <span class="bound">L</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span>
      <span class="main">(</span><span class="main">(</span>validated_part <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="free"><span class="bound"><span class="entity">P1</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>  <span class="main">∧</span> <span class="main">(</span>strictly_maximal_literal <span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="bound">L</span><span class="main">)</span><span class="main">)</span>
      <span class="main">∧</span> <span class="main">(</span>strictly_maximal_literal <span class="main">(</span>validated_part <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span><span class="main">)</span> <span class="main">(</span>complement <span class="bound">L</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ordered_model_resolvent_is_resolvent <span class="main">:</span> <span class="quoted"><span class="quoted">"less_restrictive resolvent <span class="main">(</span>ordered_model_resolvent <span class="free">I</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> less_restrictive resolvent <span class="main">(</span>ordered_model_resolvent <span class="free">I</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"ordered_model_resolvent <span class="free">I</span> <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>resolvent <span class="skolem">P2</span> <span class="skolem">P1</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> less_restrictive_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹ordered_model_resolvent <span class="free">I</span> <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> 
    <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="skolem">P1</span> <span class="skolem">L</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="main">(</span>validated_part <span class="free">I</span> <span class="skolem">P2</span><span class="main">)</span> <span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> complement <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ordered_model_resolvent_def <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">I</span></span> <span class="quoted"><span class="skolem">P1</span></span> <span class="quoted"><span class="skolem">P2</span></span> <span class="quoted"><span class="skolem">C</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">P1</span> <span class="skolem">L</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">P1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> strictly_maximal_literal_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="main">(</span>validated_part <span class="free">I</span> <span class="skolem">P2</span><span class="main">)</span> <span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">P2</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> strictly_maximal_literal_def validated_part_def<span class="main">)</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">=</span> Pos <span class="skolem">A</span> <span class="main">∨</span> <span class="skolem">L</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Literal.exhaust <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">L</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> complement <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">P1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">P2</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span> <span class="main">∨</span> resolvent <span class="skolem">P2</span> <span class="skolem">P1</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>resolvent <span class="skolem">P2</span> <span class="skolem">P1</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Unit Resolution›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Resolution is applied only if one parent is unit (this restriction is incomplete).›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">Unit</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Clause <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">Unit</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>card <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">unit_resolvent</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> BinaryRule"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">unit_resolvent</span> <span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">=</span>  <span class="main">(</span><span class="main">(</span><span class="main">∃</span><span class="bound">L</span><span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">=</span> <span class="main">(</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="main">-</span> <span class="main">{</span> <span class="bound">L</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="main">-</span> <span class="main">{</span> complement <span class="bound">L</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
      <span class="main">∧</span> <span class="bound">L</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="main">∧</span> <span class="main">(</span>complement <span class="bound">L</span><span class="main">)</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span><span class="main">)</span> <span class="main">∧</span> Unit <span class="free"><span class="bound"><span class="entity">P1</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> unit_resolvent_is_resolvent <span class="main">:</span> <span class="quoted"><span class="quoted">"less_restrictive resolvent unit_resolvent"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> less_restrictive resolvent unit_resolvent"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"unit_resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>resolvent <span class="skolem">P2</span> <span class="skolem">P1</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> less_restrictive_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹unit_resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">P1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"complement <span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">P2</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> complement <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> unit_resolvent_def <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">P1</span></span> <span class="quoted"><span class="skolem">P2</span></span> <span class="quoted"><span class="skolem">C</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">=</span> Pos <span class="skolem">A</span> <span class="main">∨</span> <span class="skolem">L</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Literal.exhaust <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">L</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> complement <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">P1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹complement <span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">P2</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span> <span class="main">∨</span> resolvent <span class="skolem">P2</span> <span class="skolem">P1</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>resolvent <span class="skolem">P2</span> <span class="skolem">P1</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Positive and Negative Resolution›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Resolution is applied only if one parent is positive (resp. negative). Again, relaxed
ordering restrictions apply.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">positive_part</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Clause"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">positive_part</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">L</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">A</span><span class="main">.</span> <span class="bound">L</span> <span class="main">=</span> Pos <span class="bound">A</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">L</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">negative_part</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Clause"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">negative_part</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">L</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">A</span><span class="main">.</span> <span class="bound">L</span> <span class="main">=</span> Neg <span class="bound">A</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">L</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> decomposition_clause_pos_neg <span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">=</span> <span class="main">(</span>negative_part <span class="free">C</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span>positive_part <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">⊆</span> <span class="main">(</span>negative_part <span class="free">C</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span>positive_part <span class="free">C</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">C</span>"</span></span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> Pos <span class="skolem">A</span> <span class="main">∨</span> <span class="skolem">x</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Literal.exhaust <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">(</span>negative_part <span class="free">C</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span>positive_part <span class="free">C</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span> 
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> Pos <span class="skolem">A</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> positive_part <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> positive_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">(</span>negative_part <span class="free">C</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span>positive_part <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≠</span> Pos <span class="skolem">A</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> Pos <span class="skolem">A</span> <span class="main">∨</span> <span class="skolem">x</span> <span class="main">=</span> Neg <span class="skolem">A</span>›</span></span><span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> negative_part <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> negative_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">(</span>negative_part <span class="free">C</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span>positive_part <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>negative_part <span class="free">C</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span>positive_part <span class="free">C</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> negative_part_def
  <span class="keyword2"><span class="keyword">and</span></span> positive_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ordered_positive_resolvent</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">ordered_positive_resolvent</span> <span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">=</span> 
    <span class="main">(</span><span class="main">∃</span><span class="bound">L</span><span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="main">-</span> <span class="main">{</span> <span class="bound">L</span> <span class="main">}</span> <span class="main">∪</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="main">-</span> <span class="main">{</span> complement <span class="bound">L</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span>
      <span class="main">(</span><span class="main">(</span>negative_part <span class="free"><span class="bound"><span class="entity">P1</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>  <span class="main">∧</span> <span class="main">(</span>strictly_maximal_literal <span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="bound">L</span><span class="main">)</span><span class="main">)</span>
      <span class="main">∧</span> <span class="main">(</span>strictly_maximal_literal <span class="main">(</span>negative_part <span class="free"><span class="bound"><span class="entity">P2</span></span></span><span class="main">)</span> <span class="main">(</span>complement <span class="bound">L</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ordered_negative_resolvent</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">ordered_negative_resolvent</span> <span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">=</span> 
    <span class="main">(</span><span class="main">∃</span><span class="bound">L</span><span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="main">-</span> <span class="main">{</span> <span class="bound">L</span> <span class="main">}</span> <span class="main">∪</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="main">-</span> <span class="main">{</span> complement <span class="bound">L</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span>
      <span class="main">(</span><span class="main">(</span>positive_part <span class="free"><span class="bound"><span class="entity">P1</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>  <span class="main">∧</span> <span class="main">(</span>strictly_maximal_literal <span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="bound">L</span><span class="main">)</span><span class="main">)</span>
      <span class="main">∧</span> <span class="main">(</span>strictly_maximal_literal <span class="main">(</span>positive_part <span class="free"><span class="bound"><span class="entity">P2</span></span></span><span class="main">)</span> <span class="main">(</span>complement <span class="bound">L</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> positive_resolvent_is_resolvent <span class="main">:</span> <span class="quoted"><span class="quoted">"less_restrictive resolvent ordered_positive_resolvent"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> less_restrictive resolvent ordered_positive_resolvent"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"ordered_positive_resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>resolvent <span class="skolem">P2</span> <span class="skolem">P1</span> <span class="skolem">C</span>"</span></span>  <span class="keyword1"><span class="command">unfolding</span></span> less_restrictive_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹ordered_positive_resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> 
    <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="skolem">P1</span> <span class="skolem">L</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="main">(</span>negative_part <span class="skolem">P2</span><span class="main">)</span><span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> complement <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ordered_positive_resolvent_def <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">P1</span></span> <span class="quoted"><span class="skolem">P2</span></span> <span class="quoted"><span class="skolem">C</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">P1</span> <span class="skolem">L</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">P1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="main">(</span>negative_part <span class="skolem">P2</span><span class="main">)</span> <span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">P2</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def negative_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">=</span> Pos <span class="skolem">A</span> <span class="main">∨</span> <span class="skolem">L</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Literal.exhaust <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">L</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> complement <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">P1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">P2</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span> <span class="main">∨</span> resolvent <span class="skolem">P2</span> <span class="skolem">P1</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span>resolvent <span class="skolem">P2</span> <span class="skolem">P1</span> <span class="skolem">C</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span>resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> negative_resolvent_is_resolvent <span class="main">:</span> <span class="quoted"><span class="quoted">"less_restrictive resolvent ordered_negative_resolvent"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> less_restrictive resolvent ordered_negative_resolvent"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordered_negative_resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>resolvent <span class="skolem">P2</span> <span class="skolem">P1</span> <span class="skolem">C</span><span class="main">)</span>"</span></span>  <span class="keyword1"><span class="command">unfolding</span></span> less_restrictive_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹ordered_negative_resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="skolem">P1</span> <span class="skolem">L</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="main">(</span>positive_part <span class="skolem">P2</span><span class="main">)</span><span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> complement <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ordered_negative_resolvent_def <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">P1</span></span> <span class="quoted"><span class="skolem">P2</span></span> <span class="quoted"><span class="skolem">C</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">P1</span> <span class="skolem">L</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">P1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="main">(</span>positive_part <span class="skolem">P2</span><span class="main">)</span> <span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">P2</span>"</span></span> 
  <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def positive_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">=</span> Pos <span class="skolem">A</span> <span class="main">∨</span> <span class="skolem">L</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Literal.exhaust <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">L</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> complement <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">P1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">P2</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span> <span class="main">∨</span> resolvent <span class="skolem">P2</span> <span class="skolem">P1</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>resolvent <span class="skolem">P2</span> <span class="skolem">P1</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Redundancy Elimination Rules›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We define the usual redundancy elimination rules.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">tautology</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> Clause <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">tautology</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">A</span><span class="main">.</span> <span class="main">(</span>Pos <span class="bound">A</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">∧</span> Neg <span class="bound">A</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">subsumes</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> Clause <span class="main">⇒</span> <span class="tfree">'a</span> Clause <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">subsumes</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">D</span></span></span><span class="main">)</span>  <span class="main">≡</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">⊆</span> <span class="free"><span class="bound"><span class="entity">D</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">redundant</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> Clause <span class="main">⇒</span> <span class="tfree">'a</span> Formula <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">redundant</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>tautology <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span><span class="bound">D</span><span class="main">.</span> <span class="main">(</span><span class="bound">D</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∧</span> subsumes <span class="bound">D</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">strictly_redundant</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> Clause <span class="main">⇒</span> <span class="tfree">'a</span> Formula <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">strictly_redundant</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>tautology <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span><span class="bound">D</span><span class="main">.</span> <span class="main">(</span><span class="bound">D</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="bound">D</span> <span class="main">⊂</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">simplify</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Formula <span class="main">⇒</span> <span class="tfree">'at</span> Formula"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">simplify</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">=</span> <span class="main">{</span> <span class="bound">C</span><span class="main">.</span> <span class="bound">C</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∧</span> <span class="main">¬</span>strictly_redundant <span class="bound">C</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We first establish some basic syntactic properties.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> tautology_monotonous <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>tautology <span class="free">C</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">C</span> <span class="main">⊆</span> <span class="free">D</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span>tautology <span class="free">D</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> simplify_involutive<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"simplify <span class="main">(</span>simplify <span class="free">S</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>simplify <span class="free">S</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> simplify_def strictly_redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> simplify_finite<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span>simplify <span class="free">S</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms all_fulfill_def simplify_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> atoms_formula_simplify<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"atoms_formula <span class="main">(</span>simplify <span class="free">S</span><span class="main">)</span> <span class="main">⊆</span> atoms_formula <span class="free">S</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> simplify_def <span class="keyword1"><span class="command">using</span></span> atoms_formula_subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> subsumption_preserves_redundancy <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="free">C</span> <span class="free">D</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">D</span> <span class="free">S</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms tautology_monotonous <span class="keyword1"><span class="command">unfolding</span></span> redundant_def subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> subsumption_and_max_literal <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="free">C1</span> <span class="free">C2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="free">C1</span> <span class="free">L1</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="free">C2</span> <span class="free">L2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A1</span> <span class="main">=</span> atom <span class="free">L1</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A2</span> <span class="main">=</span> atom <span class="free">L2</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A1</span> <span class="main">=</span> <span class="free">A2</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="free">A1</span><span class="main">,</span><span class="free">A2</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A1</span> <span class="main">=</span> atom <span class="free">L1</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">L1</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="free">A1</span><span class="main">)</span> <span class="main">∨</span> <span class="free">L1</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="free">A1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> atom_property<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A2</span> <span class="main">=</span> atom <span class="free">L2</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">L2</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="free">A2</span><span class="main">)</span> <span class="main">∨</span> <span class="free">L2</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="free">A2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> atom_property<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="free">C1</span> <span class="free">C2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="free">C1</span> <span class="free">L1</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">L1</span> <span class="main">∈</span> <span class="free">C2</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="free">C2</span> <span class="free">L2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">L1</span> <span class="main">∈</span> <span class="free">C2</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">L1</span> <span class="main">=</span> <span class="free">L2</span> <span class="main">∨</span> literal_ordering <span class="free">L1</span> <span class="free">L2</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">L1</span> <span class="main">=</span> <span class="free">L2</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">L1</span> <span class="main">=</span> <span class="free">L2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A1</span> <span class="main">=</span> atom <span class="free">L1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A2</span> <span class="main">=</span> atom <span class="free">L2</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"literal_ordering <span class="free">L1</span> <span class="free">L2</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹literal_ordering <span class="free">L1</span> <span class="free">L2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">L1</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="free">A1</span><span class="main">)</span> <span class="main">∨</span> <span class="free">L1</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="free">A1</span><span class="main">)</span>›</span></span>   
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">L2</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="free">A2</span><span class="main">)</span> <span class="main">∨</span> <span class="free">L2</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="free">A2</span><span class="main">)</span>›</span></span> 
      <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> superset_preserves_redundancy<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">⊆</span> <span class="free">S'</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="free">S'</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> superset_preserves_strict_redundancy<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"strictly_redundant <span class="free">C</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">⊆</span> <span class="free">SS</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"strictly_redundant <span class="free">C</span> <span class="free">SS</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> strictly_redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The following lemmas relate the above notions with that of semantic entailment and thus 
establish the soundness of redundancy elimination rules.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> tautologies_are_valid <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"tautology <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="free">I</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms tautology_def validate_clause.simps validate_literal.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> 
    validate_literal.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> subsumption_and_semantics <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="free">C</span> <span class="free">D</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="free">I</span> <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="free">I</span> <span class="free">D</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> redundancy_and_semantics <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"validate_formula <span class="free">I</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="free">I</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> 
<span class="main">(</span><span class="operator">meson</span> assms redundant_def subsumption_and_semantics tautologies_are_valid validate_formula.elims<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> redundancy_implies_entailment<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"entails <span class="free">S</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms entails_def redundancy_and_semantics <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> simplify_and_membership <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">=</span> simplify <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">C</span><span class="main">.</span> card <span class="bound">C</span> <span class="main">≤</span> <span class="skolem">n</span> <span class="main">⟶</span> <span class="bound">C</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">⟶</span> redundant <span class="bound">C</span> <span class="free">T</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="skolem">n</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">rule</span> allI<span class="main">)</span><span class="main"><span class="keyword3">,</span></span><span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">C</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">C</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹card <span class="skolem">C</span> <span class="main">≤</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> card_0_eq 
          <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> strictly_redundant <span class="skolem">C</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> strictly_redundant_def tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">T</span> <span class="main">=</span> simplify <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simplify_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> redundant_def subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">next</span></span> 
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="skolem">n</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">rule</span> allI<span class="main">)</span><span class="main"><span class="keyword3">,</span></span><span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">C</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">C</span> <span class="main">≤</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="free">T</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>redundant <span class="skolem">C</span> <span class="free">T</span>"</span></span>
            <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∉</span> <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> redundant_def subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">T</span> <span class="main">=</span> simplify <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"strictly_redundant <span class="skolem">C</span> <span class="free">S</span>"</span></span> 
              <span class="keyword1"><span class="command">unfolding</span></span> simplify_def strictly_redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>redundant <span class="skolem">C</span> <span class="free">T</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">D</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">⊂</span> <span class="skolem">C</span>"</span></span> 
              <span class="keyword1"><span class="command">unfolding</span></span> redundant_def strictly_redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">⊂</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">D</span> <span class="main">&lt;</span> card <span class="skolem">C</span>"</span></span> 
              <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def 
              <span class="keyword1"><span class="command">using</span></span> psubset_card_mono  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹card <span class="skolem">C</span> <span class="main">≤</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">D</span> <span class="main">≤</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹<span class="var">?P</span> <span class="skolem">n</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">D</span> <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
            <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
              <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"tautology <span class="skolem">D</span>"</span></span>
              <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">⊂</span> <span class="skolem">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"tautology <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>redundant <span class="skolem">C</span> <span class="free">T</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">next</span></span> 
              <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>tautology <span class="skolem">D</span>"</span></span>
              <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="skolem">D</span> <span class="free">T</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">E</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">E</span> <span class="main">∈</span> <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">E</span> <span class="main">⊆</span> <span class="skolem">D</span>"</span></span> 
                <span class="keyword1"><span class="command">unfolding</span></span> redundant_def subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">⊂</span> <span class="skolem">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">E</span> <span class="main">⊆</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">E</span> <span class="main">∈</span> <span class="free">T</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">¬</span>redundant <span class="skolem">C</span> <span class="free">T</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> 
                <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword2"><span class="keyword">and</span></span> subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">qed</span></span> 
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> simplify_preserves_redundancy<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="main">(</span>simplify <span class="free">S</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms redundant_def simplify_and_membership subsumption_preserves_redundancy<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> simplify_preserves_strict_redundancy<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"strictly_redundant <span class="free">C</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"strictly_redundant <span class="free">C</span> <span class="main">(</span>simplify <span class="free">S</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"tautology <span class="free">C</span>"</span></span><span class="main">)</span><span class="main"><span class="keyword3">,</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> strictly_redundant_def<span class="main">)</span><span class="main"><span class="keyword3">[</span></span>1<span class="main"><span class="keyword3">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>tautology <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">D</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">⊂</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> strictly_redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">D</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> redundant_def subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">D</span> <span class="main">(</span>simplify <span class="free">S</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simplify_preserves_redundancy <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>tautology <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">⊂</span> <span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>tautology <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="skolem">D</span> <span class="main">(</span>simplify <span class="free">S</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">E</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">E</span> <span class="main">∈</span> simplify <span class="free">S</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="skolem">E</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="skolem">E</span> <span class="skolem">D</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">⊂</span> <span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">E</span> <span class="main">⊂</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">E</span> <span class="main">∈</span> simplify <span class="free">S</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"strictly_redundant <span class="free">C</span> <span class="main">(</span>simplify <span class="free">S</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> strictly_redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> simplify_preserves_semantic <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">=</span> simplify <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"validate_formula <span class="free">I</span> <span class="free">S</span> <span class="main">⟷</span> validate_formula <span class="free">I</span> <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> assms mem_Collect_eq redundancy_and_semantics simplify_and_membership 
    simplify_def validate_formula.simps<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> simplify_preserves_equivalence <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">=</span> simplify <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"equivalent <span class="free">S</span> <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms equivalent_def simplify_preserves_semantic validity_implies_entailment <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹After simplification, the formula contains no strictly redundant clause:›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">non_redundant</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Formula <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">non_redundant</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">C</span><span class="main">.</span> <span class="main">(</span><span class="bound">C</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">⟶</span> <span class="main">¬</span>strictly_redundant <span class="bound">C</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> simplify_non_redundant<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"non_redundant <span class="main">(</span>simplify <span class="free">S</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> non_redundant_def simplify_def strictly_redundant_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> deducible_clause_preserve_redundancy<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms superset_preserves_redundancy <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Renaming›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹A renaming is a function changing the sign of some literals. We show that this operation preserves 
 most of the previous syntactic and semantic notions.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">rename_literal</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> set <span class="main">⇒</span> <span class="tfree">'at</span> Literal <span class="main">⇒</span> <span class="tfree">'at</span> Literal"</span></span> 
<span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">rename_literal</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">L</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="main">(</span><span class="main">(</span>atom <span class="free"><span class="bound"><span class="entity">L</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span>complement <span class="free"><span class="bound"><span class="entity">L</span></span></span><span class="main">)</span> <span class="keyword1">else</span> <span class="free"><span class="bound"><span class="entity">L</span></span></span><span class="main">)</span>"</span></span>
  
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">rename_clause</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> set <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Clause"</span></span>
 <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">rename_clause</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">=</span> <span class="main">{</span><span class="bound">L</span><span class="main">.</span> <span class="main">∃</span><span class="bound">LL</span><span class="main">.</span> <span class="bound">LL</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">∧</span> <span class="bound">L</span> <span class="main">=</span> <span class="main">(</span>rename_literal <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="bound">LL</span><span class="main">)</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">rename_formula</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> set <span class="main">⇒</span> <span class="tfree">'at</span> Formula <span class="main">⇒</span> <span class="tfree">'at</span> Formula"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">rename_formula</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">=</span> <span class="main">{</span><span class="bound">C</span><span class="main">.</span> <span class="main">∃</span><span class="bound">CC</span><span class="main">.</span> <span class="bound">CC</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∧</span> <span class="bound">C</span> <span class="main">=</span> <span class="main">(</span>rename_clause <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="bound">CC</span><span class="main">)</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> inverse_renaming <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>rename_literal <span class="free">A</span> <span class="main">(</span>rename_literal <span class="free">A</span> <span class="free">L</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">L</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> at<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span> <span class="main">∨</span> <span class="free">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Literal.exhaust <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">L</span></span> <span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> at <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> rename_literal_def  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> inverse_clause_renaming <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>rename_clause <span class="free">A</span> <span class="main">(</span>rename_clause <span class="free">A</span> <span class="free">L</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">L</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> inverse_renaming <span class="keyword1"><span class="command">unfolding</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> inverse_formula_renaming <span class="main">:</span> <span class="quoted"><span class="quoted">"rename_formula <span class="free">A</span> <span class="main">(</span>rename_formula <span class="free">A</span> <span class="free">L</span><span class="main">)</span> <span class="main">=</span> <span class="free">L</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> inverse_clause_renaming <span class="keyword1"><span class="command">unfolding</span></span> rename_formula_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> renaming_preserves_cardinality <span class="main">:</span>
  <span class="quoted"><span class="quoted">"card <span class="main">(</span>rename_clause <span class="free">A</span> <span class="free">C</span><span class="main">)</span> <span class="main">=</span> card <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> im<span class="main">:</span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">A</span> <span class="free">C</span> <span class="main">=</span> <span class="main">(</span>rename_literal <span class="free">A</span><span class="main">)</span> <span class="main">`</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"inj_on <span class="main">(</span>rename_literal <span class="free">A</span><span class="main">)</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inj_onI inverse_renaming<span class="main">)</span>  
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> im <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> card_image <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> renaming_preserves_literal_order <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"literal_ordering <span class="free">L1</span> <span class="free">L2</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"literal_ordering <span class="main">(</span>rename_literal <span class="free">A</span> <span class="free">L1</span><span class="main">)</span> <span class="main">(</span>rename_literal <span class="free">A</span> <span class="free">L2</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A1</span></span> <span class="keyword2"><span class="keyword">where</span></span> at1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">L1</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="skolem">A1</span><span class="main">)</span> <span class="main">∨</span> <span class="free">L1</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">A1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Literal.exhaust <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">L1</span></span> <span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A2</span></span> <span class="keyword2"><span class="keyword">where</span></span> at2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">L2</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="skolem">A2</span><span class="main">)</span> <span class="main">∨</span> <span class="free">L2</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">A2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Literal.exhaust <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">L2</span></span> <span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword2"><span class="keyword">and</span></span> at1 <span class="keyword2"><span class="keyword">and</span></span> at2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> rename_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> inverse_renaming_preserves_literal_order <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span>  <span class="quoted"><span class="quoted">"literal_ordering <span class="main">(</span>rename_literal <span class="free">A</span> <span class="free">L1</span><span class="main">)</span> <span class="main">(</span>rename_literal <span class="free">A</span> <span class="free">L2</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"literal_ordering <span class="free">L1</span> <span class="free">L2</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms inverse_renaming renaming_preserves_literal_order<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> renaming_is_injective<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">A</span> <span class="free">L1</span> <span class="main">=</span> rename_literal <span class="free">A</span> <span class="free">L2</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">L1</span> <span class="main">=</span> <span class="free">L2</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">)</span></span> assms inverse_renaming<span class="main">)</span>
  
<span class="keyword1"><span class="command">lemma</span></span> renaming_preserves_strictly_maximal_literal <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="free">C</span> <span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="main">(</span>rename_clause <span class="free">A</span> <span class="free">C</span><span class="main">)</span> <span class="main">(</span>rename_literal <span class="free">A</span> <span class="free">L</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">L</span> <span class="main">∈</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> Lismax<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">B</span><span class="main">.</span> <span class="main">(</span><span class="bound">B</span> <span class="main">∈</span> <span class="free">C</span> <span class="main">∧</span> <span class="free">L</span> <span class="main">≠</span> <span class="bound">B</span><span class="main">)</span>  <span class="main">⟶</span> <span class="main">(</span>literal_ordering <span class="bound">B</span> <span class="free">L</span><span class="main">)</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">L</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>rename_literal <span class="free">A</span> <span class="free">L</span><span class="main">)</span> <span class="main">∈</span> <span class="main">(</span>rename_clause <span class="free">A</span> <span class="free">C</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> rename_literal_def <span class="keyword2"><span class="keyword">and</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">B</span><span class="main">.</span> <span class="main">(</span><span class="bound">B</span> <span class="main">∈</span> rename_clause <span class="free">A</span> <span class="free">C</span> <span class="main">⟶</span> rename_literal <span class="free">A</span> <span class="free">L</span> <span class="main">≠</span> <span class="bound">B</span>  
      <span class="main">⟶</span> literal_ordering <span class="bound">B</span> <span class="main">(</span>rename_literal <span class="free">A</span> <span class="free">L</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> rename_clause <span class="free">A</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">A</span> <span class="free">L</span> <span class="main">≠</span> <span class="skolem">B</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> rename_clause <span class="free">A</span> <span class="free">C</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B'</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">=</span> rename_literal <span class="free">A</span> <span class="skolem">B'</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹rename_literal <span class="free">A</span> <span class="free">L</span> <span class="main">≠</span> <span class="skolem">B</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">=</span> rename_literal <span class="free">A</span> <span class="skolem">B'</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">A</span> <span class="free">L</span> <span class="main">≠</span> rename_literal <span class="free">A</span> <span class="skolem">B'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main">≠</span> <span class="skolem">B'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B'</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> Lismax <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"literal_ordering <span class="skolem">B'</span> <span class="free">L</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">=</span> <span class="main">(</span>rename_literal <span class="free">A</span> <span class="skolem">B'</span><span class="main">)</span>›</span></span> 
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"literal_ordering <span class="skolem">B</span> <span class="main">(</span>rename_literal <span class="free">A</span> <span class="free">L</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> renaming_preserves_literal_order <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>rename_literal <span class="free">A</span> <span class="free">L</span><span class="main">)</span> <span class="main">∈</span> <span class="main">(</span>rename_clause <span class="free">A</span> <span class="free">C</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> renaming_and_selected_part <span class="main">:</span>
  <span class="quoted"><span class="quoted">"selected_part UNIV <span class="free">C</span> <span class="main">=</span> rename_clause <span class="free">Sel</span> <span class="main">(</span>validated_part <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>  
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"selected_part UNIV <span class="free">C</span> <span class="main">⊆</span> rename_clause <span class="free">Sel</span> <span class="main">(</span>validated_part <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> selected_part UNIV <span class="free">C</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> rename_clause <span class="free">Sel</span> <span class="main">(</span>validated_part <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> selected_part UNIV <span class="free">C</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> 
        <span class="keyword1"><span class="command">unfolding</span></span> selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">Sel</span> <span class="skolem">x</span> <span class="main">∈</span> rename_clause <span class="free">Sel</span> <span class="free">C</span>"</span></span> 
        <span class="keyword1"><span class="command">unfolding</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> rename_clause <span class="free">Sel</span> <span class="main">(</span>validated_part <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="free">Sel</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> Neg <span class="skolem">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">Sel</span> <span class="skolem">x</span> <span class="main">=</span> Pos <span class="skolem">A</span>"</span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span> rename_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>  
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">∈</span> <span class="free">Sel</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"validate_literal <span class="free">Sel</span> <span class="main">(</span>rename_literal <span class="free">Sel</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹rename_literal <span class="free">Sel</span> <span class="skolem">x</span> <span class="main">∈</span> rename_clause <span class="free">Sel</span> <span class="free">C</span>›</span></span> 
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">Sel</span> <span class="skolem">x</span> <span class="main">∈</span> validated_part <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span> validated_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> rename_clause <span class="free">Sel</span> <span class="main">(</span>validated_part <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> inverse_renaming rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∉</span> <span class="free">Sel</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> Neg <span class="skolem">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">Sel</span> <span class="skolem">x</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span> rename_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>  
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">∉</span> <span class="free">Sel</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"validate_literal <span class="free">Sel</span> <span class="main">(</span>rename_literal <span class="free">Sel</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹rename_literal <span class="free">Sel</span> <span class="skolem">x</span> <span class="main">∈</span> rename_clause <span class="free">Sel</span> <span class="free">C</span>›</span></span> 
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">Sel</span> <span class="skolem">x</span> <span class="main">∈</span> validated_part <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span>  validated_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> rename_clause <span class="free">Sel</span> <span class="main">(</span>validated_part <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> inverse_renaming rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="main">(</span>validated_part <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span>selected_part UNIV <span class="free">C</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> rename_clause <span class="free">Sel</span> <span class="main">(</span>validated_part <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> validated_part <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> rename_literal <span class="free">Sel</span> <span class="skolem">y</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> rename_clause_def validated_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> validated_part <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> rename_clause <span class="free">Sel</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"validate_literal <span class="free">Sel</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> validated_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> rename_clause <span class="free">Sel</span> <span class="free">C</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> rename_literal <span class="free">Sel</span> <span class="skolem">z</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> zA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> Pos <span class="skolem">A</span> <span class="main">∨</span> <span class="skolem">z</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Literal.exhaust <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">z</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> selected_part UNIV <span class="free">C</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="free">Sel</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> zA <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> rename_literal <span class="free">Sel</span> <span class="skolem">z</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> complement <span class="skolem">z</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> rename_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">∈</span> <span class="free">Sel</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> zA <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_literal <span class="free">Sel</span> <span class="skolem">y</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> Pos <span class="skolem">A</span>"</span></span> 
          <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">∈</span> <span class="free">Sel</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> rename_literal <span class="free">Sel</span> <span class="skolem">y</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span> rename_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">z</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">z</span> <span class="main">=</span> Neg <span class="skolem">A</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> selected_part UNIV <span class="free">C</span>"</span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span> selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span> 
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∉</span> <span class="free">Sel</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> zA <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> rename_literal <span class="free">Sel</span> <span class="skolem">z</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> <span class="skolem">z</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> rename_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">∉</span> <span class="free">Sel</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> zA <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_literal <span class="free">Sel</span> <span class="skolem">y</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> 
          <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">∉</span> <span class="free">Sel</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> rename_literal <span class="free">Sel</span> <span class="skolem">y</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span> rename_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">z</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">z</span> <span class="main">=</span> Neg <span class="skolem">A</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> selected_part UNIV <span class="free">C</span>"</span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span> selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> renaming_preserves_tautology<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"tautology <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"tautology <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"Pos <span class="skolem">A</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Neg <span class="skolem">A</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹Pos <span class="skolem">A</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">Sel</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span>  rename_clause <span class="free">Sel</span> <span class="free">C</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹Neg <span class="skolem">A</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">Sel</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span>  rename_clause <span class="free">Sel</span> <span class="free">C</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="free">Sel</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">Sel</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">Sel</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> rename_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹rename_literal <span class="free">Sel</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹rename_literal <span class="free">Sel</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span>›</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹rename_literal <span class="free">Sel</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span>  <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span>›</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹rename_literal <span class="free">Sel</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span>  <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"tautology <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span> 
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∉</span> <span class="free">Sel</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">Sel</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span> <span class="main">=</span> Pos <span class="skolem">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">Sel</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> rename_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹rename_literal <span class="free">Sel</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span> <span class="main">=</span> Pos <span class="skolem">A</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹rename_literal <span class="free">Sel</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>›</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹rename_literal <span class="free">Sel</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span>  rename_clause <span class="free">Sel</span> <span class="free">C</span>›</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹rename_literal <span class="free">Sel</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span>  rename_clause <span class="free">Sel</span> <span class="free">C</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"tautology <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> rename_union <span class="main">:</span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="main">(</span><span class="free">C</span> <span class="main">∪</span> <span class="free">D</span><span class="main">)</span> <span class="main">=</span> rename_clause <span class="free">Sel</span> <span class="free">C</span> <span class="main">∪</span> rename_clause <span class="free">Sel</span> <span class="free">D</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> renaming_set_minus_subset <span class="main">:</span> 
  <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="main">{</span> <span class="free">L</span> <span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> rename_clause <span class="free">Sel</span> <span class="free">C</span> <span class="main">-</span> <span class="main">{</span>rename_literal <span class="free">Sel</span> <span class="free">L</span> <span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> rename_clause <span class="free">Sel</span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="main">{</span> <span class="free">L</span> <span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="free">C</span> <span class="main">-</span> <span class="main">{</span> <span class="free">L</span> <span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> rename_literal <span class="free">Sel</span> <span class="skolem">y</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="free">C</span> <span class="main">-</span> <span class="main">{</span> <span class="free">L</span> <span class="main">}</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> rename_literal <span class="free">Sel</span> <span class="skolem">y</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> rename_clause <span class="free">Sel</span> <span class="free">C</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≠</span> rename_literal <span class="free">Sel</span> <span class="free">L</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> rename_literal <span class="free">Sel</span> <span class="free">L</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">Sel</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">L</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inverse_renaming <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> rename_literal <span class="free">Sel</span> <span class="skolem">y</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> <span class="free">L</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inverse_renaming <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="free">C</span> <span class="main">-</span> <span class="main">{</span> <span class="free">L</span> <span class="main">}</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≠</span> rename_literal <span class="free">Sel</span> <span class="free">L</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> rename_clause <span class="free">Sel</span> <span class="free">C</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span>rename_literal <span class="free">Sel</span> <span class="free">L</span> <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> renaming_set_minus <span class="main">:</span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="main">{</span> <span class="free">L</span> <span class="main">}</span><span class="main">)</span> 
  <span class="main">=</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span>rename_literal <span class="free">Sel</span> <span class="free">L</span> <span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="main">{</span> <span class="free">L</span> <span class="main">}</span><span class="main">)</span> <span class="main">⊆</span>  <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span>rename_literal <span class="free">Sel</span> <span class="free">L</span> <span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> renaming_set_minus_subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span>rename_literal <span class="free">Sel</span> <span class="free">L</span> <span class="main">}</span> <span class="main">⊆</span> rename_clause <span class="free">Sel</span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="main">{</span> <span class="free">L</span> <span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="main">(</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span> <span class="main">(</span>rename_literal <span class="free">Sel</span> <span class="free">L</span><span class="main">)</span> <span class="main">}</span><span class="main">)</span> 
      <span class="main">⊆</span>  <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span>rename_literal <span class="free">Sel</span> <span class="main">(</span>rename_literal <span class="free">Sel</span> <span class="free">L</span><span class="main">)</span> <span class="main">}</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> renaming_set_minus_subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="main">(</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span> <span class="main">(</span>rename_literal <span class="free">Sel</span> <span class="free">L</span><span class="main">)</span> <span class="main">}</span><span class="main">)</span> <span class="main">⊆</span>  <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="main">{</span><span class="free">L</span> <span class="main">}</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> inverse_renaming inverse_clause_renaming <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="main">(</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span> <span class="main">(</span>rename_literal <span class="free">Sel</span> <span class="free">L</span><span class="main">)</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span> 
            <span class="main">⊆</span>  <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="main">{</span><span class="free">L</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this 
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span> <span class="main">(</span>rename_literal <span class="free">Sel</span> <span class="free">L</span><span class="main">)</span> <span class="main">}</span> <span class="main">⊆</span>  rename_clause <span class="free">Sel</span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="main">{</span><span class="free">L</span> <span class="main">}</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> inverse_renaming inverse_clause_renaming <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
 <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">rename_interpretation</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> set <span class="main">⇒</span> <span class="tfree">'at</span> Interpretation <span class="main">⇒</span> <span class="tfree">'at</span> Interpretation"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">rename_interpretation</span> <span class="free"><span class="bound"><span class="entity">Sel</span></span></span> <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="main">=</span> <span class="main">{</span> <span class="bound">A</span><span class="main">.</span> <span class="main">(</span><span class="bound">A</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="main">∧</span> <span class="bound">A</span> <span class="main">∉</span> <span class="free"><span class="bound"><span class="entity">Sel</span></span></span><span class="main">)</span> <span class="main">}</span> <span class="main">∪</span> <span class="main">{</span> <span class="bound">A</span><span class="main">.</span> <span class="main">(</span><span class="bound">A</span> <span class="main">∉</span> <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="main">∧</span> <span class="bound">A</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">Sel</span></span></span><span class="main">)</span> <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> renaming_preserves_semantic <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"validate_literal <span class="free">I</span> <span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"validate_literal <span class="main">(</span>rename_interpretation <span class="free">Sel</span> <span class="free">I</span><span class="main">)</span> <span class="main">(</span>rename_literal <span class="free">Sel</span> <span class="free">L</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?J</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"rename_interpretation <span class="free">Sel</span> <span class="free">I</span>"</span></span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main">=</span> Pos <span class="skolem">A</span> <span class="main">∨</span> <span class="free">L</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Literal.exhaust <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">L</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">L</span> <span class="main">=</span> Pos <span class="skolem">A</span> <span class="main">∨</span> <span class="free">L</span> <span class="main">=</span> Neg <span class="skolem">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"atom <span class="free">L</span> <span class="main">=</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="free">Sel</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹atom <span class="free">L</span> <span class="main">=</span> <span class="skolem">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">Sel</span> <span class="free">L</span> <span class="main">=</span> complement <span class="free">L</span>"</span></span>  
      <span class="keyword1"><span class="command">unfolding</span></span> rename_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main">=</span> Pos <span class="skolem">A</span>"</span></span> 
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_literal <span class="free">I</span> <span class="free">L</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="free">I</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">∈</span> <span class="free">Sel</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∉</span> <span class="var">?J</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> rename_interpretation_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">L</span> <span class="main">=</span> Pos <span class="skolem">A</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹rename_literal <span class="free">Sel</span> <span class="free">L</span> <span class="main">=</span> complement <span class="free">L</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main">≠</span> Pos <span class="skolem">A</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">L</span> <span class="main">=</span> Pos <span class="skolem">A</span> <span class="main">∨</span> <span class="free">L</span> <span class="main">=</span> Neg <span class="skolem">A</span>›</span></span><span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_literal <span class="free">I</span> <span class="free">L</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∉</span> <span class="free">I</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">∈</span> <span class="free">Sel</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="var">?J</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> rename_interpretation_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">L</span> <span class="main">=</span> Neg <span class="skolem">A</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹rename_literal <span class="free">Sel</span> <span class="free">L</span> <span class="main">=</span> complement <span class="free">L</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∉</span> <span class="free">Sel</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹atom <span class="free">L</span> <span class="main">=</span> <span class="skolem">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">Sel</span> <span class="free">L</span> <span class="main">=</span> <span class="free">L</span>"</span></span>  
        <span class="keyword1"><span class="command">unfolding</span></span> rename_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main">=</span> Pos <span class="skolem">A</span>"</span></span> 
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_literal <span class="free">I</span> <span class="free">L</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="free">I</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">∉</span> <span class="free">Sel</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="var">?J</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> rename_interpretation_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">L</span> <span class="main">=</span> Pos <span class="skolem">A</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹rename_literal <span class="free">Sel</span> <span class="free">L</span> <span class="main">=</span> <span class="free">L</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main">≠</span> Pos <span class="skolem">A</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">L</span> <span class="main">=</span> Pos <span class="skolem">A</span> <span class="main">∨</span> <span class="free">L</span> <span class="main">=</span> Neg <span class="skolem">A</span>›</span></span><span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main">=</span> Neg <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_literal <span class="free">I</span> <span class="free">L</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∉</span> <span class="free">I</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">∉</span> <span class="free">Sel</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∉</span> <span class="var">?J</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> rename_interpretation_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">L</span> <span class="main">=</span> Neg <span class="skolem">A</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹rename_literal <span class="free">Sel</span> <span class="free">L</span> <span class="main">=</span> <span class="free">L</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
   <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> renaming_preserves_satisfiability<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"satisfiable <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"satisfiable <span class="main">(</span>rename_formula <span class="free">Sel</span> <span class="free">S</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">I</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"validate_formula <span class="skolem">I</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> satisfiable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?J</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"rename_interpretation <span class="free">Sel</span> <span class="skolem">I</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"validate_formula <span class="var">?J</span> <span class="main">(</span>rename_formula <span class="free">Sel</span> <span class="free">S</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>validate_formula <span class="var">?J</span> <span class="main">(</span>rename_formula <span class="free">Sel</span> <span class="free">S</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>validate_clause <span class="var">?J</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> rename_formula_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_formula <span class="skolem">I</span> <span class="free">S</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">C</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"validate_literal <span class="skolem">I</span> <span class="skolem">L</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹validate_literal <span class="skolem">I</span> <span class="skolem">L</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"validate_literal <span class="var">?J</span> <span class="main">(</span>rename_literal <span class="free">Sel</span> <span class="skolem">L</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> renaming_preserves_semantic <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>validate_clause <span class="var">?J</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> satisfiable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> renaming_preserves_subsumption<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="free">C</span> <span class="free">D</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">D</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Soundness›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹In this section we prove that all the rules introduced in the previous section are sound. 
We first introduce an abstract notion of soundness.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">Sound</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> BinaryRule <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">Sound</span> <span class="free"><span class="bound"><span class="entity">Rule</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">I</span> <span class="bound">P1</span> <span class="bound">P2</span> <span class="bound">C</span><span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">Rule</span></span></span> <span class="bound">P1</span> <span class="bound">P2</span> <span class="bound">C</span> <span class="main">⟶</span> <span class="main">(</span>validate_clause <span class="bound">I</span> <span class="bound">P1</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span>validate_clause <span class="bound">I</span> <span class="bound">P2</span><span class="main">)</span> 
    <span class="main">⟶</span> <span class="main">(</span>validate_clause <span class="bound">I</span> <span class="bound">C</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> soundness_and_entailment <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Sound <span class="free">Rule</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Rule</span> <span class="free">P1</span> <span class="free">P2</span> <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P1</span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P2</span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"entails <span class="free">S</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> Sound_def assms entails_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> all_deducible_sound<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Sound <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="free">S</span> <span class="main">(</span>all_deducible_clauses <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>entails_formula <span class="free">S</span> <span class="main">(</span>all_deducible_clauses <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> all_deducible_clauses <span class="free">R</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> entails <span class="free">S</span> <span class="skolem">C</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> entails_formula_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> all_deducible_clauses <span class="free">R</span> <span class="free">S</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span> <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S</span>"</span></span>    
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">R</span> <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span><span class="keyword2"><span class="keyword">and</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> entails <span class="free">S</span> <span class="skolem">C</span>›</span></span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">using</span></span> soundness_and_entailment <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> add_all_deducible_sound<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Sound <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="free">S</span> <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> UnE add_all_deducible_clauses.simps all_deducible_sound assms 
      entails_formula_def entails_member<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹If a rule is more restrictive than a sound rule then it is necessarily sound.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> less_restrictive_correct<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"less_restrictive <span class="free">R1</span> <span class="free">R2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Sound <span class="free">R1</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Sound <span class="free">R2</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> less_restrictive_def Sound_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We finally establish usual concrete soundness results.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> resolution_is_correct<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span>Sound resolvent<span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>Sound resolvent<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">I</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span>  
    <span class="quoted"><span class="quoted">"resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="skolem">I</span> <span class="skolem">P1</span>"</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="skolem">I</span> <span class="skolem">P2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>validate_clause <span class="skolem">I</span> <span class="skolem">C</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span>  Sound_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span>
      <span class="quoted"><span class="quoted">"<span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">P1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">P2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> <span class="main">(</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="skolem">I</span>"</span></span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>validate_literal <span class="skolem">I</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>validate_literal <span class="skolem">I</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_clause <span class="skolem">I</span> <span class="skolem">P2</span>›</span></span> 
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="skolem">I</span> <span class="main">(</span><span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹validate_clause <span class="skolem">I</span> <span class="main">(</span><span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> <span class="main">(</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span>›</span></span> 
          <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>validate_clause <span class="skolem">I</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∉</span> <span class="skolem">I</span>"</span></span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>validate_literal <span class="skolem">I</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>validate_literal <span class="skolem">I</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_clause <span class="skolem">I</span> <span class="skolem">P1</span>›</span></span> 
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="skolem">I</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹validate_clause <span class="skolem">I</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> <span class="main">(</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span>›</span></span> 
          <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>validate_clause <span class="skolem">I</span> <span class="skolem">C</span>›</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> ordered_resolution_correct <span class="main">:</span> <span class="quoted"><span class="quoted">"Sound ordered_resolvent"</span></span>
<span class="keyword1"><span class="command">using</span></span> resolution_is_correct <span class="keyword2"><span class="keyword">and</span></span> ordered_resolvent_is_resolvent  less_restrictive_correct  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 

<span class="keyword1"><span class="command">theorem</span></span> ordered_model_resolution_correct <span class="main">:</span> <span class="quoted"><span class="quoted">"Sound <span class="main">(</span>ordered_model_resolvent <span class="free">I</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> resolution_is_correct ordered_model_resolvent_is_resolvent less_restrictive_correct <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 

<span class="keyword1"><span class="command">theorem</span></span> ordered_positive_resolution_correct <span class="main">:</span> <span class="quoted"><span class="quoted">"Sound ordered_positive_resolvent"</span></span>
<span class="keyword1"><span class="command">using</span></span> less_restrictive_correct positive_resolvent_is_resolvent resolution_is_correct <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">theorem</span></span> ordered_negative_resolution_correct <span class="main">:</span> <span class="quoted"><span class="quoted">"Sound ordered_negative_resolvent"</span></span>
<span class="keyword1"><span class="command">using</span></span> less_restrictive_correct negative_resolvent_is_resolvent resolution_is_correct <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">theorem</span></span> unit_resolvent_correct <span class="main">:</span> <span class="quoted"><span class="quoted">"Sound unit_resolvent"</span></span>
<span class="keyword1"><span class="command">using</span></span> less_restrictive_correct resolution_is_correct unit_resolvent_is_resolvent <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Refutational Completeness›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹In this section we establish the refutational completeness of the previous inference 
rules (under adequate restrictions for the unit resolution rule). Completeness is proven
w.r.t.\ redundancy elimination rules, i.e., we show that every saturated unsatisfiable clause set
contains the empty clause.›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We first introduce an abstract notion of saturation.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">saturated_binary_rule</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> BinaryRule <span class="main">⇒</span> <span class="tfree">'a</span> Formula <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">saturated_binary_rule</span> <span class="free"><span class="bound"><span class="entity">Rule</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">P1</span> <span class="bound">P2</span> <span class="bound">C</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="bound">P1</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">P2</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">Rule</span></span></span> <span class="bound">P1</span> <span class="bound">P2</span> <span class="bound">C</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
    <span class="main">⟶</span> redundant <span class="bound">C</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">Complete</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> BinaryRule <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">Complete</span> <span class="free"><span class="bound"><span class="entity">Rule</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">S</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span>saturated_binary_rule <span class="free"><span class="bound"><span class="entity">Rule</span></span></span> <span class="bound">S</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span>all_fulfill finite <span class="bound">S</span><span class="main">)</span> 
    <span class="main">⟶</span> <span class="main">(</span><span class="main">{}</span> <span class="main">∉</span> <span class="bound">S</span><span class="main">)</span> <span class="main">⟶</span> satisfiable <span class="bound">S</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹If a set of clauses is saturated under some rule then it is necessarily saturated 
under more restrictive rules, which entails that if a rule is less restrictive than a complete rule 
then it is also complete.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> less_restrictive_saturated<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"less_restrictive <span class="free">R1</span> <span class="free">R2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule <span class="free">R1</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule <span class="free">R2</span> <span class="free">S</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> less_restrictive_def Complete_def saturated_binary_rule_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> less_restrictive_complete<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"less_restrictive <span class="free">R1</span> <span class="free">R2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Complete <span class="free">R2</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Complete <span class="free">R1</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms less_restrictive_saturated Complete_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Ordered Resolution›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We define a function associating every set of clauses <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span> <span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">S</span></span></span></span> <span class="antiquote"><span class="antiquote">}</span></span></span></span> with a ``canonic'' 
interpretation constructed from <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span> <span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">S</span></span></span></span> <span class="antiquote"><span class="antiquote">}</span></span></span></span>.
If <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span> <span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">S</span></span></span></span> <span class="antiquote"><span class="antiquote">}</span></span></span></span> is saturated under ordered resolution and does not contain the empty clause
then the interpretation is a model of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span> <span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">S</span></span></span></span> <span class="antiquote"><span class="antiquote">}</span></span></span></span>. The interpretation is defined by mean
of an auxiliary function that maps every atom to a function indicating whether the
atom occurs in the interpretation corresponding to a given clause set.
The auxiliary function is defined by induction on the set of atoms.
›</span></span>

<span class="keyword1"><span class="command">function</span></span> <span class="entity">canonic_int_fun_ordered</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'at</span> Formula <span class="main">⇒</span> bool<span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">canonic_int_fun_ordered</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">=</span> 
      <span class="main">(</span><span class="main">λ</span><span class="bound">S</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">C</span><span class="main">.</span> <span class="main">(</span><span class="bound">C</span> <span class="main">∈</span> <span class="bound">S</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>strictly_maximal_literal <span class="bound">C</span> <span class="main">(</span>Pos <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">)</span> 
      <span class="main">∧</span> <span class="main">(</span> <span class="main">∀</span> <span class="bound">B</span><span class="main">.</span> <span class="main">(</span> Pos <span class="bound">B</span> <span class="main">∈</span> <span class="bound">C</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">,</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">¬</span><span class="main">(</span><span class="free">canonic_int_fun_ordered</span> <span class="bound">B</span><span class="main">)</span> <span class="bound">S</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
      <span class="main">∧</span> <span class="main">(</span> <span class="main">∀</span> <span class="bound">B</span><span class="main">.</span> <span class="main">(</span> Neg <span class="bound">B</span> <span class="main">∈</span> <span class="bound">C</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">,</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span><span class="free">canonic_int_fun_ordered</span> <span class="bound">B</span><span class="main">)</span> <span class="bound">S</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">termination</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">relation</span> <span class="quoted"><span class="quoted">"<span class="free">atom_ordering</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> atom_ordering_wf<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">canonic_int_ordered</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Formula <span class="main">⇒</span> <span class="tfree">'at</span> Interpretation"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">canonic_int_ordered</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">A</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="bound">A</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span> <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We first prove that the canonic interpretation validates every clause 
having a positive strictly maximal literal›</span></span>
 
<span class="keyword1"><span class="command">lemma</span></span> int_validate_cl_with_pos_max <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="free">C</span> <span class="main">(</span>Pos <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> c1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span> <span class="bound">B</span><span class="main">.</span> <span class="main">(</span> Pos <span class="bound">B</span> <span class="main">∈</span> <span class="free">C</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">,</span> <span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> 
                  <span class="main">⟶</span> <span class="main">(</span><span class="main">¬</span><span class="main">(</span>canonic_int_fun_ordered <span class="bound">B</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> c2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span> <span class="main">∀</span> <span class="bound">B</span><span class="main">.</span> <span class="main">(</span> Neg <span class="bound">B</span> <span class="main">∈</span> <span class="free">C</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">,</span> <span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> 
                    <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="bound">B</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="free">A</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="free">A</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="free">A</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">have</span></span> e<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">C</span><span class="main">.</span> <span class="main">(</span><span class="bound">C</span> <span class="main">∈</span> <span class="free">S</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>strictly_maximal_literal <span class="bound">C</span> <span class="main">(</span>Pos <span class="free">A</span><span class="main">)</span> <span class="main">)</span> 
      <span class="main">∧</span> <span class="main">(</span> <span class="main">∀</span> <span class="bound">B</span><span class="main">.</span> <span class="main">(</span> Pos <span class="bound">B</span> <span class="main">∈</span> <span class="bound">C</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">,</span> <span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">¬</span><span class="main">(</span>canonic_int_fun_ordered <span class="bound">B</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
      <span class="main">∧</span> <span class="main">(</span> <span class="main">∀</span> <span class="bound">B</span><span class="main">.</span> <span class="main">(</span> Neg <span class="bound">B</span> <span class="main">∈</span> <span class="bound">C</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">,</span> <span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="bound">B</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span>canonic_int_fun_ordered.simps<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">A</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> e <span class="keyword2"><span class="keyword">and</span></span> c1 <span class="keyword2"><span class="keyword">and</span></span> c2 <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">C</span> <span class="main">∈</span> <span class="free">S</span><span class="main">)</span>›</span></span><span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>strictly_maximal_literal <span class="free">C</span> <span class="main">(</span>Pos <span class="free">A</span><span class="main">)</span><span class="main">)</span>›</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="free">A</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">unfolding</span></span> canonic_int_ordered_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">∈</span> <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>strictly_maximal_literal <span class="free">C</span> <span class="main">(</span>Pos <span class="free">A</span><span class="main">)</span><span class="main">)</span>›</span></span> 
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?thesis</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> not_c2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span> <span class="main">∀</span> <span class="bound">B</span><span class="main">.</span> <span class="main">(</span> Neg <span class="bound">B</span> <span class="main">∈</span> <span class="free">C</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">,</span> <span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> 
                        <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="bound">B</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> not_c2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"Neg <span class="skolem">B</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="skolem">B</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="skolem">B</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∉</span> <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">unfolding</span></span> canonic_int_ordered_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹Neg <span class="skolem">B</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?thesis</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> not_c1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∀</span> <span class="bound">B</span><span class="main">.</span> <span class="main">(</span> Pos <span class="bound">B</span> <span class="main">∈</span> <span class="free">C</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">,</span> <span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> 
                      <span class="main">⟶</span> <span class="main">(</span><span class="main">¬</span><span class="main">(</span>canonic_int_fun_ordered <span class="bound">B</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> not_c1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"Pos <span class="skolem">B</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="skolem">B</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="skolem">B</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> canonic_int_ordered_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹Pos <span class="skolem">B</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?thesis</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> strictly_maximal_literal_exists <span class="main">:</span> 

  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">C</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span>finite <span class="bound">C</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>card <span class="bound">C</span><span class="main">)</span> <span class="main">=</span> <span class="free">n</span> <span class="main">∧</span> <span class="free">n</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">(</span><span class="main">¬</span> <span class="main">(</span>tautology <span class="bound">C</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> 
    <span class="main">⟶</span> <span class="main">(</span><span class="main">∃</span><span class="bound">A</span><span class="main">.</span> <span class="main">(</span>strictly_maximal_literal <span class="bound">C</span> <span class="bound">A</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="free">n</span>"</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?P</span> <span class="main">0</span><span class="main">)</span>"</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="skolem">n</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span>  
            <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">C</span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>finite <span class="skolem">C</span> <span class="main">∧</span> card <span class="skolem">C</span> <span class="main">=</span> Suc <span class="skolem">n</span> <span class="main">∧</span> Suc <span class="skolem">n</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">¬</span> <span class="main">(</span>tautology <span class="skolem">C</span><span class="main">)</span><span class="main">)</span> 
              <span class="main">⟶</span> <span class="main">(</span><span class="main">∃</span><span class="bound">A</span><span class="main">.</span> <span class="main">(</span>strictly_maximal_literal <span class="skolem">C</span> <span class="bound">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">proof</span></span> 
              <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">C</span> <span class="main">∧</span> card <span class="skolem">C</span> <span class="main">=</span> Suc <span class="skolem">n</span> <span class="main">∧</span> Suc <span class="skolem">n</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">¬</span><span class="main">(</span>tautology <span class="skolem">C</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>finite <span class="skolem">C</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>card <span class="skolem">C</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span> <span class="main">(</span>tautology <span class="skolem">C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
              <span class="keyword1"><span class="command">proof</span></span>
                <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
                <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> <span class="main">{}</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">C</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> card_0_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹card <span class="skolem">C</span> <span class="main">=</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹card <span class="skolem">C</span> <span class="main">=</span> Suc <span class="skolem">n</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>tautology <span class="skolem">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>tautology <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> tautology_monotonous 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹finite <span class="skolem">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="main">(</span>card <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> card <span class="skolem">C</span>"</span></span> 
                <span class="keyword1"><span class="command">using</span></span> card_Suc_Diff1  <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
              <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹card <span class="skolem">C</span> <span class="main">=</span> Suc <span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
             
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">A</span><span class="main">.</span> <span class="main">(</span>strictly_maximal_literal <span class="skolem">C</span> <span class="bound">A</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
                <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">C</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
                  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹card <span class="skolem">C</span> <span class="main">=</span> Suc <span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹card <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
                    <span class="keyword1"><span class="command">using</span></span> card_0_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>  <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">next</span></span>
                <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">C</span> <span class="main">≠</span> <span class="main">1</span>"</span></span>
                  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹Suc <span class="main">(</span>card <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> card <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹card <span class="skolem">C</span> <span class="main">≠</span> <span class="main">1</span>›</span></span> 
                    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>card <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹card <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">n</span>›</span></span> 
                    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>tautology <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?P</span> <span class="skolem">n</span>›</span></span> 
                  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
                  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> strictly_maximal_literal <span class="skolem">C</span> <span class="bound">M</span>"</span></span> 
                  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
                    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>atom <span class="skolem">L</span><span class="main">,</span> atom <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>"</span></span>
                      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"literal_ordering <span class="skolem">L</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>            
                      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span> <span class="skolem">A</span>›</span></span> 
                        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="skolem">C</span> <span class="skolem">A</span>"</span></span> 
                      <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                    <span class="keyword1"><span class="command">next</span></span> 
                    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>atom <span class="skolem">L</span><span class="main">,</span> atom <span class="skolem">A</span><span class="main">)</span> <span class="main">∉</span> <span class="free">atom_ordering</span>"</span></span>
                      <span class="keyword1"><span class="command">have</span></span> l_cases<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="main">(</span>atom <span class="skolem">L</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="main">(</span>atom <span class="skolem">L</span><span class="main">)</span><span class="main">)</span>"</span></span> 
                        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">rule</span> atom_property <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main"><span class="main">(</span></span></span>atom <span class="skolem"><span class="skolem"><span class="skolem">L</span></span></span><span class="main"><span class="main"><span class="main">)</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
                      <span class="keyword1"><span class="command">have</span></span> a_cases<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="main">(</span>atom <span class="skolem">A</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="skolem">A</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="main">(</span>atom <span class="skolem">A</span><span class="main">)</span><span class="main">)</span>"</span></span> 
                        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">rule</span> atom_property <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main"><span class="main">(</span></span></span>atom <span class="skolem"><span class="skolem"><span class="skolem">A</span></span></span><span class="main"><span class="main"><span class="main">)</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
                      <span class="keyword1"><span class="command">from</span></span> l_cases <span class="keyword2"><span class="keyword">and</span></span> a_cases <span class="keyword2"><span class="keyword">and</span></span><span class="quoted"><span class="quoted">‹<span class="main">(</span>strictly_maximal_literal <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span> <span class="skolem">A</span><span class="main">)</span>›</span></span> 
                        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span>tautology <span class="skolem">C</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">C</span>›</span></span>  
                      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"atom <span class="skolem">L</span> <span class="main">≠</span> atom <span class="skolem">A</span>"</span></span> 
                      <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword2"><span class="keyword">and</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>atom <span class="skolem">L</span><span class="main">,</span> atom <span class="skolem">A</span><span class="main">)</span> <span class="main">∉</span> <span class="free">atom_ordering</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> atom_ordering_total 
                        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>atom <span class="skolem">A</span><span class="main">,</span>atom <span class="skolem">L</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"literal_ordering <span class="skolem">A</span> <span class="skolem">L</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span> <span class="skolem">A</span>›</span></span> 
                        <span class="keyword2"><span class="keyword">and</span></span> literal_ordering_trans  
                      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="skolem">C</span> <span class="skolem">L</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def
                      <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">qed</span></span>
               <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We then deduce that all clauses are validated.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> canonic_int_validates_all_clauses <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule ordered_resolvent <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∉</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>tautology <span class="free">C</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> tautologies_are_valid <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">C</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>tautology <span class="free">C</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{}</span> <span class="main">∉</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="free">C</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> card_0_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>tautology <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹card <span class="free">C</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="quoted">"<span class="skolem"><span class="skolem">L</span></span>"</span>
      <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="free">C</span> <span class="skolem">L</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> strictly_maximal_literal_exists <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> atom <span class="skolem">L</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  
  <span class="keyword1"><span class="command">have</span></span> inductive_lemma<span class="main">:</span> 
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">C</span> <span class="bound">L</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">C</span> <span class="main">∈</span> <span class="free">S</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span>strictly_maximal_literal <span class="bound">C</span> <span class="bound">L</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="skolem">A</span> <span class="main">=</span> <span class="main">(</span>atom <span class="bound">L</span><span class="main">)</span><span class="main">)</span>
      <span class="main">⟶</span> <span class="main">(</span>validate_clause <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="bound">C</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?Q</span> <span class="skolem">A</span><span class="main">)</span>"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">rule</span> wf_induct <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="free"><span class="free">atom_ordering</span></span>"</span></span></span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="var"><span class="var">?Q</span></span>"</span></span></span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="skolem"><span class="skolem">A</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span><span class="main"><span class="keyword3">,</span></span><span class="main">(</span><span class="operator">rule</span> atom_ordering_wf<span class="main">)</span><span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
        <span class="keyword3"><span class="command">assume</span></span> hyp_induct<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">y</span><span class="main">,</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> <span class="main">⟶</span> <span class="main">(</span><span class="var">?Q</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?Q</span> <span class="skolem">x</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">C</span> <span class="skolem">L</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="skolem">C</span> <span class="skolem">L</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span>atom <span class="skolem">L</span><span class="main">)</span>"</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="skolem">C</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">=</span> Pos <span class="skolem">x</span>"</span></span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">=</span> Pos <span class="skolem">x</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">C</span> <span class="skolem">L</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="skolem">C</span>"</span></span> 
            <span class="keyword1"><span class="command">using</span></span> int_validate_cl_with_pos_max <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">≠</span> Pos <span class="skolem">x</span>"</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">≠</span> Pos <span class="skolem">x</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> atom <span class="skolem">L</span>›</span></span> atom_property <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>validate_clause <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="skolem">C</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
            <span class="keyword3"><span class="command">assume</span></span>  <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>validate_clause<span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="skolem">C</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>strictly_maximal_literal <span class="skolem">C</span> <span class="skolem">L</span><span class="main">)</span>›</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">¬</span> <span class="main">(</span>validate_clause <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="skolem">C</span><span class="main">)</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> canonic_int_ordered <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> canonic_int_ordered <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>canonic_int_fun_ordered <span class="skolem">x</span><span class="main">)</span> <span class="free">S</span>"</span></span> 
              <span class="keyword1"><span class="command">unfolding</span></span> canonic_int_ordered_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>canonic_int_fun_ordered <span class="skolem">x</span><span class="main">)</span> <span class="free">S</span>›</span></span> 
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span> <span class="bound">C</span><span class="main">.</span> <span class="main">(</span><span class="bound">C</span> <span class="main">∈</span> <span class="free">S</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>strictly_maximal_literal <span class="bound">C</span> <span class="main">(</span>Pos <span class="skolem">x</span><span class="main">)</span> <span class="main">)</span> 
            <span class="main">∧</span> <span class="main">(</span> <span class="main">∀</span> <span class="bound">B</span><span class="main">.</span> <span class="main">(</span> Pos <span class="bound">B</span> <span class="main">∈</span> <span class="bound">C</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">,</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">¬</span><span class="main">(</span>canonic_int_fun_ordered <span class="bound">B</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
            <span class="main">∧</span> <span class="main">(</span> <span class="main">∀</span> <span class="bound">B</span><span class="main">.</span> <span class="main">(</span> Neg <span class="bound">B</span> <span class="main">∈</span> <span class="bound">C</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">,</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="bound">B</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> canonic_int_fun_ordered.simps <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="skolem">x</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">D</span></span> 
            <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">D</span> <span class="main">∈</span> <span class="free">S</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>strictly_maximal_literal <span class="skolem">D</span> <span class="main">(</span>Pos <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword2"><span class="keyword">and</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span> <span class="main">∀</span> <span class="bound">B</span><span class="main">.</span> <span class="main">(</span> Pos <span class="bound">B</span> <span class="main">∈</span> <span class="skolem">D</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">,</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> 
                  <span class="main">⟶</span> <span class="main">(</span><span class="main">¬</span><span class="main">(</span>canonic_int_fun_ordered <span class="bound">B</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span> <span class="main">∀</span> <span class="bound">B</span><span class="main">.</span> <span class="main">(</span> Neg <span class="bound">B</span> <span class="main">∈</span> <span class="skolem">D</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">,</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> 
                      <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="bound">B</span><span class="main">)</span> <span class="free">S</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">R</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span> <span class="main">=</span> <span class="main">(</span>resolvent_upon <span class="skolem">D</span> <span class="skolem">C</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">R</span> <span class="main">=</span> resolvent_upon <span class="skolem">D</span> <span class="skolem">C</span> <span class="skolem">x</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">D</span> <span class="main">(</span>Pos <span class="skolem">x</span><span class="main">)</span>›</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">C</span> <span class="skolem">L</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">x</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"resolvent <span class="skolem">D</span> <span class="skolem">C</span> <span class="skolem">R</span>"</span></span> 
            <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">using</span></span> resolvent_upon_is_resolvent <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">R</span> <span class="main">=</span> resolvent_upon <span class="skolem">D</span> <span class="skolem">C</span> <span class="skolem">x</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">D</span> <span class="main">(</span>Pos <span class="skolem">x</span><span class="main">)</span>›</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">C</span> <span class="skolem">L</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">=</span> Neg <span class="skolem">x</span>›</span></span> 
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ordered_resolvent <span class="skolem">D</span> <span class="skolem">C</span> <span class="skolem">R</span>"</span></span> 
            <span class="keyword1"><span class="command">using</span></span> ordered_resolvent_upon_is_resolvent <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> validate_clause <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="skolem">R</span>"</span></span>
            <span class="keyword1"><span class="command">proof</span></span>
              <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="skolem">R</span>"</span></span>
              <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹validate_clause <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="skolem">R</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">M</span></span> 
                <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">M</span> <span class="main">∈</span> <span class="skolem">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"validate_literal <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="skolem">M</span>"</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">M</span> <span class="main">∈</span> <span class="skolem">R</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">R</span> <span class="main">=</span> resolvent_upon <span class="skolem">D</span> <span class="skolem">C</span> <span class="skolem">x</span>›</span></span> 
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">M</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">x</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="skolem">M</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">x</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
              <span class="keyword1"><span class="command">proof</span></span>
                <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">x</span> <span class="main">}</span><span class="main">)</span>"</span></span>
                <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
                <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
                  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">AA</span><span class="main">.</span> <span class="skolem">M</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="bound">AA</span><span class="main">)</span>"</span></span>
                  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">AA</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span> <span class="main">=</span> Pos <span class="skolem">AA</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">M</span> <span class="main">∈</span> <span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">x</span> <span class="main">}</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">D</span> <span class="main">(</span>Pos <span class="skolem">x</span><span class="main">)</span>›</span></span> 
                    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">M</span> <span class="main">=</span> Pos <span class="skolem">AA</span><span class="main">)</span>›</span></span>
                  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">AA</span><span class="main">,</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">from</span></span> a <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">AA</span><span class="main">,</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">M</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="skolem">AA</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">M</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">x</span> <span class="main">}</span><span class="main">)</span>›</span></span>
                  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>canonic_int_fun_ordered <span class="skolem">AA</span><span class="main">)</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span>canonic_int_fun_ordered <span class="skolem">AA</span><span class="main">)</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">AA</span> <span class="main">∉</span> canonic_int_ordered <span class="free">S</span>"</span></span> 
                    <span class="keyword1"><span class="command">unfolding</span></span> canonic_int_ordered_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">AA</span> <span class="main">∉</span> canonic_int_ordered <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">M</span> <span class="main">=</span> Pos <span class="skolem">AA</span>›</span></span> 
                    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_literal <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="skolem">M</span>›</span></span> 
                    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">next</span></span>
                  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">AA</span><span class="main">.</span> <span class="skolem">M</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="bound">AA</span><span class="main">)</span><span class="main">)</span>"</span></span>
                  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">AA</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="skolem">AA</span><span class="main">)</span> <span class="main">∨</span> <span class="skolem">M</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">AA</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Literal.exhaust <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">M</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">AA</span><span class="main">.</span> <span class="skolem">M</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="bound">AA</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">AA</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">M</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">x</span> <span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">D</span> <span class="main">(</span>Pos <span class="skolem">x</span><span class="main">)</span>›</span></span> 
                    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">M</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">AA</span><span class="main">)</span>›</span></span>
                  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">AA</span><span class="main">,</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">from</span></span> b <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">AA</span><span class="main">,</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">M</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">AA</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">M</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">x</span> <span class="main">}</span><span class="main">)</span>›</span></span>
                  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>canonic_int_fun_ordered <span class="skolem">AA</span><span class="main">)</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>canonic_int_fun_ordered <span class="skolem">AA</span><span class="main">)</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">AA</span> <span class="main">∈</span> canonic_int_ordered <span class="free">S</span>"</span></span>
                    <span class="keyword1"><span class="command">unfolding</span></span> canonic_int_ordered_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">AA</span> <span class="main">∈</span> canonic_int_ordered <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">M</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">AA</span><span class="main">)</span>›</span></span> 
                    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_literal <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="skolem">M</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">next</span></span>
                <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">x</span> <span class="main">}</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>validate_clause<span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">M</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">x</span> <span class="main">}</span><span class="main">)</span>›</span></span>
                <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_literal <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="skolem">M</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">qed</span></span>  
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>validate_clause <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="skolem">R</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>tautology <span class="skolem">R</span>"</span></span> 
              <span class="keyword1"><span class="command">using</span></span> tautologies_are_valid <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹ordered_resolvent <span class="skolem">D</span> <span class="skolem">C</span> <span class="skolem">R</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹saturated_binary_rule ordered_resolvent <span class="free">S</span>›</span></span> 
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">R</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> saturated_binary_rule_def  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>tautology <span class="skolem">R</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">R'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R'</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="skolem">R'</span> <span class="skolem">R</span>"</span></span> 
              <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">R</span> <span class="main">=</span> resolvent_upon <span class="skolem">D</span> <span class="skolem">C</span> <span class="skolem">x</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">D</span> <span class="main">(</span>Pos <span class="skolem">x</span><span class="main">)</span>›</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">C</span> <span class="skolem">L</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">x</span><span class="main">)</span>›</span></span> 
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"resolvent <span class="skolem">D</span> <span class="skolem">C</span> <span class="skolem">R</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def 
              <span class="keyword1"><span class="command">using</span></span> resolvent_upon_is_resolvent <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">D</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">(</span>resolvent <span class="skolem">D</span> <span class="skolem">C</span> <span class="skolem">R</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">R</span>"</span></span> 
            <span class="keyword1"><span class="command">using</span></span> resolvent_is_finite <span class="keyword1"><span class="command">unfolding</span></span> derived_clauses_are_finite_def  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">R</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="skolem">R'</span> <span class="skolem">R</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">R'</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def 
            <span class="keyword1"><span class="command">using</span></span> finite_subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">R'</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{}</span> <span class="main">∉</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>subsumes <span class="skolem">R'</span> <span class="skolem">R</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R'</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> 
              <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">R'</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">R'</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">R'</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> card_0_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="skolem">R'</span> <span class="skolem">R</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>tautology <span class="skolem">R</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>tautology <span class="skolem">R'</span>"</span></span> 
              <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def 
              <span class="keyword1"><span class="command">using</span></span> tautology_monotonous <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>tautology <span class="skolem">R'</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">R'</span>›</span></span>  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹card <span class="skolem">R'</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="quoted">"<span class="skolem"><span class="skolem">LR'</span></span>"</span> 
              <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="skolem">R'</span> <span class="skolem">LR'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> strictly_maximal_literal_exists 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">R</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">R'</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹card <span class="skolem">R'</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="skolem">R'</span> <span class="skolem">R</span>›</span></span> 
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">R</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> 
              <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>tautology <span class="skolem">R</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">R</span>›</span></span>  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹card <span class="skolem">R</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="quoted">"<span class="skolem"><span class="skolem">LR</span></span>"</span> 
              <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="skolem">R</span> <span class="skolem">LR</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> strictly_maximal_literal_exists <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">AR</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">AR'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">AR</span> <span class="main">=</span> atom <span class="skolem">LR</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">AR'</span> <span class="main">=</span> atom <span class="skolem">LR'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="skolem">R'</span> <span class="skolem">R</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">AR</span> <span class="main">=</span> atom <span class="skolem">LR</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">AR'</span> <span class="main">=</span> atom <span class="skolem">LR'</span>›</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>strictly_maximal_literal <span class="skolem">R</span> <span class="skolem">LR</span><span class="main">)</span>›</span></span>
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>strictly_maximal_literal <span class="skolem">R'</span> <span class="skolem">LR'</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">AR'</span> <span class="main">=</span> <span class="skolem">AR</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="skolem">AR'</span><span class="main">,</span><span class="skolem">AR</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>"</span></span> 
              <span class="keyword1"><span class="command">using</span></span> subsumption_and_max_literal <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">R</span> <span class="main">=</span> <span class="main">(</span>resolvent_upon <span class="skolem">D</span> <span class="skolem">C</span> <span class="skolem">x</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">AR</span> <span class="main">=</span> atom <span class="skolem">LR</span>›</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">R</span> <span class="skolem">LR</span>›</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">D</span> <span class="main">(</span>Pos <span class="skolem">x</span><span class="main">)</span>›</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">C</span> <span class="skolem">L</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">x</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">AR</span><span class="main">,</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> resolution_and_max_literal <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">AR</span><span class="main">,</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">AR'</span> <span class="main">=</span> <span class="skolem">AR</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="skolem">AR'</span><span class="main">,</span><span class="skolem">AR</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>›</span></span> 
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">AR'</span><span class="main">,</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> atom_ordering_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> hyp_induct <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">R'</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">R'</span> <span class="skolem">LR'</span>›</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">AR'</span> <span class="main">=</span> atom <span class="skolem">LR'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="skolem">R'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="skolem">R'</span> <span class="skolem">R</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>validate_clause <span class="main">(</span>canonic_int_ordered <span class="free">S</span><span class="main">)</span> <span class="skolem">R</span>›</span></span> 
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">using</span></span> subsumption_and_semantics <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> inductive_lemma <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="free">C</span> <span class="skolem">L</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">=</span> atom <span class="skolem">L</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> ordered_resolution_is_complete <span class="main">:</span>
  <span class="quoted"><span class="quoted">"Complete ordered_resolvent"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> Complete ordered_resolvent"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">S</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule ordered_resolvent <span class="skolem">S</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="skolem">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∉</span> <span class="skolem">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>satisfiable <span class="skolem">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Complete_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"validate_formula <span class="main">(</span>canonic_int_ordered <span class="skolem">S</span><span class="main">)</span> <span class="skolem">S</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>validate_formula <span class="main">(</span>canonic_int_ordered <span class="skolem">S</span><span class="main">)</span> <span class="skolem">S</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="skolem">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>validate_clause <span class="main">(</span>canonic_int_ordered <span class="skolem">S</span><span class="main">)</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹saturated_binary_rule ordered_resolvent <span class="skolem">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="skolem">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{}</span> <span class="main">∉</span> <span class="skolem">S</span>›</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="skolem">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>validate_clause <span class="main">(</span>canonic_int_ordered <span class="skolem">S</span><span class="main">)</span> <span class="skolem">C</span>›</span></span> 
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">using</span></span> canonic_int_validates_all_clauses <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹validate_formula <span class="main">(</span>canonic_int_ordered <span class="skolem">S</span><span class="main">)</span> <span class="skolem">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>satisfiable <span class="skolem">S</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> satisfiable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Ordered Resolution with Selection›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We now consider the case where some negative literals are considered with highest priority. 
The proof reuses the canonic interpretation defined in the previous section. 
The interpretation is constructed using only clauses with no selected literals. By the previous 
result, all such clauses must be satisfied. We then show that the property carries over to the 
clauses with non empty selected part.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">empty_selected_part</span> <span class="free"><span class="bound"><span class="entity">Sel</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">=</span> <span class="main">{</span> <span class="bound">C</span><span class="main">.</span> <span class="bound">C</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∧</span> <span class="main">(</span>selected_part <span class="free"><span class="bound"><span class="entity">Sel</span></span></span> <span class="bound">C</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> saturated_ordered_sel_res_empty_sel <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule <span class="main">(</span>ordered_sel_resolvent <span class="free">Sel</span><span class="main">)</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule ordered_resolvent <span class="main">(</span>empty_selected_part <span class="free">Sel</span> <span class="free">S</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>saturated_binary_rule ordered_resolvent <span class="main">(</span>empty_selected_part <span class="free">Sel</span> <span class="free">S</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">C</span></span>
    <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> empty_selected_part <span class="free">Sel</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> empty_selected_part <span class="free">Sel</span> <span class="free">S</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ordered_resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>redundant <span class="skolem">C</span> <span class="main">(</span>empty_selected_part <span class="free">Sel</span> <span class="free">S</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> <span class="quoted">"saturated_binary_rule_def"</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹ordered_resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> <span class="main">(</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span> <span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="skolem">P1</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="skolem">P2</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> ordered_resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> empty_selected_part <span class="free">Sel</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"selected_part <span class="free">Sel</span> <span class="skolem">P1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> empty_selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> empty_selected_part <span class="free">Sel</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"selected_part <span class="free">Sel</span> <span class="skolem">P2</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> empty_selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> <span class="main">(</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span> <span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">P1</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span>›</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">P2</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">P1</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>›</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹selected_part <span class="free">Sel</span> <span class="skolem">P2</span> <span class="main">=</span> <span class="main">{}</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ordered_sel_resolvent <span class="free">Sel</span> <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> ordered_sel_resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹saturated_binary_rule <span class="main">(</span>ordered_sel_resolvent <span class="free">Sel</span><span class="main">)</span> <span class="free">S</span>›</span></span>  
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">P1</span> <span class="bound">P2</span> <span class="bound">C</span><span class="main">.</span> <span class="main">(</span><span class="bound">P1</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∧</span> <span class="bound">P2</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∧</span> <span class="main">(</span>ordered_sel_resolvent <span class="free">Sel</span> <span class="bound">P1</span> <span class="bound">P2</span> <span class="bound">C</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> redundant <span class="bound">C</span> <span class="free">S</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> saturated_binary_rule_def  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="main">(</span>empty_selected_part <span class="free">Sel</span> <span class="free">S</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> <span class="main">(</span>empty_selected_part <span class="free">Sel</span> <span class="free">S</span><span class="main">)</span>›</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹ordered_sel_resolvent <span class="free">Sel</span> <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"tautology <span class="skolem">C</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span><span class="bound">D</span><span class="main">.</span> <span class="bound">D</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∧</span> subsumes <span class="bound">D</span> <span class="skolem">C</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> empty_selected_part_def redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹tautology <span class="skolem">C</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span><span class="bound">D</span><span class="main">.</span> <span class="bound">D</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∧</span> subsumes <span class="bound">D</span> <span class="skolem">C</span><span class="main">)</span>›</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>redundant <span class="skolem">C</span> <span class="main">(</span>empty_selected_part <span class="free">Sel</span> <span class="free">S</span><span class="main">)</span>›</span></span> 
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">D</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="skolem">D</span> <span class="skolem">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">∉</span> empty_selected_part <span class="free">Sel</span> <span class="free">S</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∉</span> empty_selected_part <span class="free">Sel</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> <span class="free">Sel</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Neg <span class="skolem">B</span> <span class="main">∈</span> <span class="skolem">D</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> empty_selected_part_def selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹Neg <span class="skolem">B</span> <span class="main">∈</span> <span class="skolem">D</span>›</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="skolem">D</span> <span class="skolem">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Neg <span class="skolem">B</span> <span class="main">∈</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> <span class="main">(</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span> <span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Neg <span class="skolem">B</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">∪</span> <span class="skolem">P2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹Neg <span class="skolem">B</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">∪</span> <span class="skolem">P2</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> empty_selected_part <span class="free">Sel</span> <span class="free">S</span>›</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> empty_selected_part <span class="free">Sel</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> <span class="free">Sel</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> empty_selected_part_def selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>  
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ordered_sel_resolvent_upon</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> set <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> <span class="tfree">'at</span> <span class="main">⇒</span> bool"</span></span> 
  <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ordered_sel_resolvent_upon</span> <span class="free"><span class="bound"><span class="entity">Sel</span></span></span> <span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">≡</span> 
    <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">=</span> <span class="main">(</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">}</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
      <span class="main">∧</span> <span class="main">(</span>strictly_maximal_literal <span class="free"><span class="bound"><span class="entity">P1</span></span></span> <span class="main">(</span>Pos <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">(</span>selected_part <span class="free"><span class="bound"><span class="entity">Sel</span></span></span> <span class="free"><span class="bound"><span class="entity">P1</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span><span class="main">)</span> 
      <span class="main">∧</span> <span class="main">(</span> <span class="main">(</span><span class="main">(</span>strictly_maximal_literal <span class="free"><span class="bound"><span class="entity">P2</span></span></span> <span class="main">(</span>Neg <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>selected_part <span class="free"><span class="bound"><span class="entity">Sel</span></span></span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span><span class="main">)</span>
         <span class="main">∨</span> <span class="main">(</span>strictly_maximal_literal <span class="main">(</span>selected_part <span class="free"><span class="bound"><span class="entity">Sel</span></span></span> <span class="free"><span class="bound"><span class="entity">P2</span></span></span><span class="main">)</span> <span class="main">(</span>Neg <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ordered_sel_resolvent_upon_is_resolvent<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ordered_sel_resolvent_upon <span class="free">Sel</span> <span class="free">P1</span> <span class="free">P2</span> <span class="free">C</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ordered_sel_resolvent <span class="free">Sel</span> <span class="free">P1</span> <span class="free">P2</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> ordered_sel_resolvent_upon_def <span class="keyword2"><span class="keyword">and</span></span> ordered_sel_resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> resolution_decreases_selected_part<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ordered_sel_resolvent_upon <span class="free">Sel</span> <span class="free">P1</span> <span class="free">P2</span> <span class="free">C</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Neg <span class="free">A</span> <span class="main">∈</span> <span class="free">P2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"finite <span class="free">P1</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"finite <span class="free">P2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span> <span class="main">=</span> Suc <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span> <span class="main">=</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹finite <span class="free">P2</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"selected_part <span class="free">Sel</span> <span class="free">P2</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> card_0_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹ordered_sel_resolvent_upon <span class="free">Sel</span> <span class="free">P1</span> <span class="free">P2</span> <span class="free">C</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">=</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">A</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span> <span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span> <span class="main">}</span><span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"selected_part <span class="free">Sel</span> <span class="free">P1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span> <span class="main">(</span>Neg <span class="free">A</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> ordered_sel_resolvent_upon_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span> <span class="main">(</span>Neg <span class="free">A</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Neg <span class="free">A</span> <span class="main">∈</span> selected_part <span class="free">Sel</span> <span class="free">P2</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="free">Sel</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹selected_part <span class="free">Sel</span> <span class="free">P1</span> <span class="main">=</span> <span class="main">{}</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"selected_part <span class="free">Sel</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">A</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹Neg <span class="free">A</span> <span class="main">∈</span> <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"selected_part <span class="free">Sel</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span> <span class="main">}</span>"</span></span> 
  <span class="keyword1"><span class="command">unfolding</span></span> selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">=</span> <span class="main">(</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">A</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span> <span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>
  <span class="quoted"><span class="quoted">"selected_part <span class="free">Sel</span> <span class="free">C</span> 
    <span class="main">=</span> <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">A</span><span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹selected_part <span class="free">Sel</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">A</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹selected_part <span class="free">Sel</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> selected_part <span class="free">Sel</span> <span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span> <span class="main">}</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"selected_part <span class="free">Sel</span> <span class="free">C</span> <span class="main">=</span> selected_part <span class="free">Sel</span> <span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span> <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹Neg <span class="free">A</span> <span class="main">∈</span> <span class="free">P2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">∈</span> <span class="free">Sel</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Neg <span class="free">A</span> <span class="main">∈</span> selected_part <span class="free">Sel</span> <span class="free">P2</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹selected_part <span class="free">Sel</span> <span class="free">C</span> <span class="main">=</span> <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span> <span class="main">}</span>›</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span> <span class="main">=</span> card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span> <span class="main">=</span> Suc <span class="free">n</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> canonic_int_validates_all_clauses_sel <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule <span class="main">(</span>ordered_sel_resolvent <span class="free">Sel</span><span class="main">)</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∉</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="main">(</span>canonic_int_ordered <span class="main">(</span>empty_selected_part <span class="free">Sel</span> <span class="free">S</span><span class="main">)</span><span class="main">)</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?nat_order</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">,</span><span class="bound">y</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="bound">y</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?SE</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"empty_selected_part <span class="free">Sel</span> <span class="free">S</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?I</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"canonic_int_ordered <span class="var">?SE</span>"</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">C</span><span class="main">.</span> card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="bound">C</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">n</span> <span class="main">⟶</span> <span class="bound">C</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">⟶</span> validate_clause <span class="var">?I</span> <span class="bound">C</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="skolem">n</span>"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">rule</span> wf_induct <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var"><span class="quoted"><span class="var">?nat_order</span></span></span></span></span> <span class="var"><span class="quoted"><span class="var"><span class="quoted"><span class="var">?P</span></span></span></span></span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">n</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span><span class="main"><span class="keyword3">,</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>wf<span class="main">)</span><span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span> ind_hyp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span><span class="main">.</span> <span class="main">(</span><span class="bound">m</span><span class="main">,</span><span class="skolem">n</span><span class="main">)</span> <span class="main">∈</span> <span class="var">?nat_order</span> <span class="main">⟶</span> <span class="main">(</span><span class="var">?P</span> <span class="bound">m</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?P</span> <span class="skolem">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">C</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="var">?I</span>  <span class="skolem">C</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> nat.exhaust <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="skolem"><span class="skolem">n</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">n</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"selected_part <span class="free">Sel</span> <span class="skolem">C</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹saturated_binary_rule <span class="main">(</span>ordered_sel_resolvent <span class="free">Sel</span><span class="main">)</span> <span class="free">S</span>›</span></span> 
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule ordered_resolvent <span class="var">?SE</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> saturated_ordered_sel_res_empty_sel <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{}</span> <span class="main">∉</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∉</span> <span class="var">?SE</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> empty_selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹selected_part <span class="free">Sel</span> <span class="skolem">C</span> <span class="main">=</span> <span class="main">{}</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="var">?SE</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> empty_selected_part_def 
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="var">?SE</span>"</span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span> empty_selected_part_def all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹saturated_binary_rule ordered_resolvent <span class="var">?SE</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{}</span> <span class="main">∉</span> <span class="var">?SE</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="var">?SE</span>›</span></span> 
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="var">?I</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> canonic_int_validates_all_clauses <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> Suc <span class="skolem">m</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"selected_part <span class="free">Sel</span> <span class="skolem">C</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="var">?I</span> <span class="skolem">C</span>"</span></span> 
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>validate_clause <span class="var">?I</span> <span class="skolem">C</span>"</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"tautology <span class="skolem">C</span>"</span></span> 
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹tautology <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>validate_clause <span class="var">?I</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> 
              <span class="keyword1"><span class="command">using</span></span> tautologies_are_valid <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>tautology <span class="skolem">C</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>tautology <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span><span class="main">)</span>"</span></span> 
              <span class="keyword1"><span class="command">unfolding</span></span> selected_part_def tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹selected_part <span class="free">Sel</span> <span class="skolem">C</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span>›</span></span> 
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span>tautology <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span>›</span></span> 
              <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span> <span class="skolem">L</span>"</span></span> 
              <span class="keyword1"><span class="command">using</span></span> strictly_maximal_literal_exists <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span> <span class="skolem">L</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">∈</span> <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span>"</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>validate_clause <span class="var">?I</span> <span class="skolem">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>validate_literal <span class="var">?I</span> <span class="skolem">L</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">∈</span> <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="free">Sel</span>"</span></span> 
              <span class="keyword1"><span class="command">unfolding</span></span> selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span>validate_literal <span class="var">?I</span> <span class="skolem">L</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="var">?I</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="skolem">A</span><span class="main">)</span> <span class="var">?SE</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> canonic_int_ordered_def 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">∃</span> <span class="bound">C</span><span class="main">.</span> <span class="main">(</span><span class="bound">C</span> <span class="main">∈</span> <span class="var">?SE</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>strictly_maximal_literal <span class="bound">C</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span> <span class="main">)</span> 
                <span class="main">∧</span> <span class="main">(</span> <span class="main">∀</span> <span class="bound">B</span><span class="main">.</span> <span class="main">(</span> Pos <span class="bound">B</span> <span class="main">∈</span> <span class="bound">C</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">,</span> <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> 
                  <span class="main">⟶</span> <span class="main">(</span><span class="main">¬</span><span class="main">(</span>canonic_int_fun_ordered <span class="bound">B</span><span class="main">)</span> <span class="var">?SE</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
                <span class="main">∧</span> <span class="main">(</span> <span class="main">∀</span> <span class="bound">B</span><span class="main">.</span> <span class="main">(</span> Neg <span class="bound">B</span> <span class="main">∈</span> <span class="bound">C</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">,</span> <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> 
                  <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="bound">B</span><span class="main">)</span> <span class="var">?SE</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="var"><span class="quoted"><span class="var">?exp</span></span></span><span class="main">)</span>
            <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>                
                <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="var">?exp</span>"</span></span>
                <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="skolem">A</span><span class="main">)</span> <span class="var">?SE</span><span class="main">)</span>"</span></span> 
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span>canonic_int_fun_ordered.simps <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="skolem">A</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>
                <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>canonic_int_fun_ordered <span class="skolem">A</span><span class="main">)</span> <span class="var">?SE</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">D</span></span> <span class="keyword2"><span class="keyword">where</span></span> 
                <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">∈</span> <span class="var">?SE</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="skolem">D</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span>"</span></span> 
                <span class="keyword2"><span class="keyword">and</span></span> c1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span> <span class="main">∀</span> <span class="bound">B</span><span class="main">.</span> <span class="main">(</span> Pos <span class="bound">B</span> <span class="main">∈</span> <span class="skolem">D</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">,</span> <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> 
                  <span class="main">⟶</span> <span class="main">(</span><span class="main">¬</span><span class="main">(</span>canonic_int_fun_ordered <span class="bound">B</span><span class="main">)</span> <span class="var">?SE</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
                <span class="keyword2"><span class="keyword">and</span></span> c2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span> <span class="main">∀</span> <span class="bound">B</span><span class="main">.</span> <span class="main">(</span> Neg <span class="bound">B</span> <span class="main">∈</span> <span class="skolem">D</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">,</span> <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> 
                  <span class="main">⟶</span> <span class="main">(</span><span class="main">(</span>canonic_int_fun_ordered <span class="bound">B</span><span class="main">)</span> <span class="var">?SE</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∈</span> <span class="var">?SE</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">D</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> 
              <span class="keyword1"><span class="command">unfolding</span></span> empty_selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∈</span> <span class="var">?SE</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span>"</span></span> 
              <span class="keyword1"><span class="command">unfolding</span></span> empty_selected_part_def all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?R</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">D</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span>›</span></span> 
                <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span> <span class="skolem">L</span>›</span></span> 
                <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">D</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>›</span></span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordered_sel_resolvent_upon <span class="free">Sel</span> <span class="skolem">D</span> <span class="skolem">C</span> <span class="var">?R</span> <span class="skolem">A</span><span class="main">)</span>"</span></span> 
                <span class="keyword1"><span class="command">unfolding</span></span> ordered_sel_resolvent_upon_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ordered_sel_resolvent <span class="free">Sel</span> <span class="skolem">D</span> <span class="skolem">C</span> <span class="var">?R</span>"</span></span> 
                <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ordered_sel_resolvent_upon_is_resolvent<span class="main">)</span>
              <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>ordered_sel_resolvent_upon <span class="free">Sel</span> <span class="skolem">D</span> <span class="skolem">C</span> <span class="var">?R</span> <span class="skolem">A</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">n</span>›</span></span> 
                <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">=</span> Suc <span class="skolem">m</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">D</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">C</span>›</span></span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="var">?R</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">m</span>"</span></span> 
                <span class="keyword1"><span class="command">using</span></span> resolution_decreases_selected_part <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹ordered_sel_resolvent <span class="free">Sel</span> <span class="skolem">D</span> <span class="skolem">C</span> <span class="var">?R</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∈</span> <span class="free">S</span>›</span></span><span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> 
                <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹saturated_binary_rule <span class="main">(</span>ordered_sel_resolvent <span class="free">Sel</span><span class="main">)</span> <span class="free">S</span>›</span></span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="var">?R</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> saturated_binary_rule_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"tautology <span class="var">?R</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span><span class="bound">RR</span><span class="main">.</span> <span class="main">(</span><span class="bound">RR</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∧</span> <span class="main">(</span>subsumes <span class="bound">RR</span> <span class="var">?R</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
                <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>  
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="var">?I</span> <span class="var">?R</span>"</span></span>
              <span class="keyword1"><span class="command">proof</span></span> 
                <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"tautology <span class="var">?R</span>"</span></span>
                <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="var">?I</span> <span class="var">?R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> tautologies_are_valid<span class="main">)</span>
              <span class="keyword1"><span class="command">next</span></span>
                <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">R'</span><span class="main">.</span> <span class="bound">R'</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∧</span> <span class="main">(</span>subsumes <span class="bound">R'</span> <span class="var">?R</span><span class="main">)</span>"</span></span>
                <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">R'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R'</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="skolem">R'</span> <span class="var">?R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">C</span>›</span></span><span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">D</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="var">?R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="var">?R</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="skolem">R'</span> <span class="var">?R</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"selected_part <span class="free">Sel</span> <span class="skolem">R'</span> <span class="main">⊆</span> selected_part <span class="free">Sel</span> <span class="var">?R</span>"</span></span> 
                  <span class="keyword1"><span class="command">unfolding</span></span> selected_part_def <span class="keyword2"><span class="keyword">and</span></span> subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="var">?R</span><span class="main">)</span>›</span></span> 
                  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">R'</span><span class="main">)</span> <span class="main">≤</span> card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="var">?R</span><span class="main">)</span>"</span></span> 
                  <span class="keyword1"><span class="command">using</span></span> card_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="var">?R</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">m</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">=</span> Suc <span class="skolem">m</span>›</span></span> 
                  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="skolem">R'</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> ind_hyp <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">R'</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="var">?I</span> <span class="skolem">R'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="skolem">R'</span> <span class="var">?R</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="var">?I</span> <span class="var">?R</span>"</span></span> 
                  <span class="keyword1"><span class="command">using</span></span> subsumption_and_semantics <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">R'</span></span> <span class="var"><span class="quoted"><span class="var">?R</span></span></span> <span class="var"><span class="quoted"><span class="var">?I</span></span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L'</span> <span class="main">∈</span> <span class="var">?R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"validate_literal <span class="var">?I</span> <span class="skolem">L'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L'</span> <span class="main">∉</span> <span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span> <span class="main">}</span>"</span></span> 
              <span class="keyword1"><span class="command">proof</span></span> 
                <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L'</span> <span class="main">∈</span> <span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span> <span class="main">}</span>"</span></span>
                <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L'</span> <span class="main">∈</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?A'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"atom <span class="skolem">L'</span>"</span></span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L'</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="var">?A'</span><span class="main">)</span> <span class="main">∨</span> <span class="skolem">L'</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="var">?A'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> atom_property <span class="main">[</span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?A'</span></span></span> <span class="quoted"><span class="skolem">L'</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
                <span class="keyword1"><span class="command">proof</span></span>
                  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L'</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="var">?A'</span><span class="main">)</span>"</span></span> 
                  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">D</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L'</span> <span class="main">∈</span> <span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span> <span class="main">}</span>›</span></span>
                  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A'</span><span class="main">,</span><span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">from</span></span> c1 
                  <span class="keyword1"><span class="command">have</span></span> c1'<span class="main">:</span> <span class="quoted"><span class="quoted">"Pos <span class="var">?A'</span> <span class="main">∈</span> <span class="skolem">D</span> <span class="main">⟶</span> <span class="main">(</span><span class="var">?A'</span><span class="main">,</span> <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> 
                                <span class="main">⟶</span> <span class="main">(</span><span class="main">¬</span><span class="main">(</span>canonic_int_fun_ordered <span class="var">?A'</span><span class="main">)</span> <span class="var">?SE</span><span class="main">)</span>"</span></span>
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L'</span> <span class="main">∈</span> <span class="skolem">D</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L'</span> <span class="main">=</span> Pos <span class="var">?A'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Pos <span class="var">?A'</span> <span class="main">∈</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
                  <span class="keyword1"><span class="command">from</span></span> c1' <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹Pos <span class="var">?A'</span> <span class="main">∈</span> <span class="skolem">D</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="var">?A'</span><span class="main">,</span><span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>›</span></span>  
                  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>canonic_int_fun_ordered <span class="var">?A'</span><span class="main">)</span> <span class="var">?SE</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A'</span> <span class="main">∉</span> <span class="var">?I</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> canonic_int_ordered_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>validate_literal <span class="var">?I</span> <span class="main">(</span>Pos <span class="var">?A'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L'</span> <span class="main">=</span> Pos <span class="var">?A'</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_literal <span class="var">?I</span> <span class="skolem">L'</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">next</span></span>
                  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L'</span> <span class="main">=</span> Neg <span class="var">?A'</span>"</span></span> 
                  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">D</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L'</span> <span class="main">∈</span> <span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span> <span class="main">}</span>›</span></span>
                  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?A'</span><span class="main">,</span><span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">from</span></span> c2 
                    <span class="keyword1"><span class="command">have</span></span> c2'<span class="main">:</span> <span class="quoted"><span class="quoted">"Neg <span class="var">?A'</span> <span class="main">∈</span> <span class="skolem">D</span> <span class="main">⟶</span> <span class="main">(</span><span class="var">?A'</span><span class="main">,</span> <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span> 
                      <span class="main">⟶</span> <span class="main">(</span>canonic_int_fun_ordered <span class="var">?A'</span><span class="main">)</span> <span class="var">?SE</span>"</span></span>
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L'</span> <span class="main">∈</span> <span class="skolem">D</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L'</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="var">?A'</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Neg <span class="var">?A'</span> <span class="main">∈</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
                  <span class="keyword1"><span class="command">from</span></span> c2' <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹Neg <span class="var">?A'</span> <span class="main">∈</span> <span class="skolem">D</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="var">?A'</span><span class="main">,</span><span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">atom_ordering</span>›</span></span>  
                  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>canonic_int_fun_ordered <span class="var">?A'</span><span class="main">)</span> <span class="var">?SE</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A'</span> <span class="main">∈</span> <span class="var">?I</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> canonic_int_ordered_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>validate_literal <span class="var">?I</span> <span class="main">(</span>Neg <span class="var">?A'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L'</span> <span class="main">=</span> Neg <span class="var">?A'</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_literal <span class="var">?I</span> <span class="skolem">L'</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">qed</span></span>
             <span class="keyword1"><span class="command">qed</span></span>
           <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L'</span> <span class="main">∈</span> <span class="var">?R</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L'</span> <span class="main">∈</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
           <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_literal <span class="var">?I</span> <span class="skolem">L'</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>validate_clause <span class="var">?I</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
         <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
 <span class="keyword1"><span class="command">qed</span></span>
 <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?P</span> <span class="skolem">n</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">=</span> card <span class="main">(</span>selected_part <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> ordered_resolution_is_complete_ordered_sel <span class="main">:</span> 
  <span class="quoted"><span class="quoted">"Complete <span class="main">(</span>ordered_sel_resolvent <span class="free">Sel</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>Complete <span class="main">(</span>ordered_sel_resolvent <span class="free">Sel</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">S</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule <span class="main">(</span>ordered_sel_resolvent <span class="free">Sel</span><span class="main">)</span> <span class="skolem">S</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="skolem">S</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∉</span> <span class="skolem">S</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>satisfiable <span class="skolem">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Complete_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?SE</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"empty_selected_part <span class="free">Sel</span> <span class="skolem">S</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?I</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"canonic_int_ordered <span class="var">?SE</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"validate_formula <span class="var">?I</span> <span class="skolem">S</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>validate_formula <span class="var">?I</span> <span class="skolem">S</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="skolem">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>validate_clause <span class="var">?I</span> <span class="skolem">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹saturated_binary_rule <span class="main">(</span>ordered_sel_resolvent <span class="free">Sel</span><span class="main">)</span> <span class="skolem">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="skolem">S</span>›</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{}</span> <span class="main">∉</span> <span class="skolem">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="skolem">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span>validate_clause <span class="var">?I</span> <span class="skolem">C</span><span class="main">)</span>›</span></span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">using</span></span> canonic_int_validates_all_clauses_sel <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">Sel</span></span> <span class="quoted"><span class="skolem">S</span></span> <span class="quoted"><span class="skolem">C</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>validate_formula <span class="var">?I</span> <span class="skolem">S</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span>satisfiable <span class="skolem">S</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> satisfiable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Semantic Resolution›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We show that under some particular renaming, model resolution simulates ordered resolution 
where all negative literals are selected, which immediately entails the refutational completeness 
of model resolution.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ordered_res_with_selection_is_model_res <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"ordered_sel_resolvent UNIV <span class="free">P1</span> <span class="free">P2</span> <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ordered_model_resolvent <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">P1</span><span class="main">)</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span> 
            <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> 
  <span class="keyword2"><span class="keyword">where</span></span> c_def<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"selected_part UNIV <span class="free">P1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="free">P1</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> disj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>strictly_maximal_literal <span class="free">P2</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>selected_part UNIV <span class="free">P2</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span><span class="main">)</span> 
      <span class="main">∨</span> strictly_maximal_literal <span class="main">(</span>selected_part UNIV <span class="free">P2</span><span class="main">)</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ordered_sel_resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="main">(</span><span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span> 
    <span class="main">=</span>  <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">∪</span> rename_clause <span class="free">Sel</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span> <span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> rename_union <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">Sel</span></span> <span class="quoted"><span class="quoted">"<span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span> <span class="main">}</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">A</span> <span class="main">}</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> c_def <span class="keyword1"><span class="command">have</span></span> ren_c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span> <span class="main">=</span>
    <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">∪</span> rename_clause <span class="free">Sel</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span> <span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> m1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">P1</span><span class="main">)</span> 
              <span class="main">-</span> <span class="main">{</span> rename_literal <span class="free">Sel</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span> <span class="main">}</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> renaming_set_minus <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> m2<span class="main">:</span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span> 
              <span class="main">-</span> <span class="main">{</span> rename_literal <span class="free">Sel</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span> <span class="main">}</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> renaming_set_minus <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> m1 <span class="keyword2"><span class="keyword">and</span></span> m2 <span class="keyword2"><span class="keyword">and</span></span> ren_c <span class="keyword1"><span class="command">have</span></span> 
  rc_def<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span> <span class="main">=</span> 
    <span class="main">(</span><span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">P1</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span> rename_literal <span class="free">Sel</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span> <span class="main">}</span><span class="main">)</span>
    <span class="main">∪</span> <span class="main">(</span><span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span> rename_literal <span class="free">Sel</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>  <span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">(</span>strictly_maximal_literal <span class="free">P2</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>selected_part UNIV <span class="free">P2</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>strictly_maximal_literal <span class="free">P2</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>selected_part UNIV <span class="free">P2</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="free">P2</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"selected_part UNIV <span class="free">P2</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="free">P2</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Neg <span class="skolem">A</span> <span class="main">∈</span> <span class="free">P2</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹selected_part UNIV <span class="free">P2</span> <span class="main">=</span> <span class="main">{}</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> selected_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> disj <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="main">(</span>selected_part UNIV <span class="free">P2</span><span class="main">)</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="main">(</span>validated_part <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> renaming_and_selected_part <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="main">(</span>validated_part <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> 
        <span class="main">(</span>rename_literal <span class="free">Sel</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> renaming_preserves_strictly_maximal_literal <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> 
    p1<span class="main">:</span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="main">(</span>validated_part <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span><span class="main">)</span> 
      <span class="main">(</span>rename_literal <span class="free">Sel</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> inverse_clause_renaming  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="free">P1</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> p2<span class="main">:</span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">P1</span><span class="main">)</span> <span class="main">(</span>rename_literal <span class="free">Sel</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> renaming_preserves_strictly_maximal_literal <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>selected_part UNIV <span class="free">P1</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="main">(</span>validated_part <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">P1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> renaming_and_selected_part <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> q<span class="main">:</span> <span class="quoted"><span class="quoted">"validated_part <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">P1</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>   
    <span class="keyword1"><span class="command">unfolding</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> r<span class="main">:</span> <span class="quoted"><span class="quoted">"rename_literal <span class="free">Sel</span> <span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span> <span class="main">=</span> complement <span class="main">(</span>rename_literal <span class="free">Sel</span> <span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> rename_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> r <span class="keyword2"><span class="keyword">and</span></span> q <span class="keyword2"><span class="keyword">and</span></span> p1 <span class="keyword2"><span class="keyword">and</span></span> p2 <span class="keyword2"><span class="keyword">and</span></span> rc_def <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"ordered_model_resolvent <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">P1</span><span class="main">)</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">P2</span><span class="main">)</span><span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="free">C</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> ordered_model_resolvent_def <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">Sel</span></span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="free">P1</span>"</span></span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="free">P2</span>"</span></span> 
      <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="free">C</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> ordered_resolution_is_complete_model_resolution<span class="main">:</span>
  <span class="quoted"><span class="quoted">"Complete <span class="main">(</span>ordered_model_resolvent <span class="free">Sel</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>Complete <span class="main">(</span>ordered_model_resolvent <span class="free">Sel</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">S</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule <span class="main">(</span>ordered_model_resolvent <span class="free">Sel</span><span class="main">)</span> <span class="skolem">S</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∉</span> <span class="skolem">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="skolem">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>satisfiable <span class="skolem">S</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Complete_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?S'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"rename_formula <span class="free">Sel</span> <span class="skolem">S</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∉</span> <span class="var">?S'</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∈</span> <span class="var">?S'</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">V</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">∈</span> <span class="skolem">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="skolem">V</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> rename_formula_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹rename_clause <span class="free">Sel</span> <span class="skolem">V</span> <span class="main">=</span> <span class="main">{}</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">V</span> <span class="main">∈</span> <span class="skolem">S</span>›</span></span>  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{}</span> <span class="main">∉</span> <span class="skolem">S</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="skolem">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="var">?S'</span>"</span></span> 
  <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def rename_formula_def rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule <span class="main">(</span>ordered_sel_resolvent UNIV<span class="main">)</span> <span class="var">?S'</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>saturated_binary_rule <span class="main">(</span>ordered_sel_resolvent UNIV<span class="main">)</span> <span class="var">?S'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> <span class="var">?S'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> <span class="var">?S'</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ordered_sel_resolvent UNIV <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>tautology <span class="skolem">C</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> not_subsumed<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">D</span><span class="main">.</span> <span class="main">(</span><span class="bound">D</span> <span class="main">∈</span> <span class="var">?S'</span> <span class="main">⟶</span> <span class="main">¬</span>subsumes <span class="bound">D</span> <span class="skolem">C</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> saturated_binary_rule_def redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>  
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹ordered_sel_resolvent UNIV <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> ord_ren<span class="main">:</span> <span class="quoted"><span class="quoted">"ordered_model_resolvent <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="skolem">P1</span><span class="main">)</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="skolem">P2</span><span class="main">)</span> 
                        <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> ordered_res_with_selection_is_model_res <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>tautology <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> renaming_preserves_tautology inverse_clause_renaming 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> tautology <span class="skolem">C</span>›</span></span> inverse_clause_renaming renaming_preserves_tautology<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="var">?S'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="skolem">P1</span> <span class="main">∈</span> rename_formula <span class="free">Sel</span> <span class="var">?S'</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> rename_formula_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="skolem">P1</span> <span class="main">∈</span> <span class="skolem">S</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inverse_formula_renaming <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> <span class="var">?S'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="skolem">P2</span> <span class="main">∈</span> rename_formula <span class="free">Sel</span> <span class="var">?S'</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> rename_formula_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="skolem">P2</span> <span class="main">∈</span> <span class="skolem">S</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inverse_formula_renaming <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>tautology <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> ord_ren 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹saturated_binary_rule <span class="main">(</span>ordered_model_resolvent <span class="free">Sel</span><span class="main">)</span> <span class="skolem">S</span>›</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹rename_clause <span class="free">Sel</span> <span class="skolem">P1</span> <span class="main">∈</span> <span class="skolem">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹rename_clause <span class="free">Sel</span> <span class="skolem">P2</span> <span class="main">∈</span> <span class="skolem">S</span>›</span></span> 
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">D'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D'</span> <span class="main">∈</span> <span class="skolem">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="skolem">D'</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> saturated_binary_rule_def redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="skolem">D'</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="skolem">D'</span><span class="main">)</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="skolem">C</span><span class="main">)</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> renaming_preserves_subsumption <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="skolem">D'</span><span class="main">)</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inverse_clause_renaming <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D'</span> <span class="main">∈</span> <span class="skolem">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_clause <span class="free">Sel</span> <span class="skolem">D'</span> <span class="main">∈</span> <span class="var">?S'</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> rename_formula_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> not_subsumed <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹subsumes <span class="main">(</span>rename_clause <span class="free">Sel</span> <span class="skolem">D'</span><span class="main">)</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{}</span> <span class="main">∉</span> <span class="var">?S'</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="var">?S'</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"satisfiable <span class="var">?S'</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> ordered_resolution_is_complete_ordered_sel <span class="keyword1"><span class="command">unfolding</span></span> Complete_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"satisfiable <span class="main">(</span>rename_formula <span class="free">Sel</span> <span class="var">?S'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> renaming_preserves_satisfiability  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>satisfiable <span class="skolem">S</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">using</span></span> inverse_formula_renaming <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Positive and Negative Resolution›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We show that positive and negative resolution simulate model resolution 
with some specific interpretation. Then completeness follows from previous results.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> empty_interpretation_validate <span class="main">:</span>
  <span class="quoted"><span class="quoted">"validate_literal <span class="main">{}</span> <span class="free">L</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span><span class="bound">A</span><span class="main">.</span> <span class="main">(</span><span class="free">L</span> <span class="main">=</span> Neg <span class="bound">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> empty_iff validate_literal.elims<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> validate_literal.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> universal_interpretation_validate <span class="main">:</span>
  <span class="quoted"><span class="quoted">"validate_literal UNIV <span class="free">L</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span><span class="bound">A</span><span class="main">.</span> <span class="main">(</span><span class="free">L</span> <span class="main">=</span> Pos <span class="bound">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> UNIV_I validate_literal.elims<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> validate_literal.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> negative_part_lemma<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span>negative_part <span class="free">C</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>validated_part <span class="main">{}</span> <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> negative_part_def validated_part_def <span class="keyword1"><span class="command">using</span></span> empty_interpretation_validate <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> positive_part_lemma<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span>positive_part <span class="free">C</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>validated_part UNIV <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> positive_part_def validated_part_def <span class="keyword1"><span class="command">using</span></span> universal_interpretation_validate <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> negative_resolvent_is_model_res<span class="main">:</span>
  <span class="quoted"><span class="quoted">"less_restrictive ordered_negative_resolvent <span class="main">(</span>ordered_model_resolvent UNIV<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> ordered_negative_resolvent_def ordered_model_resolvent_def  less_restrictive_def 
  <span class="keyword1"><span class="command">using</span></span> positive_part_lemma <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> positive_resolvent_is_model_res<span class="main">:</span>
  <span class="quoted"><span class="quoted">"less_restrictive ordered_positive_resolvent <span class="main">(</span>ordered_model_resolvent <span class="main">{}</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> ordered_positive_resolvent_def ordered_model_resolvent_def less_restrictive_def 
  <span class="keyword1"><span class="command">using</span></span> negative_part_lemma <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">theorem</span></span> ordered_positive_resolvent_is_complete <span class="main">:</span> <span class="quoted"><span class="quoted">"Complete ordered_positive_resolvent"</span></span>
<span class="keyword1"><span class="command">using</span></span> ordered_resolution_is_complete_model_resolution less_restrictive_complete positive_resolvent_is_model_res <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">theorem</span></span> ordered_negative_resolvent_is_complete<span class="main">:</span> <span class="quoted"><span class="quoted">"Complete ordered_negative_resolvent"</span></span>
<span class="keyword1"><span class="command">using</span></span> ordered_resolution_is_complete_model_resolution less_restrictive_complete negative_resolvent_is_model_res <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Unit Resolution and Horn Renamable Clauses›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Unit resolution is complete if the considered clause set can be transformed into a 
Horn clause set by renaming. 
This result is proven by showing that unit resolution simulates
semantic resolution for Horn-renamable clauses (for some specific interpretation).›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">Horn</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Clause <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">Horn</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>card <span class="main">(</span>positive_part <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">Horn_renamable_formula</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Formula <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">Horn_renamable_formula</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span><span class="bound">I</span><span class="main">.</span> <span class="main">(</span>all_fulfill Horn <span class="main">(</span>rename_formula <span class="bound">I</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">theorem</span></span> unit_resolvent_complete_for_Horn_renamable_set<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule unit_resolvent <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∉</span> <span class="free">S</span>"</span></span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Horn_renamable_formula <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"satisfiable <span class="free">S</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹Horn_renamable_formula <span class="free">S</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">I</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"all_fulfill Horn <span class="main">(</span>rename_formula <span class="skolem">I</span> <span class="free">S</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> Horn_renamable_formula_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule <span class="main">(</span>ordered_model_resolvent <span class="skolem">I</span><span class="main">)</span> <span class="free">S</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>saturated_binary_rule <span class="main">(</span>ordered_model_resolvent <span class="skolem">I</span><span class="main">)</span> <span class="free">S</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"ordered_model_resolvent <span class="skolem">I</span> <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>redundant <span class="skolem">C</span> <span class="free">S</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> saturated_binary_rule_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹ordered_model_resolvent <span class="skolem">I</span> <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> 
      <span class="keyword2"><span class="keyword">where</span></span> def_c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> <span class="main">(</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> <span class="skolem">L</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span> <span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> <span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span> <span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="skolem">P1</span> <span class="skolem">L</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"validated_part <span class="skolem">I</span> <span class="skolem">P1</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"strictly_maximal_literal <span class="main">(</span>validated_part <span class="skolem">I</span> <span class="skolem">P2</span><span class="main">)</span> <span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> ordered_model_resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">P1</span> <span class="skolem">L</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">P1</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="main">(</span>validated_part <span class="skolem">I</span> <span class="skolem">P2</span><span class="main">)</span> <span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"complement <span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">P2</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def validated_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"selected_part UNIV <span class="main">(</span>rename_clause <span class="skolem">I</span> <span class="skolem">P1</span><span class="main">)</span> 
      <span class="main">=</span>  rename_clause <span class="skolem">I</span> <span class="main">(</span>validated_part <span class="skolem">I</span> <span class="main">(</span>rename_clause <span class="skolem">I</span> <span class="main">(</span>rename_clause <span class="skolem">I</span> <span class="skolem">P1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> renaming_and_selected_part <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"rename_clause <span class="skolem">I</span> <span class="skolem">P1</span>"</span></span> <span class="quoted"><span class="skolem">I</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"selected_part UNIV <span class="main">(</span>rename_clause <span class="skolem">I</span> <span class="skolem">P1</span><span class="main">)</span> <span class="main">=</span>  rename_clause <span class="skolem">I</span> <span class="main">(</span>validated_part <span class="skolem">I</span> <span class="skolem">P1</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> inverse_clause_renaming <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validated_part <span class="skolem">I</span> <span class="skolem">P1</span> <span class="main">=</span> <span class="main">{}</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"selected_part UNIV <span class="main">(</span>rename_clause <span class="skolem">I</span> <span class="skolem">P1</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"negative_part <span class="main">(</span>rename_clause <span class="skolem">I</span> <span class="skolem">P1</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> selected_part_def negative_part_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹all_fulfill Horn <span class="main">(</span>rename_formula <span class="skolem">I</span> <span class="free">S</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Horn <span class="main">(</span>rename_clause <span class="skolem">I</span> <span class="skolem">P1</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def <span class="keyword2"><span class="keyword">and</span></span> rename_formula_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>positive_part <span class="main">(</span>rename_clause <span class="skolem">I</span> <span class="skolem">P1</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Horn_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹negative_part <span class="main">(</span>rename_clause <span class="skolem">I</span> <span class="skolem">P1</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_clause <span class="skolem">I</span> <span class="skolem">P1</span> <span class="main">=</span> <span class="main">(</span>positive_part <span class="main">(</span>rename_clause <span class="skolem">I</span> <span class="skolem">P1</span><span class="main">)</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> decomposition_clause_pos_neg <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹card <span class="main">(</span>positive_part <span class="main">(</span>rename_clause <span class="skolem">I</span> <span class="skolem">P1</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>rename_clause <span class="skolem">I</span> <span class="skolem">P1</span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹strictly_maximal_literal <span class="skolem">P1</span> <span class="skolem">L</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rename_clause <span class="skolem">I</span> <span class="skolem">P1</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">P1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>rename_clause <span class="skolem">I</span> <span class="skolem">P1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> rename_clause_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹rename_clause <span class="skolem">I</span> <span class="skolem">P1</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card<span class="main">(</span>rename_clause <span class="skolem">I</span> <span class="skolem">P1</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> card_0_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹card <span class="main">(</span>rename_clause <span class="skolem">I</span> <span class="skolem">P1</span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>rename_clause <span class="skolem">I</span> <span class="skolem">P1</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">P1</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> renaming_preserves_cardinality <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Unit <span class="skolem">P1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Unit_def <span class="keyword1"><span class="command">using</span></span> card_image <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">P1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹complement <span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">P2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> def_c <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"unit_resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> unit_resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span>redundant <span class="skolem">C</span> <span class="free">S</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹saturated_binary_rule unit_resolvent <span class="free">S</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> saturated_binary_rule_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{}</span> <span class="main">∉</span> <span class="free">S</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">using</span></span> ordered_resolution_is_complete_model_resolution <span class="keyword1"><span class="command">unfolding</span></span> Complete_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Computation of Saturated Clause Sets›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We now provide a concrete (rather straightforward) procedure for computing saturated clause 
sets. Starting from the initial set, we define a sequence of clause sets, where each set is obtained 
from the previous one by applying the resolution rule in a systematic way, followed by redundancy 
elimination rules. The algorithm is generic, in the sense that it applies to any binary 
inference rule.›</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">inferred_clause_sets</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> BinaryRule <span class="main">⇒</span> <span class="tfree">'at</span> Formula <span class="main">⇒</span> nat <span class="main">⇒</span> <span class="tfree">'at</span> Formula"</span></span>
 <span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">inferred_clause_sets</span> <span class="free"><span class="bound"><span class="entity">R</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>simplify <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span>"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">inferred_clause_sets</span> <span class="free"><span class="bound"><span class="entity">R</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">(</span>Suc <span class="free"><span class="bound"><span class="entity">N</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> 
    <span class="main">(</span>simplify <span class="main">(</span>add_all_deducible_clauses <span class="free"><span class="bound"><span class="entity">R</span></span></span> <span class="main">(</span><span class="free">inferred_clause_sets</span> <span class="free"><span class="bound"><span class="entity">R</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">N</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The saturated set is constructed by considering the set of persistent clauses, i.e.,
the clauses that are generated and never deleted.›</span></span>
 
<span class="keyword1"><span class="command">fun</span></span> <span class="entity">saturation</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> BinaryRule <span class="main">⇒</span> <span class="tfree">'at</span> Formula <span class="main">⇒</span> <span class="tfree">'at</span> Formula"</span></span>
 <span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">saturation</span> <span class="free"><span class="bound"><span class="entity">R</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">=</span> <span class="main">{</span> <span class="bound">C</span><span class="main">.</span> <span class="main">∃</span><span class="bound">N</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">M</span><span class="main">.</span> <span class="main">(</span><span class="bound">M</span> <span class="main">≥</span> <span class="bound">N</span> <span class="main">⟶</span> <span class="bound">C</span> <span class="main">∈</span> inferred_clause_sets <span class="free"><span class="bound"><span class="entity">R</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="bound">M</span><span class="main">)</span><span class="main">)</span> <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We prove that all inference rules yield finite clauses.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> ordered_resolvent_is_finite <span class="main">:</span> <span class="quoted"><span class="quoted">"derived_clauses_are_finite ordered_resolvent"</span></span>
<span class="keyword1"><span class="command">using</span></span> less_restrictive_and_finite ordered_resolvent_is_resolvent resolvent_is_finite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">theorem</span></span> model_resolvent_is_finite <span class="main">:</span> <span class="quoted"><span class="quoted">"derived_clauses_are_finite <span class="main">(</span>ordered_model_resolvent <span class="free">I</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> less_restrictive_and_finite ordered_model_resolvent_is_resolvent resolvent_is_finite 
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">theorem</span></span> positive_resolvent_is_finite <span class="main">:</span> <span class="quoted"><span class="quoted">"derived_clauses_are_finite ordered_positive_resolvent"</span></span>
<span class="keyword1"><span class="command">using</span></span> less_restrictive_and_finite positive_resolvent_is_resolvent resolvent_is_finite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">theorem</span></span> negative_resolvent_is_finite <span class="main">:</span> <span class="quoted"><span class="quoted">"derived_clauses_are_finite ordered_negative_resolvent"</span></span>
<span class="keyword1"><span class="command">using</span></span> less_restrictive_and_finite negative_resolvent_is_resolvent resolvent_is_finite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">theorem</span></span> unit_resolvent_is_finite <span class="main">:</span> <span class="quoted"><span class="quoted">"derived_clauses_are_finite unit_resolvent"</span></span>
<span class="keyword1"><span class="command">using</span></span> less_restrictive_and_finite unit_resolvent_is_resolvent resolvent_is_finite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> all_deducible_clauses_are_finite<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"derived_clauses_are_finite <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span>all_deducible_clauses <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>all_fulfill finite <span class="main">(</span>all_deducible_clauses <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> all_deducible_clauses <span class="free">R</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>finite <span class="skolem">C</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> all_deducible_clauses <span class="free">R</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">P1</span> <span class="bound">P2</span><span class="main">.</span> <span class="free">R</span> <span class="bound">P1</span> <span class="bound">P2</span> <span class="skolem">C</span> <span class="main">∧</span> <span class="bound">P1</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∧</span> <span class="bound">P2</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span> <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">P1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">P2</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span>  all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">P1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">P2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹derived_clauses_are_finite <span class="free">R</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">R</span> <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>finite <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> derived_clauses_are_finite_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹This entails that all the clauses occurring in the sets in the sequence are finite.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> all_inferred_clause_sets_are_finite<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"derived_clauses_are_finite <span class="free">R</span>"</span></span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="free">N</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">N</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">0</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> simplify_finite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">N</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span>all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> all_deducible_clauses_are_finite <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">R</span></span> <span class="quoted"><span class="quoted">"inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span>Suc <span class="skolem">N</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> simplify_finite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>  

<span class="keyword1"><span class="command">lemma</span></span> add_all_deducible_clauses_finite<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"derived_clauses_are_finite <span class="free">R</span>"</span></span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="free">N</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span>all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="free">N</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> all_deducible_clauses_are_finite <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">R</span></span> <span class="quoted"><span class="quoted">"inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="free">N</span>"</span></span><span class="main">]</span> 
    all_inferred_clause_sets_are_finite <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">R</span></span> <span class="quoted"><span class="free">S</span></span> <span class="quoted"><span class="free">N</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="free">N</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms all_fulfill_def all_inferred_clause_sets_are_finite <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">R</span></span> <span class="quoted"><span class="free">S</span></span> <span class="quoted"><span class="quoted">"<span class="free">N</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We show that the set of redundant clauses can only increase.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> sequence_of_inferred_clause_sets_is_monotonous<span class="main">:</span> 
 <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"derived_clauses_are_finite <span class="free">R</span>"</span></span>
 <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
 <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">C</span><span class="main">.</span> redundant <span class="bound">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="free">N</span><span class="main">)</span> 
  <span class="main">⟶</span> redundant <span class="bound">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="free">M</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">M</span></span><span class="main">)</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> inferred_clause_sets.simps<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">M</span> <span class="skolem">C</span> <span class="keyword3"><span class="command">assume</span></span> ind_hyp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">C</span><span class="main">.</span> redundant <span class="bound">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="free">N</span><span class="main">)</span> 
    <span class="main">⟶</span> redundant <span class="bound">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="skolem">M</span><span class="main">::</span>nat<span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="free">N</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> ind_hyp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="skolem">M</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="skolem">M</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> deducible_clause_preserve_redundancy <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="skolem">M</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms  add_all_deducible_clauses_finite <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">R</span></span> <span class="quoted"><span class="free">S</span></span> <span class="quoted"><span class="quoted">"<span class="free">N</span><span class="main">+</span><span class="skolem">M</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹redundant <span class="skolem">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="free">N</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> ind_hyp 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="skolem">M</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹redundant <span class="skolem">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="skolem">M</span><span class="main">)</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="skolem">M</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> deducible_clause_preserve_redundancy <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="skolem">M</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span>simplify <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="skolem">M</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> simplify_preserves_redundancy <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span>Suc <span class="main">(</span><span class="free">N</span> <span class="main">+</span> <span class="skolem">M</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We show that non-persistent clauses are strictly redundant in some element of the 
sequence.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> non_persistent_clauses_are_redundant<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">D</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="free">N</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">D</span> <span class="main">∉</span> saturation <span class="free">R</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"derived_clauses_are_finite <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">M</span><span class="main">.</span> strictly_redundant <span class="free">D</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="bound">M</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> hyp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">M</span><span class="main">.</span> strictly_redundant <span class="free">D</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="bound">M</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">{</span></span> 
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">M</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">D</span> <span class="main">∈</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="skolem">M</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="skolem">M</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">D</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">M</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">D</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="skolem">M</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">D</span> <span class="main">∈</span> add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="skolem">M</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">D</span> <span class="main">∈</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="main">(</span>Suc <span class="skolem">M</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">D</span> <span class="main">∉</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="main">(</span>Suc <span class="skolem">M</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">D</span> <span class="main">∈</span> add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="skolem">M</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"strictly_redundant <span class="free">D</span> <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="skolem">M</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> simplify_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="skolem">M</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">)</span> assms<span class="main">(</span>3<span class="main">)</span>  add_all_deducible_clauses_finite <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">R</span></span> <span class="quoted"><span class="free">S</span></span> <span class="quoted"><span class="quoted">"<span class="free">N</span><span class="main">+</span><span class="skolem">M</span>"</span></span><span class="main">]</span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

        <span class="keyword1"><span class="command">from</span></span> this 
          <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹strictly_redundant <span class="free">D</span> <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="skolem">M</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"strictly_redundant <span class="free">D</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="main">(</span>Suc <span class="skolem">M</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> simplify_preserves_strict_redundancy <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> hyp <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∀</span><span class="bound">M'</span><span class="main">.</span> <span class="main">(</span><span class="bound">M'</span> <span class="main">≥</span> <span class="free">N</span> <span class="main">⟶</span> <span class="free">D</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="bound">M'</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">M'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M'</span> <span class="main">≥</span> <span class="free">N</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">D</span> <span class="main">∉</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">M'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">M'</span> <span class="main">≥</span> <span class="free">N</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N'</span></span><span class="main">::</span> <span class="quoted">nat</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">N'</span> <span class="main">=</span> <span class="skolem">M'</span> <span class="main">-</span> <span class="free">N</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">D</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span><span class="main">+</span><span class="main">(</span><span class="skolem">M'</span><span class="main">-</span><span class="free">N</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">M</span><span class="main">.</span> <span class="free">D</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span><span class="free">N</span> <span class="main">+</span> <span class="bound">M</span><span class="main">)</span>›</span></span><span class="main">)</span> 
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">D</span> <span class="main">∉</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">M'</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="free">N</span> <span class="main">≤</span> <span class="skolem">M'</span>›</span></span><span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>        

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹This entails that the clauses that are redundant in some set in the sequence are also 
redundant in the set of persistent clauses.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> persistent_clauses_subsume_redundant_clauses<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="free">N</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"derived_clauses_are_finite <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"finite <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?nat_order</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span>nat<span class="main">,</span><span class="bound">y</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span> <span class="bound">x</span> <span class="main">&lt;</span> <span class="bound">y</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">I</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">C</span> <span class="bound">N</span><span class="main">.</span> finite <span class="bound">C</span> <span class="main">⟶</span> card <span class="bound">C</span> <span class="main">=</span> <span class="skolem">I</span> 
         <span class="main">⟶</span> <span class="main">(</span>redundant <span class="bound">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="bound">N</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> redundant <span class="bound">C</span> <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="skolem">I</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">rule</span> wf_induct <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var"><span class="quoted"><span class="var">?nat_order</span></span></span></span></span> <span class="var"><span class="quoted"><span class="var"><span class="quoted"><span class="var">?P</span></span></span></span></span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">I</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span><span class="main"><span class="keyword3">,</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>wf<span class="main">)</span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">I</span> <span class="keyword3"><span class="command">assume</span></span> hyp_induct<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">J</span><span class="main">.</span> <span class="main">(</span><span class="bound">J</span><span class="main">,</span><span class="skolem">I</span><span class="main">)</span> <span class="main">∈</span> <span class="var">?nat_order</span> <span class="main">⟶</span> <span class="main">(</span><span class="var">?P</span> <span class="bound">J</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="skolem">I</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">rule</span> allI<span class="main">)</span><span class="main"><span class="keyword3">+</span></span><span class="main"><span class="keyword3">,</span></span><span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">C</span> <span class="skolem">N</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">C</span>"</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">C</span> <span class="main">=</span> <span class="skolem">I</span>"</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"tautology <span class="skolem">C</span>"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>tautology <span class="skolem">C</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="skolem">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">D</span></span> 
          <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="skolem">D</span> <span class="skolem">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">∈</span> saturation <span class="free">R</span> <span class="free">S</span>"</span></span>
          <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="skolem">D</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span> 
            <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">∉</span> saturation <span class="free">R</span> <span class="free">S</span>"</span></span>
          <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>2<span class="main">)</span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∉</span> saturation <span class="free">R</span> <span class="free">S</span>›</span></span>
          <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">M</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"strictly_redundant <span class="skolem">D</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">M</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 
            non_persistent_clauses_are_redundant <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">D</span></span> <span class="quoted"><span class="free">R</span></span> <span class="quoted"><span class="free">S</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="skolem">D</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>tautology <span class="skolem">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>tautology <span class="skolem">D</span>"</span></span> 
            <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹strictly_redundant <span class="skolem">D</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">M</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>tautology <span class="skolem">D</span>›</span></span> 
            <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">D'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D'</span> <span class="main">⊂</span> <span class="skolem">D</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D'</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">M</span>"</span></span>
            <span class="keyword1"><span class="command">unfolding</span></span> strictly_redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D'</span> <span class="main">⊂</span> <span class="skolem">D</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="skolem">D</span> <span class="skolem">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D'</span> <span class="main">⊂</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D'</span> <span class="main">⊂</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D'</span>"</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> psubset_imp_subset rev_finite_subset<span class="main">)</span> 
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D'</span> <span class="main">⊂</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">D'</span> <span class="main">&lt;</span> card <span class="skolem">C</span>"</span></span> 
              <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def 
              <span class="keyword1"><span class="command">using</span></span> psubset_card_mono  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹card <span class="skolem">C</span> <span class="main">=</span> <span class="skolem">I</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>card <span class="skolem">D'</span><span class="main">,</span><span class="skolem">I</span><span class="main">)</span> <span class="main">∈</span> <span class="var">?nat_order</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D'</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">M</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">D'</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">M</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">unfolding</span></span> redundant_def subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span>  hyp_induct <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>card <span class="skolem">D'</span><span class="main">,</span><span class="skolem">I</span><span class="main">)</span> <span class="main">∈</span> <span class="var">?nat_order</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">(</span>card <span class="skolem">D'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
          <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">D'</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="skolem">D'</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">M</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 
            <span class="quoted"><span class="quoted">"redundant <span class="skolem">D'</span> <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> <span class="quoted"><span class="quoted">‹<span class="skolem">D'</span> <span class="main">⊂</span> <span class="skolem">C</span>›</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="skolem">D'</span> <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span>›</span></span> 
              psubset_imp_subset subsumes_def subsumption_preserves_redundancy<span class="main">)</span> 
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
 <span class="keyword1"><span class="command">qed</span></span>
 <span class="keyword1"><span class="command">}</span></span>
 <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We deduce that the set of persistent clauses is saturated.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> persistent_clauses_are_saturated<span class="main">:</span>
 <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"derived_clauses_are_finite <span class="free">R</span>"</span></span>
 <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule <span class="free">R</span> <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?S</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"saturation <span class="free">R</span> <span class="free">S</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>saturated_binary_rule <span class="free">R</span> <span class="var">?S</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span> <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> <span class="var">?S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> <span class="var">?S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>redundant <span class="skolem">C</span> <span class="var">?S</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> saturated_binary_rule_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="var">?S</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N1</span></span> <span class="keyword2"><span class="keyword">where</span></span> i<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">M</span><span class="main">.</span> <span class="main">(</span><span class="bound">M</span> <span class="main">≥</span> <span class="skolem">N1</span> <span class="main">⟶</span> <span class="skolem">P1</span> <span class="main">∈</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="bound">M</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> <span class="var">?S</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N2</span></span> <span class="keyword2"><span class="keyword">where</span></span> ii<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">M</span><span class="main">.</span> <span class="main">(</span><span class="bound">M</span> <span class="main">≥</span> <span class="skolem">N2</span> <span class="main">⟶</span> <span class="skolem">P2</span> <span class="main">∈</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="bound">M</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?N</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"max <span class="skolem">N1</span> <span class="skolem">N2</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?N</span> <span class="main">≥</span> <span class="skolem">N1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?N</span> <span class="main">≥</span> <span class="skolem">N2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> i <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="var">?N</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?N</span> <span class="main">≥</span> <span class="skolem">N2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> ii <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="var">?N</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">R</span> <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="var">?N</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="var">?N</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> all_deducible_clauses <span class="free">R</span> <span class="main">(</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="var">?N</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="var">?N</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="var">?N</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> all_inferred_clause_sets_are_finite <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">R</span></span> <span class="quoted"><span class="free">S</span></span> <span class="var"><span class="quoted"><span class="var">?N</span></span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="var">?N</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> add_all_deducible_clauses_finite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="var">?N</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span>Suc <span class="var">?N</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> simplify_and_membership
    <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="var">?N</span><span class="main">)</span>"</span></span> 
      <span class="quoted"><span class="quoted">"inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span>Suc <span class="var">?N</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="skolem">C</span></span><span class="main">]</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">P1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span>max <span class="skolem">N1</span> <span class="skolem">N2</span><span class="main">)</span>›</span></span>
      <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span>max <span class="skolem">N1</span> <span class="skolem">N2</span><span class="main">)</span><span class="main">)</span>›</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">P2</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span>max <span class="skolem">N1</span> <span class="skolem">N2</span><span class="main">)</span>›</span></span>
      <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span>max <span class="skolem">N1</span> <span class="skolem">N2</span><span class="main">)</span><span class="main">)</span>›</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">R</span> <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">P1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">P2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹derived_clauses_are_finite <span class="free">R</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">C</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> derived_clauses_are_finite_def  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> assms this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="skolem">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span>Suc <span class="var">?N</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span>  persistent_clauses_subsume_redundant_clauses <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">C</span></span> <span class="quoted"><span class="free">R</span></span> <span class="quoted"><span class="free">S</span></span> <span class="quoted"><span class="quoted">"Suc <span class="var">?N</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>redundant <span class="skolem">C</span> <span class="var">?S</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
 <span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Finally, we show that the computed saturated set is equivalent to the initial formula.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> saturation_is_correct<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Sound <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"derived_clauses_are_finite <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"equivalent <span class="free">S</span> <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="free">S</span> <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> entails_formula <span class="free">S</span> <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> saturation <span class="free">R</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> entails <span class="free">S</span> <span class="skolem">C</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> entails_formula_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> saturation <span class="free">R</span> <span class="free">S</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">N</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">{</span></span> 
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">N</span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="free">S</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="skolem">N</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="free">S</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">0</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> simplify_preserves_semantic validity_implies_entailment <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">N</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="free">S</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span><span class="main">)</span>   
          <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> add_all_deducible_sound  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹entails_formula <span class="free">S</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span><span class="main">)</span>›</span></span> 
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="free">S</span> <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> entails_transitive 
        <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">S</span></span> <span class="quoted"><span class="quoted">"inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span>"</span></span> <span class="quoted"><span class="quoted">"add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span><span class="main">)</span>"</span></span><span class="main">]</span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span>Suc <span class="skolem">N</span><span class="main">)</span> <span class="main">⊆</span> add_all_deducible_clauses <span class="free">R</span> 
                <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> simplify_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span><span class="main">)</span><span class="main">)</span>
              <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span>Suc <span class="skolem">N</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> entailment_subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹entails_formula <span class="free">S</span> <span class="main">(</span>add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="free">S</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">(</span>Suc <span class="skolem">N</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> entails_transitive <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">S</span></span> <span class="quoted"><span class="quoted">"add_all_deducible_clauses <span class="free">R</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span><span class="main">)</span>"</span></span><span class="main">]</span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="skolem">N</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> entails <span class="free">S</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> entails_formula_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span> <span class="free">S</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> entails_formula <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span> <span class="free">S</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> entails <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span> <span class="skolem">C</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> entails_formula_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> redundant_def subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="skolem">C</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">0</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> simplify_preserves_redundancy <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="skolem">C</span> <span class="main">(</span>inferred_clause_sets <span class="free">R</span> <span class="free">S</span> <span class="main">0</span><span class="main">)</span>›</span></span> assms<span class="main">(</span>2<span class="main">)</span> assms<span class="main">(</span>3<span class="main">)</span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">C</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> persistent_clauses_subsume_redundant_clauses <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">C</span></span> <span class="quoted"><span class="free">R</span></span> <span class="quoted"><span class="free">S</span></span> <span class="quoted"><span class="main">0</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> entails <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> entails_formula_def redundancy_implies_entailment <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
 <span class="keyword1"><span class="command">qed</span></span>
 <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹entails_formula <span class="free">S</span> <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹entails_formula <span class="main">(</span>saturation <span class="free">R</span> <span class="free">S</span><span class="main">)</span> <span class="free">S</span>›</span></span> 
 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
 <span class="keyword1"><span class="command">unfolding</span></span> equivalent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span>


</pre>
</div><div id="Prime_Implicates">
<div class="head">
<h1>Theory Prime_Implicates</h1>
</div>
<pre class="source">
<span class="comment1">(* N. Peltier. LIG/CNRS http://membres-lig.imag.fr/peltier/ *)</span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Prime Implicates  Generation›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We show that the unrestricted resolution rule is deductive complete, i.e. that it is able
to generate all (prime) implicates of any given clause set.›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Prime_Implicates

<span class="keyword2"><span class="keyword">imports</span></span> <a href="Propositional_Resolution.html">Propositional_Resolution</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">context</span></span> propositional_atoms

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Implicates and Prime Implicates›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We first introduce the definitions of implicates and prime implicates.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">implicates</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Formula <span class="main">⇒</span> <span class="tfree">'at</span> Formula"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">implicates</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">=</span> <span class="main">{</span> <span class="bound">C</span><span class="main">.</span> entails <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="bound">C</span> <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">prime_implicates</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Formula <span class="main">⇒</span> <span class="tfree">'at</span> Formula"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">prime_implicates</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">=</span> simplify <span class="main">(</span>implicates <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Generation of Prime Implicates›</span></span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We introduce a function simplifying a given clause set by evaluating some literals
   to false. We show that this partial evaluation operation preserves saturatedness and 
that if the considered set of literals is an implicate of the initial clause set 
then the partial evaluation yields a clause set that is unsatisfiable.
Then the proof follows from refutational completeness: since the partially evaluated set 
is unsatisfiable and saturated it must contain the empty clause, and therefore the initial 
clause set necessarily contains a clause subsuming the implicate.›</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">partial_evaluation</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> Formula <span class="main">⇒</span> <span class="tfree">'a</span> Literal set <span class="main">⇒</span> <span class="tfree">'a</span> Formula"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">partial_evaluation</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">E</span><span class="main">.</span> <span class="main">∃</span><span class="bound">D</span><span class="main">.</span> <span class="bound">D</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∧</span> <span class="bound">E</span> <span class="main">=</span> <span class="bound">D</span><span class="main">-</span><span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">∧</span> <span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">L</span><span class="main">.</span> <span class="main">(</span><span class="bound">L</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>complement <span class="bound">L</span><span class="main">)</span> <span class="main">∈</span> <span class="bound">D</span><span class="main">)</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> partial_evaluation_is_saturated <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule resolvent <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule ordered_resolvent <span class="main">(</span>partial_evaluation <span class="free">S</span> <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?peval</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"partial_evaluation <span class="free">S</span> <span class="free">C</span>"</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>saturated_binary_rule ordered_resolvent <span class="var">?peval</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">R</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> <span class="var">?peval</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> <span class="var">?peval</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ordered_resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">R</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>tautology <span class="skolem">R</span><span class="main">)</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> not_subsumed<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">D</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">D</span> <span class="main">∈</span> <span class="main">(</span>partial_evaluation <span class="free">S</span> <span class="free">C</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>subsumes <span class="bound">D</span> <span class="skolem">R</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> saturated_binary_rule_def <span class="keyword2"><span class="keyword">and</span></span> redundant_def  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="var">?peval</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">PP1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">PP1</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">=</span> <span class="skolem">PP1</span> <span class="main">-</span> <span class="free">C</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> i<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">L</span><span class="main">.</span> <span class="main">(</span><span class="bound">L</span> <span class="main">∈</span> <span class="free">C</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>complement <span class="bound">L</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">PP1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> <span class="var">?peval</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">PP2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">PP2</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">=</span> <span class="skolem">PP2</span> <span class="main">-</span> <span class="free">C</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span>  ii<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">L</span><span class="main">.</span> <span class="main">(</span><span class="bound">L</span> <span class="main">∈</span> <span class="free">C</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>complement <span class="bound">L</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">PP2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>ordered_resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">R</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> 
      r_def<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">P1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">P2</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> ordered_resolvent_def strictly_maximal_literal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?RR</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">PP1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">PP2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="skolem">A</span> <span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">=</span> <span class="skolem">PP1</span> <span class="main">-</span> <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">P1</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">PP1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">=</span> <span class="skolem">PP2</span> <span class="main">-</span> <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">P2</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">PP2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> r_def <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">=</span> <span class="skolem">PP1</span> <span class="main">-</span> <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">=</span> <span class="skolem">PP2</span> <span class="main">-</span> <span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span> <span class="main">=</span>  <span class="var">?RR</span> <span class="main">-</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>Pos <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">PP1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>Neg <span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">PP2</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"resolvent <span class="skolem">PP1</span> <span class="skolem">PP2</span> <span class="var">?RR</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">PP1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">PP2</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹saturated_binary_rule resolvent <span class="free">S</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"tautology <span class="var">?RR</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span><span class="bound">D</span><span class="main">.</span> <span class="main">(</span><span class="bound">D</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∧</span> <span class="main">(</span>subsumes <span class="bound">D</span> <span class="var">?RR</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> saturated_binary_rule_def redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> 
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"tautology <span class="var">?RR</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">R</span> <span class="main">=</span> <span class="var">?RR</span> <span class="main">-</span> <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>tautology <span class="skolem">R</span>›</span></span>
        <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">X</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">X</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"complement <span class="skolem">X</span> <span class="main">∈</span> <span class="skolem">PP1</span> <span class="main">∪</span> <span class="skolem">PP2</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">X</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹complement <span class="skolem">X</span> <span class="main">∈</span> <span class="skolem">PP1</span> <span class="main">∪</span> <span class="skolem">PP2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> i <span class="keyword2"><span class="keyword">and</span></span> ii 
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">D</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">D</span> <span class="main">∈</span> <span class="free">S</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>subsumes <span class="bound">D</span> <span class="var">?RR</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">D</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="skolem">D</span> <span class="var">?RR</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="skolem">D</span> <span class="var">?RR</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">R</span> <span class="main">=</span> <span class="var">?RR</span> <span class="main">-</span> <span class="free">C</span>›</span></span> 
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="main">(</span><span class="skolem">D</span> <span class="main">-</span> <span class="free">C</span><span class="main">)</span> <span class="skolem">R</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> ii <span class="keyword2"><span class="keyword">and</span></span> i <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>subsumes <span class="skolem">D</span> <span class="var">?RR</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">-</span> <span class="free">C</span> <span class="main">∈</span> <span class="var">?peval</span>"</span></span> 
        <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="main">(</span><span class="skolem">D</span> <span class="main">-</span> <span class="free">C</span><span class="main">)</span> <span class="skolem">R</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> not_subsumed <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> evaluation_wrt_implicate_is_unsat <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"entails <span class="free">S</span> <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>tautology <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>satisfiable <span class="main">(</span>partial_evaluation <span class="free">S</span> <span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?peval</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"partial_evaluation <span class="free">S</span> <span class="free">C</span>"</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"satisfiable <span class="var">?peval</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">I</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"validate_formula <span class="skolem">I</span> <span class="var">?peval</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> satisfiable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?J</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">I</span> <span class="main">-</span> <span class="main">{</span> <span class="bound">X</span><span class="main">.</span> <span class="main">(</span>Pos <span class="bound">X</span><span class="main">)</span> <span class="main">∈</span> <span class="free">C</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span> <span class="bound">Y</span><span class="main">.</span> <span class="main">(</span>Neg <span class="bound">Y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">C</span> <span class="main">}</span>"</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>validate_clause <span class="var">?J</span> <span class="free">C</span>"</span></span>  
    <span class="keyword1"><span class="command">proof</span></span> 
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="var">?J</span> <span class="free">C</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"validate_literal <span class="var">?J</span> <span class="skolem">L</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">X</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="skolem">X</span><span class="main">)</span> <span class="main">∨</span> <span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Literal.exhaust <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">L</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="skolem">X</span><span class="main">)</span> <span class="main">∨</span> <span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">X</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>tautology <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_literal <span class="var">?J</span> <span class="skolem">L</span>›</span></span> 
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"validate_formula <span class="var">?J</span> <span class="free">S</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>validate_formula <span class="var">?J</span> <span class="free">S</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">D</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>validate_clause <span class="var">?J</span> <span class="skolem">D</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span><span class="main">-</span><span class="free">C</span> <span class="main">∈</span> <span class="var">?peval</span> <span class="main">∨</span>  <span class="main">(</span><span class="main">∃</span><span class="bound">L</span><span class="main">.</span> <span class="main">(</span><span class="bound">L</span> <span class="main">∈</span> <span class="free">C</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>complement <span class="bound">L</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">D</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"False"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">L</span><span class="main">.</span> <span class="main">(</span><span class="bound">L</span> <span class="main">∈</span> <span class="free">C</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>complement <span class="bound">L</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">D</span>"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"complement <span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">X</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="skolem">X</span><span class="main">)</span> <span class="main">∨</span> <span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Literal.exhaust <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">L</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> this  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span>tautology <span class="free">C</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"validate_literal <span class="var">?J</span> <span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">unfolding</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>validate_literal <span class="var">?J</span> <span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>complement <span class="skolem">L</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">D</span>›</span></span> 
          <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span>validate_clause <span class="var">?J</span> <span class="skolem">D</span><span class="main">)</span>›</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>  
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span><span class="main">-</span><span class="free">C</span> <span class="main">∈</span> <span class="var">?peval</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span><span class="main">-</span><span class="free">C</span> <span class="main">∈</span> <span class="var">?peval</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>validate_formula <span class="skolem">I</span> <span class="var">?peval</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"validate_clause <span class="skolem">I</span> <span class="main">(</span><span class="skolem">D</span><span class="main">-</span><span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> validate_formula.simps <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">D</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">∉</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"validate_literal <span class="skolem">I</span> <span class="skolem">L</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">X</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="skolem">X</span><span class="main">)</span> <span class="main">∨</span> <span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Literal.exhaust <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">L</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Pos <span class="skolem">X</span><span class="main">)</span> <span class="main">∨</span> <span class="skolem">L</span> <span class="main">=</span> <span class="main">(</span>Neg <span class="skolem">X</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_literal <span class="skolem">I</span> <span class="skolem">L</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">∉</span> <span class="free">C</span>›</span></span> 
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"validate_literal <span class="var">?J</span> <span class="skolem">L</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹validate_literal <span class="var">?J</span> <span class="skolem">L</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">L</span> <span class="main">∈</span> <span class="skolem">D</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span>validate_clause <span class="var">?J</span> <span class="skolem">D</span><span class="main">)</span>›</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>validate_clause <span class="var">?J</span> <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹validate_formula <span class="var">?J</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹entails <span class="free">S</span> <span class="free">C</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> entails_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> entailment_and_implicates<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="free">S1</span> <span class="free">S2</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"implicates <span class="free">S2</span> <span class="main">⊆</span> implicates <span class="free">S1</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms entailed_formula_entails_implicates implicates_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> equivalence_and_implicates<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"equivalent <span class="free">S1</span> <span class="free">S2</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"implicates <span class="free">S1</span> <span class="main">=</span> implicates <span class="free">S2</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms entailment_and_implicates equivalent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> equivalence_and_prime_implicates<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"equivalent <span class="free">S1</span> <span class="free">S2</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"prime_implicates <span class="free">S1</span> <span class="main">=</span> prime_implicates <span class="free">S2</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms equivalence_and_implicates prime_implicates_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> unrestricted_resolution_is_deductive_complete <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule resolvent <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">∈</span> implicates <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="free">S</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"tautology <span class="free">C</span>"</span></span><span class="main">)</span><span class="main"><span class="keyword3">,</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> redundant_def<span class="main">)</span><span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> 
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> tautology <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">D</span><span class="main">.</span> <span class="main">(</span><span class="bound">D</span> <span class="main">∈</span> <span class="free">S</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>subsumes <span class="bound">D</span> <span class="free">C</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?peval</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"partial_evaluation <span class="free">S</span> <span class="free">C</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹saturated_binary_rule resolvent <span class="free">S</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule ordered_resolvent <span class="var">?peval</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> partial_evaluation_is_saturated <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">∈</span> implicates <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"entails <span class="free">S</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> implicates_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹entails <span class="free">S</span> <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>tautology <span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>satisfiable <span class="var">?peval</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> evaluation_wrt_implicate_is_unsat <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="var">?peval</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>satisfiable <span class="var">?peval</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹saturated_binary_rule ordered_resolvent <span class="var">?peval</span>›</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="var">?peval</span>›</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∈</span> <span class="var">?peval</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Complete_def ordered_resolution_is_complete <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> prime_implicates_generation_correct <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule resolvent <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"non_redundant <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">⊆</span> prime_implicates <span class="free">S</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> prime_implicates <span class="free">S</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">x</span> <span class="main">∈</span> prime_implicates <span class="free">S</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"entails <span class="free">S</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> entails_def implicates_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> implicates <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> implicates_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="main">(</span>prime_implicates <span class="free">S</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"strictly_redundant <span class="skolem">x</span> <span class="main">(</span>implicates <span class="free">S</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> prime_implicates_def simplify_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"tautology <span class="skolem">x</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">y</span> <span class="main">∈</span> <span class="main">(</span>implicates <span class="free">S</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">y</span> <span class="main">⊂</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> strictly_redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"strictly_redundant <span class="skolem">x</span> <span class="free">S</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"tautology <span class="skolem">x</span>"</span></span><span class="main">)</span><span class="main"><span class="keyword3">,</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> strictly_redundant_def<span class="main">)</span><span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span> 
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>tautology <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹tautology <span class="skolem">x</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">y</span> <span class="main">∈</span> <span class="main">(</span>implicates <span class="free">S</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">y</span> <span class="main">⊂</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>›</span></span> 
        <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> implicates <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">⊂</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> implicates <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹saturated_binary_rule resolvent <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="free">S</span>›</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">y</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> unrestricted_resolution_is_deductive_complete <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">⊂</span> <span class="skolem">x</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>tautology <span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>tautology <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="skolem">y</span> <span class="free">S</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">⊆</span> <span class="skolem">y</span>"</span></span> 
        <span class="keyword1"><span class="command">unfolding</span></span> redundant_def subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">⊂</span> <span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">⊂</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">z</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"strictly_redundant <span class="skolem">x</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> strictly_redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹non_redundant <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> non_redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
 <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> prime_implicates_of_saturated_sets<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule resolvent <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"non_redundant <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">=</span> prime_implicates <span class="free">S</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">⊆</span> prime_implicates <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> prime_implicates_generation_correct <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"prime_implicates <span class="free">S</span> <span class="main">⊆</span> <span class="free">S</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> prime_implicates <span class="free">S</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> implicates <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> prime_implicates_def simplify_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">x</span> <span class="free">S</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> unrestricted_resolution_is_deductive_complete <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∉</span> <span class="free">S</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="skolem">x</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"strictly_redundant <span class="skolem">x</span> <span class="free">S</span>"</span></span> 
        <span class="keyword1"><span class="command">unfolding</span></span> redundant_def strictly_redundant_def subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">S</span> <span class="main">⊆</span> prime_implicates <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"strictly_redundant <span class="skolem">x</span> <span class="main">(</span>prime_implicates <span class="free">S</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> strictly_redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"strictly_redundant <span class="skolem">x</span> <span class="main">(</span>implicates <span class="free">S</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> strictly_redundant_def prime_implicates_def simplify_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> prime_implicates <span class="free">S</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span>  
        <span class="keyword1"><span class="command">unfolding</span></span> prime_implicates_def simplify_def  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Incremental Prime Implicates Computation›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We show that it is possible to compute the set of prime implicates incrementally
i.e., to fix an ordering among atoms, and to compute the set of resolvents upon each atom
one by one, without backtracking (in the sense that if the resolvents upon a given atom are 
generated at some step <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span> <span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">i</span></span></span></span> <span class="antiquote"><span class="antiquote">}</span></span></span></span> then no resolvents upon the same atom are generated at 
step <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span> <span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">j</span></span><span class="main"><span class="main">&gt;</span></span><span class="free"><span class="free">i</span></span>"</span></span> <span class="antiquote"><span class="antiquote">}</span></span></span></span>. 
This feature is critical in practice for the efficiency of prime implicates 
generation algorithms.›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We first introduce a function computing all resolvents upon a given atom.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">all_resolvents_upon</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Formula <span class="main">⇒</span> <span class="tfree">'at</span> <span class="main">⇒</span> <span class="tfree">'at</span> Formula"</span></span>
 <span class="keyword2"><span class="keyword">where</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">all_resolvents_upon</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">C</span><span class="main">.</span> <span class="main">∃</span><span class="bound">P1</span> <span class="bound">P2</span><span class="main">.</span> <span class="bound">P1</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∧</span> <span class="bound">P2</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∧</span> <span class="bound">C</span> <span class="main">=</span> <span class="main">(</span>resolvent_upon <span class="bound">P1</span> <span class="bound">P2</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">}</span>"</span></span> 

<span class="keyword1"><span class="command">lemma</span></span> resolvent_upon_correct<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P1</span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P2</span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">=</span> resolvent_upon <span class="free">P1</span> <span class="free">P2</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"entails <span class="free">S</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"Pos <span class="free">A</span> <span class="main">∈</span> <span class="free">P1</span> <span class="main">∧</span> Neg <span class="free">A</span> <span class="main">∈</span> <span class="free">P2</span>"</span></span> 
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">=</span> resolvent_upon <span class="free">P1</span> <span class="free">P2</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"resolvent <span class="free">P1</span> <span class="free">P2</span> <span class="free">C</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">P1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">P2</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> soundness_and_entailment resolution_is_correct <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span> 
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>Pos <span class="free">A</span> <span class="main">∈</span> <span class="free">P1</span> <span class="main">∧</span> Neg <span class="free">A</span> <span class="main">∈</span> <span class="free">P2</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">=</span> resolvent_upon <span class="free">P1</span> <span class="free">P2</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P1</span> <span class="main">⊆</span> <span class="free">C</span> <span class="main">∨</span> <span class="free">P2</span> <span class="main">⊆</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">P1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">P2</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="free">S</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> redundant_def subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> redundancy_implies_entailment <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> all_resolvents_upon_is_finite<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="free">S</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def all_resolvents_upon_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> atoms_formula_resolvents<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"atoms_formula <span class="main">(</span>all_resolvents_upon <span class="free">S</span> <span class="free">A</span><span class="main">)</span> <span class="main">⊆</span>  atoms_formula <span class="free">S</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> all_resolvents_upon_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We define a partial saturation predicate that is restricted to a specific atom.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">partial_saturation</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Formula <span class="main">⇒</span> <span class="tfree">'at</span> <span class="main">⇒</span> <span class="tfree">'at</span> Formula <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">partial_saturation</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">R</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">P1</span> <span class="bound">P2</span><span class="main">.</span> <span class="main">(</span><span class="bound">P1</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">⟶</span> <span class="bound">P2</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span>  
    <span class="main">⟶</span><span class="main">(</span>redundant <span class="main">(</span>resolvent_upon <span class="bound">P1</span> <span class="bound">P2</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">R</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We show that the resolvent of two redundant clauses in a partially saturated set 
is itself redundant.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> resolvent_upon_and_partial_saturation <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">P1</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">P2</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"partial_saturation <span class="free">S</span> <span class="free">A</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">=</span> resolvent_upon <span class="free">P1</span> <span class="free">P2</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>redundant <span class="free">C</span>  <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">=</span> resolvent_upon <span class="free">P1</span> <span class="free">P2</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">=</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">A</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span> <span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>redundant <span class="free">C</span>  <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>tautology <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>tautology <span class="free">P1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>   
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"tautology <span class="free">P1</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"Pos <span class="skolem">B</span> <span class="main">∈</span> <span class="free">P1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Neg <span class="skolem">B</span> <span class="main">∈</span> <span class="free">P1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="skolem">B</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹Neg <span class="skolem">B</span> <span class="main">∈</span> <span class="free">P1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">=</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">A</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span> <span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="free">P2</span> <span class="free">C</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def <span class="keyword1"><span class="command">using</span></span> Literal.distinct <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="free">P2</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="free">S</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> subsumption_preserves_redundancy <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>redundant <span class="free">C</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span> 
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="skolem">B</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">=</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">A</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span> <span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹Pos <span class="skolem">B</span> <span class="main">∈</span> <span class="free">P1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹Neg <span class="skolem">B</span> <span class="main">∈</span> <span class="free">P1</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Pos <span class="skolem">B</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Neg <span class="skolem">B</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>redundant <span class="free">C</span>  <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> 
        <span class="keyword1"><span class="command">unfolding</span></span> tautology_def redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="free">P1</span> <span class="free">S</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Q1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q1</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="skolem">Q1</span> <span class="free">P1</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>tautology <span class="free">P2</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>   
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"tautology <span class="free">P2</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"Pos <span class="skolem">B</span> <span class="main">∈</span> <span class="free">P2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Neg <span class="skolem">B</span> <span class="main">∈</span> <span class="free">P2</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="skolem">B</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹Pos <span class="skolem">B</span> <span class="main">∈</span> <span class="free">P2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">=</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">A</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span> <span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="free">P1</span> <span class="free">C</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def <span class="keyword1"><span class="command">using</span></span> Literal.distinct <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="free">P1</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="free">C</span> <span class="free">S</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> subsumption_preserves_redundancy <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>redundant <span class="free">C</span>  <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span> 
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="skolem">B</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">=</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">A</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span> <span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹Pos <span class="skolem">B</span> <span class="main">∈</span> <span class="free">P2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹Neg <span class="skolem">B</span> <span class="main">∈</span> <span class="free">P2</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Pos <span class="skolem">B</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Neg <span class="skolem">B</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>redundant <span class="free">C</span>  <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> tautology_def redundant_def  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="free">P2</span> <span class="free">S</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Q2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q2</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="skolem">Q2</span> <span class="free">P2</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?res</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">Q1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">A</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">Q2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span> <span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?res</span> <span class="main">=</span> resolvent_upon <span class="skolem">Q1</span> <span class="skolem">Q2</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹partial_saturation <span class="free">S</span> <span class="free">A</span>  <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">Q1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">Q2</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="var">?res</span>  <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> partial_saturation_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>  
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="skolem">Q1</span> <span class="free">P1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹subsumes <span class="skolem">Q2</span> <span class="free">P2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">=</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">A</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span> <span class="main">}</span><span class="main">)</span>›</span></span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="var">?res</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="var">?res</span>  <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>redundant <span class="free">C</span>  <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> 
    <span class="keyword1"><span class="command">using</span></span> subsumption_preserves_redundancy <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We show that if <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">R</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is a set of resolvents of a set of clauses <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">S</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> then the 
same holds for <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span> <span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">S</span></span> <span class="main"><span class="main">∪</span></span> <span class="free"><span class="free">R</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>. For the clauses in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">S</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, the premises are identical to 
the resolvent and the inference is thus redundant (this trick is useful to simplify proofs).›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">in_all_resolvents_upon</span><span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'at</span> Formula <span class="main">⇒</span> <span class="tfree">'at</span> <span class="main">⇒</span> <span class="tfree">'at</span> Clause <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">in_all_resolvents_upon</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">P1</span> <span class="bound">P2</span><span class="main">.</span> <span class="main">(</span><span class="bound">P1</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∧</span> <span class="bound">P2</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">=</span> resolvent_upon <span class="bound">P1</span> <span class="bound">P2</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>
 
<span class="keyword1"><span class="command">lemma</span></span> every_clause_is_a_resolvent<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill <span class="main">(</span>in_all_resolvents_upon <span class="free">S</span> <span class="free">A</span><span class="main">)</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">¬</span><span class="main">(</span>tautology <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P1</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∪</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"in_all_resolvents_upon <span class="free">S</span> <span class="free">A</span> <span class="free">P1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">P1</span> <span class="main">∈</span> <span class="free">R</span>"</span></span><span class="main">)</span><span class="main"><span class="keyword3">,</span></span><span class="main">(</span><span class="operator">metis</span> all_fulfill_def assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span><span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> 
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">P1</span> <span class="main">∉</span> <span class="free">R</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">P1</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∪</span> <span class="free">R</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P1</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">¬</span><span class="main">(</span>tautology <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="free">S</span> <span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> tautology <span class="free">P1</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> tautology <span class="free">P1</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Neg <span class="free">A</span> <span class="main">∉</span> <span class="free">P1</span> <span class="main">∨</span> Pos <span class="free">A</span> <span class="main">∉</span> <span class="free">P1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P1</span> <span class="main">=</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">A</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">A</span> <span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">P1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> resolvent_def 
      <span class="keyword1"><span class="command">unfolding</span></span> in_all_resolvents_upon_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We show that if a formula is partially saturated then it stays so when new resolvents 
are added in the set.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> partial_saturation_is_preserved <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"partial_saturation <span class="free">S</span> <span class="free">E1</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"partial_saturation <span class="free">S</span> <span class="free">E2</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">¬</span><span class="main">(</span>tautology <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill <span class="main">(</span>in_all_resolvents_upon <span class="free">S</span> <span class="free">E2</span><span class="main">)</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"partial_saturation <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span> <span class="free">E1</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> partial_saturation <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span> <span class="free">E1</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∪</span> <span class="free">R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∪</span> <span class="free">R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="free">E1</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> redundant <span class="skolem">C</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> partial_saturation_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="free">E1</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">E1</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">E1</span> <span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∪</span> <span class="free">R</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">¬</span><span class="main">(</span>tautology <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="free">S</span> <span class="main">)</span>›</span></span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"in_all_resolvents_upon <span class="free">S</span> <span class="free">E2</span> <span class="skolem">P1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> every_clause_is_a_resolvent <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1_1</span></span> <span class="skolem"><span class="skolem">P1_2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1_1</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1_2</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1_1</span> <span class="skolem">P1_2</span> <span class="free">E2</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> every_clause_is_a_resolvent <span class="keyword1"><span class="command">unfolding</span></span> in_all_resolvents_upon_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∪</span> <span class="free">R</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">¬</span><span class="main">(</span>tautology <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="free">S</span> <span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"in_all_resolvents_upon <span class="free">S</span> <span class="free">E2</span> <span class="skolem">P2</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> every_clause_is_a_resolvent <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P2_1</span></span> <span class="skolem"><span class="skolem">P2_2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2_1</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2_2</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">=</span> resolvent_upon <span class="skolem">P2_1</span> <span class="skolem">P2_2</span> <span class="free">E2</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> every_clause_is_a_resolvent <span class="keyword1"><span class="command">unfolding</span></span> in_all_resolvents_upon_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?R1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"resolvent_upon <span class="skolem">P1_1</span> <span class="skolem">P2_1</span> <span class="free">E1</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹partial_saturation <span class="free">S</span> <span class="free">E1</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1_1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2_1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="var">?R1</span> <span class="free">S</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> partial_saturation_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?R2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"resolvent_upon <span class="skolem">P1_2</span> <span class="skolem">P2_2</span> <span class="free">E1</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹partial_saturation <span class="free">S</span> <span class="free">E1</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1_2</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2_2</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="var">?R2</span> <span class="free">S</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> partial_saturation_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"resolvent_upon <span class="var">?R1</span> <span class="var">?R2</span> <span class="free">E2</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="free">E1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">=</span> resolvent_upon <span class="skolem">P2_1</span> <span class="skolem">P2_2</span> <span class="free">E2</span>›</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1_1</span> <span class="skolem">P1_2</span> <span class="free">E2</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C</span> <span class="main">=</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="var">?R1</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="var">?R2</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹partial_saturation <span class="free">S</span> <span class="free">E2</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>›</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> redundant <span class="skolem">C</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">using</span></span> resolvent_upon_and_partial_saturation <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The next lemma shows that the clauses inferred by applying the resolution rule
 upon a given atom contain no occurrence of this atom, unless the inference is redundant.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> resolvents_do_not_contain_atom <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> tautology <span class="free">P1</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> tautology <span class="free">P2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">=</span> resolvent_upon <span class="free">P1</span> <span class="free">P2</span> <span class="free">E2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> subsumes <span class="free">P1</span> <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> subsumes <span class="free">P2</span> <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Neg <span class="free">E2</span><span class="main">)</span> <span class="main">∉</span> <span class="free">C</span> <span class="main">∧</span> <span class="main">(</span>Pos <span class="free">E2</span><span class="main">)</span> <span class="main">∉</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">=</span> resolvent_upon <span class="free">P1</span> <span class="free">P2</span> <span class="free">E2</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">=</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">E2</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">E2</span> <span class="main">}</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Neg <span class="free">E2</span><span class="main">)</span> <span class="main">∉</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> 
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"Neg <span class="free">E2</span> <span class="main">∈</span> <span class="free">C</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">=</span> resolvent_upon <span class="free">P1</span> <span class="free">P2</span> <span class="free">E2</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">=</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">E2</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">E2</span> <span class="main">}</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹Neg <span class="free">E2</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Neg <span class="free">E2</span> <span class="main">∈</span> <span class="free">P1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> subsumes <span class="free">P1</span> <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">=</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">E2</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">E2</span> <span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Pos <span class="free">E2</span> <span class="main">∈</span> <span class="free">P1</span>"</span></span>  
      <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹Neg <span class="free">E2</span> <span class="main">∈</span> <span class="free">P1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹Pos <span class="free">E2</span> <span class="main">∈</span> <span class="free">P1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">¬</span> tautology <span class="free">P1</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Pos <span class="free">E2</span><span class="main">)</span> <span class="main">∉</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"Pos <span class="free">E2</span> <span class="main">∈</span> <span class="free">C</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">=</span> resolvent_upon <span class="free">P1</span> <span class="free">P2</span> <span class="free">E2</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">=</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">E2</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">E2</span> <span class="main">}</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹Pos <span class="free">E2</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Pos <span class="free">E2</span> <span class="main">∈</span> <span class="free">P2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> subsumes <span class="free">P2</span> <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹<span class="free">C</span> <span class="main">=</span> <span class="main">(</span><span class="free">P1</span> <span class="main">-</span> <span class="main">{</span> Pos <span class="free">E2</span> <span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">P2</span> <span class="main">-</span> <span class="main">{</span> Neg <span class="free">E2</span> <span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Neg <span class="free">E2</span> <span class="main">∈</span> <span class="free">P2</span>"</span></span>  
      <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹Neg <span class="free">E2</span> <span class="main">∈</span> <span class="free">P2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹Pos <span class="free">E2</span> <span class="main">∈</span> <span class="free">P2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">¬</span> tautology <span class="free">P2</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The next lemma shows that partial saturation can be ensured by computing all 
(non-redundant) resolvents upon the considered atom.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ensures_partial_saturation <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"partial_saturation <span class="free">S</span> <span class="free">E2</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">¬</span><span class="main">(</span>tautology <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill <span class="main">(</span>in_all_resolvents_upon <span class="free">S</span> <span class="free">E2</span><span class="main">)</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">¬</span>redundant <span class="bound">x</span> <span class="free">S</span><span class="main">)</span><span class="main">)</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"partial_saturation <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span> <span class="free">E2</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> partial_saturation <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span> <span class="free">E2</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∪</span> <span class="free">R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∪</span> <span class="free">R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="free">E2</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> redundant <span class="skolem">C</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> partial_saturation_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∉</span> <span class="free">S</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∪</span> <span class="free">R</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1_1</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">P1_2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1_1</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1_2</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> 
     <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1_1</span> <span class="skolem">P1_2</span> <span class="free">E2</span>"</span></span>
     <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def in_all_resolvents_upon_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">¬</span><span class="main">(</span>tautology <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1_1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1_2</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> tautology <span class="skolem">P1_1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> tautology <span class="skolem">P1_2</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">¬</span>redundant <span class="bound">x</span> <span class="free">S</span><span class="main">)</span><span class="main">)</span> <span class="free">R</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">R</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1_1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1_2</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> subsumes <span class="skolem">P1_1</span> <span class="skolem">P1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> subsumes <span class="skolem">P1_2</span> <span class="skolem">P1</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> redundant_def all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> tautology <span class="skolem">P1_1</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> tautology <span class="skolem">P1_2</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> subsumes <span class="skolem">P1_1</span> <span class="skolem">P1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> subsumes <span class="skolem">P1_2</span> <span class="skolem">P1</span>›</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1_1</span> <span class="skolem">P1_2</span> <span class="free">E2</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Neg <span class="free">E2</span><span class="main">)</span> <span class="main">∉</span> <span class="skolem">P1</span> <span class="main">∧</span> <span class="main">(</span>Pos <span class="free">E2</span><span class="main">)</span> <span class="main">∉</span> <span class="skolem">P1</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> resolvents_do_not_contain_atom <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">P1_1</span></span> <span class="quoted"><span class="skolem">P1_2</span></span> <span class="quoted"><span class="skolem">P1</span></span> <span class="quoted"><span class="free">E2</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="free">E2</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="skolem">P1</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> redundant <span class="skolem">C</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∪</span> <span class="free">R</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> redundant_def 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>    
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∉</span> <span class="free">S</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∪</span> <span class="free">R</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P2_1</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">P2_2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2_1</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2_2</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">=</span> resolvent_upon <span class="skolem">P2_1</span> <span class="skolem">P2_2</span> <span class="free">E2</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def in_all_resolvents_upon_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">¬</span><span class="main">(</span>tautology <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="free">S</span> <span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2_1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2_2</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> tautology <span class="skolem">P2_1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> tautology <span class="skolem">P2_2</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">¬</span>redundant <span class="bound">x</span> <span class="free">S</span><span class="main">)</span><span class="main">)</span> <span class="free">R</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">R</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2_1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2_2</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> subsumes <span class="skolem">P2_1</span> <span class="skolem">P2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> subsumes <span class="skolem">P2_2</span> <span class="skolem">P2</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> redundant_def all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> tautology <span class="skolem">P2_1</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> tautology <span class="skolem">P2_2</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> subsumes <span class="skolem">P2_1</span> <span class="skolem">P2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> subsumes <span class="skolem">P2_2</span> <span class="skolem">P2</span>›</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">=</span> resolvent_upon <span class="skolem">P2_1</span> <span class="skolem">P2_2</span> <span class="free">E2</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Neg <span class="free">E2</span><span class="main">)</span> <span class="main">∉</span> <span class="skolem">P2</span> <span class="main">∧</span> <span class="main">(</span>Pos <span class="free">E2</span><span class="main">)</span> <span class="main">∉</span> <span class="skolem">P2</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> resolvents_do_not_contain_atom <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">P2_1</span></span> <span class="quoted"><span class="skolem">P2_2</span></span> <span class="quoted"><span class="skolem">P2</span></span> <span class="quoted"><span class="free">E2</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="free">E2</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"subsumes <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> redundant <span class="skolem">C</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S</span> <span class="main">∪</span> <span class="free">R</span>›</span></span> 
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>    
   <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹partial_saturation <span class="free">S</span> <span class="free">E2</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>›</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="free">E2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> redundant <span class="skolem">C</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="free">R</span><span class="main">)</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> redundant_def partial_saturation_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> resolvents_preserve_equivalence<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"equivalent <span class="free">S</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="free">S</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">⊆</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="free">S</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="free">S</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> entailment_subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"entails_formula <span class="free">S</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="free">S</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>entails_formula <span class="free">S</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="free">S</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="main">(</span>all_resolvents_upon <span class="free">S</span> <span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>entails <span class="free">S</span> <span class="skolem">C</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> entails_formula_def <span class="keyword1"><span class="command">using</span></span> entails_member <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="main">(</span>all_resolvents_upon <span class="free">S</span> <span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="skolem"><span class="skolem">P2</span></span> 
      <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> all_resolvents_upon_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="free">A</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"entails <span class="free">S</span> <span class="skolem">C</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> resolvent_upon_correct <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>entails <span class="free">S</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹entails_formula <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="free">S</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="free">S</span>›</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹entails_formula <span class="free">S</span> <span class="main">(</span><span class="free">S</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="free">S</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span>›</span></span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> equivalent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Given a sequence of atoms, we define a sequence of clauses obtained by resolving upon 
each atom successively. Simplification rules are applied at each iteration step.›</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">resolvents_sequence</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> <span class="tfree">'at</span><span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'at</span> Formula <span class="main">⇒</span> nat <span class="main">⇒</span> <span class="tfree">'at</span> Formula"</span></span>
 <span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">resolvents_sequence</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>simplify <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span>"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">resolvents_sequence</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">(</span>Suc <span class="free"><span class="bound"><span class="entity">N</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> 
    <span class="main">(</span>simplify <span class="main">(</span><span class="main">(</span><span class="free">resolvents_sequence</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">N</span></span></span><span class="main">)</span>
      <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="main">(</span><span class="free">resolvents_sequence</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">N</span></span></span><span class="main">)</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">N</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The following lemma states that partial saturation is preserved by simplification.›</span></span>
 
<span class="keyword1"><span class="command">lemma</span></span> redundancy_implies_partial_saturation<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"partial_saturation <span class="free">S1</span> <span class="free">A</span> <span class="free">S1</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">S2</span> <span class="main">⊆</span> <span class="free">S1</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> redundant <span class="bound">x</span> <span class="free">S2</span><span class="main">)</span> <span class="free">S1</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"partial_saturation <span class="free">S2</span> <span class="free">A</span> <span class="free">S2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>partial_saturation <span class="free">S2</span> <span class="free">A</span> <span class="free">S2</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S2</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> <span class="main">(</span>resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="free">A</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> redundant <span class="skolem">C</span> <span class="free">S2</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> partial_saturation_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">S2</span> <span class="main">⊆</span> <span class="free">S1</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">S2</span> <span class="main">⊆</span> <span class="free">S1</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="free">S1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> <span class="free">S1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹partial_saturation <span class="free">S1</span> <span class="free">A</span> <span class="free">S1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="free">A</span>›</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="free">S1</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> partial_saturation_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> redundant <span class="skolem">C</span> <span class="free">S2</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>tautology <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="skolem">C</span> <span class="free">S1</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">D</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">∈</span> <span class="free">S1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">⊆</span> <span class="skolem">C</span>"</span></span>  
    <span class="keyword1"><span class="command">unfolding</span></span> redundant_def subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∈</span> <span class="free">S1</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> redundant <span class="bound">x</span> <span class="free">S2</span><span class="main">)</span> <span class="free">S1</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">D</span> <span class="free">S2</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> tautology <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">⊆</span> <span class="skolem">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> tautology <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> tautology_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹redundant <span class="skolem">D</span> <span class="free">S2</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">E</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">E</span> <span class="main">∈</span> <span class="free">S2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">E</span> <span class="main">⊆</span> <span class="skolem">D</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> redundant_def subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">E</span> <span class="main">⊆</span> <span class="skolem">D</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">⊆</span> <span class="skolem">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">E</span> <span class="main">⊆</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">E</span> <span class="main">∈</span> <span class="free">S2</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">E</span> <span class="main">⊆</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>redundant <span class="skolem">C</span> <span class="free">S2</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> redundant_def subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The next theorem finally states that the implicate generation algorithm is sound and 
complete in the sense that the final clause set in the sequence is exactly the set of prime 
implicates of the considered clause set.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> incremental_prime_implication_generation<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"atoms_formula <span class="free">S</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">X</span><span class="main">.</span> <span class="main">∃</span><span class="bound">I</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">I</span> <span class="main">&lt;</span> <span class="free">N</span> <span class="main">∧</span> <span class="bound">X</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span> <span class="bound">I</span><span class="main">)</span> <span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>prime_implicates <span class="free">S</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="free">N</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We define a set of invariants and show that they are satisfied by all sets in the 
above sequence. For the last set in the sequence, the invariants ensure that the clause set is 
saturated, which entails the desired property.›</span></span>

  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?Final</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="free">N</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We define some properties and show by induction that they are satisfied by all the 
clause sets in the constructed sequence›</span></span>

  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?equiv_init</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">I</span><span class="main">.</span><span class="main">(</span>equivalent <span class="free">S</span> <span class="main">(</span>resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="bound">I</span><span class="main">)</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?partial_saturation</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">I</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">J</span><span class="main">::</span>nat<span class="main">.</span> <span class="main">(</span><span class="bound">J</span> <span class="main">&lt;</span> <span class="bound">I</span> 
    <span class="main">⟶</span> <span class="main">(</span>partial_saturation <span class="main">(</span>resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="bound">I</span><span class="main">)</span> <span class="main">(</span><span class="free">A</span> <span class="bound">J</span><span class="main">)</span> <span class="main">(</span>resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="bound">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?no_tautologies</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">I</span><span class="main">.</span><span class="main">(</span>all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">¬</span><span class="main">(</span>tautology <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="bound">I</span><span class="main">)</span> <span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?atoms_init</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">I</span><span class="main">.</span><span class="main">(</span>atoms_formula <span class="main">(</span>resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="bound">I</span><span class="main">)</span>  
                      <span class="main">⊆</span>  <span class="main">{</span> <span class="bound">X</span><span class="main">.</span> <span class="main">∃</span><span class="bound">I</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">I</span> <span class="main">&lt;</span> <span class="free">N</span> <span class="main">∧</span> <span class="bound">X</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span> <span class="bound">I</span><span class="main">)</span><span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?non_redundant</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">I</span><span class="main">.</span><span class="main">(</span>non_redundant <span class="main">(</span>resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="bound">I</span><span class="main">)</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?finite</span></span></span> <span class="main">=</span><span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">I</span><span class="main">.</span> <span class="main">(</span>all_fulfill finite <span class="main">(</span>resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="bound">I</span><span class="main">)</span><span class="main">)</span>"</span></span>

  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">I</span><span class="main">.</span> <span class="main">(</span><span class="bound">I</span> <span class="main">≤</span> <span class="free">N</span>   <span class="main">⟶</span> <span class="main">(</span><span class="var">?equiv_init</span> <span class="bound">I</span><span class="main">)</span>  <span class="main">∧</span> <span class="main">(</span><span class="var">?partial_saturation</span> <span class="bound">I</span><span class="main">)</span> <span class="main">∧</span>  <span class="main">(</span><span class="var">?no_tautologies</span> <span class="bound">I</span><span class="main">)</span> 
          <span class="main">∧</span> <span class="main">(</span><span class="var">?atoms_init</span> <span class="bound">I</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="var">?non_redundant</span> <span class="bound">I</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="var">?finite</span> <span class="bound">I</span><span class="main">)</span> <span class="main">)</span>"</span></span>

  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">I</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">" <span class="main">(</span><span class="skolem">I</span> <span class="main">≤</span> <span class="free">N</span>  
      <span class="main">⟶</span> <span class="main">(</span><span class="var">?equiv_init</span> <span class="skolem">I</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="var">?partial_saturation</span> <span class="skolem">I</span><span class="main">)</span> <span class="main">∧</span>  <span class="main">(</span><span class="var">?no_tautologies</span> <span class="skolem">I</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="var">?atoms_init</span> <span class="skolem">I</span><span class="main">)</span>    
            <span class="main">∧</span> <span class="main">(</span><span class="var">?non_redundant</span> <span class="skolem">I</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="var">?finite</span> <span class="skolem">I</span><span class="main">)</span> <span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">I</span> <span class="main">≤</span> <span class="free">N</span> <span class="main">⟶</span> <span class="var">?P</span> <span class="skolem">I</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="skolem">I</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We show that the properties are all satisfied by the initial clause set 
(after simplification).›</span></span>

      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">N</span> <span class="main">⟶</span> <span class="var">?P</span> <span class="main">0</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">N</span>"</span></span> 
          <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?R</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="main">0</span>"</span></span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="free">S</span>›</span></span> 
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?equiv_init</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simplify_preserves_equivalence  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?no_tautologies</span> <span class="main">0</span>"</span></span> 
            <span class="keyword1"><span class="command">using</span></span> simplify_def strictly_redundant_def all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?partial_saturation</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="free">S</span>›</span></span>  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?finite</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simplify_finite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"atoms_formula <span class="var">?R</span> <span class="main">⊆</span> atoms_formula <span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> atoms_formula_simplify <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> <span class="quoted"><span class="quoted">‹atoms_formula <span class="free">S</span> <span class="main">=</span> <span class="main">{</span> <span class="bound">X</span><span class="main">.</span> <span class="main">∃</span><span class="bound">I</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">I</span> <span class="main">&lt;</span> <span class="free">N</span> <span class="main">∧</span> <span class="bound">X</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span> <span class="bound">I</span><span class="main">)</span> <span class="main">}</span>›</span></span> 
            <span class="keyword1"><span class="command">have</span></span> v<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?atoms_init</span> <span class="main">0</span>"</span></span>  <span class="keyword1"><span class="command">unfolding</span></span> simplify_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?non_redundant</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simplify_non_redundant <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We then show that the properties are preserved by induction.›</span></span>

      <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">I</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">I</span> <span class="main">≤</span> <span class="free">N</span> <span class="main">⟶</span> <span class="var">?P</span> <span class="skolem">I</span>"</span></span> 
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span> <span class="main">≤</span> <span class="free">N</span> <span class="main">⟶</span> <span class="main">(</span><span class="var">?P</span> <span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
        <span class="keyword3"><span class="command">assume</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span> <span class="main">≤</span> <span class="free">N</span>"</span></span>
        <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?Prec</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="skolem">I</span>"</span></span>
        <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?R</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹Suc <span class="skolem">I</span> <span class="main">≤</span> <span class="free">N</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">I</span> <span class="main">≤</span> <span class="free">N</span> <span class="main">⟶</span> <span class="var">?P</span> <span class="skolem">I</span>›</span></span> 
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?equiv_init</span> <span class="skolem">I</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?partial_saturation</span> <span class="skolem">I</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?no_tautologies</span> <span class="skolem">I</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?finite</span> <span class="skolem">I</span>"</span></span>
            <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?atoms_init</span> <span class="skolem">I</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?non_redundant</span> <span class="skolem">I</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"equivalent <span class="var">?Prec</span> <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> resolvents_preserve_equivalence <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?finite</span> <span class="skolem">I</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> all_resolvents_upon_is_finite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="main">(</span>simplify <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> simplify_finite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?finite</span> <span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span> 
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"equivalent <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="var">?R</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> simplify_preserves_equivalence <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹equivalent <span class="var">?Prec</span> <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span> 
        <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹equivalent <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="var">?R</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"equivalent <span class="var">?Prec</span> <span class="var">?R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> equivalent_transitive<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?equiv_init</span> <span class="skolem">I</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?equiv_init</span> <span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> equivalent_transitive<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?no_tautologies</span> <span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simplify_def strictly_redundant_def all_fulfill_def 
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?Delta</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">-</span> <span class="var">?Prec</span>"</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="main">⊆</span> <span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span>redundant <span class="bound">x</span> <span class="var">?R</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span>redundant <span class="bound">x</span> <span class="var">?R</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>redundant <span class="skolem">x</span> <span class="var">?R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>redundant <span class="skolem">x</span> <span class="var">?R</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="skolem">x</span> <span class="main">∈</span> <span class="var">?R</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> redundant_def subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">x</span> <span class="main">(</span>simplify <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> simplify_and_membership <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>redundant <span class="skolem">x</span> <span class="var">?R</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"all_fulfill <span class="main">(</span>in_all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span> <span class="var">?Delta</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>all_fulfill <span class="main">(</span>in_all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span> <span class="var">?Delta</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="var">?Delta</span>"</span></span> 
            <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>in_all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span> <span class="skolem">C</span>"</span></span> 
            <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="var">?Delta</span>"</span></span> 
            <span class="keyword2"><span class="keyword">and</span></span> not_res<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">P1</span> <span class="bound">P2</span><span class="main">.</span> <span class="main">¬</span><span class="main">(</span><span class="bound">P1</span> <span class="main">∈</span> <span class="var">?Prec</span> <span class="main">∧</span> <span class="bound">P2</span> <span class="main">∈</span> <span class="var">?Prec</span> <span class="main">∧</span> <span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="bound">P1</span> <span class="bound">P2</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span>"</span></span> 
            <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def in_all_resolvents_upon_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="var">?Delta</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="var">?R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∉</span> <span class="var">?Prec</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> simplify <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> simplify_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∉</span> <span class="var">?Prec</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> not_res <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> all_resolvents_upon_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">¬</span>redundant <span class="bound">x</span> <span class="var">?Prec</span><span class="main">)</span><span class="main">)</span> <span class="var">?Delta</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">¬</span>redundant <span class="bound">x</span> <span class="var">?Prec</span><span class="main">)</span><span class="main">)</span> <span class="var">?Delta</span>"</span></span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="var">?Delta</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> redundant<span class="main">:</span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="var">?Prec</span>"</span></span> 
            <span class="keyword1"><span class="command">unfolding</span></span> all_fulfill_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="var">?Delta</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="var">?R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∉</span> <span class="var">?Prec</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"strictly_redundant <span class="skolem">C</span> <span class="var">?Prec</span>"</span></span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"strictly_redundant <span class="skolem">C</span> <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
              <span class="keyword1"><span class="command">unfolding</span></span> strictly_redundant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∉</span> simplify <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
              <span class="keyword1"><span class="command">unfolding</span></span> simplify_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∉</span> <span class="var">?R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="var">?R</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>strictly_redundant <span class="skolem">C</span> <span class="var">?Prec</span>"</span></span>
            <span class="keyword1"><span class="command">with</span></span> redundant <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="var">?Prec</span>"</span></span> 
              <span class="keyword1"><span class="command">unfolding</span></span> strictly_redundant_def redundant_def subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∉</span> <span class="var">?Prec</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">J</span><span class="main">::</span>nat<span class="main">.</span> <span class="main">(</span><span class="bound">J</span> <span class="main">&lt;</span> <span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span>partial_saturation <span class="var">?R</span> <span class="main">(</span><span class="free">A</span> <span class="bound">J</span><span class="main">)</span> <span class="var">?R</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∀</span><span class="bound">J</span><span class="main">::</span>nat<span class="main">.</span> <span class="main">(</span><span class="bound">J</span> <span class="main">&lt;</span> <span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span>partial_saturation <span class="var">?R</span> <span class="main">(</span><span class="free">A</span> <span class="bound">J</span><span class="main">)</span> <span class="var">?R</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">J</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">&lt;</span> <span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>partial_saturation <span class="var">?R</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">J</span><span class="main">)</span> <span class="var">?R</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>          
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span>partial_saturation <span class="var">?R</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">J</span><span class="main">)</span> <span class="var">?R</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="skolem"><span class="skolem">C</span></span> 
          <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> <span class="var">?R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> <span class="var">?R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">J</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> redundant <span class="skolem">C</span> <span class="var">?R</span>"</span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span> partial_saturation_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"partial_saturation <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span> <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>partial_saturation <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span> <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> <span class="var">?Prec</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> <span class="var">?Prec</span>"</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
              <span class="quoted"><span class="quoted">"<span class="main">¬</span>redundant <span class="skolem">C</span> <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> partial_saturation_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="var">?Prec</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> <span class="var">?Prec</span>›</span></span> 
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span>"</span></span> 
              <span class="keyword1"><span class="command">unfolding</span></span> all_resolvents_upon_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="var">?R</span>"</span></span>  
              <span class="keyword1"><span class="command">using</span></span> simplify_and_membership <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="var"><span class="quoted"><span class="var">?R</span></span></span> <span class="quoted"><span class="skolem">C</span></span><span class="main">]</span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?R</span> <span class="main">⊆</span> <span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span><span class="main">)</span>"</span></span> 
            <span class="keyword1"><span class="command">using</span></span> superset_preserves_redundancy <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">C</span></span> <span class="var"><span class="quoted"><span class="var">?R</span></span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span><span class="main">)</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>redundant <span class="skolem">C</span> <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">=</span> <span class="skolem">I</span>"</span></span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹partial_saturation <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span> <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?no_tautologies</span> <span class="skolem">I</span>›</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>all_fulfill <span class="main">(</span>in_all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span> <span class="var">?Delta</span><span class="main">)</span>›</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">¬</span>redundant <span class="bound">x</span> <span class="var">?Prec</span><span class="main">)</span><span class="main">)</span> <span class="var">?Delta</span>›</span></span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"partial_saturation <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span><span class="main">)</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span> <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span><span class="main">)</span>"</span></span> 
              <span class="keyword1"><span class="command">using</span></span> ensures_partial_saturation <span class="main">[</span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?Prec</span></span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span>"</span></span> <span class="var"><span class="quoted"><span class="var">?Delta</span></span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?R</span> <span class="main">⊆</span> <span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span>›</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span>redundant <span class="bound">x</span> <span class="var">?R</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"partial_saturation <span class="var">?R</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span> <span class="var">?R</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> redundancy_implies_partial_saturation 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">J</span> <span class="main">=</span> <span class="skolem">I</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span>partial_saturation <span class="var">?R</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">J</span><span class="main">)</span> <span class="var">?R</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">next</span></span> 
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">≠</span> <span class="skolem">I</span>"</span></span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">J</span> <span class="main">&lt;</span> <span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">&lt;</span> <span class="skolem">I</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?partial_saturation</span> <span class="skolem">I</span>›</span></span> 
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"partial_saturation <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">J</span><span class="main">)</span> <span class="var">?Prec</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹partial_saturation <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span> <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?no_tautologies</span> <span class="skolem">I</span>›</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>all_fulfill <span class="main">(</span>in_all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span> <span class="var">?Delta</span><span class="main">)</span>›</span></span>
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">¬</span>redundant <span class="bound">x</span> <span class="var">?Prec</span><span class="main">)</span><span class="main">)</span> <span class="var">?Delta</span>›</span></span> 
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"partial_saturation <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span><span class="main">)</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">J</span><span class="main">)</span> <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> partial_saturation_is_preserved <span class="main">[</span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?Prec</span></span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="skolem">J</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="skolem">I</span>"</span></span> <span class="var"><span class="quoted"><span class="var">?Delta</span></span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?R</span> <span class="main">⊆</span> <span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span>›</span></span> 
              <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span>redundant <span class="bound">x</span> <span class="var">?R</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="var">?Delta</span><span class="main">)</span>›</span></span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"partial_saturation <span class="var">?R</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">J</span><span class="main">)</span> <span class="var">?R</span>"</span></span> 
              <span class="keyword1"><span class="command">using</span></span> redundancy_implies_partial_saturation <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span>partial_saturation <span class="var">?R</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">J</span><span class="main">)</span> <span class="var">?R</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
         <span class="keyword1"><span class="command">qed</span></span>
       <span class="keyword1"><span class="command">qed</span></span>
       <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"non_redundant <span class="var">?R</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simplify_non_redundant <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
       <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?atoms_init</span> <span class="skolem">I</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"atoms_formula <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span> 
                                    <span class="main">⊆</span>  <span class="main">{</span> <span class="bound">X</span><span class="main">.</span> <span class="main">∃</span><span class="bound">I</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">I</span> <span class="main">&lt;</span> <span class="free">N</span> <span class="main">∧</span> <span class="bound">X</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span> <span class="bound">I</span><span class="main">)</span><span class="main">}</span>"</span></span>
       <span class="keyword1"><span class="command">using</span></span> atoms_formula_resolvents <span class="main">[</span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?Prec</span></span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="skolem">I</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
       <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?atoms_init</span> <span class="skolem">I</span>›</span></span> 
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"atoms_formula <span class="main">(</span><span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> 
                <span class="main">⊆</span>  <span class="main">{</span> <span class="bound">X</span><span class="main">.</span> <span class="main">∃</span><span class="bound">I</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">I</span> <span class="main">&lt;</span> <span class="free">N</span> <span class="main">∧</span> <span class="bound">X</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span> <span class="bound">I</span><span class="main">)</span><span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> atoms_formula_union <span class="main">[</span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?Prec</span></span></span> <span class="quoted"><span class="quoted">"all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span>"</span></span><span class="main">]</span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
       <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"atoms_formula <span class="var">?R</span> <span class="main">⊆</span>  <span class="main">{</span> <span class="bound">X</span><span class="main">.</span> <span class="main">∃</span><span class="bound">I</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">I</span> <span class="main">&lt;</span> <span class="free">N</span> <span class="main">∧</span> <span class="bound">X</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span> <span class="bound">I</span><span class="main">)</span><span class="main">}</span>"</span></span>
       <span class="keyword1"><span class="command">using</span></span> atoms_formula_simplify <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="var">?Prec</span> <span class="main">∪</span> <span class="main">(</span>all_resolvents_upon <span class="var">?Prec</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
       <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹equivalent <span class="free">S</span> <span class="main">(</span>resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span><span class="main">)</span>›</span></span> 
          <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">∀</span><span class="bound">J</span><span class="main">::</span>nat<span class="main">.</span> <span class="main">(</span><span class="bound">J</span> <span class="main">&lt;</span> <span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span> 
            <span class="main">⟶</span> <span class="main">(</span>partial_saturation <span class="main">(</span>resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">A</span> <span class="bound">J</span><span class="main">)</span> 
                  <span class="main">(</span>resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span> 
          <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>all_fulfill <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">¬</span><span class="main">(</span>tautology <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span><span class="main">)</span> <span class="main">)</span>›</span></span>
          <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>all_fulfill finite <span class="main">(</span>resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹non_redundant <span class="var">?R</span>›</span></span>
          <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹atoms_formula <span class="main">(</span>resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span><span class="main">)</span>  <span class="main">⊆</span>  <span class="main">{</span> <span class="bound">X</span><span class="main">.</span> <span class="main">∃</span><span class="bound">I</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">I</span> <span class="main">&lt;</span> <span class="free">N</span> <span class="main">∧</span> <span class="bound">X</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span> <span class="bound">I</span><span class="main">)</span><span class="main">}</span>›</span></span>
       <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">(</span>Suc <span class="skolem">I</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">qed</span></span>
   <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Using the above invariants, we show that the final clause set is saturated.›</span></span>

  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">J</span><span class="main">.</span> <span class="main">(</span><span class="bound">J</span> <span class="main">&lt;</span> <span class="free">N</span> <span class="main">⟶</span> partial_saturation <span class="var">?Final</span> <span class="main">(</span><span class="free">A</span> <span class="bound">J</span><span class="main">)</span> <span class="var">?Final</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"atoms_formula <span class="main">(</span>resolvents_sequence <span class="free">A</span> <span class="free">S</span> <span class="free">N</span><span class="main">)</span>  <span class="main">⊆</span>  <span class="main">{</span> <span class="bound">X</span><span class="main">.</span> <span class="main">∃</span><span class="bound">I</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">I</span> <span class="main">&lt;</span> <span class="free">N</span> <span class="main">∧</span> <span class="bound">X</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span> <span class="bound">I</span><span class="main">)</span><span class="main">}</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"equivalent <span class="free">S</span> <span class="var">?Final</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"non_redundant <span class="var">?Final</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"all_fulfill finite <span class="var">?Final</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"saturated_binary_rule resolvent <span class="var">?Final</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> saturated_binary_rule resolvent <span class="var">?Final</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P1</span></span> <span class="skolem"><span class="skolem">P2</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">∈</span> <span class="var">?Final</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P2</span> <span class="main">∈</span> <span class="var">?Final</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>"</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>redundant <span class="skolem">C</span> <span class="var">?Final</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> saturated_binary_rule_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹resolvent <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">C</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">B</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> resolvent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> <span class="main">(</span>atoms_formula <span class="var">?Final</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹atoms_formula <span class="var">?Final</span> <span class="main">⊆</span> <span class="main">{</span> <span class="bound">X</span><span class="main">.</span> <span class="main">∃</span><span class="bound">I</span><span class="main">::</span>nat<span class="main">.</span> <span class="bound">I</span> <span class="main">&lt;</span> <span class="free">N</span> <span class="main">∧</span> <span class="bound">X</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span> <span class="bound">I</span><span class="main">)</span> <span class="main">}</span>›</span></span> 
        <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">I</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">I</span> <span class="main">&lt;</span> <span class="free">N</span>"</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">B</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">J</span><span class="main">.</span> <span class="main">(</span><span class="bound">J</span> <span class="main">&lt;</span> <span class="free">N</span> <span class="main">⟶</span> partial_saturation <span class="var">?Final</span> <span class="main">(</span><span class="free">A</span> <span class="bound">J</span><span class="main">)</span> <span class="var">?Final</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span>›</span></span><span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">I</span> <span class="main">&lt;</span> <span class="free">N</span>›</span></span> 
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"partial_saturation <span class="var">?Final</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span> <span class="var">?Final</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="main">(</span><span class="free">A</span> <span class="skolem">I</span><span class="main">)</span>›</span></span><span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="var">?Final</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P2</span> <span class="main">∈</span> <span class="var">?Final</span>›</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"redundant <span class="skolem">C</span> <span class="var">?Final</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> partial_saturation_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>redundant <span class="skolem">C</span> <span class="var">?Final</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span> 
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∉</span> atoms_formula <span class="var">?Final</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="var">?Final</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∉</span> atoms_clause <span class="skolem">P1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Pos <span class="skolem">B</span> <span class="main">∉</span> <span class="skolem">P1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">=</span> resolvent_upon <span class="skolem">P1</span> <span class="skolem">P2</span> <span class="skolem">B</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P1</span> <span class="main">⊆</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P1</span> <span class="main">∈</span> <span class="var">?Final</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">¬</span>redundant <span class="skolem">C</span> <span class="var">?Final</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> 
        <span class="keyword1"><span class="command">unfolding</span></span> redundant_def subsumes_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
   <span class="keyword1"><span class="command">qed</span></span>
   <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹all_fulfill finite <span class="var">?Final</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹non_redundant <span class="var">?Final</span>›</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"prime_implicates <span class="var">?Final</span> <span class="main">=</span> <span class="var">?Final</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> prime_implicates_of_saturated_sets <span class="main">[</span><span class="operator">of</span> <span class="var"><span class="quoted"><span class="var">?Final</span></span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹equivalent <span class="free">S</span> <span class="var">?Final</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>  equivalence_and_prime_implicates <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div>
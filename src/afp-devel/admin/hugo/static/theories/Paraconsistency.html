<div id="Paraconsistency">
<div class="head">
<h1>Theory Paraconsistency</h1>
</div>
<pre class="source"><span class="comment1">(* Anders Schlichtkrull &amp; Jørgen Villadsen, DTU Compute, Denmark *)</span>

<span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹On Paraconsistency›</span></span>

<span class="keyword1"><span class="command">text</span></span>
<span class="quoted"><span class="plain_text">‹
Paraconsistency concerns inference systems that do not explode given a contradiction.

The Internet Encyclopedia of Philosophy has a survey article on paraconsistent logic.

The following Isabelle theory formalizes a specific paraconsistent many-valued logic.
›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Paraconsistency <span class="keyword2"><span class="keyword">imports</span></span> <a href="../../HOL/HOL/Main.html">Main</a> <span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span>
<span class="quoted"><span class="plain_text">‹
The details about our logic are in our article in a special issue on logical approaches to
paraconsistency in the Journal of Applied Non-Classical Logics (Volume 15, Number 1, 2005).
›</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Syntax and Semantics›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Syntax of Propositional Logic›</span></span>

<span class="keyword1"><span class="command">text</span></span>
<span class="quoted"><span class="plain_text">‹
Only the primed operators return indeterminate truth values.
›</span></span>

<span class="keyword1"><span class="command">type_synonym</span></span> id <span class="main">=</span> <span class="quoted">string</span>

<span class="keyword1"><span class="command">datatype</span></span> fm <span class="main">=</span> Pro <span class="quoted">id</span> <span class="main">|</span> Truth <span class="main">|</span> Neg' <span class="quoted">fm</span> <span class="main">|</span> Con' <span class="quoted">fm</span> <span class="quoted">fm</span> <span class="main">|</span> Eql <span class="quoted">fm</span> <span class="quoted">fm</span> <span class="main">|</span> Eql' <span class="quoted">fm</span> <span class="quoted">fm</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">Falsity</span> <span class="main">::</span> <span class="quoted">fm</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">Falsity</span> <span class="main">≡</span> Neg' Truth"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">Dis'</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> fm <span class="main">⇒</span> fm"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">Dis'</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="main">≡</span> Neg' <span class="main">(</span>Con' <span class="main">(</span>Neg' <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span> <span class="main">(</span>Neg' <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">Imp</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> fm <span class="main">⇒</span> fm"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">Imp</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="main">≡</span> Eql <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">(</span>Con' <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">Imp'</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> fm <span class="main">⇒</span> fm"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">Imp'</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="main">≡</span> Eql' <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">(</span>Con' <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">Box</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> fm"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">Box</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">≡</span> Eql <span class="free"><span class="bound"><span class="entity">p</span></span></span> Truth"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">Neg</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> fm"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">Neg</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">≡</span> Box <span class="main">(</span>Neg' <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">Con</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> fm <span class="main">⇒</span> fm"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">Con</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="main">≡</span> Box <span class="main">(</span>Con' <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">Dis</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> fm <span class="main">⇒</span> fm"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">Dis</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="main">≡</span> Box <span class="main">(</span>Dis' <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">Cla</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> fm"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">Cla</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">≡</span> Dis <span class="main">(</span>Box <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span> <span class="main">(</span>Eql <span class="free"><span class="bound"><span class="entity">p</span></span></span> Falsity<span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">Nab</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> fm"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">Nab</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">≡</span> Neg <span class="main">(</span>Cla <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Semantics of Propositional Logic›</span></span>

<span class="keyword1"><span class="command">text</span></span>
<span class="quoted"><span class="plain_text">‹
There is a countably infinite number of indeterminate truth values.
›</span></span>

<span class="keyword1"><span class="command">datatype</span></span> tv <span class="main">=</span> Det <span class="quoted">bool</span> <span class="main">|</span> Indet <span class="quoted">nat</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">eval_neg</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"tv <span class="main">⇒</span> tv"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">eval_neg</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span>
    <span class="main">(</span>
      <span class="keyword1">case</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">of</span>
        Det False <span class="main">⇒</span> Det True <span class="main">|</span>
        Det True <span class="main">⇒</span> Det False <span class="main">|</span>
        Indet <span class="bound">n</span> <span class="main">⇒</span> Indet <span class="bound">n</span>
    <span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">eval</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>id <span class="main">⇒</span> tv<span class="main">)</span> <span class="main">⇒</span> fm <span class="main">⇒</span> tv"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="main">(</span>Pro <span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">s</span></span></span>"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> Truth <span class="main">=</span> Det True"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="main">(</span>Neg' <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span> <span class="main">=</span> eval_neg <span class="main">(</span><span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span>"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="main">(</span>Con' <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span> <span class="main">=</span>
    <span class="main">(</span>
      <span class="keyword1">if</span> <span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">=</span> <span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="keyword1">then</span> <span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="keyword1">else</span>
      <span class="keyword1">if</span> <span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">=</span> Det True <span class="keyword1">then</span> <span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="keyword1">else</span>
      <span class="keyword1">if</span> <span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="main">=</span> Det True <span class="keyword1">then</span> <span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="keyword1">else</span> Det False
    <span class="main">)</span>"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="main">(</span>Eql <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span> <span class="main">=</span>
    <span class="main">(</span>
      <span class="keyword1">if</span> <span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">=</span> <span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="keyword1">then</span> Det True <span class="keyword1">else</span> Det False
    <span class="main">)</span>"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="main">(</span>Eql' <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span> <span class="main">=</span>
    <span class="main">(</span>
      <span class="keyword1">if</span> <span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">=</span> <span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="keyword1">then</span> Det True <span class="keyword1">else</span>
        <span class="main">(</span>
          <span class="keyword1">case</span> <span class="main">(</span><span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">,</span> <span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span> <span class="keyword1">of</span>
            <span class="main">(</span>Det True<span class="main">,</span> <span class="main"><span class="bound">_</span></span><span class="main">)</span> <span class="main">⇒</span> <span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="main">|</span>
            <span class="main">(</span><span class="main"><span class="bound">_</span></span><span class="main">,</span> Det True<span class="main">)</span> <span class="main">⇒</span> <span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">|</span>
            <span class="main">(</span>Det False<span class="main">,</span> <span class="main"><span class="bound">_</span></span><span class="main">)</span> <span class="main">⇒</span> eval_neg <span class="main">(</span><span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span> <span class="main">|</span>
            <span class="main">(</span><span class="main"><span class="bound">_</span></span><span class="main">,</span> Det False<span class="main">)</span> <span class="main">⇒</span> eval_neg <span class="main">(</span><span class="free">eval</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span> <span class="main">|</span>
            <span class="main"><span class="bound">_</span></span> <span class="main">⇒</span> Det False
        <span class="main">)</span>
    <span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> eval_equality_simplify<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="main">(</span>Eql <span class="free">p</span> <span class="free">q</span><span class="main">)</span> <span class="main">=</span> Det <span class="main">(</span>eval <span class="free">i</span> <span class="free">p</span> <span class="main">=</span> eval <span class="free">i</span> <span class="free">q</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">theorem</span></span> eval_equality<span class="main">:</span>
  <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="free">p</span> <span class="free">q</span><span class="main">)</span> <span class="main">=</span>
    <span class="main">(</span>
      <span class="keyword1">if</span> eval <span class="free">i</span> <span class="free">p</span> <span class="main">=</span> eval <span class="free">i</span> <span class="free">q</span> <span class="keyword1">then</span> Det True <span class="keyword1">else</span>
      <span class="keyword1">if</span> eval <span class="free">i</span> <span class="free">p</span> <span class="main">=</span> Det True <span class="keyword1">then</span> eval <span class="free">i</span> <span class="free">q</span> <span class="keyword1">else</span>
      <span class="keyword1">if</span> eval <span class="free">i</span> <span class="free">q</span> <span class="main">=</span> Det True <span class="keyword1">then</span> eval <span class="free">i</span> <span class="free">p</span> <span class="keyword1">else</span>
      <span class="keyword1">if</span> eval <span class="free">i</span> <span class="free">p</span> <span class="main">=</span> Det False <span class="keyword1">then</span> eval <span class="free">i</span> <span class="main">(</span>Neg' <span class="free">q</span><span class="main">)</span> <span class="keyword1">else</span>
      <span class="keyword1">if</span> eval <span class="free">i</span> <span class="free">q</span> <span class="main">=</span> Det False <span class="keyword1">then</span> eval <span class="free">i</span> <span class="main">(</span>Neg' <span class="free">p</span><span class="main">)</span> <span class="keyword1">else</span>
      Det False
    <span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="free">p</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="free">q</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">theorem</span></span> eval_negation<span class="main">:</span>
  <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="main">(</span>Neg' <span class="free">p</span><span class="main">)</span> <span class="main">=</span>
    <span class="main">(</span>
      <span class="keyword1">if</span> eval <span class="free">i</span> <span class="free">p</span> <span class="main">=</span> Det False <span class="keyword1">then</span> Det True <span class="keyword1">else</span>
      <span class="keyword1">if</span> eval <span class="free">i</span> <span class="free">p</span> <span class="main">=</span> Det True <span class="keyword1">then</span> Det False <span class="keyword1">else</span>
      eval <span class="free">i</span> <span class="free">p</span>
    <span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="free">p</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="main">(</span>Cla <span class="free">p</span><span class="main">)</span> <span class="main">=</span> eval <span class="free">i</span> <span class="main">(</span>Box <span class="main">(</span>Dis' <span class="free">p</span> <span class="main">(</span>Neg' <span class="free">p</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> eval_negation
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> double_negation<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="free">p</span> <span class="main">=</span> eval <span class="free">i</span> <span class="main">(</span>Neg' <span class="main">(</span>Neg' <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> eval_negation
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Validity and Consistency›</span></span>

<span class="keyword1"><span class="command">text</span></span>
<span class="quoted"><span class="plain_text">‹
Validity gives the set of theorems and the logic has at least a theorem and a non-theorem.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">valid</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">valid</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">i</span><span class="main">.</span> eval <span class="bound">i</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">=</span> Det True"</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid Truth"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid Falsity"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Truth Tables›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹String Functions›</span></span>

<span class="keyword1"><span class="command">text</span></span>
<span class="quoted"><span class="plain_text">‹
The following functions support arbitrary unary and binary truth tables.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">tv_pair_row</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"tv list <span class="main">⇒</span> tv <span class="main">⇒</span> <span class="main">(</span>tv <span class="main">*</span> tv<span class="main">)</span> list"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">tv_pair_row</span> <span class="free"><span class="bound"><span class="entity">tvs</span></span></span> <span class="free"><span class="bound"><span class="entity">tv</span></span></span> <span class="main">≡</span> map <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">tv</span></span></span><span class="main">,</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">tvs</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">tv_pair_table</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"tv list <span class="main">⇒</span> <span class="main">(</span>tv <span class="main">*</span> tv<span class="main">)</span> list list"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">tv_pair_table</span> <span class="free"><span class="bound"><span class="entity">tvs</span></span></span> <span class="main">≡</span> map <span class="main">(</span>tv_pair_row <span class="free"><span class="bound"><span class="entity">tvs</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">tvs</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">map_row</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>tv <span class="main">⇒</span> tv <span class="main">⇒</span> tv<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>tv <span class="main">*</span> tv<span class="main">)</span> list <span class="main">⇒</span> tv list"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">map_row</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">tvtvs</span></span></span> <span class="main">≡</span> map <span class="main">(</span><span class="main">λ</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span> <span class="bound">y</span><span class="main">)</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">tvtvs</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">map_table</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>tv <span class="main">⇒</span> tv <span class="main">⇒</span> tv<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>tv <span class="main">*</span> tv<span class="main">)</span> list list <span class="main">⇒</span> tv list list"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">map_table</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">tvtvss</span></span></span> <span class="main">≡</span> map <span class="main">(</span>map_row <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">tvtvss</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">unary_truth_table</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> tv list <span class="main">⇒</span> tv list"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">unary_truth_table</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">tvs</span></span></span> <span class="main">≡</span>
      map <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> eval <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> undefined<span class="main">)</span><span class="main">(</span><span class="inner_quoted">''p''</span> <span class="main">:=</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">tvs</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">binary_truth_table</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> tv list <span class="main">⇒</span> tv list list"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">binary_truth_table</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">tvs</span></span></span> <span class="main">≡</span>
      map_table <span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> eval <span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> undefined<span class="main">)</span><span class="main">(</span><span class="inner_quoted">''p''</span> <span class="main">:=</span> <span class="bound">x</span><span class="main">,</span> <span class="inner_quoted">''q''</span> <span class="main">:=</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span> <span class="main">(</span>tv_pair_table <span class="free"><span class="bound"><span class="entity">tvs</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">digit_of_nat</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> char"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">digit_of_nat</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">≡</span>
   <span class="main">(</span><span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">=</span> <span class="main">1</span> <span class="keyword1">then</span> <span class="main">(</span><span class="keyword1">CHR</span> <span class="inner_quoted">''1''</span><span class="main">)</span> <span class="keyword1">else</span> <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">=</span> <span class="numeral">2</span> <span class="keyword1">then</span> <span class="main">(</span><span class="keyword1">CHR</span> <span class="inner_quoted">''2''</span><span class="main">)</span> <span class="keyword1">else</span> <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">=</span> <span class="numeral">3</span> <span class="keyword1">then</span> <span class="main">(</span><span class="keyword1">CHR</span> <span class="inner_quoted">''3''</span><span class="main">)</span> <span class="keyword1">else</span>
    <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">=</span> <span class="numeral">4</span> <span class="keyword1">then</span> <span class="main">(</span><span class="keyword1">CHR</span> <span class="inner_quoted">''4''</span><span class="main">)</span> <span class="keyword1">else</span> <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">=</span> <span class="numeral">5</span> <span class="keyword1">then</span> <span class="main">(</span><span class="keyword1">CHR</span> <span class="inner_quoted">''5''</span><span class="main">)</span> <span class="keyword1">else</span> <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">=</span> <span class="numeral">6</span> <span class="keyword1">then</span> <span class="main">(</span><span class="keyword1">CHR</span> <span class="inner_quoted">''6''</span><span class="main">)</span> <span class="keyword1">else</span>
    <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">=</span> <span class="numeral">7</span> <span class="keyword1">then</span> <span class="main">(</span><span class="keyword1">CHR</span> <span class="inner_quoted">''7''</span><span class="main">)</span> <span class="keyword1">else</span> <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">=</span> <span class="numeral">8</span> <span class="keyword1">then</span> <span class="main">(</span><span class="keyword1">CHR</span> <span class="inner_quoted">''8''</span><span class="main">)</span> <span class="keyword1">else</span> <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">=</span> <span class="numeral">9</span> <span class="keyword1">then</span> <span class="main">(</span><span class="keyword1">CHR</span> <span class="inner_quoted">''9''</span><span class="main">)</span> <span class="keyword1">else</span>
      <span class="main">(</span><span class="keyword1">CHR</span> <span class="inner_quoted">''0''</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">string_of_nat</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat <span class="main">⇒</span> string"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">string_of_nat</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">=</span>
      <span class="main">(</span><span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">&lt;</span> <span class="numeral">10</span> <span class="keyword1">then</span> <span class="main">[</span>digit_of_nat <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">]</span> <span class="keyword1">else</span> <span class="free">string_of_nat</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="keyword1">div</span> <span class="numeral">10</span><span class="main">)</span> <span class="main">@</span> <span class="main">[</span>digit_of_nat <span class="main">(</span><span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="keyword1">mod</span> <span class="numeral">10</span><span class="main">)</span><span class="main">]</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">string_tv</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"tv <span class="main">⇒</span> string"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">string_tv</span> <span class="main">(</span>Det True<span class="main">)</span> <span class="main">=</span> <span class="inner_quoted">''*''</span>"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">string_tv</span> <span class="main">(</span>Det False<span class="main">)</span> <span class="main">=</span> <span class="inner_quoted">''o''</span>"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">string_tv</span> <span class="main">(</span>Indet <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="main">=</span> string_of_nat <span class="free"><span class="bound"><span class="entity">n</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">appends</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"string list <span class="main">⇒</span> string"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">appends</span> <span class="free"><span class="bound"><span class="entity">strs</span></span></span> <span class="main">≡</span> foldr append <span class="free"><span class="bound"><span class="entity">strs</span></span></span> <span class="main">[]</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">appends_nl</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"string list <span class="main">⇒</span> string"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">appends_nl</span> <span class="free"><span class="bound"><span class="entity">strs</span></span></span> <span class="main">≡</span> <span class="inner_quoted">''⏎  ''</span> <span class="main">@</span> foldr <span class="main">(</span><span class="main">λ</span><span class="bound">s</span> <span class="bound">s'</span><span class="main">.</span> <span class="bound">s</span> <span class="main">@</span> <span class="inner_quoted">''⏎  ''</span> <span class="main">@</span> <span class="bound">s'</span><span class="main">)</span> <span class="main">(</span>butlast <span class="free"><span class="bound"><span class="entity">strs</span></span></span><span class="main">)</span> <span class="main">(</span>last <span class="free"><span class="bound"><span class="entity">strs</span></span></span><span class="main">)</span> <span class="main">@</span> <span class="inner_quoted">''⏎''</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">string_table</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"tv list list <span class="main">⇒</span> string list list"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">string_table</span> <span class="free"><span class="bound"><span class="entity">tvss</span></span></span> <span class="main">≡</span> map <span class="main">(</span>map string_tv<span class="main">)</span> <span class="free"><span class="bound"><span class="entity">tvss</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">string_table_string</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"string list list <span class="main">⇒</span> string"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">string_table_string</span> <span class="free"><span class="bound"><span class="entity">strss</span></span></span> <span class="main">≡</span> appends_nl <span class="main">(</span>map appends <span class="free"><span class="bound"><span class="entity">strss</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">unary</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> tv list <span class="main">⇒</span> string"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">unary</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">tvs</span></span></span> <span class="main">≡</span> appends_nl <span class="main">(</span>map string_tv <span class="main">(</span>unary_truth_table <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">tvs</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">binary</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> tv list <span class="main">⇒</span> string"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">binary</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">tvs</span></span></span> <span class="main">≡</span> string_table_string <span class="main">(</span>string_table <span class="main">(</span>binary_truth_table <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">tvs</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Main Truth Tables›</span></span>

<span class="keyword1"><span class="command">text</span></span>
<span class="quoted"><span class="plain_text">‹
The omitted Cla (for Classic) is discussed later; Nab (for Nabla) is simply the negation of it.
›</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="comment1">(* Box Truth Table *)</span>
  <span class="quoted"><span class="quoted">"unary <span class="main">(</span>Box <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">]</span> <span class="main">=</span> <span class="inner_quoted">''
  *
  o
  o
''</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">code_simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="comment1">(* Con' Truth Table *)</span>
  <span class="quoted"><span class="quoted">"binary <span class="main">(</span>Con' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">]</span> <span class="main">=</span> <span class="inner_quoted">''
  *o12
  oooo
  1o1o
  2oo2
''</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">code_simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="comment1">(* Dis' Truth Table *)</span>
  <span class="quoted"><span class="quoted">"binary <span class="main">(</span>Dis' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">]</span> <span class="main">=</span> <span class="inner_quoted">''
  ****
  *o12
  *11*
  *2*2
''</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">code_simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="comment1">(* Neg' Truth Table *)</span>
  <span class="quoted"><span class="quoted">"unary <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">]</span> <span class="main">=</span> <span class="inner_quoted">''
  o
  *
  1
''</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">code_simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="comment1">(* Eql' Truth Table *)</span>
  <span class="quoted"><span class="quoted">"binary <span class="main">(</span>Eql' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">]</span> <span class="main">=</span> <span class="inner_quoted">''
  *o12
  o*12
  11*o
  22o*
''</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">code_simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="comment1">(* Imp' Truth Table *)</span>
  <span class="quoted"><span class="quoted">"binary <span class="main">(</span>Imp' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">]</span> <span class="main">=</span> <span class="inner_quoted">''
  *o12
  ****
  *1*1
  *22*
''</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">code_simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="comment1">(* Neg Truth Table *)</span>
  <span class="quoted"><span class="quoted">"unary <span class="main">(</span>Neg <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">]</span> <span class="main">=</span> <span class="inner_quoted">''
  o
  *
  o
''</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">code_simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="comment1">(* Eql Truth Table *)</span>
  <span class="quoted"><span class="quoted">"binary <span class="main">(</span>Eql <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">]</span> <span class="main">=</span> <span class="inner_quoted">''
  *ooo
  o*oo
  oo*o
  ooo*
''</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">code_simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="comment1">(* Imp Truth Table *)</span>
  <span class="quoted"><span class="quoted">"binary <span class="main">(</span>Imp <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">]</span> <span class="main">=</span> <span class="inner_quoted">''
  *ooo
  ****
  *o*o
  *oo*
''</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">code_simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="comment1">(* Nab Truth Table *)</span>
  <span class="quoted"><span class="quoted">"unary <span class="main">(</span>Nab <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">]</span> <span class="main">=</span> <span class="inner_quoted">''
  o
  o
  *
''</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">code_simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="comment1">(* Con Truth Table *)</span>
  <span class="quoted"><span class="quoted">"binary <span class="main">(</span>Con <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">]</span> <span class="main">=</span> <span class="inner_quoted">''
  *ooo
  oooo
  oooo
  oooo
''</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">code_simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="comment1">(* Dis Truth Table *)</span>
  <span class="quoted"><span class="quoted">"binary <span class="main">(</span>Dis <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">]</span> <span class="main">=</span> <span class="inner_quoted">''
  ****
  *ooo
  *oo*
  *o*o
''</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">code_simp</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Basic Theorems›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Selected Theorems and Non-Theorems›</span></span>

<span class="keyword1"><span class="command">text</span></span>
<span class="quoted"><span class="plain_text">‹
Many of the following theorems and non-theorems use assumptions and meta-variables.
›</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Cla <span class="main">(</span>Box <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid <span class="main">(</span>Nab <span class="main">(</span>Box <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Cla <span class="main">(</span>Cla <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid <span class="main">(</span>Nab <span class="main">(</span>Nab <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Cla <span class="main">(</span>Nab <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid <span class="main">(</span>Nab <span class="main">(</span>Cla <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Box <span class="free">p</span><span class="main">)</span> <span class="main">⟷</span> valid <span class="main">(</span>Box <span class="main">(</span>Box <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Neg <span class="free">p</span><span class="main">)</span> <span class="main">⟷</span> valid <span class="main">(</span>Neg' <span class="free">p</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Con <span class="free">p</span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> valid <span class="main">(</span>Con' <span class="free">p</span> <span class="free">q</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Dis <span class="free">p</span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> valid <span class="main">(</span>Dis' <span class="free">p</span> <span class="free">q</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Eql <span class="free">p</span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> valid <span class="main">(</span>Eql' <span class="free">p</span> <span class="free">q</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">using</span></span> eval.simps tv.inject eval_equality eval_negation
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Imp <span class="free">p</span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> valid <span class="main">(</span>Imp' <span class="free">p</span> <span class="free">q</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">using</span></span> eval.simps tv.inject eval_equality eval_negation
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> Det True<span class="main">)</span> <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det False"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> valid_def
    <span class="keyword1"><span class="command">using</span></span> tv.inject
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"valid <span class="free">p</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid <span class="main">(</span>Neg' <span class="free">p</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Neg' <span class="free">p</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid <span class="free">p</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Neg' <span class="main">(</span>Neg' <span class="free">p</span><span class="main">)</span><span class="main">)</span> <span class="main">⟷</span> valid <span class="free">p</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">using</span></span> double_negation
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">theorem</span></span> conjunction<span class="main">:</span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Con' <span class="free">p</span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> valid <span class="free">p</span> <span class="main">∧</span> valid <span class="free">q</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Con' <span class="free">p</span> <span class="free">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"valid <span class="free">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"valid <span class="free">q</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms conjunction
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"valid <span class="free">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Imp <span class="free">p</span> <span class="free">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"valid <span class="free">q</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms eval.simps tv.inject
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"valid <span class="free">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Imp' <span class="free">p</span> <span class="free">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"valid <span class="free">q</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms eval.simps tv.inject eval_equality
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Key Equalities›</span></span>

<span class="keyword1"><span class="command">text</span></span>
<span class="quoted"><span class="plain_text">‹
The key equalities are part of the motivation for the semantic clauses.
›</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Eql <span class="free">p</span> <span class="main">(</span>Neg' <span class="main">(</span>Neg' <span class="free">p</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">using</span></span> double_negation
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Eql Truth <span class="main">(</span>Neg' Falsity<span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Eql Falsity <span class="main">(</span>Neg' Truth<span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Eql <span class="free">p</span> <span class="main">(</span>Con' <span class="free">p</span> <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Eql <span class="free">p</span> <span class="main">(</span>Con' Truth <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Eql <span class="free">p</span> <span class="main">(</span>Con' <span class="free">p</span> Truth<span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Eql Truth <span class="main">(</span>Eql' <span class="free">p</span> <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Eql <span class="free">p</span> <span class="main">(</span>Eql' Truth <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Eql <span class="free">p</span> <span class="main">(</span>Eql' <span class="free">p</span> Truth<span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="main">(</span>Eql <span class="free">p</span> <span class="main">(</span>Eql' <span class="free">p</span> Truth<span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">p</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Eql <span class="main">(</span>Neg' <span class="free">p</span><span class="main">)</span> <span class="main">(</span>Eql' Falsity <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="main">(</span>Eql <span class="main">(</span>Neg' <span class="free">p</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="main">(</span>Neg' Truth<span class="main">)</span> <span class="free">p</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">p</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Eql <span class="main">(</span>Neg' <span class="free">p</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="free">p</span> Falsity<span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def
  <span class="keyword1"><span class="command">using</span></span> eval.simps eval_equality eval_negation
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Further Non-Theorems›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Smaller Domains and Paraconsistency›</span></span>

<span class="keyword1"><span class="command">text</span></span>
<span class="quoted"><span class="plain_text">‹
Validity is relativized to a set of indeterminate truth values (called a domain).
›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">domain</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat set <span class="main">⇒</span> tv set"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">domain</span> <span class="free"><span class="bound"><span class="entity">U</span></span></span> <span class="main">≡</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span> <span class="main">∪</span> Indet <span class="main">`</span> <span class="free"><span class="bound"><span class="entity">U</span></span></span>"</span></span>

<span class="keyword1"><span class="command">theorem</span></span> universal_domain<span class="main">:</span> <span class="quoted"><span class="quoted">"domain <span class="main">{</span><span class="bound">n</span><span class="main">.</span> True<span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span><span class="main">.</span> True<span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> Det True <span class="main">∨</span> <span class="bound">x</span> <span class="main">=</span> Det False <span class="main">∨</span> <span class="bound">x</span> <span class="main">∈</span> range Indet"</span></span>
    <span class="keyword1"><span class="command">using</span></span> range_eqI tv.exhaust tv.inject
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">valid_in</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat set <span class="main">⇒</span> fm <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">valid_in</span> <span class="free"><span class="bound"><span class="entity">U</span></span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">i</span><span class="main">.</span> range <span class="bound">i</span> <span class="main">⊆</span> domain <span class="free"><span class="bound"><span class="entity">U</span></span></span> <span class="main">⟶</span> eval <span class="bound">i</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">=</span> Det True"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">valid_boole</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">valid_boole</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">≡</span> valid_in <span class="main">{}</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span>"</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="free">p</span> <span class="main">⟷</span> valid_in <span class="main">{</span><span class="bound">n</span><span class="main">.</span> True<span class="main">}</span> <span class="free">p</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_def valid_in_def
  <span class="keyword1"><span class="command">using</span></span> universal_domain
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">theorem</span></span> valid_valid_in<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"valid <span class="free">p</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="free">U</span> <span class="free">p</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms
  <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def valid_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">theorem</span></span> transfer<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid_in <span class="free">U</span> <span class="free">p</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid <span class="free">p</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms valid_valid_in
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="free">U</span> <span class="main">(</span>Neg' <span class="main">(</span>Neg' <span class="free">p</span><span class="main">)</span><span class="main">)</span> <span class="main">⟷</span> valid_in <span class="free">U</span> <span class="free">p</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
  <span class="keyword1"><span class="command">using</span></span> double_negation
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">theorem</span></span> conjunction_in<span class="main">:</span> <span class="quoted"><span class="quoted">"valid_in <span class="free">U</span> <span class="main">(</span>Con' <span class="free">p</span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> valid_in <span class="free">U</span> <span class="free">p</span> <span class="main">∧</span> valid_in <span class="free">U</span> <span class="free">q</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="free">U</span> <span class="main">(</span>Con' <span class="free">p</span> <span class="free">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="free">U</span> <span class="free">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="free">U</span> <span class="free">q</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms conjunction_in
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="free">U</span> <span class="free">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="free">U</span> <span class="main">(</span>Imp <span class="free">p</span> <span class="free">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="free">U</span> <span class="free">q</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms eval.simps tv.inject
  <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="free">U</span> <span class="free">p</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="free">U</span> <span class="main">(</span>Imp' <span class="free">p</span> <span class="free">q</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="free">U</span> <span class="free">q</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms eval.simps tv.inject eval_equality
  <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">Explosion</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> fm <span class="main">⇒</span> fm"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">Explosion</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="main">≡</span> Imp' <span class="main">(</span>Con' <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">(</span>Neg' <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">q</span></span></span>"</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid_boole <span class="main">(</span>Explosion <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"id <span class="main">⇒</span> tv"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"range <span class="skolem">i</span> <span class="main">⊆</span> domain <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''p''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''q''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="main">(</span>Explosion <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''p''</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''q''</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> explosion_counterexample<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid_in <span class="main">{</span><span class="main">1</span><span class="main">}</span> <span class="main">(</span>Explosion <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?i</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> Indet <span class="main">1</span><span class="main">)</span><span class="main">(</span><span class="inner_quoted">''q''</span> <span class="main">:=</span> Det False<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"range <span class="var">?i</span> <span class="main">⊆</span> domain <span class="main">{</span><span class="main">1</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> image_subset_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="var">?i</span> <span class="main">(</span>Explosion <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Indet <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Indet <span class="main">1</span> <span class="main">≠</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> explosion_not_valid<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid <span class="main">(</span>Explosion <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> explosion_counterexample transfer
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid <span class="main">(</span>Imp <span class="main">(</span>Con' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> explosion_counterexample transfer eval.simps tv.simps
  <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
  <span class="comment1">― ‹by smt OK›</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> *<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∀</span><span class="bound">i</span><span class="main">.</span> range <span class="bound">i</span> <span class="main">⊆</span> domain <span class="skolem">U</span> <span class="main">⟶</span> eval <span class="bound">i</span> <span class="skolem">p</span> <span class="main">=</span> Det True<span class="main">)</span> <span class="main">⟹</span> <span class="main">¬</span> valid <span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">U</span> <span class="skolem">p</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∀</span><span class="bound">i</span><span class="main">.</span> range <span class="bound">i</span> <span class="main">⊆</span> domain <span class="main">{</span><span class="main">1</span><span class="main">}</span> <span class="main">⟶</span>
      eval <span class="bound">i</span> <span class="main">(</span>Explosion <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det True<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    **<span class="main">:</span> <span class="quoted"><span class="quoted">"range <span class="skolem">i</span> <span class="main">⊆</span> domain <span class="main">{</span><span class="main">1</span><span class="main">}</span> <span class="main">∧</span>
        eval <span class="skolem">i</span> <span class="main">(</span>Explosion <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">≠</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="main">(</span>Con' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">≠</span>
      eval <span class="skolem">i</span> <span class="main">(</span>Con' <span class="main">(</span>Con' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> * **
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Example: Contraposition›</span></span>

<span class="keyword1"><span class="command">text</span></span>
<span class="quoted"><span class="plain_text">‹
Contraposition is not valid.
›</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">Contraposition</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> fm <span class="main">⇒</span> fm"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">Contraposition</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="main">≡</span> Eql' <span class="main">(</span>Imp' <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span> <span class="main">(</span>Imp' <span class="main">(</span>Neg' <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span> <span class="main">(</span>Neg' <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid_boole <span class="main">(</span>Contraposition <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"id <span class="main">⇒</span> tv"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"range <span class="skolem">i</span> <span class="main">⊆</span> domain <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''p''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''q''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="main">(</span>Contraposition <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''p''</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''q''</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="main">{</span><span class="main">1</span><span class="main">}</span> <span class="main">(</span>Contraposition <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"id <span class="main">⇒</span> tv"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"range <span class="skolem">i</span> <span class="main">⊆</span> domain <span class="main">{</span><span class="main">1</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''p''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''q''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="main">(</span>Contraposition <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''p''</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''q''</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> contraposition_counterexample<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid_in <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">}</span> <span class="main">(</span>Contraposition <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?i</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> Indet <span class="main">1</span><span class="main">)</span><span class="main">(</span><span class="inner_quoted">''q''</span> <span class="main">:=</span> Indet <span class="numeral">2</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"range <span class="var">?i</span> <span class="main">⊆</span> domain <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> image_subset_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="var">?i</span> <span class="main">(</span>Contraposition <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det False"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Det False <span class="main">≠</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> contraposition_not_valid<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid <span class="main">(</span>Contraposition <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> contraposition_counterexample transfer
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹More Than Four Truth Values Needed›</span></span>

<span class="keyword1"><span class="command">text</span></span>
<span class="quoted"><span class="plain_text">‹
Cla3 is valid for two indeterminate truth values but not for three indeterminate truth values.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ranges<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"range <span class="free">i</span> <span class="main">⊆</span> domain <span class="free">U</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="free">p</span> <span class="main">∈</span> domain <span class="free">U</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms
  <span class="keyword1"><span class="command">unfolding</span></span> domain_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">p</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="comment1">(* Cla Truth Table *)</span>
  <span class="quoted"><span class="quoted">"unary <span class="main">(</span>Cla <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">]</span> <span class="main">=</span> <span class="inner_quoted">''
  *
  *
  o
''</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">code_simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid_boole <span class="main">(</span>Cla <span class="free">p</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"id <span class="main">⇒</span> tv"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"range <span class="skolem">i</span> <span class="main">⊆</span> domain <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">p</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ranges<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">i</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="main">(</span>Cla <span class="free">p</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">p</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid_in <span class="main">{</span><span class="main">1</span><span class="main">}</span> <span class="main">(</span>Cla <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?i</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">s</span><span class="main">.</span> Indet <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"range <span class="var">?i</span> <span class="main">⊆</span> domain <span class="main">{</span><span class="main">1</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> image_subset_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="var">?i</span> <span class="main">(</span>Cla <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det False"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Det False <span class="main">≠</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">Cla2</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> fm <span class="main">⇒</span> fm"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">Cla2</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="main">≡</span> Dis <span class="main">(</span>Dis <span class="main">(</span>Cla <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span> <span class="main">(</span>Cla <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Eql <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="comment1">(* Cla2 Truth Table *)</span>
  <span class="quoted"><span class="quoted">"binary <span class="main">(</span>Cla2 <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">]</span> <span class="main">=</span> <span class="inner_quoted">''
  ****
  ****
  ***o
  **o*
''</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">code_simp</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid_boole <span class="main">(</span>Cla2 <span class="free">p</span> <span class="free">q</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"id <span class="main">⇒</span> tv"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> range<span class="main">:</span> <span class="quoted"><span class="quoted">"range <span class="skolem">i</span> <span class="main">⊆</span> domain <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">p</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">q</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ranges<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">i</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="main">(</span>Cla2 <span class="free">p</span> <span class="free">q</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">p</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">q</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="main">{</span><span class="main">1</span><span class="main">}</span> <span class="main">(</span>Cla2 <span class="free">p</span> <span class="free">q</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"id <span class="main">⇒</span> tv"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> range<span class="main">:</span> <span class="quoted"><span class="quoted">"range <span class="skolem">i</span> <span class="main">⊆</span> domain <span class="main">{</span><span class="main">1</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">p</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">q</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ranges<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">i</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">1</span><span class="main">}</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="main">(</span>Cla2 <span class="free">p</span> <span class="free">q</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">p</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">q</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid_in <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">}</span> <span class="main">(</span>Cla2 <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?i</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> Indet <span class="main">1</span><span class="main">)</span><span class="main">(</span><span class="inner_quoted">''q''</span> <span class="main">:=</span> Indet <span class="numeral">2</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"range <span class="var">?i</span> <span class="main">⊆</span> domain <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> image_subset_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="var">?i</span> <span class="main">(</span>Cla2 <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det False"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Det False <span class="main">≠</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">Cla3</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> fm <span class="main">⇒</span> fm <span class="main">⇒</span> fm"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">Cla3</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">≡</span> Dis <span class="main">(</span>Dis <span class="main">(</span>Cla <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span> <span class="main">(</span>Dis <span class="main">(</span>Cla <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span> <span class="main">(</span>Cla <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Dis <span class="main">(</span>Eql <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span> <span class="main">(</span>Dis <span class="main">(</span>Eql <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span> <span class="main">(</span>Eql <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid_boole <span class="main">(</span>Cla3 <span class="free">p</span> <span class="free">q</span> <span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"id <span class="main">⇒</span> tv"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"range <span class="skolem">i</span> <span class="main">⊆</span> domain <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">p</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">q</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">r</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ranges<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">i</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="main">(</span>Cla3 <span class="free">p</span> <span class="free">q</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">p</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">q</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">r</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="main">{</span><span class="main">1</span><span class="main">}</span> <span class="main">(</span>Cla3 <span class="free">p</span> <span class="free">q</span> <span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"id <span class="main">⇒</span> tv"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"range <span class="skolem">i</span> <span class="main">⊆</span> domain <span class="main">{</span><span class="main">1</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">p</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">q</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">r</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ranges<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">i</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">1</span><span class="main">}</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="main">(</span>Cla3 <span class="free">p</span> <span class="free">q</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">p</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">q</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">r</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">}</span> <span class="main">(</span>Cla3 <span class="free">p</span> <span class="free">q</span> <span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"id <span class="main">⇒</span> tv"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"range <span class="skolem">i</span> <span class="main">⊆</span> domain <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">p</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">q</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">r</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ranges<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">i</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">}</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="main">(</span>Cla3 <span class="free">p</span> <span class="free">q</span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">p</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">q</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="free">r</span>"</span></span><span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid_in <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">,</span> <span class="numeral">3</span><span class="main">}</span> <span class="main">(</span>Cla3 <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?i</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> Indet <span class="main">1</span><span class="main">)</span><span class="main">(</span><span class="inner_quoted">''q''</span> <span class="main">:=</span> Indet <span class="numeral">2</span><span class="main">,</span> <span class="inner_quoted">''r''</span> <span class="main">:=</span> Indet <span class="numeral">3</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"range <span class="var">?i</span> <span class="main">⊆</span> domain <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">,</span> <span class="numeral">3</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> image_subset_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="var">?i</span> <span class="main">(</span>Cla3 <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det False"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Det False <span class="main">≠</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Further Meta-Theorems›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Fundamental Definitions and Lemmas›</span></span>

<span class="keyword1"><span class="command">text</span></span>
<span class="quoted"><span class="plain_text">‹
The function props collects the set of propositional symbols occurring in a formula.
›</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">props</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm <span class="main">⇒</span> id set"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">props</span> Truth <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">props</span> <span class="main">(</span>Pro <span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main">}</span>"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">props</span> <span class="main">(</span>Neg' <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free">props</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span>"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">props</span> <span class="main">(</span>Con' <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free">props</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">∪</span> <span class="free">props</span> <span class="free"><span class="bound"><span class="entity">q</span></span></span>"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">props</span> <span class="main">(</span>Eql <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free">props</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">∪</span> <span class="free">props</span> <span class="free"><span class="bound"><span class="entity">q</span></span></span>"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">props</span> <span class="main">(</span>Eql' <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free">props</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">∪</span> <span class="free">props</span> <span class="free"><span class="bound"><span class="entity">q</span></span></span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> relevant_props<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">s</span> <span class="main">∈</span> props <span class="free">p</span><span class="main">.</span> <span class="free">i1</span> <span class="bound">s</span> <span class="main">=</span> <span class="free">i2</span> <span class="bound">s</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">i1</span> <span class="free">p</span> <span class="main">=</span> eval <span class="free">i2</span> <span class="free">p</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">p</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">metis</span><span class="main">)</span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">change_tv</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> tv <span class="main">⇒</span> tv"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">change_tv</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span>Det <span class="free"><span class="bound"><span class="entity">b</span></span></span><span class="main">)</span> <span class="main">=</span> Det <span class="free"><span class="bound"><span class="entity">b</span></span></span>"</span></span> <span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">change_tv</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span>Indet <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="main">=</span> Indet <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> change_tv_injection<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"inj <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"inj <span class="main">(</span>change_tv <span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"change_tv <span class="free">f</span> <span class="skolem">tv1</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="skolem">tv2</span> <span class="main">⟹</span> <span class="skolem">tv1</span> <span class="main">=</span> <span class="skolem">tv2</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">tv1</span> <span class="skolem">tv2</span>
    <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">tv1</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="skolem">tv2</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inj_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> injI<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">change_int</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> nat<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>id <span class="main">⇒</span> tv<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>id <span class="main">⇒</span> tv<span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">change_int</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">s</span><span class="main">.</span> change_tv <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="bound">s</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> eval_change<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"inj <span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="free">p</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="free">p</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">p</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval_neg <span class="main">(</span>eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">=</span> eval_neg <span class="main">(</span>change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval_neg <span class="main">(</span>eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval_neg <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p</span>"</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> case_bool_if<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Neg' <span class="skolem">p</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Neg' <span class="skolem">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p1</span> <span class="skolem">p2</span>
  <span class="keyword3"><span class="command">assume</span></span> ih1<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p1</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> ih2<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p2</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p1</span> <span class="main">=</span> eval <span class="free">i</span> <span class="skolem">p2</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p1</span> <span class="main">=</span> eval <span class="free">i</span> <span class="skolem">p2</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> yes<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> eval <span class="free">i</span> <span class="skolem">p1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> a <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p1</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p2</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">=</span> eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ih1 ih2
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> yes ih1
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> a'<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p1</span> <span class="main">≠</span> eval <span class="free">i</span> <span class="skolem">p2</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> a' <span class="keyword1"><span class="command">have</span></span> b'<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">≠</span> eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms ih1 ih2 change_tv_injection the_inv_f_f
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p1</span> <span class="main">=</span> Det True"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p1</span> <span class="main">=</span> Det True"</span></span>
      <span class="keyword1"><span class="command">from</span></span> a a' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> eval <span class="free">i</span> <span class="skolem">p2</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p2</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> a <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">=</span> Det True"</span></span>
        <span class="keyword1"><span class="command">using</span></span> ih1
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> b b' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> c ih2
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> a''<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p1</span> <span class="main">≠</span> Det True"</span></span>
      <span class="keyword1"><span class="command">from</span></span> a'' <span class="keyword1"><span class="command">have</span></span> b''<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">≠</span> Det True"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms ih1 ih2 change_tv_injection the_inv_f_f change_tv.simps
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p2</span> <span class="main">=</span> Det True"</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p2</span> <span class="main">=</span> Det True"</span></span>
        <span class="keyword1"><span class="command">from</span></span> a a' a'' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> eval <span class="free">i</span> <span class="skolem">p1</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p1</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> a <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span> <span class="main">=</span> Det True"</span></span>
          <span class="keyword1"><span class="command">using</span></span> ih2
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> b b' b'' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> c ih1
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> a'''<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p2</span> <span class="main">≠</span> Det True"</span></span>
        <span class="keyword1"><span class="command">from</span></span> a' a'' a''' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> Det False"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det False"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> a''' <span class="keyword1"><span class="command">have</span></span> b'''<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span> <span class="main">≠</span> Det True"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms ih1 ih2 change_tv_injection the_inv_f_f change_tv.simps
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
        <span class="keyword1"><span class="command">from</span></span> b' b'' b''' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> Det False"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Con' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> c
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p1</span> <span class="skolem">p2</span>
  <span class="keyword3"><span class="command">assume</span></span> ih1<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p1</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> ih2<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p2</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Det <span class="main">(</span>eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">=</span> eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span>
      Det <span class="main">(</span>change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p1</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ih1 ih2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> Det <span class="main">(</span><span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p1</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms change_tv_injection
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inj_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>Det <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p1</span> <span class="main">=</span> eval <span class="free">i</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Eql <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p1</span> <span class="skolem">p2</span>
  <span class="keyword3"><span class="command">assume</span></span> ih1<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p1</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> ih2<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p2</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p1</span> <span class="main">=</span> eval <span class="free">i</span> <span class="skolem">p2</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p1</span> <span class="main">=</span> eval <span class="free">i</span> <span class="skolem">p2</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> yes<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> a <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p1</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p2</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">=</span> eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ih1 ih2
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> yes ih1
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> a'<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p1</span> <span class="main">≠</span> eval <span class="free">i</span> <span class="skolem">p2</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p1</span> <span class="main">=</span> Det True"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p1</span> <span class="main">=</span> Det True"</span></span>
      <span class="keyword1"><span class="command">from</span></span> a a' <span class="keyword1"><span class="command">have</span></span> yes<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> eval <span class="free">i</span> <span class="skolem">p2</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> a <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p1</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">=</span> Det True"</span></span>
        <span class="keyword1"><span class="command">using</span></span> ih1
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> a' <span class="keyword1"><span class="command">have</span></span> b'<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">≠</span> eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms ih1 ih2 change_tv_injection the_inv_f_f change_tv.simps
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">from</span></span> b b' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> ih2 yes
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> a''<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p1</span> <span class="main">≠</span> Det True"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p2</span> <span class="main">=</span> Det True"</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p2</span> <span class="main">=</span> Det True"</span></span>
        <span class="keyword1"><span class="command">from</span></span> a a' a'' <span class="keyword1"><span class="command">have</span></span> yes<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> eval <span class="free">i</span> <span class="skolem">p1</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> eval_equality<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="skolem">p1</span></span> <span class="quoted"><span class="skolem">p2</span></span><span class="main">]</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> a <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span> <span class="main">=</span> Det True"</span></span>
          <span class="keyword1"><span class="command">using</span></span> ih2
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> a' <span class="keyword1"><span class="command">have</span></span> b'<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">≠</span> eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms ih1 ih2 change_tv_injection the_inv_f_f change_tv.simps
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
        <span class="keyword1"><span class="command">from</span></span> a'' <span class="keyword1"><span class="command">have</span></span> b''<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">≠</span> Det True"</span></span>
          <span class="keyword1"><span class="command">using</span></span> b b'
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> b b' b'' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> eval_equality<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"change_int <span class="free">f</span> <span class="free">i</span>"</span></span> <span class="quoted"><span class="skolem">p1</span></span> <span class="quoted"><span class="skolem">p2</span></span><span class="main">]</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> ih1 yes
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> a'''<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p2</span> <span class="main">≠</span> Det True"</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p1</span> <span class="main">=</span> Det False"</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p1</span> <span class="main">=</span> Det False"</span></span>
          <span class="keyword1"><span class="command">from</span></span> a a' a'' a''' <span class="keyword1"><span class="command">have</span></span> yes<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> eval <span class="free">i</span> <span class="main">(</span>Neg' <span class="skolem">p2</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> eval_equality<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="skolem">p1</span></span> <span class="quoted"><span class="skolem">p2</span></span><span class="main">]</span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> a <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p1</span><span class="main">)</span> <span class="main">=</span> Det False"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">=</span> Det False"</span></span>
            <span class="keyword1"><span class="command">using</span></span> ih1
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> a' <span class="keyword1"><span class="command">have</span></span> b'<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">≠</span> eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> assms ih1 ih2 change_tv_injection the_inv_f_f change_tv.simps
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
          <span class="keyword1"><span class="command">from</span></span> a'' <span class="keyword1"><span class="command">have</span></span> b''<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">≠</span> Det True"</span></span>
            <span class="keyword1"><span class="command">using</span></span> b b'
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> a''' <span class="keyword1"><span class="command">have</span></span> b'''<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span> <span class="main">≠</span> Det True"</span></span>
            <span class="keyword1"><span class="command">using</span></span> b b' b''
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms change_tv.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> change_tv_injection inj_eq ih2<span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span> b b' b'' b'''
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Neg' <span class="skolem">p2</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> eval_equality<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"change_int <span class="free">f</span> <span class="free">i</span>"</span></span> <span class="quoted"><span class="skolem">p1</span></span> <span class="quoted"><span class="skolem">p2</span></span><span class="main">]</span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> ih2 yes a a' a''' b b' b''' eval_negation
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">assume</span></span> a''''<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p1</span> <span class="main">≠</span> Det False"</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p2</span> <span class="main">=</span> Det False"</span></span><span class="main">)</span>
            <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p2</span> <span class="main">=</span> Det False"</span></span>
            <span class="keyword1"><span class="command">from</span></span> a a' a'' a''' a'''' <span class="keyword1"><span class="command">have</span></span> yes<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> eval <span class="free">i</span> <span class="main">(</span>Neg' <span class="skolem">p1</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> eval_equality<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="skolem">p1</span></span> <span class="quoted"><span class="skolem">p2</span></span><span class="main">]</span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> a <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> Det False"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span> <span class="main">=</span> Det False"</span></span>
              <span class="keyword1"><span class="command">using</span></span> ih2
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> a' <span class="keyword1"><span class="command">have</span></span> b'<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">≠</span> eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> assms ih1 ih2 change_tv_injection the_inv_f_f change_tv.simps
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
            <span class="keyword1"><span class="command">from</span></span> a'' <span class="keyword1"><span class="command">have</span></span> b''<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">≠</span> Det True"</span></span>
              <span class="keyword1"><span class="command">using</span></span> change_tv.elims ih1 tv.simps<span class="main">(</span>4<span class="main">)</span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> a''' <span class="keyword1"><span class="command">have</span></span> b'''<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span> <span class="main">≠</span> Det True"</span></span>
              <span class="keyword1"><span class="command">using</span></span> b b' b''
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms change_tv.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> change_tv_injection inj_eq ih2<span class="main">)</span>
            <span class="keyword1"><span class="command">from</span></span> a'''' <span class="keyword1"><span class="command">have</span></span> b''''<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">≠</span> Det False"</span></span>
              <span class="keyword1"><span class="command">using</span></span> b b'
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> b b' b'' b''' b''''
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Neg' <span class="skolem">p1</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> eval_equality<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"change_int <span class="free">f</span> <span class="free">i</span>"</span></span> <span class="quoted"><span class="skolem">p1</span></span> <span class="quoted"><span class="skolem">p2</span></span><span class="main">]</span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> ih1 yes a a' a''' a'''' b b' b''' b'''' eval_negation a'' b''
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">assume</span></span> a'''''<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="skolem">p2</span> <span class="main">≠</span> Det False"</span></span>
            <span class="keyword1"><span class="command">from</span></span> a' a'' a''' a'''' a''''' <span class="keyword1"><span class="command">have</span></span> yes<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> Det False"</span></span>
              <span class="keyword1"><span class="command">using</span></span> eval_equality<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="skolem">p1</span></span> <span class="quoted"><span class="skolem">p2</span></span><span class="main">]</span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> a''''' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">≠</span> Det False"</span></span>
              <span class="keyword1"><span class="command">using</span></span> change_tv_injection inj_eq assms change_tv.simps
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span> <span class="main">≠</span> Det False"</span></span>
              <span class="keyword1"><span class="command">using</span></span> ih2
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> a' <span class="keyword1"><span class="command">have</span></span> b'<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">≠</span> eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> assms ih1 ih2 change_tv_injection the_inv_f_f change_tv.simps
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
            <span class="keyword1"><span class="command">from</span></span> a'' <span class="keyword1"><span class="command">have</span></span> b''<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">≠</span> Det True"</span></span>
              <span class="keyword1"><span class="command">using</span></span> change_tv.elims ih1 tv.simps<span class="main">(</span>4<span class="main">)</span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> a''' <span class="keyword1"><span class="command">have</span></span> b'''<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p2</span> <span class="main">≠</span> Det True"</span></span>
              <span class="keyword1"><span class="command">using</span></span> b b' b''
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms change_tv.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> change_tv_injection the_inv_f_f ih2<span class="main">)</span>
            <span class="keyword1"><span class="command">from</span></span> a'''' <span class="keyword1"><span class="command">have</span></span> b''''<span class="main">:</span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="skolem">p1</span> <span class="main">≠</span> Det False"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> a'' change_tv.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> ih1 string_tv.cases tv.distinct<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
            <span class="keyword1"><span class="command">from</span></span> b b' b'' b''' b'''' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> Det False"</span></span>
              <span class="keyword1"><span class="command">using</span></span> eval_equality<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"change_int <span class="free">f</span> <span class="free">i</span>"</span></span> <span class="quoted"><span class="skolem">p1</span></span> <span class="quoted"><span class="skolem">p2</span></span><span class="main">]</span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="free">f</span> <span class="free">i</span><span class="main">)</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span> <span class="main">=</span> change_tv <span class="free">f</span> <span class="main">(</span>eval <span class="free">i</span> <span class="main">(</span>Eql' <span class="skolem">p1</span> <span class="skolem">p2</span><span class="main">)</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> ih1 yes a' a''' a'''' b b' b''' b'''' a'' b''
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> change_int_def<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Only a Finite Number of Truth Values Needed›</span></span>

<span class="keyword1"><span class="command">text</span></span>
<span class="quoted"><span class="plain_text">‹
Theorem valid_in_valid is a kind of the reverse of valid_valid_in (or its transfer variant).
›</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">is_indet</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"tv <span class="main">⇒</span> bool"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">is_indet</span> <span class="free"><span class="bound"><span class="entity">tv</span></span></span> <span class="main">≡</span> <span class="main">(</span><span class="keyword1">case</span> <span class="free"><span class="bound"><span class="entity">tv</span></span></span> <span class="keyword1">of</span> Det <span class="main"><span class="bound">_</span></span> <span class="main">⇒</span> False <span class="main">|</span> Indet <span class="main"><span class="bound">_</span></span> <span class="main">⇒</span> True<span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">get_indet</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"tv <span class="main">⇒</span> nat"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">get_indet</span> <span class="free"><span class="bound"><span class="entity">tv</span></span></span> <span class="main">≡</span> <span class="main">(</span><span class="keyword1">case</span> <span class="free"><span class="bound"><span class="entity">tv</span></span></span> <span class="keyword1">of</span> Det <span class="main"><span class="bound">_</span></span> <span class="main">⇒</span> undefined <span class="main">|</span> Indet <span class="bound">n</span> <span class="main">⇒</span> <span class="bound">n</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">theorem</span></span> valid_in_valid<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"card <span class="free">U</span> <span class="main">≥</span> card <span class="main">(</span>props <span class="free">p</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="free">U</span> <span class="free">p</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"valid <span class="free">p</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">U</span> <span class="main">⟹</span> card <span class="main">(</span>props <span class="skolem">p</span><span class="main">)</span> <span class="main">≤</span> card <span class="skolem">U</span> <span class="main">⟹</span> valid_in <span class="skolem">U</span> <span class="skolem">p</span> <span class="main">⟹</span> valid <span class="skolem">p</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">U</span> <span class="skolem">p</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> assms<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">U</span>"</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>props <span class="skolem">p</span><span class="main">)</span> <span class="main">≤</span> card <span class="skolem">U</span>"</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="skolem">U</span> <span class="skolem">p</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"valid <span class="skolem">p</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> valid_def
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span>
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> f_p<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>change_int <span class="skolem">f</span> <span class="skolem">i</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>props <span class="skolem">p</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span>domain <span class="skolem">U</span><span class="main">)</span> <span class="main">∧</span> inj <span class="skolem">f</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">U</span> <span class="main">⟹</span> card <span class="main">(</span>props <span class="skolem">p</span><span class="main">)</span> <span class="main">≤</span> card <span class="skolem">U</span> <span class="main">⟹</span>
            <span class="main">∃</span><span class="bound">f</span><span class="main">.</span> change_int <span class="bound">f</span> <span class="skolem">i</span> <span class="main">`</span> props <span class="skolem">p</span> <span class="main">⊆</span> domain <span class="skolem">U</span> <span class="main">∧</span> inj <span class="bound">f</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">U</span> <span class="skolem">p</span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword3"><span class="command">assume</span></span> assms<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">U</span>"</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>props <span class="skolem">p</span><span class="main">)</span> <span class="main">≤</span> card <span class="skolem">U</span>"</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
            <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?X</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>get_indet <span class="main">`</span> <span class="main">(</span><span class="main">(</span><span class="skolem">i</span> <span class="main">`</span> props <span class="skolem">p</span><span class="main">)</span> <span class="main">∩</span> <span class="main">{</span><span class="bound">tv</span><span class="main">.</span> is_indet <span class="bound">tv</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">have</span></span> d<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>props <span class="skolem">p</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">p</span></span><span class="main">)</span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> cx<span class="main">:</span> <span class="quoted"><span class="quoted">"card <span class="var">?X</span> <span class="main">≤</span> card <span class="skolem">U</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> assms surj_card_le Int_lower1 card_image_le finite_Int finite_imageI le_trans
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
            <span class="keyword1"><span class="command">have</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="var">?X</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> d
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> f_p<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">n</span> <span class="main">∈</span> <span class="var">?X</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">n</span> <span class="main">∈</span> <span class="skolem">U</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>inj <span class="skolem">f</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">X</span> <span class="main">⟹</span> finite <span class="skolem">Y</span> <span class="main">⟹</span> card <span class="skolem">X</span> <span class="main">≤</span> card <span class="skolem">Y</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">f</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">n</span> <span class="main">∈</span> <span class="skolem">X</span><span class="main">.</span> <span class="bound">f</span> <span class="bound">n</span> <span class="main">∈</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">∧</span> inj <span class="bound">f</span>"</span></span>
                  <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">X</span> <span class="skolem">Y</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"nat set"</span></span>
              <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
                <span class="keyword3"><span class="command">assume</span></span> assms<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="skolem">X</span>"</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">Y</span>"</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">X</span> <span class="main">≤</span> card <span class="skolem">Y</span>"</span></span>
                <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
                <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
                  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Z</span></span> <span class="keyword2"><span class="keyword">where</span></span> xyz<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Z</span> <span class="main">⊆</span> <span class="skolem">Y</span> <span class="main">∧</span> card <span class="skolem">Z</span> <span class="main">=</span> card <span class="skolem">X</span>"</span></span>
                    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> card_image card_le_inj<span class="main">)</span>
                  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"bij_betw <span class="skolem">f</span> <span class="skolem">X</span> <span class="skolem">Z</span>"</span></span>
                    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> finite_same_card_bij infinite_super<span class="main">)</span>
                  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> f_p<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">n</span> <span class="main">∈</span> <span class="skolem">X</span><span class="main">.</span> <span class="skolem">f</span> <span class="bound">n</span> <span class="main">∈</span> <span class="skolem">Y</span><span class="main">)</span> <span class="main">∧</span> inj_on <span class="skolem">f</span> <span class="skolem">X</span>"</span></span>
                    <span class="keyword1"><span class="command">using</span></span> bij_betwE bij_betw_imp_inj_on xyz
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">f'</span></span> <span class="keyword2"><span class="keyword">where</span></span> f'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f'</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="keyword1">if</span> <span class="bound">n</span> <span class="main">∈</span> <span class="skolem">X</span> <span class="keyword1">then</span> <span class="skolem">f</span> <span class="bound">n</span> <span class="keyword1">else</span> <span class="bound">n</span> <span class="main">+</span> Suc <span class="main">(</span>Max <span class="skolem">Y</span> <span class="main">+</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
                  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"inj <span class="skolem">f'</span>"</span></span>
                    <span class="keyword1"><span class="command">unfolding</span></span> f' inj_on_def
                    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> f_p le_add2 trans_le_add2 not_less_eq_eq
                    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">metis</span> Max_ge add.commute inj_on_eq_iff<span class="main">)</span>
                  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">n</span> <span class="main">∈</span> <span class="skolem">X</span><span class="main">.</span> <span class="skolem">f'</span> <span class="bound">n</span> <span class="main">∈</span> <span class="skolem">Y</span><span class="main">)</span>"</span></span>
                    <span class="keyword1"><span class="command">unfolding</span></span> f'
                    <span class="keyword1"><span class="command">using</span></span> f_p
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
                <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span><span class="bound">f</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">n</span> <span class="main">∈</span> get_indet <span class="main">`</span> <span class="main">(</span><span class="skolem">i</span> <span class="main">`</span> props <span class="skolem">p</span> <span class="main">∩</span> <span class="main">{</span><span class="bound">tv</span><span class="main">.</span> is_indet <span class="bound">tv</span><span class="main">}</span><span class="main">)</span><span class="main">.</span> <span class="bound">f</span> <span class="bound">n</span> <span class="main">∈</span> <span class="skolem">U</span><span class="main">)</span>
                  <span class="main">∧</span> inj <span class="bound">f</span> <span class="main">⟹</span> <span class="skolem">thesis</span><span class="main">)</span> <span class="main">⟹</span> <span class="skolem">thesis</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> assms cx f
                <span class="keyword1"><span class="command">unfolding</span></span> inj_on_def
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
            <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>change_int <span class="skolem">f</span> <span class="skolem">i</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>props <span class="skolem">p</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span>domain <span class="skolem">U</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">proof</span></span>
              <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
              <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> change_int <span class="skolem">f</span> <span class="skolem">i</span> <span class="main">`</span> props <span class="skolem">p</span>"</span></span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">s</span></span> <span class="keyword2"><span class="keyword">where</span></span> s_p<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">∈</span> props <span class="skolem">p</span> <span class="main">∧</span> change_int <span class="skolem">f</span> <span class="skolem">i</span> <span class="skolem">s</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"change_int <span class="skolem">f</span> <span class="skolem">i</span> <span class="skolem">s</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span> <span class="main">∪</span> Indet <span class="main">`</span> <span class="skolem">U</span>"</span></span>
              <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"change_int <span class="skolem">f</span> <span class="skolem">i</span> <span class="skolem">s</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span>"</span></span><span class="main">)</span>
                <span class="keyword3"><span class="command">case</span></span> True
                <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">next</span></span>
                <span class="keyword3"><span class="command">case</span></span> False
                <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"change_int <span class="skolem">f</span> <span class="skolem">i</span> <span class="skolem">s</span> <span class="main">=</span> Indet <span class="skolem">n'</span>"</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"change_int <span class="skolem">f</span> <span class="skolem">i</span> <span class="skolem">s</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>
                <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> p<span class="main">:</span> <span class="quoted"><span class="quoted">"change_tv <span class="skolem">f</span> <span class="main">(</span><span class="skolem">i</span> <span class="skolem">s</span><span class="main">)</span> <span class="main">=</span> Indet <span class="skolem">n'</span>"</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> change_int_def<span class="main">)</span>
                <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n'</span> <span class="main">∈</span> <span class="skolem">U</span>"</span></span>
                <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
                  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n''</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="skolem">n''</span> <span class="main">=</span> <span class="skolem">n'</span>"</span></span>
                    <span class="keyword1"><span class="command">using</span></span> calculation change_tv.elims
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">∈</span> props <span class="skolem">p</span> <span class="main">∧</span> <span class="skolem">i</span> <span class="skolem">s</span> <span class="main">=</span> <span class="main">(</span>Indet <span class="skolem">n''</span><span class="main">)</span>"</span></span>
                    <span class="keyword1"><span class="command">using</span></span> p calculation change_tv.simps change_tv_injection the_inv_f_f f_p s_p
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
                  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Indet <span class="skolem">n''</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">i</span> <span class="main">`</span> props <span class="skolem">p</span>"</span></span>
                    <span class="keyword1"><span class="command">using</span></span> image_iff
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
                  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Indet <span class="skolem">n''</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">i</span> <span class="main">`</span> props <span class="skolem">p</span> <span class="main">∧</span> is_indet <span class="main">(</span>Indet <span class="skolem">n''</span><span class="main">)</span> <span class="main">∧</span>
                      get_indet <span class="main">(</span>Indet <span class="skolem">n''</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">n''</span>"</span></span>
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n''</span> <span class="main">∈</span> <span class="var">?X</span>"</span></span>
                    <span class="keyword1"><span class="command">using</span></span> Int_Collect image_iff
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
                  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
                    <span class="keyword1"><span class="command">using</span></span> f_p
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">qed</span></span>
                <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"change_tv <span class="skolem">f</span> <span class="main">(</span><span class="skolem">i</span> <span class="skolem">s</span><span class="main">)</span> <span class="main">∈</span> Indet <span class="main">`</span> <span class="skolem">U</span>"</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"change_int <span class="skolem">f</span> <span class="skolem">i</span> <span class="skolem">s</span> <span class="main">∈</span> Indet <span class="main">`</span> <span class="skolem">U</span>"</span></span>
                  <span class="keyword1"><span class="command">unfolding</span></span> change_int_def
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> domain <span class="skolem">U</span>"</span></span>
                <span class="keyword1"><span class="command">unfolding</span></span> domain_def
                <span class="keyword1"><span class="command">using</span></span> s_p
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>change_int <span class="skolem">f</span> <span class="skolem">i</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span>props <span class="skolem">p</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span>domain <span class="skolem">U</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span>inj <span class="skolem">f</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">unfolding</span></span> domain_def
              <span class="keyword1"><span class="command">using</span></span> f_p
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
              <span class="keyword1"><span class="command">using</span></span> f_p
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span><span class="bound">f</span><span class="main">.</span> change_int <span class="bound">f</span> <span class="skolem">i</span> <span class="main">`</span> props <span class="skolem">p</span> <span class="main">⊆</span> domain <span class="skolem">U</span> <span class="main">∧</span> inj <span class="bound">f</span> <span class="main">⟹</span> <span class="skolem">thesis</span><span class="main">)</span> <span class="main">⟹</span> <span class="skolem">thesis</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i2</span></span> <span class="keyword2"><span class="keyword">where</span></span> i2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">i2</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> <span class="keyword1">if</span> <span class="bound">s</span> <span class="main">∈</span> props <span class="skolem">p</span> <span class="keyword1">then</span> <span class="main">(</span>change_int <span class="skolem">f</span> <span class="skolem">i</span><span class="main">)</span> <span class="bound">s</span> <span class="keyword1">else</span> Det True<span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> i2_p<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">s</span> <span class="main">∈</span> props <span class="skolem">p</span><span class="main">.</span> <span class="skolem">i2</span> <span class="bound">s</span> <span class="main">=</span> <span class="main">(</span>change_int <span class="skolem">f</span> <span class="skolem">i</span><span class="main">)</span> <span class="bound">s</span>"</span></span>
            <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">s</span> <span class="main">∈</span> <span class="main">-</span> props <span class="skolem">p</span><span class="main">.</span> <span class="skolem">i2</span> <span class="bound">s</span> <span class="main">=</span> Det True"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"range <span class="skolem">i2</span> <span class="main">⊆</span> <span class="main">(</span>domain <span class="skolem">U</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> i2 f_p
        <span class="keyword1"><span class="command">unfolding</span></span> domain_def
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i2</span> <span class="skolem">p</span> <span class="main">=</span> Det True"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms
        <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="main">(</span>change_int <span class="skolem">f</span> <span class="skolem">i</span><span class="main">)</span> <span class="skolem">p</span> <span class="main">=</span> Det True"</span></span>
        <span class="keyword1"><span class="command">using</span></span> relevant_props<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">p</span></span> <span class="quoted"><span class="skolem">i2</span></span> <span class="quoted"><span class="quoted">"change_int <span class="skolem">f</span> <span class="skolem">i</span>"</span></span><span class="main">]</span> i2_p
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"change_tv <span class="skolem">f</span> <span class="main">(</span>eval <span class="skolem">i</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
        <span class="keyword1"><span class="command">using</span></span> eval_change f_p
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="skolem">p</span> <span class="main">=</span> Det True"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="skolem">p</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> assms subsetI sup_bot.comm_neutral image_is_empty subsetCE UnCI valid_in_def
        Un_insert_left card.empty card.infinite finite.intros<span class="main">(</span>1<span class="main">)</span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> reduce<span class="main">:</span> <span class="quoted"><span class="quoted">"valid <span class="free">p</span> <span class="main">⟷</span> valid_in <span class="main">{</span><span class="main">1</span><span class="main">..</span>card <span class="main">(</span>props <span class="free">p</span><span class="main">)</span><span class="main">}</span> <span class="free">p</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> valid_in_valid transfer
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Case Study›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Abbreviations›</span></span>

<span class="keyword1"><span class="command">text</span></span>
<span class="quoted"><span class="plain_text">‹
Entailment takes a list of assumptions.
›</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">Entail</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"fm list <span class="main">⇒</span> fm <span class="main">⇒</span> fm"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">Entail</span> <span class="free"><span class="bound"><span class="entity">l</span></span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">≡</span> Imp <span class="main">(</span><span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">l</span></span></span> <span class="main">=</span> <span class="main">[]</span> <span class="keyword1">then</span> Truth <span class="keyword1">else</span> fold Con' <span class="main">(</span>butlast <span class="free"><span class="bound"><span class="entity">l</span></span></span><span class="main">)</span> <span class="main">(</span>last <span class="free"><span class="bound"><span class="entity">l</span></span></span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span>"</span></span>

<span class="keyword1"><span class="command">theorem</span></span> entailment_not_chain<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid <span class="main">(</span>Eql <span class="main">(</span>Entail <span class="main">[</span>Pro <span class="inner_quoted">''p''</span><span class="main">,</span> Pro <span class="inner_quoted">''q''</span><span class="main">]</span> <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span>
      <span class="main">(</span>Box <span class="main">(</span><span class="main">(</span>Imp' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Imp' <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?i</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> Indet <span class="main">1</span><span class="main">)</span><span class="main">(</span><span class="inner_quoted">''r''</span> <span class="main">:=</span> Det False<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="var">?i</span> <span class="main">(</span>Eql <span class="main">(</span>Entail <span class="main">[</span>Pro <span class="inner_quoted">''p''</span><span class="main">,</span> Pro <span class="inner_quoted">''q''</span><span class="main">]</span> <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span>
      <span class="main">(</span>Box <span class="main">(</span><span class="main">(</span>Imp' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Imp' <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det False"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Det False <span class="main">≠</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> valid_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">B0</span> <span class="main">::</span> <span class="quoted">fm</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">B0</span> <span class="main">≡</span> Con' <span class="main">(</span>Con' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">B1</span> <span class="main">::</span> <span class="quoted">fm</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">B1</span> <span class="main">≡</span> Imp' <span class="main">(</span>Con' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">B2</span> <span class="main">::</span> <span class="quoted">fm</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">B2</span> <span class="main">≡</span> Imp' <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span> <span class="main">(</span>Pro <span class="inner_quoted">''s''</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">B3</span> <span class="main">::</span> <span class="quoted">fm</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">B3</span> <span class="main">≡</span> Imp' <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''s''</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Results›</span></span>

<span class="keyword1"><span class="command">text</span></span>
<span class="quoted"><span class="plain_text">‹
The paraconsistent logic is usable in contrast to classical logic.
›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> classical_logic_is_not_usable<span class="main">:</span> <span class="quoted"><span class="quoted">"valid_boole <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> B1<span class="main">]</span> <span class="free">p</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"id <span class="main">⇒</span> tv"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"range <span class="skolem">i</span> <span class="main">⊆</span> domain <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''p''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''q''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''r''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> B1<span class="main">]</span> <span class="free">p</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''p''</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''q''</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''r''</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="quoted"><span class="quoted">"valid_boole <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> B1<span class="main">]</span> <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> classical_logic_is_not_usable<span class="main">)</span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="quoted"><span class="quoted">"valid_boole <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> B1<span class="main">]</span> <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> classical_logic_is_not_usable<span class="main">)</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> B1<span class="main">]</span> <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?i</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> Indet <span class="main">1</span><span class="main">)</span><span class="main">(</span><span class="inner_quoted">''r''</span> <span class="main">:=</span> Det False<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="var">?i</span> <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> B1<span class="main">]</span> <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det False"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Det False <span class="main">≠</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> valid_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid_boole <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">]</span> <span class="free">p</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"id <span class="main">⇒</span> tv"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"range <span class="skolem">i</span> <span class="main">⊆</span> domain <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''p''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''q''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''r''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> domain_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">]</span> <span class="free">p</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''p''</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''q''</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''r''</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?i</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> Indet <span class="main">1</span><span class="main">)</span><span class="main">(</span><span class="inner_quoted">''p''</span> <span class="main">:=</span> Det True<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="var">?i</span> <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''p''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det False"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Det False <span class="main">≠</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> valid_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?i</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> Indet <span class="main">1</span><span class="main">)</span><span class="main">(</span><span class="inner_quoted">''q''</span> <span class="main">:=</span> Det True<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="var">?i</span> <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''q''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det False"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Det False <span class="main">≠</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> valid_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> valid <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''s''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?i</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">s</span><span class="main">.</span> Indet <span class="main">1</span><span class="main">)</span><span class="main">(</span><span class="inner_quoted">''s''</span> <span class="main">:=</span> Det True<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"eval <span class="var">?i</span> <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''s''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det False"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Det False <span class="main">≠</span> Det True"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> valid_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">1</span><span class="main">..</span>card <span class="main">(</span>props <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">,</span> <span class="numeral">3</span><span class="main">,</span> <span class="numeral">4</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">code_simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">,</span> <span class="numeral">3</span><span class="main">,</span> <span class="numeral">4</span><span class="main">}</span> <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"id <span class="main">⇒</span> tv"</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"range <span class="skolem">i</span> <span class="main">⊆</span> domain <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">,</span> <span class="numeral">3</span><span class="main">,</span> <span class="numeral">4</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> icase<span class="main">:</span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''p''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">,</span> Indet <span class="numeral">3</span><span class="main">,</span> Indet <span class="numeral">4</span><span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''q''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">,</span> Indet <span class="numeral">3</span><span class="main">,</span> Indet <span class="numeral">4</span><span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''r''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">,</span> Indet <span class="numeral">3</span><span class="main">,</span> Indet <span class="numeral">4</span><span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''s''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">,</span> Indet <span class="numeral">3</span><span class="main">,</span> Indet <span class="numeral">4</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> domain_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
      <span class="keyword1"><span class="command">using</span></span> icase
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''p''</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''q''</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''r''</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''s''</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> reduce
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">1</span><span class="main">..</span>card <span class="main">(</span>props <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">,</span> <span class="numeral">3</span><span class="main">,</span> <span class="numeral">4</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">code_simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">,</span> <span class="numeral">3</span><span class="main">,</span> <span class="numeral">4</span><span class="main">}</span> <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"id <span class="main">⇒</span> tv"</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"range <span class="skolem">i</span> <span class="main">⊆</span> domain <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">,</span> <span class="numeral">3</span><span class="main">,</span> <span class="numeral">4</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> icase<span class="main">:</span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''p''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">,</span> Indet <span class="numeral">3</span><span class="main">,</span> Indet <span class="numeral">4</span><span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''q''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">,</span> Indet <span class="numeral">3</span><span class="main">,</span> Indet <span class="numeral">4</span><span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''r''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">,</span> Indet <span class="numeral">3</span><span class="main">,</span> Indet <span class="numeral">4</span><span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''s''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">,</span> Indet <span class="numeral">3</span><span class="main">,</span> Indet <span class="numeral">4</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> domain_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Neg' <span class="main">(</span>Pro <span class="inner_quoted">''r''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
      <span class="keyword1"><span class="command">using</span></span> icase
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''p''</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''q''</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''r''</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''s''</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> reduce
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">"valid <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Pro <span class="inner_quoted">''s''</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">1</span><span class="main">..</span>card <span class="main">(</span>props <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Pro <span class="inner_quoted">''s''</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">,</span> <span class="numeral">3</span><span class="main">,</span> <span class="numeral">4</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">code_simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"valid_in <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">,</span> <span class="numeral">3</span><span class="main">,</span> <span class="numeral">4</span><span class="main">}</span> <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Pro <span class="inner_quoted">''s''</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> valid_in_def
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"id <span class="main">⇒</span> tv"</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"range <span class="skolem">i</span> <span class="main">⊆</span> domain <span class="main">{</span><span class="main">1</span><span class="main">,</span> <span class="numeral">2</span><span class="main">,</span> <span class="numeral">3</span><span class="main">,</span> <span class="numeral">4</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> icase<span class="main">:</span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''p''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">,</span> Indet <span class="numeral">3</span><span class="main">,</span> Indet <span class="numeral">4</span><span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''q''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">,</span> Indet <span class="numeral">3</span><span class="main">,</span> Indet <span class="numeral">4</span><span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''r''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">,</span> Indet <span class="numeral">3</span><span class="main">,</span> Indet <span class="numeral">4</span><span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''s''</span> <span class="main">∈</span> <span class="main">{</span>Det True<span class="main">,</span> Det False<span class="main">,</span> Indet <span class="main">1</span><span class="main">,</span> Indet <span class="numeral">2</span><span class="main">,</span> Indet <span class="numeral">3</span><span class="main">,</span> Indet <span class="numeral">4</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> domain_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"eval <span class="skolem">i</span> <span class="main">(</span>Entail <span class="main">[</span>B0<span class="main">,</span> Box B1<span class="main">,</span> Box B2<span class="main">]</span> <span class="main">(</span>Pro <span class="inner_quoted">''s''</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Det True"</span></span>
      <span class="keyword1"><span class="command">using</span></span> icase
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''p''</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''q''</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''r''</span>"</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="inner_quoted">''s''</span>"</span></span><span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> reduce
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Acknowledgements›</span></span>

<span class="keyword1"><span class="command">text</span></span>
<span class="quoted"><span class="plain_text">‹
Thanks to the Isabelle developers for making a superb system and for always being willing to help.
›</span></span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹Paraconsistency file›</span>
</pre>
</div>